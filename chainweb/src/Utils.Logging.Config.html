<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span id="%24con2tag_GLh2J8w3XuXFVMdUhG26g2"><span id="%24maxtag_9wMadZqfr7S8gibCJlSPHs"><span id="%24tag2con_9wMadZqfr7S8gibCJlSPHs"><span id="%24con2tag_9wMadZqfr7S8gibCJlSPHs"></span></span></span></span><span class="hs-pragma">{-# LANGUAGE DeriveAnyClass #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE DeriveGeneric #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE DerivingStrategies #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE FlexibleContexts #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# LANGUAGE FlexibleInstances #-}</span><span>
</span><span id="line-6"></span><span class="hs-pragma">{-# LANGUAGE GeneralizedNewtypeDeriving #-}</span><span>
</span><span id="line-7"></span><span class="hs-pragma">{-# LANGUAGE LambdaCase #-}</span><span>
</span><span id="line-8"></span><span class="hs-pragma">{-# LANGUAGE OverloadedStrings #-}</span><span>
</span><span id="line-9"></span><span class="hs-pragma">{-# LANGUAGE ScopedTypeVariables #-}</span><span>
</span><span id="line-10"></span><span class="hs-pragma">{-# LANGUAGE TemplateHaskell #-}</span><span>
</span><span id="line-11"></span><span class="hs-pragma">{-# LANGUAGE TypeApplications #-}</span><span>
</span><span id="line-12"></span><span>
</span><span id="line-13"></span><span class="hs-comment">-- |</span><span>
</span><span id="line-14"></span><span class="hs-comment">-- Module: Utils.Logging.Config</span><span>
</span><span id="line-15"></span><span class="hs-comment">-- Copyright: Copyright &#169; 2019 Kadena LLC.</span><span>
</span><span id="line-16"></span><span class="hs-comment">-- License: MIT</span><span>
</span><span id="line-17"></span><span class="hs-comment">-- Maintainer: Lars Kuhtz &lt;lars@kadena.io&gt;</span><span>
</span><span id="line-18"></span><span class="hs-comment">-- Stability: experimental</span><span>
</span><span id="line-19"></span><span class="hs-comment">--</span><span>
</span><span id="line-20"></span><span class="hs-comment">-- Configuration for generic logging utils</span><span>
</span><span id="line-21"></span><span class="hs-comment">--</span><span>
</span><span id="line-22"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Utils.Logging.Config</span><span>
</span><span id="line-23"></span><span class="hs-special">(</span><span>
</span><span id="line-24"></span><span class="annot"><span class="hs-comment">-- * Log Format</span></span><span>
</span><span id="line-25"></span><span>  </span><span class="annot"><a href="Utils.Logging.Config.html#LogFormat"><span class="hs-identifier">LogFormat</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-26"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Utils.Logging.Config.html#logFormatToText"><span class="hs-identifier">logFormatToText</span></a></span><span>
</span><span id="line-27"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Utils.Logging.Config.html#logFormatFromText"><span class="hs-identifier">logFormatFromText</span></a></span><span>
</span><span id="line-28"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Utils.Logging.Config.html#pLogFormat"><span class="hs-identifier">pLogFormat</span></a></span><span>
</span><span id="line-29"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Utils.Logging.Config.html#pLogFormat_"><span class="hs-identifier">pLogFormat_</span></a></span><span>
</span><span id="line-30"></span><span>
</span><span id="line-31"></span><span class="annot"><span class="hs-comment">-- * Logging Backend Handle</span></span><span>
</span><span id="line-32"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Utils.Logging.Config.html#HandleConfig"><span class="hs-identifier">HandleConfig</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-33"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Utils.Logging.Config.html#pHandleConfig"><span class="hs-identifier">pHandleConfig</span></a></span><span>
</span><span id="line-34"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Utils.Logging.Config.html#pHandleConfig_"><span class="hs-identifier">pHandleConfig_</span></a></span><span>
</span><span id="line-35"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Utils.Logging.Config.html#validateHandleConfig"><span class="hs-identifier">validateHandleConfig</span></a></span><span>
</span><span id="line-36"></span><span>
</span><span id="line-37"></span><span class="annot"><span class="hs-comment">-- * Logger Backend</span></span><span>
</span><span id="line-38"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Utils.Logging.Config.html#BackendConfig"><span class="hs-identifier">BackendConfig</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-39"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Utils.Logging.Config.html#backendConfigColor"><span class="hs-identifier">backendConfigColor</span></a></span><span>
</span><span id="line-40"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Utils.Logging.Config.html#backendConfigHandle"><span class="hs-identifier">backendConfigHandle</span></a></span><span>
</span><span id="line-41"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Utils.Logging.Config.html#defaultBackendConfig"><span class="hs-identifier">defaultBackendConfig</span></a></span><span>
</span><span id="line-42"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Utils.Logging.Config.html#validateBackendConfig"><span class="hs-identifier">validateBackendConfig</span></a></span><span>
</span><span id="line-43"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Utils.Logging.Config.html#pBackendConfig"><span class="hs-identifier">pBackendConfig</span></a></span><span>
</span><span id="line-44"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Utils.Logging.Config.html#pBackendConfig_"><span class="hs-identifier">pBackendConfig_</span></a></span><span>
</span><span id="line-45"></span><span>
</span><span id="line-46"></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-47"></span><span>
</span><span id="line-48"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Configuration.Utils</span></span><span>
</span><span id="line-49"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Configuration.Utils.Validation</span></span><span>
</span><span id="line-50"></span><span>
</span><span id="line-51"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.DeepSeq</span></span><span>
</span><span id="line-52"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Lens.TH</span></span><span>
</span><span id="line-53"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Catch</span></span><span>
</span><span id="line-54"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Error.Class</span></span><span>
</span><span id="line-55"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Writer</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">tell</span></span><span class="hs-special">)</span><span>
</span><span id="line-56"></span><span>
</span><span id="line-57"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.CaseInsensitive</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">CI</span></span><span>
</span><span id="line-58"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.String</span></span><span>
</span><span id="line-59"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Text</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">T</span></span><span>
</span><span id="line-60"></span><span>
</span><span id="line-61"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">GHC.Generics</span></span><span>
</span><span id="line-62"></span><span>
</span><span id="line-63"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Network.HTTP.Client</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">HTTP</span></span><span>
</span><span id="line-64"></span><span>
</span><span id="line-65"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">System.Logger.Backend.ColorOption</span></span><span>
</span><span id="line-66"></span><span>
</span><span id="line-67"></span><span class="hs-comment">-- internal modules</span><span>
</span><span id="line-68"></span><span>
</span><span id="line-69"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Chainweb.Utils.html"><span class="hs-identifier">Chainweb.Utils</span></a></span><span>
</span><span id="line-70"></span><span>
</span><span id="line-71"></span><span class="hs-comment">-- -------------------------------------------------------------------------- --</span><span>
</span><span id="line-72"></span><span class="hs-comment">-- Log Format</span><span>
</span><span id="line-73"></span><span>
</span><span id="line-74"></span><span id="local-6989586621681501625"><span id="local-6989586621681501626"></span></span><span class="hs-keyword">data</span><span> </span><span id="LogFormat"><span class="annot"><a href="Utils.Logging.Config.html#LogFormat"><span class="hs-identifier hs-var">LogFormat</span></a></span></span><span>
</span><span id="line-75"></span><span>    </span><span class="hs-glyph">=</span><span> </span><span id="LogFormatText"><span class="annot"><a href="Utils.Logging.Config.html#LogFormatText"><span class="hs-identifier hs-var">LogFormatText</span></a></span></span><span>
</span><span id="line-76"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="LogFormatJson"><span class="annot"><a href="Utils.Logging.Config.html#LogFormatJson"><span class="hs-identifier hs-var">LogFormatJson</span></a></span></span><span>
</span><span id="line-77"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681501617"><span id="local-6989586621681501619"><span id="local-6989586621681501621"><span class="annot"><span class="annottext">Int -&gt; LogFormat -&gt; ShowS
[LogFormat] -&gt; ShowS
LogFormat -&gt; String
(Int -&gt; LogFormat -&gt; ShowS)
-&gt; (LogFormat -&gt; String)
-&gt; ([LogFormat] -&gt; ShowS)
-&gt; Show LogFormat
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [LogFormat] -&gt; ShowS
$cshowList :: [LogFormat] -&gt; ShowS
show :: LogFormat -&gt; String
$cshow :: LogFormat -&gt; String
showsPrec :: Int -&gt; LogFormat -&gt; ShowS
$cshowsPrec :: Int -&gt; LogFormat -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681501612"><span id="local-6989586621681501614"><span class="annot"><span class="annottext">LogFormat -&gt; LogFormat -&gt; Bool
(LogFormat -&gt; LogFormat -&gt; Bool)
-&gt; (LogFormat -&gt; LogFormat -&gt; Bool) -&gt; Eq LogFormat
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: LogFormat -&gt; LogFormat -&gt; Bool
$c/= :: LogFormat -&gt; LogFormat -&gt; Bool
== :: LogFormat -&gt; LogFormat -&gt; Bool
$c== :: LogFormat -&gt; LogFormat -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681501596"><span id="local-6989586621681501598"><span id="local-6989586621681501600"><span id="local-6989586621681501602"><span id="local-6989586621681501604"><span id="local-6989586621681501606"><span id="local-6989586621681501608"><span class="annot"><span class="annottext">Eq LogFormat
Eq LogFormat =&gt;
(LogFormat -&gt; LogFormat -&gt; Ordering)
-&gt; (LogFormat -&gt; LogFormat -&gt; Bool)
-&gt; (LogFormat -&gt; LogFormat -&gt; Bool)
-&gt; (LogFormat -&gt; LogFormat -&gt; Bool)
-&gt; (LogFormat -&gt; LogFormat -&gt; Bool)
-&gt; (LogFormat -&gt; LogFormat -&gt; LogFormat)
-&gt; (LogFormat -&gt; LogFormat -&gt; LogFormat)
-&gt; Ord LogFormat
LogFormat -&gt; LogFormat -&gt; Bool
LogFormat -&gt; LogFormat -&gt; Ordering
LogFormat -&gt; LogFormat -&gt; LogFormat
forall a.
Eq a =&gt;
(a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
min :: LogFormat -&gt; LogFormat -&gt; LogFormat
$cmin :: LogFormat -&gt; LogFormat -&gt; LogFormat
max :: LogFormat -&gt; LogFormat -&gt; LogFormat
$cmax :: LogFormat -&gt; LogFormat -&gt; LogFormat
&gt;= :: LogFormat -&gt; LogFormat -&gt; Bool
$c&gt;= :: LogFormat -&gt; LogFormat -&gt; Bool
&gt; :: LogFormat -&gt; LogFormat -&gt; Bool
$c&gt; :: LogFormat -&gt; LogFormat -&gt; Bool
&lt;= :: LogFormat -&gt; LogFormat -&gt; Bool
$c&lt;= :: LogFormat -&gt; LogFormat -&gt; Bool
&lt; :: LogFormat -&gt; LogFormat -&gt; Bool
$c&lt; :: LogFormat -&gt; LogFormat -&gt; Bool
compare :: LogFormat -&gt; LogFormat -&gt; Ordering
$ccompare :: LogFormat -&gt; LogFormat -&gt; Ordering
$cp1Ord :: Eq LogFormat
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681501591"><span id="local-6989586621681501593"><span class="annot"><span class="annottext">LogFormat
LogFormat -&gt; LogFormat -&gt; Bounded LogFormat
forall a. a -&gt; a -&gt; Bounded a
maxBound :: LogFormat
$cmaxBound :: LogFormat
minBound :: LogFormat
$cminBound :: LogFormat
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Bounded</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681501574"><span id="local-6989586621681501576"><span id="local-6989586621681501578"><span id="local-6989586621681501580"><span id="local-6989586621681501582"><span id="local-6989586621681501584"><span id="local-6989586621681501586"><span id="local-6989586621681501588"><span class="annot"><span class="annottext">Int -&gt; LogFormat
LogFormat -&gt; Int
LogFormat -&gt; [LogFormat]
LogFormat -&gt; LogFormat
LogFormat -&gt; LogFormat -&gt; [LogFormat]
LogFormat -&gt; LogFormat -&gt; LogFormat -&gt; [LogFormat]
(LogFormat -&gt; LogFormat)
-&gt; (LogFormat -&gt; LogFormat)
-&gt; (Int -&gt; LogFormat)
-&gt; (LogFormat -&gt; Int)
-&gt; (LogFormat -&gt; [LogFormat])
-&gt; (LogFormat -&gt; LogFormat -&gt; [LogFormat])
-&gt; (LogFormat -&gt; LogFormat -&gt; [LogFormat])
-&gt; (LogFormat -&gt; LogFormat -&gt; LogFormat -&gt; [LogFormat])
-&gt; Enum LogFormat
forall a.
(a -&gt; a)
-&gt; (a -&gt; a)
-&gt; (Int -&gt; a)
-&gt; (a -&gt; Int)
-&gt; (a -&gt; [a])
-&gt; (a -&gt; a -&gt; [a])
-&gt; (a -&gt; a -&gt; [a])
-&gt; (a -&gt; a -&gt; a -&gt; [a])
-&gt; Enum a
enumFromThenTo :: LogFormat -&gt; LogFormat -&gt; LogFormat -&gt; [LogFormat]
$cenumFromThenTo :: LogFormat -&gt; LogFormat -&gt; LogFormat -&gt; [LogFormat]
enumFromTo :: LogFormat -&gt; LogFormat -&gt; [LogFormat]
$cenumFromTo :: LogFormat -&gt; LogFormat -&gt; [LogFormat]
enumFromThen :: LogFormat -&gt; LogFormat -&gt; [LogFormat]
$cenumFromThen :: LogFormat -&gt; LogFormat -&gt; [LogFormat]
enumFrom :: LogFormat -&gt; [LogFormat]
$cenumFrom :: LogFormat -&gt; [LogFormat]
fromEnum :: LogFormat -&gt; Int
$cfromEnum :: LogFormat -&gt; Int
toEnum :: Int -&gt; LogFormat
$ctoEnum :: Int -&gt; LogFormat
pred :: LogFormat -&gt; LogFormat
$cpred :: LogFormat -&gt; LogFormat
succ :: LogFormat -&gt; LogFormat
$csucc :: LogFormat -&gt; LogFormat
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Enum</span></span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(forall x. LogFormat -&gt; Rep LogFormat x)
-&gt; (forall x. Rep LogFormat x -&gt; LogFormat) -&gt; Generic LogFormat
forall x. Rep LogFormat x -&gt; LogFormat
forall x. LogFormat -&gt; Rep LogFormat x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
$cto :: forall x. Rep LogFormat x -&gt; LogFormat
$cfrom :: forall x. LogFormat -&gt; Rep LogFormat x
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">Generic</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681501568"><span class="annot"><span class="annottext">LogFormat -&gt; ()
(LogFormat -&gt; ()) -&gt; NFData LogFormat
forall a. (a -&gt; ()) -&gt; NFData a
rnf :: LogFormat -&gt; ()
$crnf :: LogFormat -&gt; ()
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">NFData</span></span></span><span class="hs-special">)</span><span>
</span><span id="line-78"></span><span>
</span><span id="line-79"></span><span id="local-6989586621681501731"><span class="annot"><a href="Utils.Logging.Config.html#logFormatToText"><span class="hs-identifier hs-type">logFormatToText</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IsString</span></span><span> </span><span class="annot"><a href="#local-6989586621681501731"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Utils.Logging.Config.html#LogFormat"><span class="hs-identifier hs-type">LogFormat</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681501731"><span class="hs-identifier hs-type">p</span></a></span></span><span>
</span><span id="line-80"></span><span id="logFormatToText"><span class="annot"><span class="annottext">logFormatToText :: LogFormat -&gt; p
</span><a href="Utils.Logging.Config.html#logFormatToText"><span class="hs-identifier hs-var hs-var">logFormatToText</span></a></span></span><span> </span><span class="annot"><a href="Utils.Logging.Config.html#LogFormatText"><span class="hs-identifier hs-type">LogFormatText</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-string">&quot;text&quot;</span></span><span>
</span><span id="line-81"></span><span class="annot"><a href="Utils.Logging.Config.html#logFormatToText"><span class="hs-identifier hs-var">logFormatToText</span></a></span><span> </span><span class="annot"><a href="Utils.Logging.Config.html#LogFormatJson"><span class="hs-identifier hs-type">LogFormatJson</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-string">&quot;json&quot;</span></span><span>
</span><span id="line-82"></span><span>
</span><span id="line-83"></span><span id="local-6989586621681501566"><span class="annot"><a href="Utils.Logging.Config.html#logFormatFromText"><span class="hs-identifier hs-type">logFormatFromText</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadThrow</span></span><span> </span><span class="annot"><a href="#local-6989586621681501566"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681501566"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Utils.Logging.Config.html#LogFormat"><span class="hs-identifier hs-type">LogFormat</span></a></span></span><span>
</span><span id="line-84"></span><span id="logFormatFromText"><span class="annot"><span class="annottext">logFormatFromText :: Text -&gt; m LogFormat
</span><a href="Utils.Logging.Config.html#logFormatFromText"><span class="hs-identifier hs-var hs-var">logFormatFromText</span></a></span></span><span> </span><span id="local-6989586621681501565"><span class="annot"><span class="annottext">t :: Text
</span><a href="#local-6989586621681501565"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Text -&gt; CI Text
forall s. FoldCase s =&gt; s -&gt; CI s
</span><span class="hs-identifier hs-var">CI.mk</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621681501565"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-85"></span><span>    </span><span class="hs-string">&quot;text&quot;</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">LogFormat -&gt; m LogFormat
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">LogFormat
</span><a href="Utils.Logging.Config.html#LogFormatText"><span class="hs-identifier hs-var">LogFormatText</span></a></span><span>
</span><span id="line-86"></span><span>    </span><span class="hs-string">&quot;json&quot;</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">LogFormat -&gt; m LogFormat
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">LogFormat
</span><a href="Utils.Logging.Config.html#LogFormatJson"><span class="hs-identifier hs-var">LogFormatJson</span></a></span><span>
</span><span id="line-87"></span><span>    </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">EncodingException -&gt; m LogFormat
forall (m :: * -&gt; *) e a. (MonadThrow m, Exception e) =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwM</span></span><span> </span><span class="annot"><span class="annottext">(EncodingException -&gt; m LogFormat)
-&gt; EncodingException -&gt; m LogFormat
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; EncodingException
</span><a href="Chainweb.Utils.html#TextFormatException"><span class="hs-identifier hs-var">TextFormatException</span></a></span><span>
</span><span id="line-88"></span><span>        </span><span class="annot"><span class="annottext">(Text -&gt; EncodingException) -&gt; Text -&gt; EncodingException
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="hs-string">&quot;Unknown log format: \&quot;&quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621681501565"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="hs-string">&quot;\&quot;. Expected \&quot;text\&quot; or \&quot;json\&quot;.&quot;</span></span><span>
</span><span id="line-89"></span><span>
</span><span id="line-90"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Chainweb.Utils.html#HasTextRepresentation"><span class="hs-identifier hs-type">HasTextRepresentation</span></a></span><span> </span><span class="annot"><a href="Utils.Logging.Config.html#LogFormat"><span class="hs-identifier hs-type">LogFormat</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-91"></span><span>    </span><span id="local-6989586621681501558"><span class="annot"><span class="annottext">toText :: LogFormat -&gt; Text
</span><a href="Chainweb.Utils.html#toText"><span class="hs-identifier hs-var hs-var hs-var hs-var">toText</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LogFormat -&gt; Text
forall p. IsString p =&gt; LogFormat -&gt; p
</span><a href="Utils.Logging.Config.html#logFormatToText"><span class="hs-identifier hs-var">logFormatToText</span></a></span><span>
</span><span id="line-92"></span><span>    </span><span id="local-6989586621681501556"><span class="annot"><span class="annottext">fromText :: Text -&gt; m LogFormat
</span><a href="Chainweb.Utils.html#fromText"><span class="hs-identifier hs-var hs-var hs-var hs-var">fromText</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; m LogFormat
forall (m :: * -&gt; *). MonadThrow m =&gt; Text -&gt; m LogFormat
</span><a href="Utils.Logging.Config.html#logFormatFromText"><span class="hs-identifier hs-var">logFormatFromText</span></a></span><span>
</span><span id="line-93"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Chainweb.Utils.html#toText"><span class="hs-pragma hs-type">toText</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-94"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Chainweb.Utils.html#fromText"><span class="hs-pragma hs-type">fromText</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-95"></span><span>
</span><span id="line-96"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681501548"><span id="local-6989586621681501550"><span id="local-6989586621681501552"><span class="annot"><span class="hs-identifier hs-type">ToJSON</span></span><span> </span><span class="annot"><a href="Utils.Logging.Config.html#LogFormat"><span class="hs-identifier hs-type">LogFormat</span></a></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-97"></span><span>    </span><span id="local-6989586621681501546"><span class="annot"><span class="annottext">toJSON :: LogFormat -&gt; Value
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">toJSON</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ToJSON Text =&gt; Text -&gt; Value
forall a. ToJSON a =&gt; a -&gt; Value
</span><span class="hs-identifier hs-var">toJSON</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Value) -&gt; (LogFormat -&gt; Text) -&gt; LogFormat -&gt; Value
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">LogFormat -&gt; Text
forall p. IsString p =&gt; LogFormat -&gt; p
</span><a href="Utils.Logging.Config.html#logFormatToText"><span class="hs-identifier hs-var">logFormatToText</span></a></span><span>
</span><span id="line-98"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><span class="hs-pragma hs-type">toJSON</span></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-99"></span><span>
</span><span id="line-100"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681501541"><span class="annot"><span class="hs-identifier hs-type">FromJSON</span></span><span> </span><span class="annot"><a href="Utils.Logging.Config.html#LogFormat"><span class="hs-identifier hs-type">LogFormat</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-101"></span><span>    </span><span id="local-6989586621681501539"><span class="annot"><span class="annottext">parseJSON :: Value -&gt; Parser LogFormat
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">parseJSON</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Value -&gt; Parser LogFormat
forall a. HasTextRepresentation a =&gt; String -&gt; Value -&gt; Parser a
</span><a href="Chainweb.Utils.html#parseJsonFromText"><span class="hs-identifier hs-var">parseJsonFromText</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;LogFormat&quot;</span></span><span>
</span><span id="line-102"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><span class="hs-pragma hs-type">parseJSON</span></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-103"></span><span>
</span><span id="line-104"></span><span class="annot"><a href="Utils.Logging.Config.html#pLogFormat"><span class="hs-identifier hs-type">pLogFormat</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Chainweb.Utils.html#OptionParser"><span class="hs-identifier hs-type">OptionParser</span></a></span><span> </span><span class="annot"><a href="Utils.Logging.Config.html#LogFormat"><span class="hs-identifier hs-type">LogFormat</span></a></span><span>
</span><span id="line-105"></span><span id="pLogFormat"><span class="annot"><span class="annottext">pLogFormat :: OptionParser LogFormat
</span><a href="Utils.Logging.Config.html#pLogFormat"><span class="hs-identifier hs-var hs-var">pLogFormat</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; OptionParser LogFormat
</span><a href="Utils.Logging.Config.html#pLogFormat_"><span class="hs-identifier hs-var">pLogFormat_</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-106"></span><span>
</span><span id="line-107"></span><span class="annot"><a href="Utils.Logging.Config.html#pLogFormat_"><span class="hs-identifier hs-type">pLogFormat_</span></a></span><span>
</span><span id="line-108"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span>
</span><span id="line-109"></span><span>        </span><span class="hs-comment">-- ^ prefix for the command line options.</span><span>
</span><span id="line-110"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Chainweb.Utils.html#OptionParser"><span class="hs-identifier hs-type">OptionParser</span></a></span><span> </span><span class="annot"><a href="Utils.Logging.Config.html#LogFormat"><span class="hs-identifier hs-type">LogFormat</span></a></span><span>
</span><span id="line-111"></span><span id="pLogFormat_"><span class="annot"><span class="annottext">pLogFormat_ :: Text -&gt; OptionParser LogFormat
</span><a href="Utils.Logging.Config.html#pLogFormat_"><span class="hs-identifier hs-var hs-var">pLogFormat_</span></a></span></span><span> </span><span id="local-6989586621681501536"><span class="annot"><span class="annottext">prefix :: Text
</span><a href="#local-6989586621681501536"><span class="hs-identifier hs-var">prefix</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ReadM LogFormat
-&gt; Mod OptionFields LogFormat -&gt; OptionParser LogFormat
forall a. ReadM a -&gt; Mod OptionFields a -&gt; Parser a
</span><span class="hs-identifier hs-var">option</span></span><span> </span><span class="annot"><span class="annottext">ReadM LogFormat
forall a. HasTextRepresentation a =&gt; ReadM a
</span><a href="Chainweb.Utils.html#textReader"><span class="hs-identifier hs-var">textReader</span></a></span><span>
</span><span id="line-112"></span><span>    </span><span class="annot"><span class="annottext">(Mod OptionFields LogFormat -&gt; OptionParser LogFormat)
-&gt; Mod OptionFields LogFormat -&gt; OptionParser LogFormat
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Mod OptionFields LogFormat
forall (f :: * -&gt; *) a. HasName f =&gt; String -&gt; Mod f a
</span><span class="hs-identifier hs-var">long</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; String
</span><span class="hs-identifier hs-var">T.unpack</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621681501536"><span class="hs-identifier hs-var">prefix</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="hs-string">&quot;log-format&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-113"></span><span>    </span><span class="annot"><span class="annottext">Mod OptionFields LogFormat
-&gt; Mod OptionFields LogFormat -&gt; Mod OptionFields LogFormat
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Mod OptionFields LogFormat
forall (f :: * -&gt; *) a. HasMetavar f =&gt; String -&gt; Mod f a
</span><span class="hs-identifier hs-var">metavar</span></span><span> </span><span class="annot"><span class="hs-string">&quot;text|json&quot;</span></span><span>
</span><span id="line-114"></span><span>    </span><span class="annot"><span class="annottext">Mod OptionFields LogFormat
-&gt; Mod OptionFields LogFormat -&gt; Mod OptionFields LogFormat
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Mod OptionFields LogFormat
forall (f :: * -&gt; *) a. String -&gt; Mod f a
</span><span class="hs-identifier hs-var">help</span></span><span> </span><span class="annot"><span class="hs-string">&quot;format that is use for writing logs to file handles&quot;</span></span><span>
</span><span id="line-115"></span><span>
</span><span id="line-116"></span><span class="hs-comment">-- -------------------------------------------------------------------------- --</span><span>
</span><span id="line-117"></span><span class="hs-comment">-- Handle Configuration</span><span>
</span><span id="line-118"></span><span>
</span><span id="line-119"></span><span id="local-6989586621681501527"><span id="local-6989586621681501528"></span></span><span class="hs-keyword">data</span><span> </span><span id="HandleConfig"><span class="annot"><a href="Utils.Logging.Config.html#HandleConfig"><span class="hs-identifier hs-var">HandleConfig</span></a></span></span><span>
</span><span id="line-120"></span><span>    </span><span class="hs-glyph">=</span><span> </span><span id="StdOut"><span class="annot"><a href="Utils.Logging.Config.html#StdOut"><span class="hs-identifier hs-var">StdOut</span></a></span></span><span>
</span><span id="line-121"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="StdErr"><span class="annot"><a href="Utils.Logging.Config.html#StdErr"><span class="hs-identifier hs-var">StdErr</span></a></span></span><span>
</span><span id="line-122"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="FileHandle"><span class="annot"><a href="Utils.Logging.Config.html#FileHandle"><span class="hs-identifier hs-var">FileHandle</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span>
</span><span id="line-123"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="ElasticSearch"><span class="annot"><a href="Utils.Logging.Config.html#ElasticSearch"><span class="hs-identifier hs-var">ElasticSearch</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span>
</span><span id="line-124"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681501516"><span id="local-6989586621681501518"><span id="local-6989586621681501520"><span class="annot"><span class="annottext">Int -&gt; HandleConfig -&gt; ShowS
[HandleConfig] -&gt; ShowS
HandleConfig -&gt; String
(Int -&gt; HandleConfig -&gt; ShowS)
-&gt; (HandleConfig -&gt; String)
-&gt; ([HandleConfig] -&gt; ShowS)
-&gt; Show HandleConfig
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [HandleConfig] -&gt; ShowS
$cshowList :: [HandleConfig] -&gt; ShowS
show :: HandleConfig -&gt; String
$cshow :: HandleConfig -&gt; String
showsPrec :: Int -&gt; HandleConfig -&gt; ShowS
$cshowsPrec :: Int -&gt; HandleConfig -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681501512"><span id="local-6989586621681501514"><span class="annot"><span class="annottext">HandleConfig -&gt; HandleConfig -&gt; Bool
(HandleConfig -&gt; HandleConfig -&gt; Bool)
-&gt; (HandleConfig -&gt; HandleConfig -&gt; Bool) -&gt; Eq HandleConfig
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: HandleConfig -&gt; HandleConfig -&gt; Bool
$c/= :: HandleConfig -&gt; HandleConfig -&gt; Bool
== :: HandleConfig -&gt; HandleConfig -&gt; Bool
$c== :: HandleConfig -&gt; HandleConfig -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681501497"><span id="local-6989586621681501499"><span id="local-6989586621681501501"><span id="local-6989586621681501503"><span id="local-6989586621681501505"><span id="local-6989586621681501507"><span id="local-6989586621681501509"><span class="annot"><span class="annottext">Eq HandleConfig
Eq HandleConfig =&gt;
(HandleConfig -&gt; HandleConfig -&gt; Ordering)
-&gt; (HandleConfig -&gt; HandleConfig -&gt; Bool)
-&gt; (HandleConfig -&gt; HandleConfig -&gt; Bool)
-&gt; (HandleConfig -&gt; HandleConfig -&gt; Bool)
-&gt; (HandleConfig -&gt; HandleConfig -&gt; Bool)
-&gt; (HandleConfig -&gt; HandleConfig -&gt; HandleConfig)
-&gt; (HandleConfig -&gt; HandleConfig -&gt; HandleConfig)
-&gt; Ord HandleConfig
HandleConfig -&gt; HandleConfig -&gt; Bool
HandleConfig -&gt; HandleConfig -&gt; Ordering
HandleConfig -&gt; HandleConfig -&gt; HandleConfig
forall a.
Eq a =&gt;
(a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
min :: HandleConfig -&gt; HandleConfig -&gt; HandleConfig
$cmin :: HandleConfig -&gt; HandleConfig -&gt; HandleConfig
max :: HandleConfig -&gt; HandleConfig -&gt; HandleConfig
$cmax :: HandleConfig -&gt; HandleConfig -&gt; HandleConfig
&gt;= :: HandleConfig -&gt; HandleConfig -&gt; Bool
$c&gt;= :: HandleConfig -&gt; HandleConfig -&gt; Bool
&gt; :: HandleConfig -&gt; HandleConfig -&gt; Bool
$c&gt; :: HandleConfig -&gt; HandleConfig -&gt; Bool
&lt;= :: HandleConfig -&gt; HandleConfig -&gt; Bool
$c&lt;= :: HandleConfig -&gt; HandleConfig -&gt; Bool
&lt; :: HandleConfig -&gt; HandleConfig -&gt; Bool
$c&lt; :: HandleConfig -&gt; HandleConfig -&gt; Bool
compare :: HandleConfig -&gt; HandleConfig -&gt; Ordering
$ccompare :: HandleConfig -&gt; HandleConfig -&gt; Ordering
$cp1Ord :: Eq HandleConfig
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(forall x. HandleConfig -&gt; Rep HandleConfig x)
-&gt; (forall x. Rep HandleConfig x -&gt; HandleConfig)
-&gt; Generic HandleConfig
forall x. Rep HandleConfig x -&gt; HandleConfig
forall x. HandleConfig -&gt; Rep HandleConfig x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
$cto :: forall x. Rep HandleConfig x -&gt; HandleConfig
$cfrom :: forall x. HandleConfig -&gt; Rep HandleConfig x
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">Generic</span></span><span class="hs-special">)</span><span>
</span><span id="line-125"></span><span>
</span><span id="line-126"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681501493"><span class="annot"><span class="hs-identifier hs-type">NFData</span></span><span> </span><span class="annot"><a href="Utils.Logging.Config.html#HandleConfig"><span class="hs-identifier hs-type">HandleConfig</span></a></span></span><span>
</span><span id="line-127"></span><span>
</span><span id="line-128"></span><span id="local-6989586621681501492"><span class="annot"><a href="Utils.Logging.Config.html#handleConfigFromText"><span class="hs-identifier hs-type">handleConfigFromText</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadThrow</span></span><span> </span><span class="annot"><a href="#local-6989586621681501492"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681501492"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Utils.Logging.Config.html#HandleConfig"><span class="hs-identifier hs-type">HandleConfig</span></a></span></span><span>
</span><span id="line-129"></span><span id="handleConfigFromText"><span class="annot"><span class="annottext">handleConfigFromText :: Text -&gt; m HandleConfig
</span><a href="Utils.Logging.Config.html#handleConfigFromText"><span class="hs-identifier hs-var hs-var">handleConfigFromText</span></a></span></span><span> </span><span id="local-6989586621681501490"><span class="annot"><span class="annottext">x :: Text
</span><a href="#local-6989586621681501490"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Text -&gt; CI Text
forall s. FoldCase s =&gt; s -&gt; CI s
</span><span class="hs-identifier hs-var">CI.mk</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621681501490"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-130"></span><span>    </span><span class="hs-string">&quot;stdout&quot;</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">HandleConfig -&gt; m HandleConfig
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">HandleConfig
</span><a href="Utils.Logging.Config.html#StdOut"><span class="hs-identifier hs-var">StdOut</span></a></span><span>
</span><span id="line-131"></span><span>    </span><span class="hs-string">&quot;stderr&quot;</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">HandleConfig -&gt; m HandleConfig
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">HandleConfig
</span><a href="Utils.Logging.Config.html#StdErr"><span class="hs-identifier hs-var">StdErr</span></a></span><span>
</span><span id="line-132"></span><span>    </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Text -&gt; CI Text
forall s. FoldCase s =&gt; s -&gt; CI s
</span><span class="hs-identifier hs-var">CI.mk</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Text -&gt; Text
</span><span class="hs-identifier hs-var">T.take</span></span><span> </span><span class="annot"><span class="hs-number">5</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621681501490"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CI Text -&gt; CI Text -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="hs-string">&quot;file:&quot;</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">HandleConfig -&gt; m HandleConfig
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(HandleConfig -&gt; m HandleConfig) -&gt; HandleConfig -&gt; m HandleConfig
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; HandleConfig
</span><a href="Utils.Logging.Config.html#FileHandle"><span class="hs-identifier hs-var">FileHandle</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; String
</span><span class="hs-identifier hs-var">T.unpack</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Text -&gt; Text
</span><span class="hs-identifier hs-var">T.drop</span></span><span> </span><span class="annot"><span class="hs-number">5</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621681501490"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-133"></span><span>    </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Text -&gt; CI Text
forall s. FoldCase s =&gt; s -&gt; CI s
</span><span class="hs-identifier hs-var">CI.mk</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Text -&gt; Text
</span><span class="hs-identifier hs-var">T.take</span></span><span> </span><span class="annot"><span class="hs-number">3</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621681501490"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CI Text -&gt; CI Text -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="hs-string">&quot;es:&quot;</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">HandleConfig -&gt; m HandleConfig
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(HandleConfig -&gt; m HandleConfig) -&gt; HandleConfig -&gt; m HandleConfig
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; HandleConfig
</span><a href="Utils.Logging.Config.html#ElasticSearch"><span class="hs-identifier hs-var">ElasticSearch</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Text -&gt; Text
</span><span class="hs-identifier hs-var">T.drop</span></span><span> </span><span class="annot"><span class="hs-number">3</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621681501490"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-134"></span><span>    </span><span id="local-6989586621681501487"><span class="annot"><span class="annottext">e :: CI Text
</span><a href="#local-6989586621681501487"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CI Text -&gt; m HandleConfig
forall (m :: * -&gt; *) a a. (MonadThrow m, Show a) =&gt; a -&gt; m a
</span><a href="#local-6989586621681501486"><span class="hs-identifier hs-var">configFromTextErr</span></a></span><span> </span><span class="annot"><span class="annottext">CI Text
</span><a href="#local-6989586621681501487"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-135"></span><span>
</span><span id="line-136"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621681501486"><span class="annot"><span class="annottext">configFromTextErr :: a -&gt; m a
</span><a href="#local-6989586621681501486"><span class="hs-identifier hs-var hs-var">configFromTextErr</span></a></span></span><span> </span><span id="local-6989586621681501485"><span class="annot"><span class="annottext">e :: a
</span><a href="#local-6989586621681501485"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-137"></span><span>          </span><span class="annot"><span class="annottext">EncodingException -&gt; m a
forall (m :: * -&gt; *) e a. (MonadThrow m, Exception e) =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwM</span></span><span> </span><span class="annot"><span class="annottext">(EncodingException -&gt; m a) -&gt; EncodingException -&gt; m a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; EncodingException
</span><a href="Chainweb.Utils.html#DecodeException"><span class="hs-identifier hs-var">DecodeException</span></a></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; EncodingException) -&gt; Text -&gt; EncodingException
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="hs-string">&quot;unexpected logger handle value: &quot;</span></span><span>
</span><span id="line-138"></span><span>          </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Text
forall a. IsString a =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">fromString</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681501485"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-139"></span><span>          </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="hs-string">&quot;, expected \&quot;stdout\&quot;, \&quot;stderr\&quot;, \&quot;file:&lt;FILENAME&gt;\&quot;, or \&quot;es:&lt;URL&gt;\&quot;&quot;</span></span><span>
</span><span id="line-140"></span><span>
</span><span id="line-141"></span><span class="annot"><a href="Utils.Logging.Config.html#handleConfigToText"><span class="hs-identifier hs-type">handleConfigToText</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Utils.Logging.Config.html#HandleConfig"><span class="hs-identifier hs-type">HandleConfig</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span>
</span><span id="line-142"></span><span id="handleConfigToText"><span class="annot"><span class="annottext">handleConfigToText :: HandleConfig -&gt; Text
</span><a href="Utils.Logging.Config.html#handleConfigToText"><span class="hs-identifier hs-var hs-var">handleConfigToText</span></a></span></span><span> </span><span class="annot"><a href="Utils.Logging.Config.html#StdOut"><span class="hs-identifier hs-type">StdOut</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-string">&quot;stdout&quot;</span></span><span>
</span><span id="line-143"></span><span class="annot"><a href="Utils.Logging.Config.html#handleConfigToText"><span class="hs-identifier hs-var">handleConfigToText</span></a></span><span> </span><span class="annot"><a href="Utils.Logging.Config.html#StdErr"><span class="hs-identifier hs-type">StdErr</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-string">&quot;stderr&quot;</span></span><span>
</span><span id="line-144"></span><span class="annot"><a href="Utils.Logging.Config.html#handleConfigToText"><span class="hs-identifier hs-var">handleConfigToText</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Utils.Logging.Config.html#FileHandle"><span class="hs-identifier hs-type">FileHandle</span></a></span><span> </span><span id="local-6989586621681501481"><span class="annot"><span class="annottext">f :: String
</span><a href="#local-6989586621681501481"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-string">&quot;file:&quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Text
</span><span class="hs-identifier hs-var">T.pack</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621681501481"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-145"></span><span class="annot"><a href="Utils.Logging.Config.html#handleConfigToText"><span class="hs-identifier hs-var">handleConfigToText</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Utils.Logging.Config.html#ElasticSearch"><span class="hs-identifier hs-type">ElasticSearch</span></a></span><span> </span><span id="local-6989586621681501479"><span class="annot"><span class="annottext">f :: Text
</span><a href="#local-6989586621681501479"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-string">&quot;es:&quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621681501479"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-146"></span><span>
</span><span id="line-147"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Chainweb.Utils.html#HasTextRepresentation"><span class="hs-identifier hs-type">HasTextRepresentation</span></a></span><span> </span><span class="annot"><a href="Utils.Logging.Config.html#HandleConfig"><span class="hs-identifier hs-type">HandleConfig</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-148"></span><span>    </span><span id="local-6989586621681501476"><span class="annot"><span class="annottext">toText :: HandleConfig -&gt; Text
</span><a href="#local-6989586621681501476"><span class="hs-identifier hs-var hs-var hs-var hs-var">toText</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HandleConfig -&gt; Text
</span><a href="Utils.Logging.Config.html#handleConfigToText"><span class="hs-identifier hs-var">handleConfigToText</span></a></span><span>
</span><span id="line-149"></span><span>    </span><span id="local-6989586621681501475"><span class="annot"><span class="annottext">fromText :: Text -&gt; m HandleConfig
</span><a href="#local-6989586621681501475"><span class="hs-identifier hs-var hs-var hs-var hs-var">fromText</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; m HandleConfig
forall (m :: * -&gt; *). MonadThrow m =&gt; Text -&gt; m HandleConfig
</span><a href="Utils.Logging.Config.html#handleConfigFromText"><span class="hs-identifier hs-var">handleConfigFromText</span></a></span><span>
</span><span id="line-150"></span><span>
</span><span id="line-151"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Chainweb.Utils.html#toText"><span class="hs-pragma hs-type">toText</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-152"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Chainweb.Utils.html#fromText"><span class="hs-pragma hs-type">fromText</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-153"></span><span>
</span><span id="line-154"></span><span id="local-6989586621681501673"><span class="annot"><a href="Utils.Logging.Config.html#validateHandleConfig"><span class="hs-identifier hs-type">validateHandleConfig</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ConfigValidation</span></span><span> </span><span class="annot"><a href="Utils.Logging.Config.html#HandleConfig"><span class="hs-identifier hs-type">HandleConfig</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681501673"><span class="hs-identifier hs-type">l</span></a></span></span><span>
</span><span id="line-155"></span><span id="validateHandleConfig"><span class="annot"><span class="annottext">validateHandleConfig :: HandleConfig -&gt; m ()
</span><a href="Utils.Logging.Config.html#validateHandleConfig"><span class="hs-identifier hs-var hs-var">validateHandleConfig</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Utils.Logging.Config.html#FileHandle"><span class="hs-identifier hs-type">FileHandle</span></a></span><span> </span><span id="local-6989586621681501474"><span class="annot"><span class="annottext">filepath :: String
</span><a href="#local-6989586621681501474"><span class="hs-identifier hs-var">filepath</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; String -&gt; m ()
forall (m :: * -&gt; *).
(MonadError Text m, MonadIO m) =&gt;
Text -&gt; String -&gt; m ()
</span><span class="hs-identifier hs-var">validateFileWritable</span></span><span> </span><span class="annot"><span class="hs-string">&quot;file handle&quot;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621681501474"><span class="hs-identifier hs-var">filepath</span></a></span><span>
</span><span id="line-156"></span><span class="annot"><a href="Utils.Logging.Config.html#validateHandleConfig"><span class="hs-identifier hs-var">validateHandleConfig</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Utils.Logging.Config.html#ElasticSearch"><span class="hs-identifier hs-type">ElasticSearch</span></a></span><span> </span><span id="local-6989586621681501472"><span class="annot"><span class="annottext">urlText :: Text
</span><a href="#local-6989586621681501472"><span class="hs-identifier hs-var">urlText</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">String -&gt; Either SomeException Request
forall (m :: * -&gt; *). MonadThrow m =&gt; String -&gt; m Request
</span><span class="hs-identifier hs-var">HTTP.parseRequest</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; String
</span><span class="hs-identifier hs-var">T.unpack</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621681501472"><span class="hs-identifier hs-var">urlText</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-157"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621681501470"><span class="annot"><span class="annottext">e :: SomeException
</span><a href="#local-6989586621681501470"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Text -&gt; m ()
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwError</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; m ()) -&gt; Text -&gt; m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="hs-string">&quot;failed to parse URL for ElasticSearch logging backend handle: &quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">SomeException -&gt; Text
forall a b. (Show a, IsString b) =&gt; a -&gt; b
</span><a href="Chainweb.Utils.html#sshow"><span class="hs-identifier hs-var">sshow</span></a></span><span> </span><span class="annot"><span class="annottext">SomeException
</span><a href="#local-6989586621681501470"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-158"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">() -&gt; m ()
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-159"></span><span>
</span><span id="line-160"></span><span class="annot"><a href="Utils.Logging.Config.html#validateHandleConfig"><span class="hs-identifier hs-var">validateHandleConfig</span></a></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">() -&gt; m ()
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-161"></span><span>
</span><span id="line-162"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681501461"><span id="local-6989586621681501463"><span id="local-6989586621681501465"><span class="annot"><span class="hs-identifier hs-type">ToJSON</span></span><span> </span><span class="annot"><a href="Utils.Logging.Config.html#HandleConfig"><span class="hs-identifier hs-type">HandleConfig</span></a></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-163"></span><span>    </span><span id="local-6989586621681501460"><span class="annot"><span class="annottext">toJSON :: HandleConfig -&gt; Value
</span><a href="#local-6989586621681501460"><span class="hs-identifier hs-var hs-var hs-var hs-var">toJSON</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Value
</span><span class="hs-identifier hs-var">String</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Value) -&gt; (HandleConfig -&gt; Text) -&gt; HandleConfig -&gt; Value
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">HandleConfig -&gt; Text
</span><a href="Utils.Logging.Config.html#handleConfigToText"><span class="hs-identifier hs-var">handleConfigToText</span></a></span><span>
</span><span id="line-164"></span><span>
</span><span id="line-165"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681501456"><span class="annot"><span class="hs-identifier hs-type">FromJSON</span></span><span> </span><span class="annot"><a href="Utils.Logging.Config.html#HandleConfig"><span class="hs-identifier hs-type">HandleConfig</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-166"></span><span>    </span><span id="local-6989586621681501455"><span class="annot"><span class="annottext">parseJSON :: Value -&gt; Parser HandleConfig
</span><a href="#local-6989586621681501455"><span class="hs-identifier hs-var hs-var hs-var hs-var">parseJSON</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Value -&gt; Parser HandleConfig
forall a. HasTextRepresentation a =&gt; String -&gt; Value -&gt; Parser a
</span><a href="Chainweb.Utils.html#parseJsonFromText"><span class="hs-identifier hs-var">parseJsonFromText</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;HandleConfig&quot;</span></span><span>
</span><span id="line-167"></span><span>
</span><span id="line-168"></span><span class="annot"><a href="Utils.Logging.Config.html#pHandleConfig"><span class="hs-identifier hs-type">pHandleConfig</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Chainweb.Utils.html#OptionParser"><span class="hs-identifier hs-type">OptionParser</span></a></span><span> </span><span class="annot"><a href="Utils.Logging.Config.html#HandleConfig"><span class="hs-identifier hs-type">HandleConfig</span></a></span><span>
</span><span id="line-169"></span><span id="pHandleConfig"><span class="annot"><span class="annottext">pHandleConfig :: OptionParser HandleConfig
</span><a href="Utils.Logging.Config.html#pHandleConfig"><span class="hs-identifier hs-var hs-var">pHandleConfig</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; OptionParser HandleConfig
</span><a href="Utils.Logging.Config.html#pHandleConfig_"><span class="hs-identifier hs-var">pHandleConfig_</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-170"></span><span>
</span><span id="line-171"></span><span class="annot"><a href="Utils.Logging.Config.html#pHandleConfig_"><span class="hs-identifier hs-type">pHandleConfig_</span></a></span><span>
</span><span id="line-172"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span>
</span><span id="line-173"></span><span>        </span><span class="hs-comment">-- ^ prefix for the command line options.</span><span>
</span><span id="line-174"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Chainweb.Utils.html#OptionParser"><span class="hs-identifier hs-type">OptionParser</span></a></span><span> </span><span class="annot"><a href="Utils.Logging.Config.html#HandleConfig"><span class="hs-identifier hs-type">HandleConfig</span></a></span><span>
</span><span id="line-175"></span><span id="pHandleConfig_"><span class="annot"><span class="annottext">pHandleConfig_ :: Text -&gt; OptionParser HandleConfig
</span><a href="Utils.Logging.Config.html#pHandleConfig_"><span class="hs-identifier hs-var hs-var">pHandleConfig_</span></a></span></span><span> </span><span id="local-6989586621681501454"><span class="annot"><span class="annottext">prefix :: Text
</span><a href="#local-6989586621681501454"><span class="hs-identifier hs-var">prefix</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ReadM HandleConfig
-&gt; Mod OptionFields HandleConfig -&gt; OptionParser HandleConfig
forall a. ReadM a -&gt; Mod OptionFields a -&gt; Parser a
</span><span class="hs-identifier hs-var">option</span></span><span> </span><span class="annot"><span class="annottext">ReadM HandleConfig
forall a. HasTextRepresentation a =&gt; ReadM a
</span><a href="Chainweb.Utils.html#textReader"><span class="hs-identifier hs-var">textReader</span></a></span><span>
</span><span id="line-176"></span><span>    </span><span class="annot"><span class="annottext">(Mod OptionFields HandleConfig -&gt; OptionParser HandleConfig)
-&gt; Mod OptionFields HandleConfig -&gt; OptionParser HandleConfig
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Mod OptionFields HandleConfig
forall (f :: * -&gt; *) a. HasName f =&gt; String -&gt; Mod f a
</span><span class="hs-identifier hs-var">long</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; String
</span><span class="hs-identifier hs-var">T.unpack</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621681501454"><span class="hs-identifier hs-var">prefix</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="hs-string">&quot;log-handle&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-177"></span><span>    </span><span class="annot"><span class="annottext">Mod OptionFields HandleConfig
-&gt; Mod OptionFields HandleConfig -&gt; Mod OptionFields HandleConfig
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Mod OptionFields HandleConfig
forall (f :: * -&gt; *) a. HasMetavar f =&gt; String -&gt; Mod f a
</span><span class="hs-identifier hs-var">metavar</span></span><span> </span><span class="annot"><span class="hs-string">&quot;stdout|stderr|file:&lt;FILENAME&gt;|es:&lt;URL&gt;&quot;</span></span><span>
</span><span id="line-178"></span><span>    </span><span class="annot"><span class="annottext">Mod OptionFields HandleConfig
-&gt; Mod OptionFields HandleConfig -&gt; Mod OptionFields HandleConfig
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Mod OptionFields HandleConfig
forall (f :: * -&gt; *) a. String -&gt; Mod f a
</span><span class="hs-identifier hs-var">help</span></span><span> </span><span class="annot"><span class="hs-string">&quot;handle where the logs are written&quot;</span></span><span>
</span><span id="line-179"></span><span>
</span><span id="line-180"></span><span class="hs-comment">-- -------------------------------------------------------------------------- --</span><span>
</span><span id="line-181"></span><span class="hs-comment">-- Logger Backend Configuration</span><span>
</span><span id="line-182"></span><span>
</span><span id="line-183"></span><span class="hs-comment">-- | BackendConfig</span><span>
</span><span id="line-184"></span><span class="hs-comment">--</span><span>
</span><span id="line-185"></span><span id="local-6989586621681501452"><span id="local-6989586621681501453"></span></span><span class="hs-keyword">data</span><span> </span><span id="BackendConfig"><span class="annot"><a href="Utils.Logging.Config.html#BackendConfig"><span class="hs-identifier hs-var">BackendConfig</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="BackendConfig"><span class="annot"><a href="Utils.Logging.Config.html#BackendConfig"><span class="hs-identifier hs-var">BackendConfig</span></a></span></span><span>
</span><span id="line-186"></span><span>    </span><span class="hs-special">{</span><span> </span><span id="_backendConfigColor"><span class="annot"><span class="annottext">BackendConfig -&gt; ColorOption
</span><a href="Utils.Logging.Config.html#_backendConfigColor"><span class="hs-identifier hs-var hs-var">_backendConfigColor</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">ColorOption</span></span><span>
</span><span id="line-187"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="_backendConfigFormat"><span class="annot"><span class="annottext">BackendConfig -&gt; LogFormat
</span><a href="Utils.Logging.Config.html#_backendConfigFormat"><span class="hs-identifier hs-var hs-var">_backendConfigFormat</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="Utils.Logging.Config.html#LogFormat"><span class="hs-identifier hs-type">LogFormat</span></a></span><span>
</span><span id="line-188"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="_backendConfigHandle"><span class="annot"><span class="annottext">BackendConfig -&gt; HandleConfig
</span><a href="Utils.Logging.Config.html#_backendConfigHandle"><span class="hs-identifier hs-var hs-var">_backendConfigHandle</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="Utils.Logging.Config.html#HandleConfig"><span class="hs-identifier hs-type">HandleConfig</span></a></span><span>
</span><span id="line-189"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-190"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681501442"><span id="local-6989586621681501444"><span id="local-6989586621681501446"><span class="annot"><span class="annottext">Int -&gt; BackendConfig -&gt; ShowS
[BackendConfig] -&gt; ShowS
BackendConfig -&gt; String
(Int -&gt; BackendConfig -&gt; ShowS)
-&gt; (BackendConfig -&gt; String)
-&gt; ([BackendConfig] -&gt; ShowS)
-&gt; Show BackendConfig
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [BackendConfig] -&gt; ShowS
$cshowList :: [BackendConfig] -&gt; ShowS
show :: BackendConfig -&gt; String
$cshow :: BackendConfig -&gt; String
showsPrec :: Int -&gt; BackendConfig -&gt; ShowS
$cshowsPrec :: Int -&gt; BackendConfig -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681501438"><span id="local-6989586621681501440"><span class="annot"><span class="annottext">BackendConfig -&gt; BackendConfig -&gt; Bool
(BackendConfig -&gt; BackendConfig -&gt; Bool)
-&gt; (BackendConfig -&gt; BackendConfig -&gt; Bool) -&gt; Eq BackendConfig
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: BackendConfig -&gt; BackendConfig -&gt; Bool
$c/= :: BackendConfig -&gt; BackendConfig -&gt; Bool
== :: BackendConfig -&gt; BackendConfig -&gt; Bool
$c== :: BackendConfig -&gt; BackendConfig -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681501423"><span id="local-6989586621681501425"><span id="local-6989586621681501427"><span id="local-6989586621681501429"><span id="local-6989586621681501431"><span id="local-6989586621681501433"><span id="local-6989586621681501435"><span class="annot"><span class="annottext">Eq BackendConfig
Eq BackendConfig =&gt;
(BackendConfig -&gt; BackendConfig -&gt; Ordering)
-&gt; (BackendConfig -&gt; BackendConfig -&gt; Bool)
-&gt; (BackendConfig -&gt; BackendConfig -&gt; Bool)
-&gt; (BackendConfig -&gt; BackendConfig -&gt; Bool)
-&gt; (BackendConfig -&gt; BackendConfig -&gt; Bool)
-&gt; (BackendConfig -&gt; BackendConfig -&gt; BackendConfig)
-&gt; (BackendConfig -&gt; BackendConfig -&gt; BackendConfig)
-&gt; Ord BackendConfig
BackendConfig -&gt; BackendConfig -&gt; Bool
BackendConfig -&gt; BackendConfig -&gt; Ordering
BackendConfig -&gt; BackendConfig -&gt; BackendConfig
forall a.
Eq a =&gt;
(a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
min :: BackendConfig -&gt; BackendConfig -&gt; BackendConfig
$cmin :: BackendConfig -&gt; BackendConfig -&gt; BackendConfig
max :: BackendConfig -&gt; BackendConfig -&gt; BackendConfig
$cmax :: BackendConfig -&gt; BackendConfig -&gt; BackendConfig
&gt;= :: BackendConfig -&gt; BackendConfig -&gt; Bool
$c&gt;= :: BackendConfig -&gt; BackendConfig -&gt; Bool
&gt; :: BackendConfig -&gt; BackendConfig -&gt; Bool
$c&gt; :: BackendConfig -&gt; BackendConfig -&gt; Bool
&lt;= :: BackendConfig -&gt; BackendConfig -&gt; Bool
$c&lt;= :: BackendConfig -&gt; BackendConfig -&gt; Bool
&lt; :: BackendConfig -&gt; BackendConfig -&gt; Bool
$c&lt; :: BackendConfig -&gt; BackendConfig -&gt; Bool
compare :: BackendConfig -&gt; BackendConfig -&gt; Ordering
$ccompare :: BackendConfig -&gt; BackendConfig -&gt; Ordering
$cp1Ord :: Eq BackendConfig
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(forall x. BackendConfig -&gt; Rep BackendConfig x)
-&gt; (forall x. Rep BackendConfig x -&gt; BackendConfig)
-&gt; Generic BackendConfig
forall x. Rep BackendConfig x -&gt; BackendConfig
forall x. BackendConfig -&gt; Rep BackendConfig x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
$cto :: forall x. Rep BackendConfig x -&gt; BackendConfig
$cfrom :: forall x. BackendConfig -&gt; Rep BackendConfig x
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">Generic</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681501419"><span class="annot"><span class="annottext">BackendConfig -&gt; ()
(BackendConfig -&gt; ()) -&gt; NFData BackendConfig
forall a. (a -&gt; ()) -&gt; NFData a
rnf :: BackendConfig -&gt; ()
$crnf :: BackendConfig -&gt; ()
</span><a href="#local-6989586621681501419"><span class="hs-identifier hs-var hs-var hs-var hs-var">NFData</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-191"></span><span>
</span><span id="line-192"></span><span id="backendConfigFormat"><span id="backendConfigHandle"><span id="backendConfigColor"><span class="hs-identifier">makeLenses</span><span> </span><span class="hs-special">''</span><span class="hs-identifier">BackendConfig</span></span></span></span><span>
</span><span id="line-193"></span><span>
</span><span id="line-194"></span><span class="annot"><a href="Utils.Logging.Config.html#defaultBackendConfig"><span class="hs-identifier hs-type">defaultBackendConfig</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Utils.Logging.Config.html#BackendConfig"><span class="hs-identifier hs-type">BackendConfig</span></a></span><span>
</span><span id="line-195"></span><span id="defaultBackendConfig"><span class="annot"><span class="annottext">defaultBackendConfig :: BackendConfig
</span><a href="Utils.Logging.Config.html#defaultBackendConfig"><span class="hs-identifier hs-var hs-var">defaultBackendConfig</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">$WBackendConfig :: ColorOption -&gt; LogFormat -&gt; HandleConfig -&gt; BackendConfig
</span><a href="Utils.Logging.Config.html#%24WBackendConfig"><span class="hs-identifier hs-type hs-type">BackendConfig</span></a></span><span>
</span><span id="line-196"></span><span>    </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">_backendConfigColor :: ColorOption
</span><a href="Utils.Logging.Config.html#_backendConfigColor"><span class="hs-identifier hs-var">_backendConfigColor</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ColorOption
</span><span class="hs-identifier hs-var">defaultColorOption</span></span><span>
</span><span id="line-197"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">_backendConfigFormat :: LogFormat
</span><a href="Utils.Logging.Config.html#_backendConfigFormat"><span class="hs-identifier hs-var">_backendConfigFormat</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LogFormat
</span><a href="Utils.Logging.Config.html#LogFormatText"><span class="hs-identifier hs-var">LogFormatText</span></a></span><span>
</span><span id="line-198"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">_backendConfigHandle :: HandleConfig
</span><a href="Utils.Logging.Config.html#_backendConfigHandle"><span class="hs-identifier hs-var">_backendConfigHandle</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HandleConfig
</span><a href="Utils.Logging.Config.html#StdOut"><span class="hs-identifier hs-var">StdOut</span></a></span><span>
</span><span id="line-199"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-200"></span><span>
</span><span id="line-201"></span><span class="annot"><a href="Utils.Logging.Config.html#validateBackendConfig"><span class="hs-identifier hs-type">validateBackendConfig</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ConfigValidation</span></span><span> </span><span class="annot"><a href="Utils.Logging.Config.html#BackendConfig"><span class="hs-identifier hs-type">BackendConfig</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-202"></span><span id="validateBackendConfig"><span class="annot"><span class="annottext">validateBackendConfig :: BackendConfig -&gt; m ()
</span><a href="Utils.Logging.Config.html#validateBackendConfig"><span class="hs-identifier hs-var hs-var">validateBackendConfig</span></a></span></span><span> </span><span id="local-6989586621681501415"><span class="annot"><span class="annottext">o :: BackendConfig
</span><a href="#local-6989586621681501415"><span class="hs-identifier hs-var">o</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-203"></span><span>        </span><span class="annot"><span class="annottext">HandleConfig -&gt; m ()
forall (l :: * -&gt; *). ConfigValidation HandleConfig l
</span><a href="Utils.Logging.Config.html#validateHandleConfig"><span class="hs-identifier hs-var">validateHandleConfig</span></a></span><span> </span><span class="annot"><span class="annottext">(HandleConfig -&gt; m ()) -&gt; HandleConfig -&gt; m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">BackendConfig -&gt; HandleConfig
</span><a href="Utils.Logging.Config.html#_backendConfigHandle"><span class="hs-identifier hs-var hs-var">_backendConfigHandle</span></a></span><span> </span><span class="annot"><span class="annottext">BackendConfig
</span><a href="#local-6989586621681501415"><span class="hs-identifier hs-var">o</span></a></span><span>
</span><span id="line-204"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BackendConfig -&gt; HandleConfig
</span><a href="Utils.Logging.Config.html#_backendConfigHandle"><span class="hs-identifier hs-var hs-var">_backendConfigHandle</span></a></span><span> </span><span class="annot"><span class="annottext">BackendConfig
</span><a href="#local-6989586621681501415"><span class="hs-identifier hs-var">o</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">BackendConfig -&gt; ColorOption
</span><a href="Utils.Logging.Config.html#_backendConfigColor"><span class="hs-identifier hs-var hs-var">_backendConfigColor</span></a></span><span> </span><span class="annot"><span class="annottext">BackendConfig
</span><a href="#local-6989586621681501415"><span class="hs-identifier hs-var">o</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-205"></span><span>            </span><span class="hs-special">(</span><span class="annot"><a href="Utils.Logging.Config.html#FileHandle"><span class="hs-identifier hs-type">FileHandle</span></a></span><span> </span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ColorTrue</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-206"></span><span>              </span><span class="annot"><span class="annottext">[Text] -&gt; m ()
forall w (m :: * -&gt; *). MonadWriter w m =&gt; w -&gt; m ()
</span><span class="hs-identifier hs-var">tell</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-string">&quot;log messages are formatted using ANSI color escape codes but are written to a file&quot;</span></span><span class="hs-special">]</span><span>
</span><span id="line-207"></span><span>            </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">() -&gt; m ()
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-208"></span><span>
</span><span id="line-209"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681501407"><span id="local-6989586621681501409"><span id="local-6989586621681501411"><span class="annot"><span class="hs-identifier hs-type">ToJSON</span></span><span> </span><span class="annot"><a href="Utils.Logging.Config.html#BackendConfig"><span class="hs-identifier hs-type">BackendConfig</span></a></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-210"></span><span>    </span><span id="local-6989586621681501406"><span class="annot"><span class="annottext">toJSON :: BackendConfig -&gt; Value
</span><a href="#local-6989586621681501406"><span class="hs-identifier hs-var hs-var hs-var hs-var">toJSON</span></a></span></span><span> </span><span id="local-6989586621681501405"><span class="annot"><span class="annottext">o :: BackendConfig
</span><a href="#local-6989586621681501405"><span class="hs-identifier hs-var">o</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Pair] -&gt; Value
</span><span class="hs-identifier hs-var">object</span></span><span>
</span><span id="line-211"></span><span>        </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="hs-string">&quot;color&quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; ColorOption -&gt; Pair
forall kv v. (KeyValue kv, ToJSON v) =&gt; Text -&gt; v -&gt; kv
</span><span class="hs-operator hs-var">.=</span></span><span> </span><span class="annot"><span class="annottext">BackendConfig -&gt; ColorOption
</span><a href="Utils.Logging.Config.html#_backendConfigColor"><span class="hs-identifier hs-var hs-var">_backendConfigColor</span></a></span><span> </span><span class="annot"><span class="annottext">BackendConfig
</span><a href="#local-6989586621681501405"><span class="hs-identifier hs-var">o</span></a></span><span>
</span><span id="line-212"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-string">&quot;format&quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; LogFormat -&gt; Pair
forall kv v. (KeyValue kv, ToJSON v) =&gt; Text -&gt; v -&gt; kv
</span><span class="hs-operator hs-var">.=</span></span><span> </span><span class="annot"><span class="annottext">BackendConfig -&gt; LogFormat
</span><a href="Utils.Logging.Config.html#_backendConfigFormat"><span class="hs-identifier hs-var hs-var">_backendConfigFormat</span></a></span><span> </span><span class="annot"><span class="annottext">BackendConfig
</span><a href="#local-6989586621681501405"><span class="hs-identifier hs-var">o</span></a></span><span>
</span><span id="line-213"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-string">&quot;handle&quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; HandleConfig -&gt; Pair
forall kv v. (KeyValue kv, ToJSON v) =&gt; Text -&gt; v -&gt; kv
</span><span class="hs-operator hs-var">.=</span></span><span> </span><span class="annot"><span class="annottext">BackendConfig -&gt; HandleConfig
</span><a href="Utils.Logging.Config.html#_backendConfigHandle"><span class="hs-identifier hs-var hs-var">_backendConfigHandle</span></a></span><span> </span><span class="annot"><span class="annottext">BackendConfig
</span><a href="#local-6989586621681501405"><span class="hs-identifier hs-var">o</span></a></span><span>
</span><span id="line-214"></span><span>        </span><span class="hs-special">]</span><span>
</span><span id="line-215"></span><span>
</span><span id="line-216"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681501400"><span class="annot"><span class="hs-identifier hs-type">FromJSON</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Utils.Logging.Config.html#BackendConfig"><span class="hs-identifier hs-type">BackendConfig</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Utils.Logging.Config.html#BackendConfig"><span class="hs-identifier hs-type">BackendConfig</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-217"></span><span>    </span><span id="local-6989586621681501399"><span class="annot"><span class="annottext">parseJSON :: Value -&gt; Parser (BackendConfig -&gt; BackendConfig)
</span><a href="#local-6989586621681501399"><span class="hs-identifier hs-var hs-var hs-var hs-var">parseJSON</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
-&gt; (Object -&gt; Parser (BackendConfig -&gt; BackendConfig))
-&gt; Value
-&gt; Parser (BackendConfig -&gt; BackendConfig)
forall a. String -&gt; (Object -&gt; Parser a) -&gt; Value -&gt; Parser a
</span><span class="hs-identifier hs-var">withObject</span></span><span> </span><span class="annot"><span class="hs-string">&quot;BackendConfig&quot;</span></span><span> </span><span class="annot"><span class="annottext">((Object -&gt; Parser (BackendConfig -&gt; BackendConfig))
 -&gt; Value -&gt; Parser (BackendConfig -&gt; BackendConfig))
-&gt; (Object -&gt; Parser (BackendConfig -&gt; BackendConfig))
-&gt; Value
-&gt; Parser (BackendConfig -&gt; BackendConfig)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621681501397"><span class="annot"><span class="annottext">o :: Object
</span><a href="#local-6989586621681501397"><span class="hs-identifier hs-var">o</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">BackendConfig -&gt; BackendConfig
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span>
</span><span id="line-218"></span><span>        </span><span class="annot"><span class="annottext">(BackendConfig -&gt; BackendConfig)
-&gt; Parser (BackendConfig -&gt; BackendConfig)
-&gt; Parser (BackendConfig -&gt; BackendConfig)
forall (f :: * -&gt; *) b c a.
Functor f =&gt;
(b -&gt; c) -&gt; f (a -&gt; b) -&gt; f (a -&gt; c)
</span><span class="hs-operator hs-var">&lt;$&lt;</span></span><span> </span><span class="annot"><span class="annottext">Lens' BackendConfig ColorOption
</span><a href="Utils.Logging.Config.html#backendConfigColor"><span class="hs-identifier hs-var">backendConfigColor</span></a></span><span> </span><span class="annot"><span class="annottext">Lens' BackendConfig ColorOption
-&gt; Text -&gt; Object -&gt; Parser (BackendConfig -&gt; BackendConfig)
forall b a.
FromJSON b =&gt;
Lens' a b -&gt; Text -&gt; Object -&gt; Parser (a -&gt; a)
</span><span class="hs-operator hs-var">..:</span></span><span> </span><span class="annot"><span class="hs-string">&quot;color&quot;</span></span><span> </span><span class="annot"><span class="annottext">(Object -&gt; Parser (BackendConfig -&gt; BackendConfig))
-&gt; Object -&gt; Parser (BackendConfig -&gt; BackendConfig)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621681501397"><span class="hs-identifier hs-var">o</span></a></span><span>
</span><span id="line-219"></span><span>        </span><span class="annot"><span class="annottext">Parser (BackendConfig -&gt; BackendConfig)
-&gt; Parser (BackendConfig -&gt; BackendConfig)
-&gt; Parser (BackendConfig -&gt; BackendConfig)
forall (f :: * -&gt; *) b c a.
Applicative f =&gt;
f (b -&gt; c) -&gt; f (a -&gt; b) -&gt; f (a -&gt; c)
</span><span class="hs-operator hs-var">&lt;*&lt;</span></span><span> </span><span class="annot"><span class="annottext">Lens' BackendConfig LogFormat
</span><a href="Utils.Logging.Config.html#backendConfigFormat"><span class="hs-identifier hs-var">backendConfigFormat</span></a></span><span> </span><span class="annot"><span class="annottext">Lens' BackendConfig LogFormat
-&gt; Text -&gt; Object -&gt; Parser (BackendConfig -&gt; BackendConfig)
forall b a.
FromJSON b =&gt;
Lens' a b -&gt; Text -&gt; Object -&gt; Parser (a -&gt; a)
</span><span class="hs-operator hs-var">..:</span></span><span> </span><span class="annot"><span class="hs-string">&quot;format&quot;</span></span><span> </span><span class="annot"><span class="annottext">(Object -&gt; Parser (BackendConfig -&gt; BackendConfig))
-&gt; Object -&gt; Parser (BackendConfig -&gt; BackendConfig)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621681501397"><span class="hs-identifier hs-var">o</span></a></span><span>
</span><span id="line-220"></span><span>        </span><span class="annot"><span class="annottext">Parser (BackendConfig -&gt; BackendConfig)
-&gt; Parser (BackendConfig -&gt; BackendConfig)
-&gt; Parser (BackendConfig -&gt; BackendConfig)
forall (f :: * -&gt; *) b c a.
Applicative f =&gt;
f (b -&gt; c) -&gt; f (a -&gt; b) -&gt; f (a -&gt; c)
</span><span class="hs-operator hs-var">&lt;*&lt;</span></span><span> </span><span class="annot"><span class="annottext">Lens' BackendConfig HandleConfig
</span><a href="Utils.Logging.Config.html#backendConfigHandle"><span class="hs-identifier hs-var">backendConfigHandle</span></a></span><span> </span><span class="annot"><span class="annottext">Lens' BackendConfig HandleConfig
-&gt; Text -&gt; Object -&gt; Parser (BackendConfig -&gt; BackendConfig)
forall b a.
FromJSON b =&gt;
Lens' a b -&gt; Text -&gt; Object -&gt; Parser (a -&gt; a)
</span><span class="hs-operator hs-var">..:</span></span><span> </span><span class="annot"><span class="hs-string">&quot;handle&quot;</span></span><span> </span><span class="annot"><span class="annottext">(Object -&gt; Parser (BackendConfig -&gt; BackendConfig))
-&gt; Object -&gt; Parser (BackendConfig -&gt; BackendConfig)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621681501397"><span class="hs-identifier hs-var">o</span></a></span><span>
</span><span id="line-221"></span><span>
</span><span id="line-222"></span><span class="annot"><a href="Utils.Logging.Config.html#pBackendConfig"><span class="hs-identifier hs-type">pBackendConfig</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MParser</span></span><span> </span><span class="annot"><a href="Utils.Logging.Config.html#BackendConfig"><span class="hs-identifier hs-type">BackendConfig</span></a></span><span>
</span><span id="line-223"></span><span id="pBackendConfig"><span class="annot"><span class="annottext">pBackendConfig :: MParser BackendConfig
</span><a href="Utils.Logging.Config.html#pBackendConfig"><span class="hs-identifier hs-var hs-var">pBackendConfig</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; MParser BackendConfig
</span><a href="Utils.Logging.Config.html#pBackendConfig_"><span class="hs-identifier hs-var">pBackendConfig_</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-224"></span><span>
</span><span id="line-225"></span><span class="hs-comment">-- | A version of 'pLoggerBackendConfig' that takes a prefix for the</span><span>
</span><span id="line-226"></span><span class="hs-comment">-- command line option.</span><span>
</span><span id="line-227"></span><span class="hs-comment">--</span><span>
</span><span id="line-228"></span><span class="annot"><a href="Utils.Logging.Config.html#pBackendConfig_"><span class="hs-identifier hs-type">pBackendConfig_</span></a></span><span>
</span><span id="line-229"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span>
</span><span id="line-230"></span><span>        </span><span class="hs-comment">-- ^ prefix for this and all subordinate command line options.</span><span>
</span><span id="line-231"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MParser</span></span><span> </span><span class="annot"><a href="Utils.Logging.Config.html#BackendConfig"><span class="hs-identifier hs-type">BackendConfig</span></a></span><span>
</span><span id="line-232"></span><span id="pBackendConfig_"><span class="annot"><span class="annottext">pBackendConfig_ :: Text -&gt; MParser BackendConfig
</span><a href="Utils.Logging.Config.html#pBackendConfig_"><span class="hs-identifier hs-var hs-var">pBackendConfig_</span></a></span></span><span> </span><span id="local-6989586621681501392"><span class="annot"><span class="annottext">prefix :: Text
</span><a href="#local-6989586621681501392"><span class="hs-identifier hs-var">prefix</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BackendConfig -&gt; BackendConfig
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span>
</span><span id="line-233"></span><span>    </span><span class="annot"><span class="annottext">(BackendConfig -&gt; BackendConfig)
-&gt; MParser BackendConfig -&gt; MParser BackendConfig
forall (f :: * -&gt; *) b c a.
Functor f =&gt;
(b -&gt; c) -&gt; f (a -&gt; b) -&gt; f (a -&gt; c)
</span><span class="hs-operator hs-var">&lt;$&lt;</span></span><span> </span><span class="annot"><span class="annottext">Lens' BackendConfig ColorOption
</span><a href="Utils.Logging.Config.html#backendConfigColor"><span class="hs-identifier hs-var">backendConfigColor</span></a></span><span> </span><span class="annot"><span class="annottext">Lens' BackendConfig ColorOption
-&gt; Parser ColorOption -&gt; MParser BackendConfig
forall (f :: * -&gt; *) a b.
(Alternative f, Applicative f) =&gt;
Lens' a b -&gt; f b -&gt; f (a -&gt; a)
</span><span class="hs-operator hs-var">.::</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Parser ColorOption
</span><span class="hs-identifier hs-var">pColorOption_</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621681501392"><span class="hs-identifier hs-var">prefix</span></a></span><span>
</span><span id="line-234"></span><span>    </span><span class="annot"><span class="annottext">MParser BackendConfig
-&gt; MParser BackendConfig -&gt; MParser BackendConfig
forall (f :: * -&gt; *) b c a.
Applicative f =&gt;
f (b -&gt; c) -&gt; f (a -&gt; b) -&gt; f (a -&gt; c)
</span><span class="hs-operator hs-var">&lt;*&lt;</span></span><span> </span><span class="annot"><span class="annottext">Lens' BackendConfig LogFormat
</span><a href="Utils.Logging.Config.html#backendConfigFormat"><span class="hs-identifier hs-var">backendConfigFormat</span></a></span><span> </span><span class="annot"><span class="annottext">Lens' BackendConfig LogFormat
-&gt; OptionParser LogFormat -&gt; MParser BackendConfig
forall (f :: * -&gt; *) a b.
(Alternative f, Applicative f) =&gt;
Lens' a b -&gt; f b -&gt; f (a -&gt; a)
</span><span class="hs-operator hs-var">.::</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; OptionParser LogFormat
</span><a href="Utils.Logging.Config.html#pLogFormat_"><span class="hs-identifier hs-var">pLogFormat_</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621681501392"><span class="hs-identifier hs-var">prefix</span></a></span><span>
</span><span id="line-235"></span><span>    </span><span class="annot"><span class="annottext">MParser BackendConfig
-&gt; MParser BackendConfig -&gt; MParser BackendConfig
forall (f :: * -&gt; *) b c a.
Applicative f =&gt;
f (b -&gt; c) -&gt; f (a -&gt; b) -&gt; f (a -&gt; c)
</span><span class="hs-operator hs-var">&lt;*&lt;</span></span><span> </span><span class="annot"><span class="annottext">Lens' BackendConfig HandleConfig
</span><a href="Utils.Logging.Config.html#backendConfigHandle"><span class="hs-identifier hs-var">backendConfigHandle</span></a></span><span> </span><span class="annot"><span class="annottext">Lens' BackendConfig HandleConfig
-&gt; OptionParser HandleConfig -&gt; MParser BackendConfig
forall (f :: * -&gt; *) a b.
(Alternative f, Applicative f) =&gt;
Lens' a b -&gt; f b -&gt; f (a -&gt; a)
</span><span class="hs-operator hs-var">.::</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; OptionParser HandleConfig
</span><a href="Utils.Logging.Config.html#pHandleConfig_"><span class="hs-identifier hs-var">pHandleConfig_</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621681501392"><span class="hs-identifier hs-var">prefix</span></a></span><span>
</span><span id="line-236"></span><span>
</span><span id="line-237"></span></pre></body></html>