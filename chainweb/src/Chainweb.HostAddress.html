<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span id="%24con2tag_3pQxBadNHFTHq1UM2WH0x4"><span id="%24con2tag_2h8RfBxlK2c9mmFww1yq7E"></span></span><span class="hs-pragma">{-# LANGUAGE DeriveAnyClass #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE DeriveGeneric #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE DerivingStrategies #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE FlexibleInstances #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# LANGUAGE GeneralizedNewtypeDeriving #-}</span><span>
</span><span id="line-6"></span><span class="hs-pragma">{-# LANGUAGE LambdaCase #-}</span><span>
</span><span id="line-7"></span><span class="hs-pragma">{-# LANGUAGE OverloadedStrings #-}</span><span>
</span><span id="line-8"></span><span class="hs-pragma">{-# LANGUAGE ScopedTypeVariables #-}</span><span>
</span><span id="line-9"></span><span class="hs-pragma">{-# LANGUAGE TemplateHaskell #-}</span><span>
</span><span id="line-10"></span><span class="hs-pragma">{-# LANGUAGE TypeApplications #-}</span><span>
</span><span id="line-11"></span><span>
</span><span id="line-12"></span><span class="hs-pragma">{-# OPTIONS_GHC -fno-warn-orphans #-}</span><span>
</span><span id="line-13"></span><span>
</span><span id="line-14"></span><span class="hs-comment">-- |</span><span>
</span><span id="line-15"></span><span class="hs-comment">-- Module: Chainweb.HostAddress</span><span>
</span><span id="line-16"></span><span class="hs-comment">-- Copyright: Copyright &#169; 2018 Kadena LLC.</span><span>
</span><span id="line-17"></span><span class="hs-comment">-- License: MIT</span><span>
</span><span id="line-18"></span><span class="hs-comment">-- Maintainer: Lars Kuhtz &lt;lars@kadena.io&gt;</span><span>
</span><span id="line-19"></span><span class="hs-comment">-- Stability: experimental</span><span>
</span><span id="line-20"></span><span class="hs-comment">--</span><span>
</span><span id="line-21"></span><span class="hs-comment">-- Port numbers must be within the range @[0,2^16-1]@.</span><span>
</span><span id="line-22"></span><span class="hs-comment">--</span><span>
</span><span id="line-23"></span><span class="hs-comment">-- All hostnames are considered fully qualified and thus the final dot is</span><span>
</span><span id="line-24"></span><span class="hs-comment">-- omitted.</span><span>
</span><span id="line-25"></span><span class="hs-comment">--</span><span>
</span><span id="line-26"></span><span class="hs-comment">-- For hostnames we follow the specification for &quot;Server-based Naming Authority&quot;</span><span>
</span><span id="line-27"></span><span class="hs-comment">-- for URIs from RFC2396 section 3.2.2.:</span><span>
</span><span id="line-28"></span><span class="hs-comment">--</span><span>
</span><span id="line-29"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-30"></span><span class="hs-comment">--      hostport      = host [ &quot;:&quot; port ]</span><span>
</span><span id="line-31"></span><span class="hs-comment">--      host          = hostname | IPv4address</span><span>
</span><span id="line-32"></span><span class="hs-comment">--      hostname      = *( domainlabel &quot;.&quot; ) toplabel [ &quot;.&quot; ]</span><span>
</span><span id="line-33"></span><span class="hs-comment">--      domainlabel   = alphanum | alphanum *( alphanum | &quot;-&quot; ) alphanum</span><span>
</span><span id="line-34"></span><span class="hs-comment">--      toplabel      = alpha | alpha *( alphanum | &quot;-&quot; ) alphanum</span><span>
</span><span id="line-35"></span><span class="hs-comment">--</span><span>
</span><span id="line-36"></span><span class="hs-comment">--      IPv4address   = 1*digit &quot;.&quot; 1*digit &quot;.&quot; 1*digit &quot;.&quot; 1*digit</span><span>
</span><span id="line-37"></span><span class="hs-comment">--      port          = *digit</span><span>
</span><span id="line-38"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-39"></span><span class="hs-comment">--</span><span>
</span><span id="line-40"></span><span class="hs-comment">-- @1*digit@ designates the decimal representation of an octet. The specification</span><span>
</span><span id="line-41"></span><span class="hs-comment">-- takes the form of hostnames from section 2.1 RFC1123, but limiting the</span><span>
</span><span id="line-42"></span><span class="hs-comment">-- rightmost (top-most) label to the from given in section 3 of RFC1034, which</span><span>
</span><span id="line-43"></span><span class="hs-comment">-- allows to disambiguate domain names and IPv4 addresses.</span><span>
</span><span id="line-44"></span><span class="hs-comment">--</span><span>
</span><span id="line-45"></span><span class="hs-comment">-- IPv6 Addresses are partially supported. IPv6 address are parsed as described</span><span>
</span><span id="line-46"></span><span class="hs-comment">-- in RFC4291, but embedding of IPv4 addresses is not supported. IPv6 addresses</span><span>
</span><span id="line-47"></span><span class="hs-comment">-- are printed exactly as they where parsed. No normalization is performed. In</span><span>
</span><span id="line-48"></span><span class="hs-comment">-- particular the recommendations from RFC5952 are not considered. For host</span><span>
</span><span id="line-49"></span><span class="hs-comment">-- addresses RFC3986 and RFC 5952 are followed by requiring that IPv6 literals</span><span>
</span><span id="line-50"></span><span class="hs-comment">-- are enclosed in square brackets. Anything else from RFC3986, which is</span><span>
</span><span id="line-51"></span><span class="hs-comment">-- concerning URIs is ignored.</span><span>
</span><span id="line-52"></span><span class="hs-comment">--</span><span>
</span><span id="line-53"></span><span class="hs-comment">-- Additional restriction for hostname apply from RFC1123: labels must have not</span><span>
</span><span id="line-54"></span><span class="hs-comment">-- more than 63 octets, letters are case-insenstive. The maximum length must not</span><span>
</span><span id="line-55"></span><span class="hs-comment">-- exceed 254 octets, excluding the (optional) terminating dot.</span><span>
</span><span id="line-56"></span><span class="hs-comment">--</span><span>
</span><span id="line-57"></span><span class="hs-comment">-- See &lt;https://cs.uwaterloo.ca/twiki/view/CF/HostNamingRules&gt; for an extensive</span><span>
</span><span id="line-58"></span><span class="hs-comment">-- overview of different standards for host names.</span><span>
</span><span id="line-59"></span><span class="hs-comment">--</span><span>
</span><span id="line-60"></span><span class="hs-comment">-- Non-ascii characters are encoded via Punycode and are of no concern in this</span><span>
</span><span id="line-61"></span><span class="hs-comment">-- implementation.</span><span>
</span><span id="line-62"></span><span class="hs-comment">--</span><span>
</span><span id="line-63"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Chainweb.HostAddress</span><span>
</span><span id="line-64"></span><span class="hs-special">(</span><span>
</span><span id="line-65"></span><span class="annot"><span class="hs-comment">-- * Port Numbers</span></span><span>
</span><span id="line-66"></span><span>  </span><span class="annot"><a href="Chainweb.HostAddress.html#Port"><span class="hs-identifier">Port</span></a></span><span>
</span><span id="line-67"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Chainweb.HostAddress.html#portToText"><span class="hs-identifier">portToText</span></a></span><span>
</span><span id="line-68"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Chainweb.HostAddress.html#portFromText"><span class="hs-identifier">portFromText</span></a></span><span>
</span><span id="line-69"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Chainweb.HostAddress.html#pPort"><span class="hs-identifier">pPort</span></a></span><span>
</span><span id="line-70"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Chainweb.HostAddress.html#readPortBytes"><span class="hs-identifier">readPortBytes</span></a></span><span>
</span><span id="line-71"></span><span>
</span><span id="line-72"></span><span class="annot"><span class="hs-comment">-- * Hostnames</span></span><span>
</span><span id="line-73"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Chainweb.HostAddress.html#Hostname"><span class="hs-identifier">Hostname</span></a></span><span>
</span><span id="line-74"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Chainweb.HostAddress.html#hostnameBytes"><span class="hs-identifier">hostnameBytes</span></a></span><span>
</span><span id="line-75"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Chainweb.HostAddress.html#localhost"><span class="hs-identifier">localhost</span></a></span><span>
</span><span id="line-76"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Chainweb.HostAddress.html#localhostIPv4"><span class="hs-identifier">localhostIPv4</span></a></span><span>
</span><span id="line-77"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Chainweb.HostAddress.html#localhostIPv6"><span class="hs-identifier">localhostIPv6</span></a></span><span>
</span><span id="line-78"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Chainweb.HostAddress.html#readHostnameBytes"><span class="hs-identifier">readHostnameBytes</span></a></span><span>
</span><span id="line-79"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Chainweb.HostAddress.html#hostnameToText"><span class="hs-identifier">hostnameToText</span></a></span><span>
</span><span id="line-80"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Chainweb.HostAddress.html#hostnameFromText"><span class="hs-identifier">hostnameFromText</span></a></span><span>
</span><span id="line-81"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Chainweb.HostAddress.html#unsafeHostnameFromText"><span class="hs-identifier">unsafeHostnameFromText</span></a></span><span>
</span><span id="line-82"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Chainweb.HostAddress.html#pHostname"><span class="hs-identifier">pHostname</span></a></span><span>
</span><span id="line-83"></span><span>
</span><span id="line-84"></span><span class="annot"><span class="hs-comment">-- * HostAddresses</span></span><span>
</span><span id="line-85"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Chainweb.HostAddress.html#HostAddress"><span class="hs-identifier">HostAddress</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-86"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Chainweb.HostAddress.html#hostAddressPort"><span class="hs-identifier">hostAddressPort</span></a></span><span>
</span><span id="line-87"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Chainweb.HostAddress.html#hostAddressHost"><span class="hs-identifier">hostAddressHost</span></a></span><span>
</span><span id="line-88"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Chainweb.HostAddress.html#hostAddressBytes"><span class="hs-identifier">hostAddressBytes</span></a></span><span>
</span><span id="line-89"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Chainweb.HostAddress.html#readHostAddressBytes"><span class="hs-identifier">readHostAddressBytes</span></a></span><span>
</span><span id="line-90"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Chainweb.HostAddress.html#hostAddressToText"><span class="hs-identifier">hostAddressToText</span></a></span><span>
</span><span id="line-91"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Chainweb.HostAddress.html#hostAddressFromText"><span class="hs-identifier">hostAddressFromText</span></a></span><span>
</span><span id="line-92"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Chainweb.HostAddress.html#unsafeHostAddressFromText"><span class="hs-identifier">unsafeHostAddressFromText</span></a></span><span>
</span><span id="line-93"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Chainweb.HostAddress.html#arbitraryHostAddress"><span class="hs-identifier">arbitraryHostAddress</span></a></span><span>
</span><span id="line-94"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Chainweb.HostAddress.html#pHostAddress"><span class="hs-identifier">pHostAddress</span></a></span><span>
</span><span id="line-95"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Chainweb.HostAddress.html#pHostAddress%27"><span class="hs-identifier">pHostAddress'</span></a></span><span>
</span><span id="line-96"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Chainweb.HostAddress.html#hostAddressToBaseUrl"><span class="hs-identifier">hostAddressToBaseUrl</span></a></span><span>
</span><span id="line-97"></span><span>
</span><span id="line-98"></span><span class="annot"><span class="hs-comment">-- * Arbitrary Values</span></span><span>
</span><span id="line-99"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Chainweb.HostAddress.html#arbitraryPort"><span class="hs-identifier">arbitraryPort</span></a></span><span>
</span><span id="line-100"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Chainweb.HostAddress.html#arbitraryDomainName"><span class="hs-identifier">arbitraryDomainName</span></a></span><span>
</span><span id="line-101"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Chainweb.HostAddress.html#arbitraryHostname"><span class="hs-identifier">arbitraryHostname</span></a></span><span>
</span><span id="line-102"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Chainweb.HostAddress.html#arbitraryIpV4"><span class="hs-identifier">arbitraryIpV4</span></a></span><span>
</span><span id="line-103"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Chainweb.HostAddress.html#arbitraryIpV6"><span class="hs-identifier">arbitraryIpV6</span></a></span><span>
</span><span id="line-104"></span><span>
</span><span id="line-105"></span><span class="annot"><span class="hs-comment">-- * HostPreference Utils</span></span><span>
</span><span id="line-106"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Chainweb.HostAddress.html#hostPreferenceToText"><span class="hs-identifier">hostPreferenceToText</span></a></span><span>
</span><span id="line-107"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Chainweb.HostAddress.html#hostPreferenceFromText"><span class="hs-identifier">hostPreferenceFromText</span></a></span><span>
</span><span id="line-108"></span><span>
</span><span id="line-109"></span><span class="annot"><span class="hs-comment">-- * Properties</span></span><span>
</span><span id="line-110"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Chainweb.HostAddress.html#properties"><span class="hs-identifier">properties</span></a></span><span>
</span><span id="line-111"></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-112"></span><span>
</span><span id="line-113"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Configuration.Utils</span></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-operator">(&lt;?&gt;)</span></span><span class="hs-special">)</span><span>
</span><span id="line-114"></span><span>
</span><span id="line-115"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.DeepSeq</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">NFData</span></span><span class="hs-special">)</span><span>
</span><span id="line-116"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Lens.TH</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">makeLenses</span></span><span class="hs-special">)</span><span>
</span><span id="line-117"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">guard</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">replicateM</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">foldM</span></span><span class="hs-special">)</span><span>
</span><span id="line-118"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Catch</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">MonadThrow</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-119"></span><span>
</span><span id="line-120"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Attoparsec.ByteString.Char8</span></span><span>
</span><span id="line-121"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.ByteString.Char8</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">B8</span></span><span>
</span><span id="line-122"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.CaseInsensitive</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">CI</span></span><span>
</span><span id="line-123"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Hashable</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Hashable</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-124"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.List</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">L</span></span><span>
</span><span id="line-125"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Streaming.Network.Internal</span></span><span>
</span><span id="line-126"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Text</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">T</span></span><span>
</span><span id="line-127"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Text.Encoding</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">T</span></span><span>
</span><span id="line-128"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Word</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Word16</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">Word8</span></span><span class="hs-special">)</span><span>
</span><span id="line-129"></span><span>
</span><span id="line-130"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">GHC.Generics</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Generic</span></span><span class="hs-special">)</span><span>
</span><span id="line-131"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">GHC.Stack</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">HasCallStack</span></span><span class="hs-special">)</span><span>
</span><span id="line-132"></span><span>
</span><span id="line-133"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Servant.Client</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">BaseUrl</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">Scheme</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-134"></span><span>
</span><span id="line-135"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Test.QuickCheck</span></span><span>
</span><span id="line-136"></span><span>
</span><span id="line-137"></span><span class="hs-comment">-- internal modules</span><span>
</span><span id="line-138"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Chainweb.Utils.html"><span class="hs-identifier">Chainweb.Utils</span></a></span><span>
</span><span id="line-139"></span><span>
</span><span id="line-140"></span><span class="hs-comment">-- -------------------------------------------------------------------------- --</span><span>
</span><span id="line-141"></span><span class="hs-comment">-- Internal Parsers</span><span>
</span><span id="line-142"></span><span>
</span><span id="line-143"></span><span id="local-6989586621681468006"><span id="local-6989586621681468007"></span></span><span class="hs-keyword">data</span><span> </span><span id="HostType"><span class="annot"><a href="Chainweb.HostAddress.html#HostType"><span class="hs-identifier hs-var">HostType</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="HostTypeName"><span class="annot"><a href="Chainweb.HostAddress.html#HostTypeName"><span class="hs-identifier hs-var">HostTypeName</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="HostTypeIPv4"><span class="annot"><a href="Chainweb.HostAddress.html#HostTypeIPv4"><span class="hs-identifier hs-var">HostTypeIPv4</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="HostTypeIPv6"><span class="annot"><a href="Chainweb.HostAddress.html#HostTypeIPv6"><span class="hs-identifier hs-var">HostTypeIPv6</span></a></span></span><span>
</span><span id="line-144"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681467997"><span id="local-6989586621681467999"><span id="local-6989586621681468001"><span class="annot"><span class="annottext">Int -&gt; HostType -&gt; ShowS
[HostType] -&gt; ShowS
HostType -&gt; String
(Int -&gt; HostType -&gt; ShowS)
-&gt; (HostType -&gt; String) -&gt; ([HostType] -&gt; ShowS) -&gt; Show HostType
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [HostType] -&gt; ShowS
$cshowList :: [HostType] -&gt; ShowS
show :: HostType -&gt; String
$cshow :: HostType -&gt; String
showsPrec :: Int -&gt; HostType -&gt; ShowS
$cshowsPrec :: Int -&gt; HostType -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681467992"><span id="local-6989586621681467994"><span class="annot"><span class="annottext">HostType -&gt; HostType -&gt; Bool
(HostType -&gt; HostType -&gt; Bool)
-&gt; (HostType -&gt; HostType -&gt; Bool) -&gt; Eq HostType
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: HostType -&gt; HostType -&gt; Bool
$c/= :: HostType -&gt; HostType -&gt; Bool
== :: HostType -&gt; HostType -&gt; Bool
$c== :: HostType -&gt; HostType -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681467976"><span id="local-6989586621681467978"><span id="local-6989586621681467980"><span id="local-6989586621681467982"><span id="local-6989586621681467984"><span id="local-6989586621681467986"><span id="local-6989586621681467988"><span class="annot"><span class="annottext">Eq HostType
Eq HostType =&gt;
(HostType -&gt; HostType -&gt; Ordering)
-&gt; (HostType -&gt; HostType -&gt; Bool)
-&gt; (HostType -&gt; HostType -&gt; Bool)
-&gt; (HostType -&gt; HostType -&gt; Bool)
-&gt; (HostType -&gt; HostType -&gt; Bool)
-&gt; (HostType -&gt; HostType -&gt; HostType)
-&gt; (HostType -&gt; HostType -&gt; HostType)
-&gt; Ord HostType
HostType -&gt; HostType -&gt; Bool
HostType -&gt; HostType -&gt; Ordering
HostType -&gt; HostType -&gt; HostType
forall a.
Eq a =&gt;
(a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
min :: HostType -&gt; HostType -&gt; HostType
$cmin :: HostType -&gt; HostType -&gt; HostType
max :: HostType -&gt; HostType -&gt; HostType
$cmax :: HostType -&gt; HostType -&gt; HostType
&gt;= :: HostType -&gt; HostType -&gt; Bool
$c&gt;= :: HostType -&gt; HostType -&gt; Bool
&gt; :: HostType -&gt; HostType -&gt; Bool
$c&gt; :: HostType -&gt; HostType -&gt; Bool
&lt;= :: HostType -&gt; HostType -&gt; Bool
$c&lt;= :: HostType -&gt; HostType -&gt; Bool
&lt; :: HostType -&gt; HostType -&gt; Bool
$c&lt; :: HostType -&gt; HostType -&gt; Bool
compare :: HostType -&gt; HostType -&gt; Ordering
$ccompare :: HostType -&gt; HostType -&gt; Ordering
$cp1Ord :: Eq HostType
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(forall x. HostType -&gt; Rep HostType x)
-&gt; (forall x. Rep HostType x -&gt; HostType) -&gt; Generic HostType
forall x. Rep HostType x -&gt; HostType
forall x. HostType -&gt; Rep HostType x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
$cto :: forall x. Rep HostType x -&gt; HostType
$cfrom :: forall x. HostType -&gt; Rep HostType x
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">Generic</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681467968"><span id="local-6989586621681467970"><span class="annot"><span class="annottext">Int -&gt; HostType -&gt; Int
HostType -&gt; Int
(Int -&gt; HostType -&gt; Int) -&gt; (HostType -&gt; Int) -&gt; Hashable HostType
forall a. (Int -&gt; a -&gt; Int) -&gt; (a -&gt; Int) -&gt; Hashable a
hash :: HostType -&gt; Int
$chash :: HostType -&gt; Int
hashWithSalt :: Int -&gt; HostType -&gt; Int
$chashWithSalt :: Int -&gt; HostType -&gt; Int
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Hashable</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-145"></span><span>
</span><span id="line-146"></span><span class="annot"><a href="Chainweb.HostAddress.html#hostParser"><span class="hs-identifier hs-type">hostParser</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Parser</span></span><span> </span><span class="annot"><a href="Chainweb.HostAddress.html#HostType"><span class="hs-identifier hs-type">HostType</span></a></span><span>
</span><span id="line-147"></span><span id="hostParser"><span class="annot"><span class="annottext">hostParser :: Parser HostType
</span><a href="Chainweb.HostAddress.html#hostParser"><span class="hs-identifier hs-var hs-var">hostParser</span></a></span></span><span>
</span><span id="line-148"></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HostType
</span><a href="Chainweb.HostAddress.html#HostTypeName"><span class="hs-identifier hs-var">HostTypeName</span></a></span><span> </span><span class="annot"><span class="annottext">HostType -&gt; Parser ByteString () -&gt; Parser HostType
forall (f :: * -&gt; *) a b. Functor f =&gt; a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;$</span></span><span> </span><span class="annot"><span class="annottext">Parser ByteString ()
</span><a href="Chainweb.HostAddress.html#hostNameParser"><span class="hs-identifier hs-var">hostNameParser</span></a></span><span>
</span><span id="line-149"></span><span>    </span><span class="annot"><span class="annottext">Parser HostType -&gt; Parser HostType -&gt; Parser HostType
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="annot"><span class="annottext">HostType
</span><a href="Chainweb.HostAddress.html#HostTypeIPv4"><span class="hs-identifier hs-var">HostTypeIPv4</span></a></span><span> </span><span class="annot"><span class="annottext">HostType
-&gt; Parser ByteString (Word8, Word8, Word8, Word8)
-&gt; Parser HostType
forall (f :: * -&gt; *) a b. Functor f =&gt; a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;$</span></span><span> </span><span class="annot"><span class="annottext">Parser ByteString (Word8, Word8, Word8, Word8)
</span><a href="Chainweb.HostAddress.html#ipV4Parser"><span class="hs-identifier hs-var">ipV4Parser</span></a></span><span>
</span><span id="line-150"></span><span>    </span><span class="annot"><span class="annottext">Parser HostType -&gt; Parser HostType -&gt; Parser HostType
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="annot"><span class="annottext">HostType
</span><a href="Chainweb.HostAddress.html#HostTypeIPv6"><span class="hs-identifier hs-var">HostTypeIPv6</span></a></span><span> </span><span class="annot"><span class="annottext">HostType -&gt; Parser ByteString [Maybe Word16] -&gt; Parser HostType
forall (f :: * -&gt; *) a b. Functor f =&gt; a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;$</span></span><span> </span><span class="annot"><span class="annottext">Parser ByteString [Maybe Word16]
</span><a href="Chainweb.HostAddress.html#ipV6Parser"><span class="hs-identifier hs-var">ipV6Parser</span></a></span><span>
</span><span id="line-151"></span><span>    </span><span class="annot"><span class="annottext">Parser HostType -&gt; String -&gt; Parser HostType
forall i a. Parser i a -&gt; String -&gt; Parser i a
</span><span class="hs-operator hs-var">&lt;?&gt;</span></span><span> </span><span class="annot"><span class="hs-string">&quot;host&quot;</span></span><span>
</span><span id="line-152"></span><span>
</span><span id="line-153"></span><span class="annot"><a href="Chainweb.HostAddress.html#hostNameParser"><span class="hs-identifier hs-type">hostNameParser</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Parser</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-154"></span><span id="hostNameParser"><span class="annot"><span class="annottext">hostNameParser :: Parser ByteString ()
</span><a href="Chainweb.HostAddress.html#hostNameParser"><span class="hs-identifier hs-var hs-var">hostNameParser</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-155"></span><span>    </span><span class="annot"><span class="annottext">() -&gt; Parser ByteString [()] -&gt; Parser ByteString ()
forall (f :: * -&gt; *) a b. Functor f =&gt; a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;$</span></span><span> </span><span class="annot"><span class="annottext">Parser ByteString () -&gt; Parser ByteString [()]
forall (m :: * -&gt; *) a. MonadPlus m =&gt; m a -&gt; m [a]
</span><span class="hs-identifier hs-var">many'</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Parser ByteString ()
</span><a href="#local-6989586621681467958"><span class="hs-identifier hs-var">domainlabel</span></a></span><span> </span><span class="annot"><span class="annottext">Parser ByteString ()
-&gt; Parser ByteString ByteString -&gt; Parser ByteString ()
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;*</span></span><span> </span><span class="annot"><span class="hs-string">&quot;.&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Parser ByteString ()
-&gt; Parser ByteString () -&gt; Parser ByteString ()
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;*</span></span><span> </span><span class="annot"><span class="annottext">Parser ByteString ()
</span><a href="#local-6989586621681467956"><span class="hs-identifier hs-var">toplabel</span></a></span><span>
</span><span id="line-156"></span><span>    </span><span class="annot"><span class="annottext">Parser ByteString () -&gt; String -&gt; Parser ByteString ()
forall i a. Parser i a -&gt; String -&gt; Parser i a
</span><span class="hs-operator hs-var">&lt;?&gt;</span></span><span> </span><span class="annot"><span class="hs-string">&quot;hostname&quot;</span></span><span>
</span><span id="line-157"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-158"></span><span>    </span><span id="local-6989586621681467958"><span class="annot"><span class="annottext">domainlabel :: Parser ByteString ()
</span><a href="#local-6989586621681467958"><span class="hs-identifier hs-var hs-var">domainlabel</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-159"></span><span>        </span><span class="annot"><span class="annottext">() -&gt; Parser ByteString Char -&gt; Parser ByteString ()
forall (f :: * -&gt; *) a b. Functor f =&gt; a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;$</span></span><span> </span><span class="annot"><span class="annottext">Parser ByteString Char
</span><a href="#local-6989586621681467955"><span class="hs-identifier hs-var">alphanum</span></a></span><span> </span><span class="annot"><span class="annottext">Parser ByteString ()
-&gt; Parser ByteString (Maybe ()) -&gt; Parser ByteString ()
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;*</span></span><span> </span><span class="annot"><span class="annottext">Parser ByteString () -&gt; Parser ByteString (Maybe ())
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f (Maybe a)
</span><span class="hs-identifier hs-var">optional</span></span><span> </span><span class="annot"><span class="annottext">Parser ByteString ()
</span><a href="#local-6989586621681467953"><span class="hs-identifier hs-var">labelTail</span></a></span><span>
</span><span id="line-160"></span><span>        </span><span class="annot"><span class="annottext">Parser ByteString () -&gt; String -&gt; Parser ByteString ()
forall i a. Parser i a -&gt; String -&gt; Parser i a
</span><span class="hs-operator hs-var">&lt;?&gt;</span></span><span> </span><span class="annot"><span class="hs-string">&quot;domainlabel&quot;</span></span><span>
</span><span id="line-161"></span><span>
</span><span id="line-162"></span><span>    </span><span id="local-6989586621681467956"><span class="annot"><span class="annottext">toplabel :: Parser ByteString ()
</span><a href="#local-6989586621681467956"><span class="hs-identifier hs-var hs-var">toplabel</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-163"></span><span>        </span><span class="annot"><span class="annottext">() -&gt; Parser ByteString Char -&gt; Parser ByteString ()
forall (f :: * -&gt; *) a b. Functor f =&gt; a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;$</span></span><span> </span><span class="annot"><span class="annottext">Parser ByteString Char
</span><a href="#local-6989586621681467952"><span class="hs-identifier hs-var">alpha</span></a></span><span> </span><span class="annot"><span class="annottext">Parser ByteString ()
-&gt; Parser ByteString (Maybe ()) -&gt; Parser ByteString ()
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;*</span></span><span> </span><span class="annot"><span class="annottext">Parser ByteString () -&gt; Parser ByteString (Maybe ())
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f (Maybe a)
</span><span class="hs-identifier hs-var">optional</span></span><span> </span><span class="annot"><span class="annottext">Parser ByteString ()
</span><a href="#local-6989586621681467953"><span class="hs-identifier hs-var">labelTail</span></a></span><span>
</span><span id="line-164"></span><span>        </span><span class="annot"><span class="annottext">Parser ByteString () -&gt; String -&gt; Parser ByteString ()
forall i a. Parser i a -&gt; String -&gt; Parser i a
</span><span class="hs-operator hs-var">&lt;?&gt;</span></span><span> </span><span class="annot"><span class="hs-string">&quot;toplabel&quot;</span></span><span>
</span><span id="line-165"></span><span>
</span><span id="line-166"></span><span>    </span><span id="local-6989586621681467953"><span class="annot"><span class="annottext">labelTail :: Parser ByteString ()
</span><a href="#local-6989586621681467953"><span class="hs-identifier hs-var hs-var">labelTail</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Parser ByteString Char
</span><a href="#local-6989586621681467951"><span class="hs-identifier hs-var">alphanumhyphen</span></a></span><span> </span><span class="annot"><span class="annottext">Parser ByteString Char
-&gt; (Char -&gt; Parser ByteString ()) -&gt; Parser ByteString ()
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-167"></span><span>        </span><span class="hs-char">'-'</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Parser ByteString ()
</span><a href="#local-6989586621681467953"><span class="hs-identifier hs-var">labelTail</span></a></span><span>
</span><span id="line-168"></span><span>        </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">() -&gt; Parser ByteString (Maybe ()) -&gt; Parser ByteString ()
forall (f :: * -&gt; *) a b. Functor f =&gt; a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;$</span></span><span> </span><span class="annot"><span class="annottext">Parser ByteString () -&gt; Parser ByteString (Maybe ())
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f (Maybe a)
</span><span class="hs-identifier hs-var">optional</span></span><span> </span><span class="annot"><span class="annottext">Parser ByteString ()
</span><a href="#local-6989586621681467953"><span class="hs-identifier hs-var">labelTail</span></a></span><span>
</span><span id="line-169"></span><span>
</span><span id="line-170"></span><span>    </span><span id="local-6989586621681467952"><span class="annot"><span class="annottext">alpha :: Parser ByteString Char
</span><a href="#local-6989586621681467952"><span class="hs-identifier hs-var hs-var">alpha</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; Parser ByteString Char
</span><span class="hs-identifier hs-var">satisfy</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><span class="hs-identifier hs-var">isAlpha_ascii</span></span><span>
</span><span id="line-171"></span><span>        </span><span class="annot"><span class="annottext">Parser ByteString Char -&gt; String -&gt; Parser ByteString Char
forall i a. Parser i a -&gt; String -&gt; Parser i a
</span><span class="hs-operator hs-var">&lt;?&gt;</span></span><span> </span><span class="annot"><span class="hs-string">&quot;alpha&quot;</span></span><span>
</span><span id="line-172"></span><span>
</span><span id="line-173"></span><span>    </span><span id="local-6989586621681467955"><span class="annot"><span class="annottext">alphanum :: Parser ByteString Char
</span><a href="#local-6989586621681467955"><span class="hs-identifier hs-var hs-var">alphanum</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; Parser ByteString Char
</span><span class="hs-identifier hs-var">satisfy</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621681467948"><span class="annot"><span class="annottext">c :: Char
</span><a href="#local-6989586621681467948"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><span class="hs-identifier hs-var">isAlpha_ascii</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621681467948"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><span class="hs-identifier hs-var">isDigit</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621681467948"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-174"></span><span>        </span><span class="annot"><span class="annottext">Parser ByteString Char -&gt; String -&gt; Parser ByteString Char
forall i a. Parser i a -&gt; String -&gt; Parser i a
</span><span class="hs-operator hs-var">&lt;?&gt;</span></span><span> </span><span class="annot"><span class="hs-string">&quot;alphanum&quot;</span></span><span>
</span><span id="line-175"></span><span>
</span><span id="line-176"></span><span>    </span><span id="local-6989586621681467951"><span class="annot"><span class="annottext">alphanumhyphen :: Parser ByteString Char
</span><a href="#local-6989586621681467951"><span class="hs-identifier hs-var hs-var">alphanumhyphen</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; Parser ByteString Char
</span><span class="hs-identifier hs-var">satisfy</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621681467945"><span class="annot"><span class="annottext">c :: Char
</span><a href="#local-6989586621681467945"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><span class="hs-identifier hs-var">isAlpha_ascii</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621681467945"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><span class="hs-identifier hs-var">isDigit</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621681467945"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621681467945"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Char -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="hs-char">'-'</span></span><span class="hs-special">)</span><span>
</span><span id="line-177"></span><span>        </span><span class="annot"><span class="annottext">Parser ByteString Char -&gt; String -&gt; Parser ByteString Char
forall i a. Parser i a -&gt; String -&gt; Parser i a
</span><span class="hs-operator hs-var">&lt;?&gt;</span></span><span> </span><span class="annot"><span class="hs-string">&quot;alphahumhypen&quot;</span></span><span>
</span><span id="line-178"></span><span>
</span><span id="line-179"></span><span class="annot"><a href="Chainweb.HostAddress.html#ipV4Parser"><span class="hs-identifier hs-type">ipV4Parser</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Parser</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span class="hs-special">)</span><span>
</span><span id="line-180"></span><span id="ipV4Parser"><span class="annot"><span class="annottext">ipV4Parser :: Parser ByteString (Word8, Word8, Word8, Word8)
</span><a href="Chainweb.HostAddress.html#ipV4Parser"><span class="hs-identifier hs-var hs-var">ipV4Parser</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">,</span><span class="hs-special">,</span><span class="hs-special">,</span><span class="hs-special">)</span><span>
</span><span id="line-181"></span><span>    </span><span class="annot"><span class="annottext">(Word8 -&gt; Word8 -&gt; Word8 -&gt; Word8 -&gt; (Word8, Word8, Word8, Word8))
-&gt; Parser ByteString Word8
-&gt; Parser
     ByteString
     (Word8 -&gt; Word8 -&gt; Word8 -&gt; (Word8, Word8, Word8, Word8))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Parser ByteString Word8
</span><a href="#local-6989586621681467943"><span class="hs-identifier hs-var">octet</span></a></span><span> </span><span class="annot"><span class="annottext">Parser ByteString Word8
-&gt; Parser ByteString ByteString -&gt; Parser ByteString Word8
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;*</span></span><span> </span><span class="annot"><span class="hs-string">&quot;.&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Parser
  ByteString
  (Word8 -&gt; Word8 -&gt; Word8 -&gt; (Word8, Word8, Word8, Word8))
-&gt; Parser ByteString Word8
-&gt; Parser
     ByteString (Word8 -&gt; Word8 -&gt; (Word8, Word8, Word8, Word8))
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Parser ByteString Word8
</span><a href="#local-6989586621681467943"><span class="hs-identifier hs-var">octet</span></a></span><span> </span><span class="annot"><span class="annottext">Parser ByteString Word8
-&gt; Parser ByteString ByteString -&gt; Parser ByteString Word8
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;*</span></span><span> </span><span class="annot"><span class="hs-string">&quot;.&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Parser ByteString (Word8 -&gt; Word8 -&gt; (Word8, Word8, Word8, Word8))
-&gt; Parser ByteString Word8
-&gt; Parser ByteString (Word8 -&gt; (Word8, Word8, Word8, Word8))
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Parser ByteString Word8
</span><a href="#local-6989586621681467943"><span class="hs-identifier hs-var">octet</span></a></span><span> </span><span class="annot"><span class="annottext">Parser ByteString Word8
-&gt; Parser ByteString ByteString -&gt; Parser ByteString Word8
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;*</span></span><span> </span><span class="annot"><span class="hs-string">&quot;.&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Parser ByteString (Word8 -&gt; (Word8, Word8, Word8, Word8))
-&gt; Parser ByteString Word8
-&gt; Parser ByteString (Word8, Word8, Word8, Word8)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Parser ByteString Word8
</span><a href="#local-6989586621681467943"><span class="hs-identifier hs-var">octet</span></a></span><span>
</span><span id="line-182"></span><span>    </span><span class="annot"><span class="annottext">Parser ByteString (Word8, Word8, Word8, Word8)
-&gt; String -&gt; Parser ByteString (Word8, Word8, Word8, Word8)
forall i a. Parser i a -&gt; String -&gt; Parser i a
</span><span class="hs-operator hs-var">&lt;?&gt;</span></span><span> </span><span class="annot"><span class="hs-string">&quot;ipv4address&quot;</span></span><span>
</span><span id="line-183"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-184"></span><span>    </span><span class="annot"><a href="#local-6989586621681467943"><span class="hs-identifier hs-type">octet</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Parser</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span>
</span><span id="line-185"></span><span>    </span><span id="local-6989586621681467943"><span class="annot"><span class="annottext">octet :: Parser ByteString Word8
</span><a href="#local-6989586621681467943"><span class="hs-identifier hs-var hs-var">octet</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Parser Integer
forall a. Integral a =&gt; Parser a
</span><span class="hs-identifier hs-var">decimal</span></span><span> </span><span class="annot"><span class="annottext">Parser Integer
-&gt; (Integer -&gt; Parser ByteString Word8) -&gt; Parser ByteString Word8
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621681467941"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621681467941"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Word8
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="Chainweb.Utils.html#int"><span class="hs-identifier hs-var">int</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621681467941"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Parser ByteString () -&gt; Parser ByteString Word8
forall (f :: * -&gt; *) a b. Functor f =&gt; a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;$</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Parser ByteString ()
forall (f :: * -&gt; *). Alternative f =&gt; Bool -&gt; f ()
</span><span class="hs-identifier hs-var">guard</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621681467941"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="hs-number">256</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-186"></span><span>        </span><span class="annot"><span class="annottext">Parser ByteString Word8 -&gt; String -&gt; Parser ByteString Word8
forall i a. Parser i a -&gt; String -&gt; Parser i a
</span><span class="hs-operator hs-var">&lt;?&gt;</span></span><span> </span><span class="annot"><span class="hs-string">&quot;octet&quot;</span></span><span>
</span><span id="line-187"></span><span>
</span><span id="line-188"></span><span class="annot"><a href="Chainweb.HostAddress.html#ipV6Parser"><span class="hs-identifier hs-type">ipV6Parser</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Parser</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word16</span></span><span class="hs-special">]</span><span>
</span><span id="line-189"></span><span id="ipV6Parser"><span class="annot"><span class="annottext">ipV6Parser :: Parser ByteString [Maybe Word16]
</span><a href="Chainweb.HostAddress.html#ipV6Parser"><span class="hs-identifier hs-var hs-var">ipV6Parser</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Parser ByteString [Maybe Word16]
</span><a href="#local-6989586621681467938"><span class="hs-identifier hs-var">p0</span></a></span><span>
</span><span id="line-190"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-191"></span><span>    </span><span id="local-6989586621681467938"><span class="annot"><span class="annottext">p0 :: Parser ByteString [Maybe Word16]
</span><a href="#local-6989586621681467938"><span class="hs-identifier hs-var hs-var">p0</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Word16 -&gt; [Maybe Word16]
forall a. a -&gt; [a]
</span><a href="#local-6989586621681467937"><span class="hs-identifier hs-var">l1</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe Word16 -&gt; [Maybe Word16])
-&gt; Parser ByteString (Maybe Word16)
-&gt; Parser ByteString [Maybe Word16]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Parser ByteString (Maybe Word16)
</span><a href="#local-6989586621681467936"><span class="hs-identifier hs-var">elision</span></a></span><span> </span><span class="annot"><span class="annottext">Parser ByteString [Maybe Word16]
-&gt; Parser ByteString () -&gt; Parser ByteString [Maybe Word16]
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;*</span></span><span> </span><span class="annot"><span class="annottext">Parser ByteString ()
forall t. Chunk t =&gt; Parser t ()
</span><span class="hs-identifier hs-var">endOfInput</span></span><span>
</span><span id="line-192"></span><span>        </span><span class="annot"><span class="annottext">Parser ByteString [Maybe Word16]
-&gt; Parser ByteString [Maybe Word16]
-&gt; Parser ByteString [Maybe Word16]
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="annot"><span class="annottext">Maybe Word16 -&gt; Maybe Word16 -&gt; [Maybe Word16] -&gt; [Maybe Word16]
forall a. a -&gt; a -&gt; [a] -&gt; [a]
</span><a href="#local-6989586621681467934"><span class="hs-identifier hs-var">l3</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe Word16 -&gt; Maybe Word16 -&gt; [Maybe Word16] -&gt; [Maybe Word16])
-&gt; Parser ByteString (Maybe Word16)
-&gt; Parser
     ByteString (Maybe Word16 -&gt; [Maybe Word16] -&gt; [Maybe Word16])
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Parser ByteString (Maybe Word16)
</span><a href="#local-6989586621681467936"><span class="hs-identifier hs-var">elision</span></a></span><span> </span><span class="annot"><span class="annottext">Parser
  ByteString (Maybe Word16 -&gt; [Maybe Word16] -&gt; [Maybe Word16])
-&gt; Parser ByteString (Maybe Word16)
-&gt; Parser ByteString ([Maybe Word16] -&gt; [Maybe Word16])
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Parser ByteString (Maybe Word16)
</span><a href="#local-6989586621681467933"><span class="hs-identifier hs-var">h16</span></a></span><span> </span><span class="annot"><span class="annottext">Parser ByteString ([Maybe Word16] -&gt; [Maybe Word16])
-&gt; Parser ByteString [Maybe Word16]
-&gt; Parser ByteString [Maybe Word16]
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Parser ByteString [Maybe Word16]
</span><a href="#local-6989586621681467932"><span class="hs-identifier hs-var">p2</span></a></span><span> </span><span class="annot"><span class="hs-number">6</span></span><span>
</span><span id="line-193"></span><span>        </span><span class="annot"><span class="annottext">Parser ByteString [Maybe Word16]
-&gt; Parser ByteString [Maybe Word16]
-&gt; Parser ByteString [Maybe Word16]
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="annot"><span class="annottext">Maybe Word16 -&gt; [Maybe Word16] -&gt; [Maybe Word16]
forall a. a -&gt; [a] -&gt; [a]
</span><a href="#local-6989586621681467931"><span class="hs-identifier hs-var">l2</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe Word16 -&gt; [Maybe Word16] -&gt; [Maybe Word16])
-&gt; Parser ByteString (Maybe Word16)
-&gt; Parser ByteString ([Maybe Word16] -&gt; [Maybe Word16])
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Parser ByteString (Maybe Word16)
</span><a href="#local-6989586621681467933"><span class="hs-identifier hs-var">h16</span></a></span><span> </span><span class="annot"><span class="annottext">Parser ByteString ([Maybe Word16] -&gt; [Maybe Word16])
-&gt; Parser ByteString [Maybe Word16]
-&gt; Parser ByteString [Maybe Word16]
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Parser ByteString [Maybe Word16]
</span><a href="#local-6989586621681467930"><span class="hs-identifier hs-var">p1</span></a></span><span> </span><span class="annot"><span class="hs-number">7</span></span><span>
</span><span id="line-194"></span><span>        </span><span class="annot"><span class="annottext">Parser ByteString [Maybe Word16]
-&gt; String -&gt; Parser ByteString [Maybe Word16]
forall i a. Parser i a -&gt; String -&gt; Parser i a
</span><span class="hs-operator hs-var">&lt;?&gt;</span></span><span> </span><span class="annot"><span class="hs-string">&quot;IPv6address&quot;</span></span><span>
</span><span id="line-195"></span><span>
</span><span id="line-196"></span><span>    </span><span class="annot"><a href="#local-6989586621681467930"><span class="hs-identifier hs-type">p1</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Parser</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word16</span></span><span class="hs-special">]</span><span>
</span><span id="line-197"></span><span>    </span><span id="local-6989586621681467930"><span class="annot"><span class="annottext">p1 :: Int -&gt; Parser ByteString [Maybe Word16]
</span><a href="#local-6989586621681467930"><span class="hs-identifier hs-var hs-var">p1</span></a></span></span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Maybe Word16]
forall a. [a]
</span><a href="#local-6989586621681467929"><span class="hs-identifier hs-var">l0</span></a></span><span> </span><span class="annot"><span class="annottext">[Maybe Word16]
-&gt; Parser ByteString () -&gt; Parser ByteString [Maybe Word16]
forall (f :: * -&gt; *) a b. Functor f =&gt; a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;$</span></span><span> </span><span class="annot"><span class="annottext">Parser ByteString ()
forall t. Chunk t =&gt; Parser t ()
</span><span class="hs-identifier hs-var">endOfInput</span></span><span> </span><span class="annot"><span class="annottext">Parser ByteString [Maybe Word16]
-&gt; String -&gt; Parser ByteString [Maybe Word16]
forall i a. Parser i a -&gt; String -&gt; Parser i a
</span><span class="hs-operator hs-var">&lt;?&gt;</span></span><span> </span><span class="annot"><span class="hs-string">&quot;IPv6 prefix: too many segments&quot;</span></span><span>
</span><span id="line-198"></span><span>    </span><span class="annot"><a href="#local-6989586621681467930"><span class="hs-identifier hs-var">p1</span></a></span><span> </span><span id="local-6989586621681467928"><span class="annot"><span class="annottext">i :: Int
</span><a href="#local-6989586621681467928"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Word16 -&gt; [Maybe Word16]
forall a. a -&gt; [a]
</span><a href="#local-6989586621681467937"><span class="hs-identifier hs-var">l1</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe Word16 -&gt; [Maybe Word16])
-&gt; Parser ByteString (Maybe Word16)
-&gt; Parser ByteString [Maybe Word16]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Parser ByteString (Maybe Word16)
</span><a href="#local-6989586621681467936"><span class="hs-identifier hs-var">elision</span></a></span><span> </span><span class="annot"><span class="annottext">Parser ByteString [Maybe Word16]
-&gt; Parser ByteString () -&gt; Parser ByteString [Maybe Word16]
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;*</span></span><span> </span><span class="annot"><span class="annottext">Parser ByteString ()
forall t. Chunk t =&gt; Parser t ()
</span><span class="hs-identifier hs-var">endOfInput</span></span><span>
</span><span id="line-199"></span><span>        </span><span class="annot"><span class="annottext">Parser ByteString [Maybe Word16]
-&gt; Parser ByteString [Maybe Word16]
-&gt; Parser ByteString [Maybe Word16]
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="annot"><span class="annottext">Maybe Word16 -&gt; Maybe Word16 -&gt; [Maybe Word16] -&gt; [Maybe Word16]
forall a. a -&gt; a -&gt; [a] -&gt; [a]
</span><a href="#local-6989586621681467934"><span class="hs-identifier hs-var">l3</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe Word16 -&gt; Maybe Word16 -&gt; [Maybe Word16] -&gt; [Maybe Word16])
-&gt; Parser ByteString (Maybe Word16)
-&gt; Parser
     ByteString (Maybe Word16 -&gt; [Maybe Word16] -&gt; [Maybe Word16])
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Parser ByteString (Maybe Word16)
</span><a href="#local-6989586621681467936"><span class="hs-identifier hs-var">elision</span></a></span><span> </span><span class="annot"><span class="annottext">Parser
  ByteString (Maybe Word16 -&gt; [Maybe Word16] -&gt; [Maybe Word16])
-&gt; Parser ByteString (Maybe Word16)
-&gt; Parser ByteString ([Maybe Word16] -&gt; [Maybe Word16])
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Parser ByteString (Maybe Word16)
</span><a href="#local-6989586621681467933"><span class="hs-identifier hs-var">h16</span></a></span><span> </span><span class="annot"><span class="annottext">Parser ByteString ([Maybe Word16] -&gt; [Maybe Word16])
-&gt; Parser ByteString [Maybe Word16]
-&gt; Parser ByteString [Maybe Word16]
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Parser ByteString [Maybe Word16]
</span><a href="#local-6989586621681467932"><span class="hs-identifier hs-var">p2</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681467928"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span class="hs-special">)</span><span>
</span><span id="line-200"></span><span>        </span><span class="annot"><span class="annottext">Parser ByteString [Maybe Word16]
-&gt; Parser ByteString [Maybe Word16]
-&gt; Parser ByteString [Maybe Word16]
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="annot"><span class="annottext">Maybe Word16 -&gt; [Maybe Word16] -&gt; [Maybe Word16]
forall a. a -&gt; [a] -&gt; [a]
</span><a href="#local-6989586621681467931"><span class="hs-identifier hs-var">l2</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe Word16 -&gt; [Maybe Word16] -&gt; [Maybe Word16])
-&gt; Parser ByteString ByteString
-&gt; Parser
     ByteString (Maybe Word16 -&gt; [Maybe Word16] -&gt; [Maybe Word16])
forall (f :: * -&gt; *) a b. Functor f =&gt; a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;$</span></span><span> </span><span class="annot"><span class="hs-string">&quot;:&quot;</span></span><span> </span><span class="annot"><span class="annottext">Parser
  ByteString (Maybe Word16 -&gt; [Maybe Word16] -&gt; [Maybe Word16])
-&gt; Parser ByteString (Maybe Word16)
-&gt; Parser ByteString ([Maybe Word16] -&gt; [Maybe Word16])
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Parser ByteString (Maybe Word16)
</span><a href="#local-6989586621681467933"><span class="hs-identifier hs-var">h16</span></a></span><span> </span><span class="annot"><span class="annottext">Parser ByteString ([Maybe Word16] -&gt; [Maybe Word16])
-&gt; Parser ByteString [Maybe Word16]
-&gt; Parser ByteString [Maybe Word16]
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Parser ByteString [Maybe Word16]
</span><a href="#local-6989586621681467930"><span class="hs-identifier hs-var">p1</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681467928"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-201"></span><span>        </span><span class="annot"><span class="annottext">Parser ByteString [Maybe Word16]
-&gt; String -&gt; Parser ByteString [Maybe Word16]
forall i a. Parser i a -&gt; String -&gt; Parser i a
</span><span class="hs-operator hs-var">&lt;?&gt;</span></span><span> </span><span class="annot"><span class="hs-string">&quot;IPv6 prefix&quot;</span></span><span>
</span><span id="line-202"></span><span>
</span><span id="line-203"></span><span>    </span><span class="annot"><a href="#local-6989586621681467932"><span class="hs-identifier hs-type">p2</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Parser</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word16</span></span><span class="hs-special">]</span><span>
</span><span id="line-204"></span><span>    </span><span id="local-6989586621681467932"><span class="annot"><span class="annottext">p2 :: Int -&gt; Parser ByteString [Maybe Word16]
</span><a href="#local-6989586621681467932"><span class="hs-identifier hs-var hs-var">p2</span></a></span></span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Maybe Word16]
forall a. [a]
</span><a href="#local-6989586621681467929"><span class="hs-identifier hs-var">l0</span></a></span><span> </span><span class="annot"><span class="annottext">[Maybe Word16]
-&gt; Parser ByteString () -&gt; Parser ByteString [Maybe Word16]
forall (f :: * -&gt; *) a b. Functor f =&gt; a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;$</span></span><span> </span><span class="annot"><span class="annottext">Parser ByteString ()
forall t. Chunk t =&gt; Parser t ()
</span><span class="hs-identifier hs-var">endOfInput</span></span><span> </span><span class="annot"><span class="annottext">Parser ByteString [Maybe Word16]
-&gt; String -&gt; Parser ByteString [Maybe Word16]
forall i a. Parser i a -&gt; String -&gt; Parser i a
</span><span class="hs-operator hs-var">&lt;?&gt;</span></span><span> </span><span class="annot"><span class="hs-string">&quot;IPv6 suffix: too many segments&quot;</span></span><span>
</span><span id="line-205"></span><span>    </span><span class="annot"><a href="#local-6989586621681467932"><span class="hs-identifier hs-var">p2</span></a></span><span> </span><span id="local-6989586621681467927"><span class="annot"><span class="annottext">i :: Int
</span><a href="#local-6989586621681467927"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Word16 -&gt; [Maybe Word16] -&gt; [Maybe Word16]
forall a. a -&gt; [a] -&gt; [a]
</span><a href="#local-6989586621681467931"><span class="hs-identifier hs-var">l2</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe Word16 -&gt; [Maybe Word16] -&gt; [Maybe Word16])
-&gt; Parser ByteString ByteString
-&gt; Parser
     ByteString (Maybe Word16 -&gt; [Maybe Word16] -&gt; [Maybe Word16])
forall (f :: * -&gt; *) a b. Functor f =&gt; a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;$</span></span><span> </span><span class="annot"><span class="hs-string">&quot;:&quot;</span></span><span> </span><span class="annot"><span class="annottext">Parser
  ByteString (Maybe Word16 -&gt; [Maybe Word16] -&gt; [Maybe Word16])
-&gt; Parser ByteString (Maybe Word16)
-&gt; Parser ByteString ([Maybe Word16] -&gt; [Maybe Word16])
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Parser ByteString (Maybe Word16)
</span><a href="#local-6989586621681467933"><span class="hs-identifier hs-var">h16</span></a></span><span> </span><span class="annot"><span class="annottext">Parser ByteString ([Maybe Word16] -&gt; [Maybe Word16])
-&gt; Parser ByteString [Maybe Word16]
-&gt; Parser ByteString [Maybe Word16]
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Parser ByteString [Maybe Word16]
</span><a href="#local-6989586621681467932"><span class="hs-identifier hs-var">p2</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681467927"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-206"></span><span>        </span><span class="annot"><span class="annottext">Parser ByteString [Maybe Word16]
-&gt; Parser ByteString [Maybe Word16]
-&gt; Parser ByteString [Maybe Word16]
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Maybe Word16]
forall a. [a]
</span><a href="#local-6989586621681467929"><span class="hs-identifier hs-var">l0</span></a></span><span> </span><span class="annot"><span class="annottext">[Maybe Word16]
-&gt; Parser ByteString () -&gt; Parser ByteString [Maybe Word16]
forall (f :: * -&gt; *) a b. Functor f =&gt; a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;$</span></span><span> </span><span class="annot"><span class="annottext">Parser ByteString ()
forall t. Chunk t =&gt; Parser t ()
</span><span class="hs-identifier hs-var">endOfInput</span></span><span>
</span><span id="line-207"></span><span>        </span><span class="annot"><span class="annottext">Parser ByteString [Maybe Word16]
-&gt; String -&gt; Parser ByteString [Maybe Word16]
forall i a. Parser i a -&gt; String -&gt; Parser i a
</span><span class="hs-operator hs-var">&lt;?&gt;</span></span><span> </span><span class="annot"><span class="hs-string">&quot;IPv6 suffix&quot;</span></span><span>
</span><span id="line-208"></span><span>
</span><span id="line-209"></span><span>    </span><span class="annot"><a href="#local-6989586621681467936"><span class="hs-identifier hs-type">elision</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Parser</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word16</span></span><span class="hs-special">)</span><span>
</span><span id="line-210"></span><span>    </span><span id="local-6989586621681467936"><span class="annot"><span class="annottext">elision :: Parser ByteString (Maybe Word16)
</span><a href="#local-6989586621681467936"><span class="hs-identifier hs-var hs-var">elision</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Word16
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="annot"><span class="annottext">Maybe Word16
-&gt; Parser ByteString ByteString -&gt; Parser ByteString (Maybe Word16)
forall (f :: * -&gt; *) a b. Functor f =&gt; a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;$</span></span><span> </span><span class="annot"><span class="hs-string">&quot;::&quot;</span></span><span>
</span><span id="line-211"></span><span>
</span><span id="line-212"></span><span>    </span><span class="annot"><a href="#local-6989586621681467933"><span class="hs-identifier hs-type">h16</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Parser</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word16</span></span><span class="hs-special">)</span><span>
</span><span id="line-213"></span><span>    </span><span id="local-6989586621681467933"><span class="annot"><span class="annottext">h16 :: Parser ByteString (Maybe Word16)
</span><a href="#local-6989586621681467933"><span class="hs-identifier hs-var hs-var">h16</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word16 -&gt; Maybe Word16
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(Word16 -&gt; Maybe Word16)
-&gt; Parser ByteString Word16 -&gt; Parser ByteString (Maybe Word16)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-214"></span><span>        </span><span id="local-6989586621681467926"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621681467926"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Integral Integer, Bits Integer) =&gt; Parser Integer
forall a. (Integral a, Bits a) =&gt; Parser a
</span><span class="hs-identifier hs-var">hexadecimal</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span>
</span><span id="line-215"></span><span>        </span><span class="annot"><span class="annottext">Bool -&gt; Parser ByteString ()
forall (f :: * -&gt; *). Alternative f =&gt; Bool -&gt; f ()
</span><span class="hs-identifier hs-var">guard</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Parser ByteString ()) -&gt; Bool -&gt; Parser ByteString ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621681467926"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Word16 -&gt; Integer
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="Chainweb.Utils.html#int"><span class="hs-identifier hs-var">int</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bounded Word16 =&gt; Word16
forall a. Bounded a =&gt; a
</span><span class="hs-identifier hs-var">maxBound</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-identifier hs-type">Word16</span></span><span class="hs-special">)</span><span>
</span><span id="line-216"></span><span>        </span><span class="annot"><span class="annottext">Word16 -&gt; Parser ByteString Word16
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Word16 -&gt; Parser ByteString Word16)
-&gt; Word16 -&gt; Parser ByteString Word16
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$!</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Word16
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="Chainweb.Utils.html#int"><span class="hs-identifier hs-var">int</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621681467926"><span class="hs-identifier hs-var">h</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-217"></span><span>        </span><span class="annot"><span class="annottext">Parser ByteString (Maybe Word16)
-&gt; String -&gt; Parser ByteString (Maybe Word16)
forall i a. Parser i a -&gt; String -&gt; Parser i a
</span><span class="hs-operator hs-var">&lt;?&gt;</span></span><span> </span><span class="annot"><span class="hs-string">&quot;h16&quot;</span></span><span>
</span><span id="line-218"></span><span>
</span><span id="line-219"></span><span>    </span><span id="local-6989586621681467929"><span class="annot"><span class="annottext">l0 :: [a]
</span><a href="#local-6989586621681467929"><span class="hs-identifier hs-var hs-var">l0</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-220"></span><span>    </span><span id="local-6989586621681467937"><span class="annot"><span class="annottext">l1 :: a -&gt; [a]
</span><a href="#local-6989586621681467937"><span class="hs-identifier hs-var hs-var">l1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; [a]
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span>
</span><span id="line-221"></span><span>    </span><span id="local-6989586621681467931"><span class="annot"><span class="annottext">l2 :: a -&gt; [a] -&gt; [a]
</span><a href="#local-6989586621681467931"><span class="hs-identifier hs-var hs-var">l2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">:</span><span class="hs-special">)</span><span>
</span><span id="line-222"></span><span>    </span><span id="local-6989586621681467934"><span class="annot"><span class="annottext">l3 :: a -&gt; a -&gt; [a] -&gt; [a]
</span><a href="#local-6989586621681467934"><span class="hs-identifier hs-var hs-var">l3</span></a></span></span><span> </span><span id="local-6989586621681467922"><span class="annot"><span class="annottext">a :: a
</span><a href="#local-6989586621681467922"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621681467921"><span class="annot"><span class="annottext">b :: a
</span><a href="#local-6989586621681467921"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621681467920"><span class="annot"><span class="annottext">t :: [a]
</span><a href="#local-6989586621681467920"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681467922"><span class="hs-identifier hs-var">a</span></a></span><span class="annot"><span class="annottext">a -&gt; [a] -&gt; [a]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681467921"><span class="hs-identifier hs-var">b</span></a></span><span class="annot"><span class="annottext">a -&gt; [a] -&gt; [a]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621681467920"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-223"></span><span>
</span><span id="line-224"></span><span class="annot"><a href="Chainweb.HostAddress.html#portParser"><span class="hs-identifier hs-type">portParser</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Parser</span></span><span> </span><span class="annot"><a href="Chainweb.HostAddress.html#Port"><span class="hs-identifier hs-type">Port</span></a></span><span>
</span><span id="line-225"></span><span id="portParser"><span class="annot"><span class="annottext">portParser :: Parser Port
</span><a href="Chainweb.HostAddress.html#portParser"><span class="hs-identifier hs-var hs-var">portParser</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word16 -&gt; Port
</span><a href="Chainweb.HostAddress.html#Port"><span class="hs-identifier hs-var">Port</span></a></span><span>
</span><span id="line-226"></span><span>    </span><span class="annot"><span class="annottext">(Word16 -&gt; Port) -&gt; Parser ByteString Word16 -&gt; Parser Port
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Parser Integer
forall a. Integral a =&gt; Parser a
</span><span class="hs-identifier hs-var">decimal</span></span><span> </span><span class="annot"><span class="annottext">Parser Integer
-&gt; (Integer -&gt; Parser ByteString Word16)
-&gt; Parser ByteString Word16
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621681467917"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621681467917"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Word16
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="Chainweb.Utils.html#int"><span class="hs-identifier hs-var">int</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621681467917"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">Word16 -&gt; Parser ByteString () -&gt; Parser ByteString Word16
forall (f :: * -&gt; *) a b. Functor f =&gt; a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;$</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Parser ByteString ()
forall (f :: * -&gt; *). Alternative f =&gt; Bool -&gt; f ()
</span><span class="hs-identifier hs-var">guard</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621681467917"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span class="annot"><span class="annottext">Integer -&gt; Int -&gt; Integer
forall a b. (Num a, Integral b) =&gt; a -&gt; b -&gt; a
</span><span class="hs-operator hs-var">^</span></span><span class="hs-special">(</span><span class="annot"><span class="hs-number">16</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-227"></span><span>    </span><span class="annot"><span class="annottext">Parser Port -&gt; String -&gt; Parser Port
forall i a. Parser i a -&gt; String -&gt; Parser i a
</span><span class="hs-operator hs-var">&lt;?&gt;</span></span><span> </span><span class="annot"><span class="hs-string">&quot;port&quot;</span></span><span>
</span><span id="line-228"></span><span>
</span><span id="line-229"></span><span id="local-6989586621681468120"><span id="local-6989586621681468121"><span class="annot"><a href="Chainweb.HostAddress.html#parseBytes"><span class="hs-identifier hs-type">parseBytes</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadThrow</span></span><span> </span><span class="annot"><a href="#local-6989586621681468121"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Parser</span></span><span> </span><span class="annot"><a href="#local-6989586621681468120"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">B8.ByteString</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681468121"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681468120"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-230"></span><span id="parseBytes"><span class="annot"><span class="annottext">parseBytes :: Text -&gt; Parser a -&gt; ByteString -&gt; m a
</span><a href="Chainweb.HostAddress.html#parseBytes"><span class="hs-identifier hs-var hs-var">parseBytes</span></a></span></span><span> </span><span id="local-6989586621681467914"><span class="annot"><span class="annottext">name :: Text
</span><a href="#local-6989586621681467914"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621681467913"><span class="annot"><span class="annottext">parser :: Parser a
</span><a href="#local-6989586621681467913"><span class="hs-identifier hs-var">parser</span></a></span></span><span> </span><span id="local-6989586621681467912"><span class="annot"><span class="annottext">b :: ByteString
</span><a href="#local-6989586621681467912"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(String -&gt; m a) -&gt; (a -&gt; m a) -&gt; Either String a -&gt; m a
forall a c b. (a -&gt; c) -&gt; (b -&gt; c) -&gt; Either a b -&gt; c
</span><span class="hs-identifier hs-var">either</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">EncodingException -&gt; m a
forall (m :: * -&gt; *) e a. (MonadThrow m, Exception e) =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwM</span></span><span> </span><span class="annot"><span class="annottext">(EncodingException -&gt; m a)
-&gt; (String -&gt; EncodingException) -&gt; String -&gt; m a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; EncodingException
</span><a href="Chainweb.Utils.html#TextFormatException"><span class="hs-identifier hs-var">TextFormatException</span></a></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; EncodingException)
-&gt; (String -&gt; Text) -&gt; String -&gt; EncodingException
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Text
</span><a href="#local-6989586621681467907"><span class="hs-identifier hs-var">msg</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span>
</span><span id="line-231"></span><span>    </span><span class="annot"><span class="annottext">(Either String a -&gt; m a) -&gt; Either String a -&gt; m a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Parser a -&gt; ByteString -&gt; Either String a
forall a. Parser a -&gt; ByteString -&gt; Either String a
</span><span class="hs-identifier hs-var">parseOnly</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Parser a
</span><a href="#local-6989586621681467913"><span class="hs-identifier hs-var">parser</span></a></span><span> </span><span class="annot"><span class="annottext">Parser a -&gt; Parser ByteString () -&gt; Parser a
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;*</span></span><span> </span><span class="annot"><span class="annottext">Parser ByteString ()
forall t. Chunk t =&gt; Parser t ()
</span><span class="hs-identifier hs-var">endOfInput</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621681467912"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-232"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-233"></span><span>    </span><span id="local-6989586621681467907"><span class="annot"><span class="annottext">msg :: String -&gt; Text
</span><a href="#local-6989586621681467907"><span class="hs-identifier hs-var hs-var">msg</span></a></span></span><span> </span><span id="local-6989586621681467905"><span class="annot"><span class="annottext">e :: String
</span><a href="#local-6989586621681467905"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-string">&quot;Failed to parse &quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Text
forall a b. (Show a, IsString b) =&gt; a -&gt; b
</span><a href="Chainweb.Utils.html#sshow"><span class="hs-identifier hs-var">sshow</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621681467912"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="hs-string">&quot; as &quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621681467914"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="hs-string">&quot;: &quot;</span></span><span>
</span><span id="line-234"></span><span>        </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Text
</span><span class="hs-identifier hs-var">T.pack</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621681467905"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-235"></span><span>
</span><span id="line-236"></span><span class="hs-comment">-- -------------------------------------------------------------------------- --</span><span>
</span><span id="line-237"></span><span class="hs-comment">-- Arbitrary Values</span><span>
</span><span id="line-238"></span><span>
</span><span id="line-239"></span><span class="hs-comment">-- | TODO should we exclude network, broadcast, otherwise special values?</span><span>
</span><span id="line-240"></span><span class="hs-comment">--</span><span>
</span><span id="line-241"></span><span class="annot"><a href="Chainweb.HostAddress.html#arbitraryIpV4"><span class="hs-identifier hs-type">arbitraryIpV4</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Gen</span></span><span> </span><span class="annot"><a href="Chainweb.HostAddress.html#Hostname"><span class="hs-identifier hs-type">Hostname</span></a></span><span>
</span><span id="line-242"></span><span id="arbitraryIpV4"><span class="annot"><span class="annottext">arbitraryIpV4 :: Gen Hostname
</span><a href="Chainweb.HostAddress.html#arbitraryIpV4"><span class="hs-identifier hs-var hs-var">arbitraryIpV4</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CI ByteString -&gt; Hostname
</span><a href="Chainweb.HostAddress.html#HostnameIPv4"><span class="hs-identifier hs-var">HostnameIPv4</span></a></span><span> </span><span class="annot"><span class="annottext">(CI ByteString -&gt; Hostname)
-&gt; ([Word8] -&gt; CI ByteString) -&gt; [Word8] -&gt; Hostname
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; CI ByteString
forall s. FoldCase s =&gt; s -&gt; CI s
</span><span class="hs-identifier hs-var">CI.mk</span></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; CI ByteString)
-&gt; ([Word8] -&gt; ByteString) -&gt; [Word8] -&gt; CI ByteString
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; [ByteString] -&gt; ByteString
</span><span class="hs-identifier hs-var">B8.intercalate</span></span><span> </span><span class="annot"><span class="hs-string">&quot;.&quot;</span></span><span> </span><span class="annot"><span class="annottext">([ByteString] -&gt; ByteString)
-&gt; ([Word8] -&gt; [ByteString]) -&gt; [Word8] -&gt; ByteString
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Word8 -&gt; ByteString) -&gt; [Word8] -&gt; [ByteString]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; ByteString
forall a b. (Show a, IsString b) =&gt; a -&gt; b
</span><a href="Chainweb.Utils.html#sshow"><span class="hs-identifier hs-var">sshow</span></a></span><span>
</span><span id="line-243"></span><span>    </span><span class="annot"><span class="annottext">([Word8] -&gt; Hostname) -&gt; Gen [Word8] -&gt; Gen Hostname
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Gen Word8 -&gt; Gen [Word8]
forall (m :: * -&gt; *) a. Applicative m =&gt; Int -&gt; m a -&gt; m [a]
</span><span class="hs-identifier hs-var">replicateM</span></span><span> </span><span class="annot"><span class="hs-number">4</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Gen Word8
forall a. Arbitrary a =&gt; Gen a
</span><span class="hs-identifier hs-var">arbitrary</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Gen</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span class="hs-special">)</span><span>
</span><span id="line-244"></span><span>
</span><span id="line-245"></span><span class="annot"><a href="Chainweb.HostAddress.html#arbitraryIpV6"><span class="hs-identifier hs-type">arbitraryIpV6</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Gen</span></span><span> </span><span class="annot"><a href="Chainweb.HostAddress.html#Hostname"><span class="hs-identifier hs-type">Hostname</span></a></span><span>
</span><span id="line-246"></span><span id="arbitraryIpV6"><span class="annot"><span class="annottext">arbitraryIpV6 :: Gen Hostname
</span><a href="Chainweb.HostAddress.html#arbitraryIpV6"><span class="hs-identifier hs-var hs-var">arbitraryIpV6</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CI ByteString -&gt; Hostname
</span><a href="Chainweb.HostAddress.html#HostnameIPv6"><span class="hs-identifier hs-var">HostnameIPv6</span></a></span><span> </span><span class="annot"><span class="annottext">(CI ByteString -&gt; Hostname)
-&gt; ([Word8] -&gt; CI ByteString) -&gt; [Word8] -&gt; Hostname
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; CI ByteString
forall s. FoldCase s =&gt; s -&gt; CI s
</span><span class="hs-identifier hs-var">CI.mk</span></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; CI ByteString)
-&gt; ([Word8] -&gt; ByteString) -&gt; [Word8] -&gt; CI ByteString
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; [ByteString] -&gt; ByteString
</span><span class="hs-identifier hs-var">B8.intercalate</span></span><span> </span><span class="annot"><span class="hs-string">&quot;:&quot;</span></span><span> </span><span class="annot"><span class="annottext">([ByteString] -&gt; ByteString)
-&gt; ([Word8] -&gt; [ByteString]) -&gt; [Word8] -&gt; ByteString
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Word8 -&gt; ByteString) -&gt; [Word8] -&gt; [ByteString]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; ByteString
forall a b. (Show a, IsString b) =&gt; a -&gt; b
</span><a href="Chainweb.Utils.html#sshow"><span class="hs-identifier hs-var">sshow</span></a></span><span>
</span><span id="line-247"></span><span>    </span><span class="annot"><span class="annottext">([Word8] -&gt; Hostname) -&gt; Gen [Word8] -&gt; Gen Hostname
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Gen Word8 -&gt; Gen [Word8]
forall (m :: * -&gt; *) a. Applicative m =&gt; Int -&gt; m a -&gt; m [a]
</span><span class="hs-identifier hs-var">replicateM</span></span><span> </span><span class="annot"><span class="hs-number">8</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Gen Word8
forall a. Arbitrary a =&gt; Gen a
</span><span class="hs-identifier hs-var">arbitrary</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Gen</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span class="hs-special">)</span><span>
</span><span id="line-248"></span><span>
</span><span id="line-249"></span><span class="annot"><a href="Chainweb.HostAddress.html#arbitraryDomainName"><span class="hs-identifier hs-type">arbitraryDomainName</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Gen</span></span><span> </span><span class="annot"><a href="Chainweb.HostAddress.html#Hostname"><span class="hs-identifier hs-type">Hostname</span></a></span><span>
</span><span id="line-250"></span><span id="arbitraryDomainName"><span class="annot"><span class="annottext">arbitraryDomainName :: Gen Hostname
</span><a href="Chainweb.HostAddress.html#arbitraryDomainName"><span class="hs-identifier hs-var hs-var">arbitraryDomainName</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Gen Hostname) -&gt; Gen Hostname
forall a. (Int -&gt; Gen a) -&gt; Gen a
</span><span class="hs-identifier hs-var">sized</span></span><span> </span><span class="annot"><span class="annottext">((Int -&gt; Gen Hostname) -&gt; Gen Hostname)
-&gt; (Int -&gt; Gen Hostname) -&gt; Gen Hostname
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621681467896"><span class="annot"><span class="annottext">n :: Int
</span><a href="#local-6989586621681467896"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Gen Hostname -&gt; Gen Hostname
forall a. Int -&gt; Gen a -&gt; Gen a
</span><span class="hs-identifier hs-var">resize</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Ord a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">min</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681467896"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="hs-number">254</span></span><span class="hs-special">)</span><span>
</span><span id="line-251"></span><span>    </span><span class="annot"><span class="annottext">(Gen Hostname -&gt; Gen Hostname)
-&gt; (Gen [CI ByteString] -&gt; Gen Hostname)
-&gt; Gen [CI ByteString]
-&gt; Gen Hostname
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">([CI ByteString] -&gt; Hostname)
-&gt; Gen [CI ByteString] -&gt; Gen Hostname
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CI ByteString -&gt; Hostname
</span><a href="Chainweb.HostAddress.html#HostnameName"><span class="hs-identifier hs-var">HostnameName</span></a></span><span> </span><span class="annot"><span class="annottext">(CI ByteString -&gt; Hostname)
-&gt; ([CI ByteString] -&gt; CI ByteString)
-&gt; [CI ByteString]
-&gt; Hostname
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[CI ByteString] -&gt; CI ByteString
forall a. Monoid a =&gt; [a] -&gt; a
</span><span class="hs-identifier hs-var">mconcat</span></span><span> </span><span class="annot"><span class="annottext">([CI ByteString] -&gt; CI ByteString)
-&gt; ([CI ByteString] -&gt; [CI ByteString])
-&gt; [CI ByteString]
-&gt; CI ByteString
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">CI ByteString -&gt; [CI ByteString] -&gt; [CI ByteString]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">L.intersperse</span></span><span> </span><span class="annot"><span class="hs-string">&quot;.&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-252"></span><span>    </span><span class="annot"><span class="annottext">(Gen [CI ByteString] -&gt; Gen Hostname)
-&gt; Gen [CI ByteString] -&gt; Gen Hostname
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[CI ByteString] -&gt; [CI ByteString] -&gt; [CI ByteString]
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">(&lt;&gt;)</span></span><span>
</span><span id="line-253"></span><span>        </span><span class="annot"><span class="annottext">([CI ByteString] -&gt; [CI ByteString] -&gt; [CI ByteString])
-&gt; Gen [CI ByteString] -&gt; Gen ([CI ByteString] -&gt; [CI ByteString])
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Gen (CI ByteString) -&gt; Gen [CI ByteString]
forall a. Gen a -&gt; Gen [a]
</span><span class="hs-identifier hs-var">listOf</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Gen (CI ByteString)
</span><a href="Chainweb.HostAddress.html#arbitraryDomainLabel"><span class="hs-identifier hs-var">arbitraryDomainLabel</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">)</span><span>
</span><span id="line-254"></span><span>        </span><span class="annot"><span class="annottext">Gen ([CI ByteString] -&gt; [CI ByteString])
-&gt; Gen [CI ByteString] -&gt; Gen [CI ByteString]
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Gen (CI ByteString) -&gt; Gen [CI ByteString]
forall a. Int -&gt; Gen a -&gt; Gen [a]
</span><span class="hs-identifier hs-var">vectorOf</span></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Gen (CI ByteString)
</span><a href="Chainweb.HostAddress.html#arbitraryDomainLabel"><span class="hs-identifier hs-var">arbitraryDomainLabel</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">)</span><span>
</span><span id="line-255"></span><span>
</span><span id="line-256"></span><span class="hs-comment">-- TODO add frequency or used sized to yield a better distribution</span><span>
</span><span id="line-257"></span><span class="hs-comment">--</span><span>
</span><span id="line-258"></span><span class="annot"><a href="Chainweb.HostAddress.html#arbitraryDomainLabel"><span class="hs-identifier hs-type">arbitraryDomainLabel</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Gen</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">CI.CI</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">B8.ByteString</span></span><span class="hs-special">)</span><span>
</span><span id="line-259"></span><span id="arbitraryDomainLabel"><span class="annot"><span class="annottext">arbitraryDomainLabel :: Bool -&gt; Gen (CI ByteString)
</span><a href="Chainweb.HostAddress.html#arbitraryDomainLabel"><span class="hs-identifier hs-var hs-var">arbitraryDomainLabel</span></a></span></span><span> </span><span id="local-6989586621681467888"><span class="annot"><span class="annottext">isTop :: Bool
</span><a href="#local-6989586621681467888"><span class="hs-identifier hs-var">isTop</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Gen (CI ByteString)) -&gt; Gen (CI ByteString)
forall a. (Int -&gt; Gen a) -&gt; Gen a
</span><span class="hs-identifier hs-var">sized</span></span><span> </span><span class="annot"><span class="annottext">((Int -&gt; Gen (CI ByteString)) -&gt; Gen (CI ByteString))
-&gt; (Int -&gt; Gen (CI ByteString)) -&gt; Gen (CI ByteString)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621681467887"><span class="annot"><span class="annottext">n :: Int
</span><a href="#local-6989586621681467887"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Gen (CI ByteString) -&gt; Gen (CI ByteString)
forall a. Int -&gt; Gen a -&gt; Gen a
</span><span class="hs-identifier hs-var">resize</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Ord a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">min</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681467887"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="hs-number">63</span></span><span class="hs-special">)</span><span>
</span><span id="line-260"></span><span>    </span><span class="annot"><span class="annottext">(Gen (CI ByteString) -&gt; Gen (CI ByteString))
-&gt; Gen (CI ByteString) -&gt; Gen (CI ByteString)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; CI ByteString
forall s. FoldCase s =&gt; s -&gt; CI s
</span><span class="hs-identifier hs-var">CI.mk</span></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; CI ByteString)
-&gt; (String -&gt; ByteString) -&gt; String -&gt; CI ByteString
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ByteString
</span><span class="hs-identifier hs-var">B8.pack</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; CI ByteString) -&gt; Gen String -&gt; Gen (CI ByteString)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Gen String] -&gt; Gen String
forall a. [Gen a] -&gt; Gen a
</span><span class="hs-identifier hs-var">oneof</span></span><span>
</span><span id="line-261"></span><span>        </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Gen Char -&gt; Gen String
forall a. Int -&gt; Gen a -&gt; Gen [a]
</span><span class="hs-identifier hs-var">vectorOf</span></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span> </span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681467888"><span class="hs-identifier hs-var">isTop</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Gen Char
</span><a href="#local-6989586621681467884"><span class="hs-identifier hs-var">letter</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Gen Char
</span><a href="#local-6989586621681467883"><span class="hs-identifier hs-var">letterOrDigit</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-262"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(String -&gt; Gen String -&gt; Gen String)
-&gt; String -&gt; [Gen String] -&gt; Gen String
forall (t :: * -&gt; *) (m :: * -&gt; *) b a.
(Foldable t, Monad m) =&gt;
(b -&gt; a -&gt; m b) -&gt; b -&gt; t a -&gt; m b
</span><span class="hs-identifier hs-var">foldM</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621681467882"><span class="annot"><span class="annottext">l :: String
</span><a href="#local-6989586621681467882"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621681467881"><span class="annot"><span class="annottext">a :: Gen String
</span><a href="#local-6989586621681467881"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621681467882"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ShowS -&gt; Gen String -&gt; Gen String
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Gen String
</span><a href="#local-6989586621681467881"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-263"></span><span>            </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Gen Char -&gt; Gen String
forall a. Int -&gt; Gen a -&gt; Gen [a]
</span><span class="hs-identifier hs-var">vectorOf</span></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span> </span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681467888"><span class="hs-identifier hs-var">isTop</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Gen Char
</span><a href="#local-6989586621681467884"><span class="hs-identifier hs-var">letter</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Gen Char
</span><a href="#local-6989586621681467883"><span class="hs-identifier hs-var">letterOrDigit</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-264"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Gen Char -&gt; Gen String
forall a. Gen a -&gt; Gen [a]
</span><span class="hs-identifier hs-var">listOf</span></span><span> </span><span class="annot"><span class="annottext">Gen Char
</span><a href="#local-6989586621681467880"><span class="hs-identifier hs-var">letterOrDigitOrHyphen</span></a></span><span>
</span><span id="line-265"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Gen Char -&gt; Gen String
forall a. Int -&gt; Gen a -&gt; Gen [a]
</span><span class="hs-identifier hs-var">vectorOf</span></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Gen Char
</span><a href="#local-6989586621681467883"><span class="hs-identifier hs-var">letterOrDigit</span></a></span><span>
</span><span id="line-266"></span><span>            </span><span class="hs-special">]</span><span>
</span><span id="line-267"></span><span>        </span><span class="hs-special">]</span><span>
</span><span id="line-268"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-269"></span><span>    </span><span id="local-6989586621681467884"><span class="annot"><span class="annottext">letter :: Gen Char
</span><a href="#local-6989586621681467884"><span class="hs-identifier hs-var hs-var">letter</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Gen Char
forall a. [a] -&gt; Gen a
</span><span class="hs-identifier hs-var">elements</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Gen Char) -&gt; String -&gt; Gen Char
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-char">'a'</span></span><span class="hs-glyph">..</span><span class="annot"><span class="hs-char">'z'</span></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-char">'A'</span></span><span class="hs-glyph">..</span><span class="annot"><span class="hs-char">'Z'</span></span><span class="hs-special">]</span><span>
</span><span id="line-270"></span><span>    </span><span id="local-6989586621681467883"><span class="annot"><span class="annottext">letterOrDigit :: Gen Char
</span><a href="#local-6989586621681467883"><span class="hs-identifier hs-var hs-var">letterOrDigit</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Gen Char
forall a. [a] -&gt; Gen a
</span><span class="hs-identifier hs-var">elements</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Gen Char) -&gt; String -&gt; Gen Char
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-char">'a'</span></span><span class="hs-glyph">..</span><span class="annot"><span class="hs-char">'z'</span></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-char">'A'</span></span><span class="hs-glyph">..</span><span class="annot"><span class="hs-char">'Z'</span></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-char">'0'</span></span><span class="hs-glyph">..</span><span class="annot"><span class="hs-char">'9'</span></span><span class="hs-special">]</span><span>
</span><span id="line-271"></span><span>    </span><span id="local-6989586621681467880"><span class="annot"><span class="annottext">letterOrDigitOrHyphen :: Gen Char
</span><a href="#local-6989586621681467880"><span class="hs-identifier hs-var hs-var">letterOrDigitOrHyphen</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Gen Char
forall a. [a] -&gt; Gen a
</span><span class="hs-identifier hs-var">elements</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Gen Char) -&gt; String -&gt; Gen Char
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-char">'a'</span></span><span class="hs-glyph">..</span><span class="annot"><span class="hs-char">'z'</span></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-char">'A'</span></span><span class="hs-glyph">..</span><span class="annot"><span class="hs-char">'Z'</span></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-char">'-'</span></span><span class="hs-special">]</span><span>
</span><span id="line-272"></span><span>
</span><span id="line-273"></span><span class="hs-comment">-- -------------------------------------------------------------------------- --</span><span>
</span><span id="line-274"></span><span class="hs-comment">-- Port Numbers</span><span>
</span><span id="line-275"></span><span>
</span><span id="line-276"></span><span id="local-6989586621681467877"><span id="local-6989586621681467878"></span></span><span class="hs-keyword">newtype</span><span> </span><span id="Port"><span class="annot"><a href="Chainweb.HostAddress.html#Port"><span class="hs-identifier hs-var">Port</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Port"><span class="annot"><a href="Chainweb.HostAddress.html#Port"><span class="hs-identifier hs-var">Port</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word16</span></span><span>
</span><span id="line-277"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681467873"><span id="local-6989586621681467875"><span class="annot"><span class="annottext">Port -&gt; Port -&gt; Bool
(Port -&gt; Port -&gt; Bool) -&gt; (Port -&gt; Port -&gt; Bool) -&gt; Eq Port
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: Port -&gt; Port -&gt; Bool
$c/= :: Port -&gt; Port -&gt; Bool
== :: Port -&gt; Port -&gt; Bool
$c== :: Port -&gt; Port -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681467858"><span id="local-6989586621681467860"><span id="local-6989586621681467862"><span id="local-6989586621681467864"><span id="local-6989586621681467866"><span id="local-6989586621681467868"><span id="local-6989586621681467870"><span class="annot"><span class="annottext">Eq Port
Eq Port =&gt;
(Port -&gt; Port -&gt; Ordering)
-&gt; (Port -&gt; Port -&gt; Bool)
-&gt; (Port -&gt; Port -&gt; Bool)
-&gt; (Port -&gt; Port -&gt; Bool)
-&gt; (Port -&gt; Port -&gt; Bool)
-&gt; (Port -&gt; Port -&gt; Port)
-&gt; (Port -&gt; Port -&gt; Port)
-&gt; Ord Port
Port -&gt; Port -&gt; Bool
Port -&gt; Port -&gt; Ordering
Port -&gt; Port -&gt; Port
forall a.
Eq a =&gt;
(a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
min :: Port -&gt; Port -&gt; Port
$cmin :: Port -&gt; Port -&gt; Port
max :: Port -&gt; Port -&gt; Port
$cmax :: Port -&gt; Port -&gt; Port
&gt;= :: Port -&gt; Port -&gt; Bool
$c&gt;= :: Port -&gt; Port -&gt; Bool
&gt; :: Port -&gt; Port -&gt; Bool
$c&gt; :: Port -&gt; Port -&gt; Bool
&lt;= :: Port -&gt; Port -&gt; Bool
$c&lt;= :: Port -&gt; Port -&gt; Bool
&lt; :: Port -&gt; Port -&gt; Bool
$c&lt; :: Port -&gt; Port -&gt; Bool
compare :: Port -&gt; Port -&gt; Ordering
$ccompare :: Port -&gt; Port -&gt; Ordering
$cp1Ord :: Eq Port
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(forall x. Port -&gt; Rep Port x)
-&gt; (forall x. Rep Port x -&gt; Port) -&gt; Generic Port
forall x. Rep Port x -&gt; Port
forall x. Port -&gt; Rep Port x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
$cto :: forall x. Rep Port x -&gt; Port
$cfrom :: forall x. Port -&gt; Rep Port x
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">Generic</span></span><span class="hs-special">)</span><span>
</span><span id="line-278"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">anyclass</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621681467852"><span id="local-6989586621681467854"><span class="annot"><span class="annottext">Int -&gt; Port -&gt; Int
Port -&gt; Int
(Int -&gt; Port -&gt; Int) -&gt; (Port -&gt; Int) -&gt; Hashable Port
forall a. (Int -&gt; a -&gt; Int) -&gt; (a -&gt; Int) -&gt; Hashable a
hash :: Port -&gt; Int
$chash :: Port -&gt; Int
hashWithSalt :: Int -&gt; Port -&gt; Int
$chashWithSalt :: Int -&gt; Port -&gt; Int
</span><a href="#local-6989586621681467852"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Hashable</span></a></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681467850"><span class="annot"><span class="annottext">Port -&gt; ()
(Port -&gt; ()) -&gt; NFData Port
forall a. (a -&gt; ()) -&gt; NFData a
rnf :: Port -&gt; ()
$crnf :: Port -&gt; ()
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">NFData</span></span></span><span class="hs-special">)</span><span>
</span><span id="line-279"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">newtype</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621681467843"><span id="local-6989586621681467845"><span id="local-6989586621681467847"><span class="annot"><span class="annottext">Int -&gt; Port -&gt; ShowS
[Port] -&gt; ShowS
Port -&gt; String
(Int -&gt; Port -&gt; ShowS)
-&gt; (Port -&gt; String) -&gt; ([Port] -&gt; ShowS) -&gt; Show Port
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [Port] -&gt; ShowS
$cshowList :: [Port] -&gt; ShowS
show :: Port -&gt; String
$cshow :: Port -&gt; String
showsPrec :: Int -&gt; Port -&gt; ShowS
$cshowsPrec :: Int -&gt; Port -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681467839"><span class="annot"><span class="annottext">Num Port
Ord Port
(Num Port, Ord Port) =&gt; (Port -&gt; Rational) -&gt; Real Port
Port -&gt; Rational
forall a. (Num a, Ord a) =&gt; (a -&gt; Rational) -&gt; Real a
toRational :: Port -&gt; Rational
$ctoRational :: Port -&gt; Rational
$cp2Real :: Ord Port
$cp1Real :: Num Port
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Real</span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681467822"><span id="local-6989586621681467824"><span id="local-6989586621681467826"><span id="local-6989586621681467828"><span id="local-6989586621681467830"><span id="local-6989586621681467832"><span id="local-6989586621681467834"><span class="annot"><span class="annottext">Enum Port
Real Port
(Real Port, Enum Port) =&gt;
(Port -&gt; Port -&gt; Port)
-&gt; (Port -&gt; Port -&gt; Port)
-&gt; (Port -&gt; Port -&gt; Port)
-&gt; (Port -&gt; Port -&gt; Port)
-&gt; (Port -&gt; Port -&gt; (Port, Port))
-&gt; (Port -&gt; Port -&gt; (Port, Port))
-&gt; (Port -&gt; Integer)
-&gt; Integral Port
Port -&gt; Integer
Port -&gt; Port -&gt; (Port, Port)
Port -&gt; Port -&gt; Port
forall a.
(Real a, Enum a) =&gt;
(a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; (a, a))
-&gt; (a -&gt; a -&gt; (a, a))
-&gt; (a -&gt; Integer)
-&gt; Integral a
toInteger :: Port -&gt; Integer
$ctoInteger :: Port -&gt; Integer
divMod :: Port -&gt; Port -&gt; (Port, Port)
$cdivMod :: Port -&gt; Port -&gt; (Port, Port)
quotRem :: Port -&gt; Port -&gt; (Port, Port)
$cquotRem :: Port -&gt; Port -&gt; (Port, Port)
mod :: Port -&gt; Port -&gt; Port
$cmod :: Port -&gt; Port -&gt; Port
div :: Port -&gt; Port -&gt; Port
$cdiv :: Port -&gt; Port -&gt; Port
rem :: Port -&gt; Port -&gt; Port
$crem :: Port -&gt; Port -&gt; Port
quot :: Port -&gt; Port -&gt; Port
$cquot :: Port -&gt; Port -&gt; Port
$cp2Integral :: Enum Port
$cp1Integral :: Real Port
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Integral</span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681467807"><span id="local-6989586621681467809"><span id="local-6989586621681467811"><span id="local-6989586621681467813"><span id="local-6989586621681467815"><span id="local-6989586621681467817"><span id="local-6989586621681467819"><span class="annot"><span class="annottext">Integer -&gt; Port
Port -&gt; Port
Port -&gt; Port -&gt; Port
(Port -&gt; Port -&gt; Port)
-&gt; (Port -&gt; Port -&gt; Port)
-&gt; (Port -&gt; Port -&gt; Port)
-&gt; (Port -&gt; Port)
-&gt; (Port -&gt; Port)
-&gt; (Port -&gt; Port)
-&gt; (Integer -&gt; Port)
-&gt; Num Port
forall a.
(a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a)
-&gt; (a -&gt; a)
-&gt; (a -&gt; a)
-&gt; (Integer -&gt; a)
-&gt; Num a
fromInteger :: Integer -&gt; Port
$cfromInteger :: Integer -&gt; Port
signum :: Port -&gt; Port
$csignum :: Port -&gt; Port
abs :: Port -&gt; Port
$cabs :: Port -&gt; Port
negate :: Port -&gt; Port
$cnegate :: Port -&gt; Port
* :: Port -&gt; Port -&gt; Port
$c* :: Port -&gt; Port -&gt; Port
- :: Port -&gt; Port -&gt; Port
$c- :: Port -&gt; Port -&gt; Port
+ :: Port -&gt; Port -&gt; Port
$c+ :: Port -&gt; Port -&gt; Port
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Num</span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681467802"><span id="local-6989586621681467804"><span class="annot"><span class="annottext">Port
Port -&gt; Port -&gt; Bounded Port
forall a. a -&gt; a -&gt; Bounded a
maxBound :: Port
$cmaxBound :: Port
minBound :: Port
$cminBound :: Port
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Bounded</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681467785"><span id="local-6989586621681467787"><span id="local-6989586621681467789"><span id="local-6989586621681467791"><span id="local-6989586621681467793"><span id="local-6989586621681467795"><span id="local-6989586621681467797"><span id="local-6989586621681467799"><span class="annot"><span class="annottext">Int -&gt; Port
Port -&gt; Int
Port -&gt; [Port]
Port -&gt; Port
Port -&gt; Port -&gt; [Port]
Port -&gt; Port -&gt; Port -&gt; [Port]
(Port -&gt; Port)
-&gt; (Port -&gt; Port)
-&gt; (Int -&gt; Port)
-&gt; (Port -&gt; Int)
-&gt; (Port -&gt; [Port])
-&gt; (Port -&gt; Port -&gt; [Port])
-&gt; (Port -&gt; Port -&gt; [Port])
-&gt; (Port -&gt; Port -&gt; Port -&gt; [Port])
-&gt; Enum Port
forall a.
(a -&gt; a)
-&gt; (a -&gt; a)
-&gt; (Int -&gt; a)
-&gt; (a -&gt; Int)
-&gt; (a -&gt; [a])
-&gt; (a -&gt; a -&gt; [a])
-&gt; (a -&gt; a -&gt; [a])
-&gt; (a -&gt; a -&gt; a -&gt; [a])
-&gt; Enum a
enumFromThenTo :: Port -&gt; Port -&gt; Port -&gt; [Port]
$cenumFromThenTo :: Port -&gt; Port -&gt; Port -&gt; [Port]
enumFromTo :: Port -&gt; Port -&gt; [Port]
$cenumFromTo :: Port -&gt; Port -&gt; [Port]
enumFromThen :: Port -&gt; Port -&gt; [Port]
$cenumFromThen :: Port -&gt; Port -&gt; [Port]
enumFrom :: Port -&gt; [Port]
$cenumFrom :: Port -&gt; [Port]
fromEnum :: Port -&gt; Int
$cfromEnum :: Port -&gt; Int
toEnum :: Int -&gt; Port
$ctoEnum :: Int -&gt; Port
pred :: Port -&gt; Port
$cpred :: Port -&gt; Port
succ :: Port -&gt; Port
$csucc :: Port -&gt; Port
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Enum</span></span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681467776"><span id="local-6989586621681467778"><span id="local-6989586621681467780"><span id="local-6989586621681467782"><span class="annot"><span class="annottext">[Port] -&gt; Encoding
[Port] -&gt; Value
Port -&gt; Encoding
Port -&gt; Value
(Port -&gt; Value)
-&gt; (Port -&gt; Encoding)
-&gt; ([Port] -&gt; Value)
-&gt; ([Port] -&gt; Encoding)
-&gt; ToJSON Port
forall a.
(a -&gt; Value)
-&gt; (a -&gt; Encoding)
-&gt; ([a] -&gt; Value)
-&gt; ([a] -&gt; Encoding)
-&gt; ToJSON a
toEncodingList :: [Port] -&gt; Encoding
$ctoEncodingList :: [Port] -&gt; Encoding
toJSONList :: [Port] -&gt; Value
$ctoJSONList :: [Port] -&gt; Value
toEncoding :: Port -&gt; Encoding
$ctoEncoding :: Port -&gt; Encoding
toJSON :: Port -&gt; Value
$ctoJSON :: Port -&gt; Value
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">ToJSON</span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681467771"><span id="local-6989586621681467773"><span class="annot"><span class="annottext">Value -&gt; Parser [Port]
Value -&gt; Parser Port
(Value -&gt; Parser Port) -&gt; (Value -&gt; Parser [Port]) -&gt; FromJSON Port
forall a.
(Value -&gt; Parser a) -&gt; (Value -&gt; Parser [a]) -&gt; FromJSON a
parseJSONList :: Value -&gt; Parser [Port]
$cparseJSONList :: Value -&gt; Parser [Port]
parseJSON :: Value -&gt; Parser Port
$cparseJSON :: Value -&gt; Parser Port
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">FromJSON</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-280"></span><span>
</span><span id="line-281"></span><span id="local-6989586621681468118"><span class="annot"><a href="Chainweb.HostAddress.html#readPortBytes"><span class="hs-identifier hs-type">readPortBytes</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadThrow</span></span><span> </span><span class="annot"><a href="#local-6989586621681468118"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">B8.ByteString</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681468118"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Chainweb.HostAddress.html#Port"><span class="hs-identifier hs-type">Port</span></a></span></span><span>
</span><span id="line-282"></span><span id="readPortBytes"><span class="annot"><span class="annottext">readPortBytes :: ByteString -&gt; m Port
</span><a href="Chainweb.HostAddress.html#readPortBytes"><span class="hs-identifier hs-var hs-var">readPortBytes</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Parser Port -&gt; ByteString -&gt; m Port
forall (m :: * -&gt; *) a.
MonadThrow m =&gt;
Text -&gt; Parser a -&gt; ByteString -&gt; m a
</span><a href="Chainweb.HostAddress.html#parseBytes"><span class="hs-identifier hs-var">parseBytes</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;port&quot;</span></span><span> </span><span class="annot"><span class="annottext">Parser Port
</span><a href="Chainweb.HostAddress.html#portParser"><span class="hs-identifier hs-var">portParser</span></a></span><span>
</span><span id="line-283"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Chainweb.HostAddress.html#readPortBytes"><span class="hs-pragma hs-type">readPortBytes</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-284"></span><span>
</span><span id="line-285"></span><span class="annot"><a href="Chainweb.HostAddress.html#arbitraryPort"><span class="hs-identifier hs-type">arbitraryPort</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Gen</span></span><span> </span><span class="annot"><a href="Chainweb.HostAddress.html#Port"><span class="hs-identifier hs-type">Port</span></a></span><span>
</span><span id="line-286"></span><span id="arbitraryPort"><span class="annot"><span class="annottext">arbitraryPort :: Gen Port
</span><a href="Chainweb.HostAddress.html#arbitraryPort"><span class="hs-identifier hs-var hs-var">arbitraryPort</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word16 -&gt; Port
</span><a href="Chainweb.HostAddress.html#Port"><span class="hs-identifier hs-var">Port</span></a></span><span> </span><span class="annot"><span class="annottext">(Word16 -&gt; Port) -&gt; Gen Word16 -&gt; Gen Port
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Gen Word16
forall a. Arbitrary a =&gt; Gen a
</span><span class="hs-identifier hs-var">arbitrary</span></span><span>
</span><span id="line-287"></span><span>
</span><span id="line-288"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681467767"><span class="annot"><span class="hs-identifier hs-type">Arbitrary</span></span><span> </span><span class="annot"><a href="Chainweb.HostAddress.html#Port"><span class="hs-identifier hs-type">Port</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-289"></span><span>    </span><span id="local-6989586621681467765"><span class="annot"><span class="annottext">arbitrary :: Gen Port
</span><a href="#local-6989586621681467765"><span class="hs-identifier hs-var hs-var hs-var hs-var">arbitrary</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Gen Port
</span><a href="Chainweb.HostAddress.html#arbitraryPort"><span class="hs-identifier hs-var">arbitraryPort</span></a></span><span>
</span><span id="line-290"></span><span>
</span><span id="line-291"></span><span class="annot"><a href="Chainweb.HostAddress.html#portToText"><span class="hs-identifier hs-type">portToText</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Chainweb.HostAddress.html#Port"><span class="hs-identifier hs-type">Port</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span>
</span><span id="line-292"></span><span id="portToText"><span class="annot"><span class="annottext">portToText :: Port -&gt; Text
</span><a href="Chainweb.HostAddress.html#portToText"><span class="hs-identifier hs-var hs-var">portToText</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Port -&gt; Text
forall a b. (Show a, IsString b) =&gt; a -&gt; b
</span><a href="Chainweb.Utils.html#sshow"><span class="hs-identifier hs-var">sshow</span></a></span><span>
</span><span id="line-293"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Chainweb.HostAddress.html#portToText"><span class="hs-pragma hs-type">portToText</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-294"></span><span>
</span><span id="line-295"></span><span id="local-6989586621681467764"><span class="annot"><a href="Chainweb.HostAddress.html#portFromText"><span class="hs-identifier hs-type">portFromText</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadThrow</span></span><span> </span><span class="annot"><a href="#local-6989586621681467764"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681467764"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Chainweb.HostAddress.html#Port"><span class="hs-identifier hs-type">Port</span></a></span></span><span>
</span><span id="line-296"></span><span id="portFromText"><span class="annot"><span class="annottext">portFromText :: Text -&gt; m Port
</span><a href="Chainweb.HostAddress.html#portFromText"><span class="hs-identifier hs-var hs-var">portFromText</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; m Port
forall (m :: * -&gt; *). MonadThrow m =&gt; ByteString -&gt; m Port
</span><a href="Chainweb.HostAddress.html#readPortBytes"><span class="hs-identifier hs-var">readPortBytes</span></a></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; m Port) -&gt; (Text -&gt; ByteString) -&gt; Text -&gt; m Port
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; ByteString
</span><span class="hs-identifier hs-var">T.encodeUtf8</span></span><span>
</span><span id="line-297"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Chainweb.HostAddress.html#portFromText"><span class="hs-pragma hs-type">portFromText</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-298"></span><span>
</span><span id="line-299"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Chainweb.Utils.html#HasTextRepresentation"><span class="hs-identifier hs-type">HasTextRepresentation</span></a></span><span> </span><span class="annot"><a href="Chainweb.HostAddress.html#Port"><span class="hs-identifier hs-type">Port</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-300"></span><span>    </span><span id="local-6989586621681467759"><span class="annot"><span class="annottext">toText :: Port -&gt; Text
</span><a href="Chainweb.Utils.html#toText"><span class="hs-identifier hs-var hs-var hs-var hs-var">toText</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Port -&gt; Text
</span><a href="Chainweb.HostAddress.html#portToText"><span class="hs-identifier hs-var">portToText</span></a></span><span>
</span><span id="line-301"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Chainweb.Utils.html#toText"><span class="hs-pragma hs-type">toText</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-302"></span><span>    </span><span id="local-6989586621681467757"><span class="annot"><span class="annottext">fromText :: Text -&gt; m Port
</span><a href="Chainweb.Utils.html#fromText"><span class="hs-identifier hs-var hs-var hs-var hs-var">fromText</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; m Port
forall (m :: * -&gt; *). MonadThrow m =&gt; Text -&gt; m Port
</span><a href="Chainweb.HostAddress.html#portFromText"><span class="hs-identifier hs-var">portFromText</span></a></span><span>
</span><span id="line-303"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Chainweb.Utils.html#fromText"><span class="hs-pragma hs-type">fromText</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-304"></span><span>
</span><span id="line-305"></span><span class="annot"><a href="Chainweb.HostAddress.html#pPort"><span class="hs-identifier hs-type">pPort</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Chainweb.Utils.html#OptionParser"><span class="hs-identifier hs-type">OptionParser</span></a></span><span> </span><span class="annot"><a href="Chainweb.HostAddress.html#Port"><span class="hs-identifier hs-type">Port</span></a></span><span>
</span><span id="line-306"></span><span id="pPort"><span class="annot"><span class="annottext">pPort :: Maybe String -&gt; OptionParser Port
</span><a href="Chainweb.HostAddress.html#pPort"><span class="hs-identifier hs-var hs-var">pPort</span></a></span></span><span> </span><span id="local-6989586621681467755"><span class="annot"><span class="annottext">service :: Maybe String
</span><a href="#local-6989586621681467755"><span class="hs-identifier hs-var">service</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Mod OptionFields Port -&gt; OptionParser Port
forall a. HasTextRepresentation a =&gt; Mod OptionFields a -&gt; Parser a
</span><a href="Chainweb.Utils.html#textOption"><span class="hs-identifier hs-var">textOption</span></a></span><span>
</span><span id="line-307"></span><span>    </span><span class="annot"><span class="annottext">(Mod OptionFields Port -&gt; OptionParser Port)
-&gt; Mod OptionFields Port -&gt; OptionParser Port
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Maybe String -&gt; String -&gt; Mod OptionFields Port
forall (f :: * -&gt; *) a.
HasName f =&gt;
Maybe String -&gt; String -&gt; Mod f a
</span><a href="Chainweb.Utils.html#prefixLong"><span class="hs-identifier hs-var">prefixLong</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe String
</span><a href="#local-6989586621681467755"><span class="hs-identifier hs-var">service</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;port&quot;</span></span><span>
</span><span id="line-308"></span><span>    </span><span class="annot"><span class="annottext">Mod OptionFields Port
-&gt; Mod OptionFields Port -&gt; Mod OptionFields Port
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Maybe String -&gt; String -&gt; Mod OptionFields Port
forall (f :: * -&gt; *) a. Maybe String -&gt; String -&gt; Mod f a
</span><a href="Chainweb.Utils.html#suffixHelp"><span class="hs-identifier hs-var">suffixHelp</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe String
</span><a href="#local-6989586621681467755"><span class="hs-identifier hs-var">service</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;port number&quot;</span></span><span>
</span><span id="line-309"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Chainweb.HostAddress.html#pPort"><span class="hs-pragma hs-type">pPort</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-310"></span><span>
</span><span id="line-311"></span><span class="hs-comment">-- -------------------------------------------------------------------------- --</span><span>
</span><span id="line-312"></span><span class="hs-comment">-- Hostnames</span><span>
</span><span id="line-313"></span><span>
</span><span id="line-314"></span><span id="local-6989586621681467749"><span id="local-6989586621681467750"></span></span><span class="hs-keyword">data</span><span> </span><span id="Hostname"><span class="annot"><a href="Chainweb.HostAddress.html#Hostname"><span class="hs-identifier hs-var">Hostname</span></a></span></span><span>
</span><span id="line-315"></span><span>    </span><span class="hs-glyph">=</span><span> </span><span id="HostnameName"><span class="annot"><a href="Chainweb.HostAddress.html#HostnameName"><span class="hs-identifier hs-var">HostnameName</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">CI.CI</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">B8.ByteString</span></span><span class="hs-special">)</span><span>
</span><span id="line-316"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="HostnameIPv4"><span class="annot"><a href="Chainweb.HostAddress.html#HostnameIPv4"><span class="hs-identifier hs-var">HostnameIPv4</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">CI.CI</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">B8.ByteString</span></span><span class="hs-special">)</span><span>
</span><span id="line-317"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="HostnameIPv6"><span class="annot"><a href="Chainweb.HostAddress.html#HostnameIPv6"><span class="hs-identifier hs-var">HostnameIPv6</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">CI.CI</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">B8.ByteString</span></span><span class="hs-special">)</span><span>
</span><span id="line-318"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681467745"><span id="local-6989586621681467747"><span class="annot"><span class="annottext">Hostname -&gt; Hostname -&gt; Bool
(Hostname -&gt; Hostname -&gt; Bool)
-&gt; (Hostname -&gt; Hostname -&gt; Bool) -&gt; Eq Hostname
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: Hostname -&gt; Hostname -&gt; Bool
$c/= :: Hostname -&gt; Hostname -&gt; Bool
== :: Hostname -&gt; Hostname -&gt; Bool
$c== :: Hostname -&gt; Hostname -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681467730"><span id="local-6989586621681467732"><span id="local-6989586621681467734"><span id="local-6989586621681467736"><span id="local-6989586621681467738"><span id="local-6989586621681467740"><span id="local-6989586621681467742"><span class="annot"><span class="annottext">Eq Hostname
Eq Hostname =&gt;
(Hostname -&gt; Hostname -&gt; Ordering)
-&gt; (Hostname -&gt; Hostname -&gt; Bool)
-&gt; (Hostname -&gt; Hostname -&gt; Bool)
-&gt; (Hostname -&gt; Hostname -&gt; Bool)
-&gt; (Hostname -&gt; Hostname -&gt; Bool)
-&gt; (Hostname -&gt; Hostname -&gt; Hostname)
-&gt; (Hostname -&gt; Hostname -&gt; Hostname)
-&gt; Ord Hostname
Hostname -&gt; Hostname -&gt; Bool
Hostname -&gt; Hostname -&gt; Ordering
Hostname -&gt; Hostname -&gt; Hostname
forall a.
Eq a =&gt;
(a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
min :: Hostname -&gt; Hostname -&gt; Hostname
$cmin :: Hostname -&gt; Hostname -&gt; Hostname
max :: Hostname -&gt; Hostname -&gt; Hostname
$cmax :: Hostname -&gt; Hostname -&gt; Hostname
&gt;= :: Hostname -&gt; Hostname -&gt; Bool
$c&gt;= :: Hostname -&gt; Hostname -&gt; Bool
&gt; :: Hostname -&gt; Hostname -&gt; Bool
$c&gt; :: Hostname -&gt; Hostname -&gt; Bool
&lt;= :: Hostname -&gt; Hostname -&gt; Bool
$c&lt;= :: Hostname -&gt; Hostname -&gt; Bool
&lt; :: Hostname -&gt; Hostname -&gt; Bool
$c&lt; :: Hostname -&gt; Hostname -&gt; Bool
compare :: Hostname -&gt; Hostname -&gt; Ordering
$ccompare :: Hostname -&gt; Hostname -&gt; Ordering
$cp1Ord :: Eq Hostname
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(forall x. Hostname -&gt; Rep Hostname x)
-&gt; (forall x. Rep Hostname x -&gt; Hostname) -&gt; Generic Hostname
forall x. Rep Hostname x -&gt; Hostname
forall x. Hostname -&gt; Rep Hostname x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
$cto :: forall x. Rep Hostname x -&gt; Hostname
$cfrom :: forall x. Hostname -&gt; Rep Hostname x
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">Generic</span></span><span class="hs-special">)</span><span>
</span><span id="line-319"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">anyclass</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621681467724"><span id="local-6989586621681467726"><span class="annot"><span class="annottext">Int -&gt; Hostname -&gt; Int
Hostname -&gt; Int
(Int -&gt; Hostname -&gt; Int) -&gt; (Hostname -&gt; Int) -&gt; Hashable Hostname
forall a. (Int -&gt; a -&gt; Int) -&gt; (a -&gt; Int) -&gt; Hashable a
hash :: Hostname -&gt; Int
$chash :: Hostname -&gt; Int
hashWithSalt :: Int -&gt; Hostname -&gt; Int
$chashWithSalt :: Int -&gt; Hostname -&gt; Int
</span><a href="#local-6989586621681467724"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Hashable</span></a></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681467722"><span class="annot"><span class="annottext">Hostname -&gt; ()
(Hostname -&gt; ()) -&gt; NFData Hostname
forall a. (a -&gt; ()) -&gt; NFData a
rnf :: Hostname -&gt; ()
$crnf :: Hostname -&gt; ()
</span><a href="#local-6989586621681467722"><span class="hs-identifier hs-var hs-var hs-var hs-var">NFData</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-320"></span><span>
</span><span id="line-321"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681467717"><span id="local-6989586621681467720"><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="Chainweb.HostAddress.html#Hostname"><span class="hs-identifier hs-type">Hostname</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-322"></span><span>    </span><span id="local-6989586621681467716"><span class="annot"><span class="annottext">show :: Hostname -&gt; String
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">show</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; String
</span><span class="hs-identifier hs-var">B8.unpack</span></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; String)
-&gt; (Hostname -&gt; ByteString) -&gt; Hostname -&gt; String
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Hostname -&gt; ByteString
</span><a href="Chainweb.HostAddress.html#hostnameBytes"><span class="hs-identifier hs-var">hostnameBytes</span></a></span><span>
</span><span id="line-323"></span><span>
</span><span id="line-324"></span><span id="local-6989586621681468096"><span class="annot"><a href="Chainweb.HostAddress.html#readHostnameBytes"><span class="hs-identifier hs-type">readHostnameBytes</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadThrow</span></span><span> </span><span class="annot"><a href="#local-6989586621681468096"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">B8.ByteString</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681468096"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Chainweb.HostAddress.html#Hostname"><span class="hs-identifier hs-type">Hostname</span></a></span></span><span>
</span><span id="line-325"></span><span id="readHostnameBytes"><span class="annot"><span class="annottext">readHostnameBytes :: ByteString -&gt; m Hostname
</span><a href="Chainweb.HostAddress.html#readHostnameBytes"><span class="hs-identifier hs-var hs-var">readHostnameBytes</span></a></span></span><span> </span><span id="local-6989586621681467713"><span class="annot"><span class="annottext">b :: ByteString
</span><a href="#local-6989586621681467713"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Parser Hostname -&gt; ByteString -&gt; m Hostname
forall (m :: * -&gt; *) a.
MonadThrow m =&gt;
Text -&gt; Parser a -&gt; ByteString -&gt; m a
</span><a href="Chainweb.HostAddress.html#parseBytes"><span class="hs-identifier hs-var">parseBytes</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;hostname&quot;</span></span><span> </span><span class="annot"><span class="annottext">Parser Hostname
</span><a href="#local-6989586621681467712"><span class="hs-identifier hs-var">parser</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621681467713"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-326"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-327"></span><span>    </span><span id="local-6989586621681467712"><span class="annot"><span class="annottext">parser :: Parser Hostname
</span><a href="#local-6989586621681467712"><span class="hs-identifier hs-var hs-var">parser</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Parser HostType
</span><a href="Chainweb.HostAddress.html#hostParser"><span class="hs-identifier hs-var">hostParser</span></a></span><span> </span><span class="annot"><span class="annottext">Parser HostType -&gt; Parser ByteString () -&gt; Parser HostType
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;*</span></span><span> </span><span class="annot"><span class="annottext">Parser ByteString ()
forall t. Chunk t =&gt; Parser t ()
</span><span class="hs-identifier hs-var">endOfInput</span></span><span> </span><span class="annot"><span class="annottext">Parser HostType -&gt; (HostType -&gt; Parser Hostname) -&gt; Parser Hostname
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-328"></span><span>        </span><span class="annot"><a href="Chainweb.HostAddress.html#HostTypeName"><span class="hs-identifier hs-type">HostTypeName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Hostname -&gt; Parser Hostname
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Hostname -&gt; Parser Hostname) -&gt; Hostname -&gt; Parser Hostname
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$!</span></span><span> </span><span class="annot"><span class="annottext">CI ByteString -&gt; Hostname
</span><a href="Chainweb.HostAddress.html#HostnameName"><span class="hs-identifier hs-var">HostnameName</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; CI ByteString
forall s. FoldCase s =&gt; s -&gt; CI s
</span><span class="hs-identifier hs-var">CI.mk</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621681467713"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-329"></span><span>        </span><span class="annot"><a href="Chainweb.HostAddress.html#HostTypeIPv4"><span class="hs-identifier hs-type">HostTypeIPv4</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Hostname -&gt; Parser Hostname
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Hostname -&gt; Parser Hostname) -&gt; Hostname -&gt; Parser Hostname
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$!</span></span><span> </span><span class="annot"><span class="annottext">CI ByteString -&gt; Hostname
</span><a href="Chainweb.HostAddress.html#HostnameIPv4"><span class="hs-identifier hs-var">HostnameIPv4</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; CI ByteString
forall s. FoldCase s =&gt; s -&gt; CI s
</span><span class="hs-identifier hs-var">CI.mk</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621681467713"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-330"></span><span>        </span><span class="annot"><a href="Chainweb.HostAddress.html#HostTypeIPv6"><span class="hs-identifier hs-type">HostTypeIPv6</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Hostname -&gt; Parser Hostname
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Hostname -&gt; Parser Hostname) -&gt; Hostname -&gt; Parser Hostname
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$!</span></span><span> </span><span class="annot"><span class="annottext">CI ByteString -&gt; Hostname
</span><a href="Chainweb.HostAddress.html#HostnameIPv6"><span class="hs-identifier hs-var">HostnameIPv6</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; CI ByteString
forall s. FoldCase s =&gt; s -&gt; CI s
</span><span class="hs-identifier hs-var">CI.mk</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621681467713"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-331"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Chainweb.HostAddress.html#readHostnameBytes"><span class="hs-pragma hs-type">readHostnameBytes</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-332"></span><span>
</span><span id="line-333"></span><span class="annot"><a href="Chainweb.HostAddress.html#localhost"><span class="hs-identifier hs-type">localhost</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Chainweb.HostAddress.html#Hostname"><span class="hs-identifier hs-type">Hostname</span></a></span><span>
</span><span id="line-334"></span><span id="localhost"><span class="annot"><span class="annottext">localhost :: Hostname
</span><a href="Chainweb.HostAddress.html#localhost"><span class="hs-identifier hs-var hs-var">localhost</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CI ByteString -&gt; Hostname
</span><a href="Chainweb.HostAddress.html#HostnameName"><span class="hs-identifier hs-var">HostnameName</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;localhost&quot;</span></span><span>
</span><span id="line-335"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Chainweb.HostAddress.html#localhost"><span class="hs-pragma hs-type">localhost</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-336"></span><span>
</span><span id="line-337"></span><span class="hs-comment">-- | Using explicit IP addresses and not to &quot;localhost&quot; greatly improves</span><span>
</span><span id="line-338"></span><span class="hs-comment">-- networking performance and Mac OS X.</span><span>
</span><span id="line-339"></span><span class="hs-comment">--</span><span>
</span><span id="line-340"></span><span class="annot"><a href="Chainweb.HostAddress.html#localhostIPv4"><span class="hs-identifier hs-type">localhostIPv4</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Chainweb.HostAddress.html#Hostname"><span class="hs-identifier hs-type">Hostname</span></a></span><span>
</span><span id="line-341"></span><span id="localhostIPv4"><span class="annot"><span class="annottext">localhostIPv4 :: Hostname
</span><a href="Chainweb.HostAddress.html#localhostIPv4"><span class="hs-identifier hs-var hs-var">localhostIPv4</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CI ByteString -&gt; Hostname
</span><a href="Chainweb.HostAddress.html#HostnameIPv4"><span class="hs-identifier hs-var">HostnameIPv4</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;127.0.0.1&quot;</span></span><span>
</span><span id="line-342"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Chainweb.HostAddress.html#localhostIPv4"><span class="hs-pragma hs-type">localhostIPv4</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-343"></span><span>
</span><span id="line-344"></span><span class="hs-comment">-- | Using explicit IP addresses and not to &quot;localhost&quot; greatly improves</span><span>
</span><span id="line-345"></span><span class="hs-comment">-- networking performance and Mac OS X.</span><span>
</span><span id="line-346"></span><span class="hs-comment">--</span><span>
</span><span id="line-347"></span><span class="annot"><a href="Chainweb.HostAddress.html#localhostIPv6"><span class="hs-identifier hs-type">localhostIPv6</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Chainweb.HostAddress.html#Hostname"><span class="hs-identifier hs-type">Hostname</span></a></span><span>
</span><span id="line-348"></span><span id="localhostIPv6"><span class="annot"><span class="annottext">localhostIPv6 :: Hostname
</span><a href="Chainweb.HostAddress.html#localhostIPv6"><span class="hs-identifier hs-var hs-var">localhostIPv6</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CI ByteString -&gt; Hostname
</span><a href="Chainweb.HostAddress.html#HostnameIPv6"><span class="hs-identifier hs-var">HostnameIPv6</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;::1&quot;</span></span><span>
</span><span id="line-349"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Chainweb.HostAddress.html#localhostIPv6"><span class="hs-pragma hs-type">localhostIPv6</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-350"></span><span>
</span><span id="line-351"></span><span class="annot"><a href="Chainweb.HostAddress.html#hostnameBytes"><span class="hs-identifier hs-type">hostnameBytes</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Chainweb.HostAddress.html#Hostname"><span class="hs-identifier hs-type">Hostname</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">B8.ByteString</span></span><span>
</span><span id="line-352"></span><span id="hostnameBytes"><span class="annot"><span class="annottext">hostnameBytes :: Hostname -&gt; ByteString
</span><a href="Chainweb.HostAddress.html#hostnameBytes"><span class="hs-identifier hs-var hs-var">hostnameBytes</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Chainweb.HostAddress.html#HostnameName"><span class="hs-identifier hs-type">HostnameName</span></a></span><span> </span><span id="local-6989586621681467711"><span class="annot"><span class="annottext">b :: CI ByteString
</span><a href="#local-6989586621681467711"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CI ByteString -&gt; ByteString
forall s. CI s -&gt; s
</span><span class="hs-identifier hs-var hs-var">CI.original</span></span><span> </span><span class="annot"><span class="annottext">CI ByteString
</span><a href="#local-6989586621681467711"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-353"></span><span class="annot"><a href="Chainweb.HostAddress.html#hostnameBytes"><span class="hs-identifier hs-var">hostnameBytes</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Chainweb.HostAddress.html#HostnameIPv4"><span class="hs-identifier hs-type">HostnameIPv4</span></a></span><span> </span><span id="local-6989586621681467709"><span class="annot"><span class="annottext">b :: CI ByteString
</span><a href="#local-6989586621681467709"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CI ByteString -&gt; ByteString
forall s. CI s -&gt; s
</span><span class="hs-identifier hs-var hs-var">CI.original</span></span><span> </span><span class="annot"><span class="annottext">CI ByteString
</span><a href="#local-6989586621681467709"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-354"></span><span class="annot"><a href="Chainweb.HostAddress.html#hostnameBytes"><span class="hs-identifier hs-var">hostnameBytes</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Chainweb.HostAddress.html#HostnameIPv6"><span class="hs-identifier hs-type">HostnameIPv6</span></a></span><span> </span><span id="local-6989586621681467708"><span class="annot"><span class="annottext">b :: CI ByteString
</span><a href="#local-6989586621681467708"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CI ByteString -&gt; ByteString
forall s. CI s -&gt; s
</span><span class="hs-identifier hs-var hs-var">CI.original</span></span><span> </span><span class="annot"><span class="annottext">CI ByteString
</span><a href="#local-6989586621681467708"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-355"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Chainweb.HostAddress.html#hostnameBytes"><span class="hs-pragma hs-type">hostnameBytes</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-356"></span><span>
</span><span id="line-357"></span><span class="annot"><a href="Chainweb.HostAddress.html#arbitraryHostname"><span class="hs-identifier hs-type">arbitraryHostname</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Gen</span></span><span> </span><span class="annot"><a href="Chainweb.HostAddress.html#Hostname"><span class="hs-identifier hs-type">Hostname</span></a></span><span>
</span><span id="line-358"></span><span id="arbitraryHostname"><span class="annot"><span class="annottext">arbitraryHostname :: Gen Hostname
</span><a href="Chainweb.HostAddress.html#arbitraryHostname"><span class="hs-identifier hs-var hs-var">arbitraryHostname</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Gen Hostname] -&gt; Gen Hostname
forall a. [Gen a] -&gt; Gen a
</span><span class="hs-identifier hs-var">oneof</span></span><span>
</span><span id="line-359"></span><span>    </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Gen Hostname
</span><a href="Chainweb.HostAddress.html#arbitraryIpV4"><span class="hs-identifier hs-var">arbitraryIpV4</span></a></span><span>
</span><span id="line-360"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Gen Hostname
</span><a href="Chainweb.HostAddress.html#arbitraryIpV4"><span class="hs-identifier hs-var">arbitraryIpV4</span></a></span><span>
</span><span id="line-361"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Gen Hostname
</span><a href="Chainweb.HostAddress.html#arbitraryDomainName"><span class="hs-identifier hs-var">arbitraryDomainName</span></a></span><span>
</span><span id="line-362"></span><span>        </span><span class="hs-comment">--  Note that not every valid domain name is also a valid host name.</span><span>
</span><span id="line-363"></span><span>        </span><span class="hs-comment">--  Generally, a hostname has at least one associated IP address.</span><span>
</span><span id="line-364"></span><span>        </span><span class="hs-comment">--  Also, syntactic restriction apply for certain top-level domains.</span><span>
</span><span id="line-365"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Hostname -&gt; Gen Hostname
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CI ByteString -&gt; Hostname
</span><a href="Chainweb.HostAddress.html#HostnameName"><span class="hs-identifier hs-var">HostnameName</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;localhost&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-366"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Hostname -&gt; Gen Hostname
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Hostname
</span><a href="Chainweb.HostAddress.html#localhost"><span class="hs-identifier hs-var">localhost</span></a></span><span>
</span><span id="line-367"></span><span>    </span><span class="hs-special">]</span><span>
</span><span id="line-368"></span><span>
</span><span id="line-369"></span><span class="annot"><a href="Chainweb.HostAddress.html#hostnameToText"><span class="hs-identifier hs-type">hostnameToText</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Chainweb.HostAddress.html#Hostname"><span class="hs-identifier hs-type">Hostname</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span>
</span><span id="line-370"></span><span id="hostnameToText"><span class="annot"><span class="annottext">hostnameToText :: Hostname -&gt; Text
</span><a href="Chainweb.HostAddress.html#hostnameToText"><span class="hs-identifier hs-var hs-var">hostnameToText</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Text
</span><span class="hs-identifier hs-var">T.decodeUtf8</span></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; Text)
-&gt; (Hostname -&gt; ByteString) -&gt; Hostname -&gt; Text
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Hostname -&gt; ByteString
</span><a href="Chainweb.HostAddress.html#hostnameBytes"><span class="hs-identifier hs-var">hostnameBytes</span></a></span><span>
</span><span id="line-371"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Chainweb.HostAddress.html#hostnameToText"><span class="hs-pragma hs-type">hostnameToText</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-372"></span><span>
</span><span id="line-373"></span><span id="local-6989586621681468093"><span class="annot"><a href="Chainweb.HostAddress.html#hostnameFromText"><span class="hs-identifier hs-type">hostnameFromText</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadThrow</span></span><span> </span><span class="annot"><a href="#local-6989586621681468093"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681468093"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Chainweb.HostAddress.html#Hostname"><span class="hs-identifier hs-type">Hostname</span></a></span></span><span>
</span><span id="line-374"></span><span id="hostnameFromText"><span class="annot"><span class="annottext">hostnameFromText :: Text -&gt; m Hostname
</span><a href="Chainweb.HostAddress.html#hostnameFromText"><span class="hs-identifier hs-var hs-var">hostnameFromText</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; m Hostname
forall (m :: * -&gt; *). MonadThrow m =&gt; ByteString -&gt; m Hostname
</span><a href="Chainweb.HostAddress.html#readHostnameBytes"><span class="hs-identifier hs-var">readHostnameBytes</span></a></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; m Hostname)
-&gt; (Text -&gt; ByteString) -&gt; Text -&gt; m Hostname
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; ByteString
</span><span class="hs-identifier hs-var">T.encodeUtf8</span></span><span>
</span><span id="line-375"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Chainweb.HostAddress.html#hostnameFromText"><span class="hs-pragma hs-type">hostnameFromText</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-376"></span><span>
</span><span id="line-377"></span><span class="annot"><a href="Chainweb.HostAddress.html#unsafeHostnameFromText"><span class="hs-identifier hs-type">unsafeHostnameFromText</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">HasCallStack</span></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Chainweb.HostAddress.html#Hostname"><span class="hs-identifier hs-type">Hostname</span></a></span><span>
</span><span id="line-378"></span><span id="unsafeHostnameFromText"><span class="annot"><span class="annottext">unsafeHostnameFromText :: Text -&gt; Hostname
</span><a href="Chainweb.HostAddress.html#unsafeHostnameFromText"><span class="hs-identifier hs-var hs-var">unsafeHostnameFromText</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Hostname -&gt; Hostname
forall a. HasCallStack =&gt; Maybe a -&gt; a
</span><a href="Chainweb.Utils.html#fromJuste"><span class="hs-identifier hs-var">fromJuste</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe Hostname -&gt; Hostname)
-&gt; (Text -&gt; Maybe Hostname) -&gt; Text -&gt; Hostname
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Maybe Hostname
forall (m :: * -&gt; *). MonadThrow m =&gt; Text -&gt; m Hostname
</span><a href="Chainweb.HostAddress.html#hostnameFromText"><span class="hs-identifier hs-var">hostnameFromText</span></a></span><span>
</span><span id="line-379"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Chainweb.HostAddress.html#unsafeHostnameFromText"><span class="hs-pragma hs-type">unsafeHostnameFromText</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-380"></span><span>
</span><span id="line-381"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681467699"><span id="local-6989586621681467701"><span id="local-6989586621681467703"><span class="annot"><span class="hs-identifier hs-type">ToJSON</span></span><span> </span><span class="annot"><a href="Chainweb.HostAddress.html#Hostname"><span class="hs-identifier hs-type">Hostname</span></a></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-382"></span><span>    </span><span id="local-6989586621681467698"><span class="annot"><span class="annottext">toJSON :: Hostname -&gt; Value
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">toJSON</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Value
forall a. ToJSON a =&gt; a -&gt; Value
</span><span class="hs-identifier hs-var">toJSON</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Value) -&gt; (Hostname -&gt; Text) -&gt; Hostname -&gt; Value
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Hostname -&gt; Text
</span><a href="Chainweb.HostAddress.html#hostnameToText"><span class="hs-identifier hs-var">hostnameToText</span></a></span><span>
</span><span id="line-383"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><span class="hs-pragma hs-type">toJSON</span></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-384"></span><span>
</span><span id="line-385"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681467694"><span class="annot"><span class="hs-identifier hs-type">FromJSON</span></span><span> </span><span class="annot"><a href="Chainweb.HostAddress.html#Hostname"><span class="hs-identifier hs-type">Hostname</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-386"></span><span>    </span><span id="local-6989586621681467693"><span class="annot"><span class="annottext">parseJSON :: Value -&gt; Parser Hostname
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">parseJSON</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Value -&gt; Parser Hostname
forall a. HasTextRepresentation a =&gt; String -&gt; Value -&gt; Parser a
</span><a href="Chainweb.Utils.html#parseJsonFromText"><span class="hs-identifier hs-var">parseJsonFromText</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;Hostname&quot;</span></span><span>
</span><span id="line-387"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><span class="hs-pragma hs-type">parseJSON</span></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-388"></span><span>
</span><span id="line-389"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Chainweb.Utils.html#HasTextRepresentation"><span class="hs-identifier hs-type">HasTextRepresentation</span></a></span><span> </span><span class="annot"><a href="Chainweb.HostAddress.html#Hostname"><span class="hs-identifier hs-type">Hostname</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-390"></span><span>    </span><span id="local-6989586621681467688"><span class="annot"><span class="annottext">toText :: Hostname -&gt; Text
</span><a href="#local-6989586621681467688"><span class="hs-identifier hs-var hs-var hs-var hs-var">toText</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Hostname -&gt; Text
</span><a href="Chainweb.HostAddress.html#hostnameToText"><span class="hs-identifier hs-var">hostnameToText</span></a></span><span>
</span><span id="line-391"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Chainweb.Utils.html#toText"><span class="hs-pragma hs-type">toText</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-392"></span><span>    </span><span id="local-6989586621681467687"><span class="annot"><span class="annottext">fromText :: Text -&gt; m Hostname
</span><a href="#local-6989586621681467687"><span class="hs-identifier hs-var hs-var hs-var hs-var">fromText</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; m Hostname
forall (m :: * -&gt; *). MonadThrow m =&gt; Text -&gt; m Hostname
</span><a href="Chainweb.HostAddress.html#hostnameFromText"><span class="hs-identifier hs-var">hostnameFromText</span></a></span><span>
</span><span id="line-393"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Chainweb.Utils.html#fromText"><span class="hs-pragma hs-type">fromText</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-394"></span><span>
</span><span id="line-395"></span><span class="annot"><a href="Chainweb.HostAddress.html#pHostname"><span class="hs-identifier hs-type">pHostname</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Chainweb.Utils.html#OptionParser"><span class="hs-identifier hs-type">OptionParser</span></a></span><span> </span><span class="annot"><a href="Chainweb.HostAddress.html#Hostname"><span class="hs-identifier hs-type">Hostname</span></a></span><span>
</span><span id="line-396"></span><span id="pHostname"><span class="annot"><span class="annottext">pHostname :: Maybe String -&gt; OptionParser Hostname
</span><a href="Chainweb.HostAddress.html#pHostname"><span class="hs-identifier hs-var hs-var">pHostname</span></a></span></span><span> </span><span id="local-6989586621681467686"><span class="annot"><span class="annottext">service :: Maybe String
</span><a href="#local-6989586621681467686"><span class="hs-identifier hs-var">service</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Mod OptionFields Hostname -&gt; OptionParser Hostname
forall a. HasTextRepresentation a =&gt; Mod OptionFields a -&gt; Parser a
</span><a href="Chainweb.Utils.html#textOption"><span class="hs-identifier hs-var">textOption</span></a></span><span>
</span><span id="line-397"></span><span>    </span><span class="annot"><span class="annottext">(Mod OptionFields Hostname -&gt; OptionParser Hostname)
-&gt; Mod OptionFields Hostname -&gt; OptionParser Hostname
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Maybe String -&gt; String -&gt; Mod OptionFields Hostname
forall (f :: * -&gt; *) a.
HasName f =&gt;
Maybe String -&gt; String -&gt; Mod f a
</span><a href="Chainweb.Utils.html#prefixLong"><span class="hs-identifier hs-var">prefixLong</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe String
</span><a href="#local-6989586621681467686"><span class="hs-identifier hs-var">service</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;hostname&quot;</span></span><span>
</span><span id="line-398"></span><span>    </span><span class="annot"><span class="annottext">Mod OptionFields Hostname
-&gt; Mod OptionFields Hostname -&gt; Mod OptionFields Hostname
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Maybe String -&gt; String -&gt; Mod OptionFields Hostname
forall (f :: * -&gt; *) a. Maybe String -&gt; String -&gt; Mod f a
</span><a href="Chainweb.Utils.html#suffixHelp"><span class="hs-identifier hs-var">suffixHelp</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe String
</span><a href="#local-6989586621681467686"><span class="hs-identifier hs-var">service</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;hostname&quot;</span></span><span>
</span><span id="line-399"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Chainweb.HostAddress.html#pHostname"><span class="hs-pragma hs-type">pHostname</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-400"></span><span>
</span><span id="line-401"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681467683"><span class="annot"><span class="hs-identifier hs-type">Arbitrary</span></span><span> </span><span class="annot"><a href="Chainweb.HostAddress.html#Hostname"><span class="hs-identifier hs-type">Hostname</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-402"></span><span>    </span><span id="local-6989586621681467682"><span class="annot"><span class="annottext">arbitrary :: Gen Hostname
</span><a href="#local-6989586621681467682"><span class="hs-identifier hs-var hs-var hs-var hs-var">arbitrary</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Gen Hostname
</span><a href="Chainweb.HostAddress.html#arbitraryHostname"><span class="hs-identifier hs-var">arbitraryHostname</span></a></span><span>
</span><span id="line-403"></span><span>
</span><span id="line-404"></span><span class="annot"><a href="Chainweb.HostAddress.html#prop_readHostnameBytes"><span class="hs-identifier hs-type">prop_readHostnameBytes</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Chainweb.HostAddress.html#Hostname"><span class="hs-identifier hs-type">Hostname</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Property</span></span><span>
</span><span id="line-405"></span><span id="prop_readHostnameBytes"><span class="annot"><span class="annottext">prop_readHostnameBytes :: Hostname -&gt; Property
</span><a href="Chainweb.HostAddress.html#prop_readHostnameBytes"><span class="hs-identifier hs-var hs-var">prop_readHostnameBytes</span></a></span></span><span> </span><span id="local-6989586621681467680"><span class="annot"><span class="annottext">h :: Hostname
</span><a href="#local-6989586621681467680"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Maybe Hostname
forall (m :: * -&gt; *). MonadThrow m =&gt; ByteString -&gt; m Hostname
</span><a href="Chainweb.HostAddress.html#readHostnameBytes"><span class="hs-identifier hs-var">readHostnameBytes</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Hostname -&gt; ByteString
</span><a href="Chainweb.HostAddress.html#hostnameBytes"><span class="hs-identifier hs-var">hostnameBytes</span></a></span><span> </span><span class="annot"><span class="annottext">Hostname
</span><a href="#local-6989586621681467680"><span class="hs-identifier hs-var">h</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe Hostname -&gt; Maybe Hostname -&gt; Property
forall a. (Eq a, Show a) =&gt; a -&gt; a -&gt; Property
</span><span class="hs-operator hs-var">===</span></span><span> </span><span class="annot"><span class="annottext">Hostname -&gt; Maybe Hostname
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Hostname
</span><a href="#local-6989586621681467680"><span class="hs-identifier hs-var">h</span></a></span><span>
</span><span id="line-406"></span><span>
</span><span id="line-407"></span><span class="hs-comment">-- -------------------------------------------------------------------------- --</span><span>
</span><span id="line-408"></span><span class="hs-comment">-- Host Addresses</span><span>
</span><span id="line-409"></span><span>
</span><span id="line-410"></span><span id="local-6989586621681467677"><span id="local-6989586621681467678"></span></span><span class="hs-keyword">data</span><span> </span><span id="HostAddress"><span class="annot"><a href="Chainweb.HostAddress.html#HostAddress"><span class="hs-identifier hs-var">HostAddress</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="HostAddress"><span class="annot"><a href="Chainweb.HostAddress.html#HostAddress"><span class="hs-identifier hs-var">HostAddress</span></a></span></span><span>
</span><span id="line-411"></span><span>    </span><span class="hs-special">{</span><span> </span><span id="_hostAddressHost"><span class="annot"><span class="annottext">HostAddress -&gt; Hostname
</span><a href="Chainweb.HostAddress.html#_hostAddressHost"><span class="hs-identifier hs-var hs-var">_hostAddressHost</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="Chainweb.HostAddress.html#Hostname"><span class="hs-identifier hs-type">Hostname</span></a></span><span>
</span><span id="line-412"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="_hostAddressPort"><span class="annot"><span class="annottext">HostAddress -&gt; Port
</span><a href="Chainweb.HostAddress.html#_hostAddressPort"><span class="hs-identifier hs-var hs-var">_hostAddressPort</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="Chainweb.HostAddress.html#Port"><span class="hs-identifier hs-type">Port</span></a></span><span>
</span><span id="line-413"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-414"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681467668"><span id="local-6989586621681467670"><span id="local-6989586621681467672"><span class="annot"><span class="annottext">Int -&gt; HostAddress -&gt; ShowS
[HostAddress] -&gt; ShowS
HostAddress -&gt; String
(Int -&gt; HostAddress -&gt; ShowS)
-&gt; (HostAddress -&gt; String)
-&gt; ([HostAddress] -&gt; ShowS)
-&gt; Show HostAddress
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [HostAddress] -&gt; ShowS
$cshowList :: [HostAddress] -&gt; ShowS
show :: HostAddress -&gt; String
$cshow :: HostAddress -&gt; String
showsPrec :: Int -&gt; HostAddress -&gt; ShowS
$cshowsPrec :: Int -&gt; HostAddress -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681467664"><span id="local-6989586621681467666"><span class="annot"><span class="annottext">HostAddress -&gt; HostAddress -&gt; Bool
(HostAddress -&gt; HostAddress -&gt; Bool)
-&gt; (HostAddress -&gt; HostAddress -&gt; Bool) -&gt; Eq HostAddress
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: HostAddress -&gt; HostAddress -&gt; Bool
$c/= :: HostAddress -&gt; HostAddress -&gt; Bool
== :: HostAddress -&gt; HostAddress -&gt; Bool
$c== :: HostAddress -&gt; HostAddress -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681467649"><span id="local-6989586621681467651"><span id="local-6989586621681467653"><span id="local-6989586621681467655"><span id="local-6989586621681467657"><span id="local-6989586621681467659"><span id="local-6989586621681467661"><span class="annot"><span class="annottext">Eq HostAddress
Eq HostAddress =&gt;
(HostAddress -&gt; HostAddress -&gt; Ordering)
-&gt; (HostAddress -&gt; HostAddress -&gt; Bool)
-&gt; (HostAddress -&gt; HostAddress -&gt; Bool)
-&gt; (HostAddress -&gt; HostAddress -&gt; Bool)
-&gt; (HostAddress -&gt; HostAddress -&gt; Bool)
-&gt; (HostAddress -&gt; HostAddress -&gt; HostAddress)
-&gt; (HostAddress -&gt; HostAddress -&gt; HostAddress)
-&gt; Ord HostAddress
HostAddress -&gt; HostAddress -&gt; Bool
HostAddress -&gt; HostAddress -&gt; Ordering
HostAddress -&gt; HostAddress -&gt; HostAddress
forall a.
Eq a =&gt;
(a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
min :: HostAddress -&gt; HostAddress -&gt; HostAddress
$cmin :: HostAddress -&gt; HostAddress -&gt; HostAddress
max :: HostAddress -&gt; HostAddress -&gt; HostAddress
$cmax :: HostAddress -&gt; HostAddress -&gt; HostAddress
&gt;= :: HostAddress -&gt; HostAddress -&gt; Bool
$c&gt;= :: HostAddress -&gt; HostAddress -&gt; Bool
&gt; :: HostAddress -&gt; HostAddress -&gt; Bool
$c&gt; :: HostAddress -&gt; HostAddress -&gt; Bool
&lt;= :: HostAddress -&gt; HostAddress -&gt; Bool
$c&lt;= :: HostAddress -&gt; HostAddress -&gt; Bool
&lt; :: HostAddress -&gt; HostAddress -&gt; Bool
$c&lt; :: HostAddress -&gt; HostAddress -&gt; Bool
compare :: HostAddress -&gt; HostAddress -&gt; Ordering
$ccompare :: HostAddress -&gt; HostAddress -&gt; Ordering
$cp1Ord :: Eq HostAddress
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(forall x. HostAddress -&gt; Rep HostAddress x)
-&gt; (forall x. Rep HostAddress x -&gt; HostAddress)
-&gt; Generic HostAddress
forall x. Rep HostAddress x -&gt; HostAddress
forall x. HostAddress -&gt; Rep HostAddress x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
$cto :: forall x. Rep HostAddress x -&gt; HostAddress
$cfrom :: forall x. HostAddress -&gt; Rep HostAddress x
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">Generic</span></span><span class="hs-special">)</span><span>
</span><span id="line-415"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">anyclass</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621681467643"><span id="local-6989586621681467645"><span class="annot"><span class="annottext">Int -&gt; HostAddress -&gt; Int
HostAddress -&gt; Int
(Int -&gt; HostAddress -&gt; Int)
-&gt; (HostAddress -&gt; Int) -&gt; Hashable HostAddress
forall a. (Int -&gt; a -&gt; Int) -&gt; (a -&gt; Int) -&gt; Hashable a
hash :: HostAddress -&gt; Int
$chash :: HostAddress -&gt; Int
hashWithSalt :: Int -&gt; HostAddress -&gt; Int
$chashWithSalt :: Int -&gt; HostAddress -&gt; Int
</span><a href="#local-6989586621681467643"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Hashable</span></a></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681467641"><span class="annot"><span class="annottext">HostAddress -&gt; ()
(HostAddress -&gt; ()) -&gt; NFData HostAddress
forall a. (a -&gt; ()) -&gt; NFData a
rnf :: HostAddress -&gt; ()
$crnf :: HostAddress -&gt; ()
</span><a href="#local-6989586621681467641"><span class="hs-identifier hs-var hs-var hs-var hs-var">NFData</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-416"></span><span>
</span><span id="line-417"></span><span id="hostAddressHost"><span id="hostAddressPort"><span class="hs-identifier">makeLenses</span><span> </span><span class="hs-special">''</span><span class="hs-identifier">HostAddress</span></span></span><span>
</span><span id="line-418"></span><span>
</span><span id="line-419"></span><span class="annot"><a href="Chainweb.HostAddress.html#hostAddressBytes"><span class="hs-identifier hs-type">hostAddressBytes</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Chainweb.HostAddress.html#HostAddress"><span class="hs-identifier hs-type">HostAddress</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">B8.ByteString</span></span><span>
</span><span id="line-420"></span><span id="hostAddressBytes"><span class="annot"><span class="annottext">hostAddressBytes :: HostAddress -&gt; ByteString
</span><a href="Chainweb.HostAddress.html#hostAddressBytes"><span class="hs-identifier hs-var hs-var">hostAddressBytes</span></a></span></span><span> </span><span id="local-6989586621681467640"><span class="annot"><span class="annottext">a :: HostAddress
</span><a href="#local-6989586621681467640"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621681467639"><span class="hs-identifier hs-var">host</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString -&gt; ByteString
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="hs-string">&quot;:&quot;</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString -&gt; ByteString
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Port -&gt; ByteString
forall a b. (Show a, IsString b) =&gt; a -&gt; b
</span><a href="Chainweb.Utils.html#sshow"><span class="hs-identifier hs-var">sshow</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HostAddress -&gt; Port
</span><a href="Chainweb.HostAddress.html#_hostAddressPort"><span class="hs-identifier hs-var hs-var">_hostAddressPort</span></a></span><span> </span><span class="annot"><span class="annottext">HostAddress
</span><a href="#local-6989586621681467640"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-421"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-422"></span><span>    </span><span id="local-6989586621681467638"><span class="annot"><span class="annottext">ha :: Hostname
</span><a href="#local-6989586621681467638"><span class="hs-identifier hs-var hs-var">ha</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HostAddress -&gt; Hostname
</span><a href="Chainweb.HostAddress.html#_hostAddressHost"><span class="hs-identifier hs-var hs-var">_hostAddressHost</span></a></span><span> </span><span class="annot"><span class="annottext">HostAddress
</span><a href="#local-6989586621681467640"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-423"></span><span>    </span><span id="local-6989586621681467639"><span class="annot"><span class="annottext">host :: ByteString
</span><a href="#local-6989586621681467639"><span class="hs-identifier hs-var hs-var">host</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Hostname
</span><a href="#local-6989586621681467638"><span class="hs-identifier hs-var">ha</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-424"></span><span>        </span><span class="annot"><a href="Chainweb.HostAddress.html#HostnameIPv6"><span class="hs-identifier hs-type">HostnameIPv6</span></a></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-string">&quot;[&quot;</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString -&gt; ByteString
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Hostname -&gt; ByteString
</span><a href="Chainweb.HostAddress.html#hostnameBytes"><span class="hs-identifier hs-var">hostnameBytes</span></a></span><span> </span><span class="annot"><span class="annottext">Hostname
</span><a href="#local-6989586621681467638"><span class="hs-identifier hs-var">ha</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString -&gt; ByteString
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="hs-string">&quot;]&quot;</span></span><span>
</span><span id="line-425"></span><span>        </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Hostname -&gt; ByteString
</span><a href="Chainweb.HostAddress.html#hostnameBytes"><span class="hs-identifier hs-var">hostnameBytes</span></a></span><span> </span><span class="annot"><span class="annottext">Hostname
</span><a href="#local-6989586621681467638"><span class="hs-identifier hs-var">ha</span></a></span><span>
</span><span id="line-426"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Chainweb.HostAddress.html#hostAddressBytes"><span class="hs-pragma hs-type">hostAddressBytes</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-427"></span><span>
</span><span id="line-428"></span><span id="local-6989586621681468079"><span class="annot"><a href="Chainweb.HostAddress.html#readHostAddressBytes"><span class="hs-identifier hs-type">readHostAddressBytes</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadThrow</span></span><span> </span><span class="annot"><a href="#local-6989586621681468079"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">B8.ByteString</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681468079"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Chainweb.HostAddress.html#HostAddress"><span class="hs-identifier hs-type">HostAddress</span></a></span></span><span>
</span><span id="line-429"></span><span id="readHostAddressBytes"><span class="annot"><span class="annottext">readHostAddressBytes :: ByteString -&gt; m HostAddress
</span><a href="Chainweb.HostAddress.html#readHostAddressBytes"><span class="hs-identifier hs-var hs-var">readHostAddressBytes</span></a></span></span><span> </span><span id="local-6989586621681467637"><span class="annot"><span class="annottext">bytes :: ByteString
</span><a href="#local-6989586621681467637"><span class="hs-identifier hs-var">bytes</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Parser HostAddress -&gt; ByteString -&gt; m HostAddress
forall (m :: * -&gt; *) a.
MonadThrow m =&gt;
Text -&gt; Parser a -&gt; ByteString -&gt; m a
</span><a href="Chainweb.HostAddress.html#parseBytes"><span class="hs-identifier hs-var">parseBytes</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;hostaddress&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; Parser HostAddress
</span><a href="Chainweb.HostAddress.html#hostAddressParser"><span class="hs-identifier hs-var">hostAddressParser</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621681467637"><span class="hs-identifier hs-var">bytes</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621681467637"><span class="hs-identifier hs-var">bytes</span></a></span><span>
</span><span id="line-430"></span><span>
</span><span id="line-431"></span><span class="hs-comment">-- | Parser a host address. The input bytestring isn't used for parsing but for</span><span>
</span><span id="line-432"></span><span class="hs-comment">-- the constructing the reslt HostAddress.</span><span>
</span><span id="line-433"></span><span class="hs-comment">--</span><span>
</span><span id="line-434"></span><span class="annot"><a href="Chainweb.HostAddress.html#hostAddressParser"><span class="hs-identifier hs-type">hostAddressParser</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">B8.ByteString</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Parser</span></span><span> </span><span class="annot"><a href="Chainweb.HostAddress.html#HostAddress"><span class="hs-identifier hs-type">HostAddress</span></a></span><span>
</span><span id="line-435"></span><span id="hostAddressParser"><span class="annot"><span class="annottext">hostAddressParser :: ByteString -&gt; Parser HostAddress
</span><a href="Chainweb.HostAddress.html#hostAddressParser"><span class="hs-identifier hs-var hs-var">hostAddressParser</span></a></span></span><span> </span><span id="local-6989586621681467635"><span class="annot"><span class="annottext">b :: ByteString
</span><a href="#local-6989586621681467635"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Hostname -&gt; Port -&gt; HostAddress
</span><a href="Chainweb.HostAddress.html#HostAddress"><span class="hs-identifier hs-var">HostAddress</span></a></span><span>
</span><span id="line-436"></span><span>    </span><span class="annot"><span class="annottext">(Hostname -&gt; Port -&gt; HostAddress)
-&gt; Parser Hostname -&gt; Parser ByteString (Port -&gt; HostAddress)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Parser Hostname
</span><a href="#local-6989586621681467634"><span class="hs-identifier hs-var">hostnameParser'</span></a></span><span>
</span><span id="line-437"></span><span>    </span><span class="annot"><span class="annottext">Parser ByteString (Port -&gt; HostAddress)
-&gt; Parser ByteString ByteString
-&gt; Parser ByteString (Port -&gt; HostAddress)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;*</span></span><span> </span><span class="annot"><span class="hs-string">&quot;:&quot;</span></span><span>
</span><span id="line-438"></span><span>    </span><span class="annot"><span class="annottext">Parser ByteString (Port -&gt; HostAddress)
-&gt; Parser Port -&gt; Parser HostAddress
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Parser Port
</span><a href="Chainweb.HostAddress.html#portParser"><span class="hs-identifier hs-var">portParser</span></a></span><span>
</span><span id="line-439"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-440"></span><span>    </span><span id="local-6989586621681467633"><span class="annot"><span class="annottext">host :: ByteString
</span><a href="#local-6989586621681467633"><span class="hs-identifier hs-var hs-var">host</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString
</span><span class="hs-identifier hs-var">B8.init</span></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; ByteString) -&gt; ByteString -&gt; ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(ByteString, ByteString) -&gt; ByteString
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">((ByteString, ByteString) -&gt; ByteString)
-&gt; (ByteString, ByteString) -&gt; ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; ByteString -&gt; (ByteString, ByteString)
</span><span class="hs-identifier hs-var">B8.breakEnd</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; Char -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="hs-char">':'</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621681467635"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-441"></span><span>    </span><span id="local-6989586621681467634"><span class="annot"><span class="annottext">hostnameParser' :: Parser Hostname
</span><a href="#local-6989586621681467634"><span class="hs-identifier hs-var hs-var">hostnameParser'</span></a></span></span><span>
</span><span id="line-442"></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CI ByteString -&gt; Hostname
</span><a href="Chainweb.HostAddress.html#HostnameName"><span class="hs-identifier hs-var">HostnameName</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; CI ByteString
forall s. FoldCase s =&gt; s -&gt; CI s
</span><span class="hs-identifier hs-var">CI.mk</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621681467633"><span class="hs-identifier hs-var">host</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Hostname -&gt; Parser ByteString () -&gt; Parser Hostname
forall (f :: * -&gt; *) a b. Functor f =&gt; a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;$</span></span><span> </span><span class="annot"><span class="annottext">Parser ByteString ()
</span><a href="Chainweb.HostAddress.html#hostNameParser"><span class="hs-identifier hs-var">hostNameParser</span></a></span><span>
</span><span id="line-443"></span><span>        </span><span class="annot"><span class="annottext">Parser Hostname -&gt; Parser Hostname -&gt; Parser Hostname
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="annot"><span class="annottext">CI ByteString -&gt; Hostname
</span><a href="Chainweb.HostAddress.html#HostnameIPv4"><span class="hs-identifier hs-var">HostnameIPv4</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; CI ByteString
forall s. FoldCase s =&gt; s -&gt; CI s
</span><span class="hs-identifier hs-var">CI.mk</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621681467633"><span class="hs-identifier hs-var">host</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Hostname
-&gt; Parser ByteString (Word8, Word8, Word8, Word8)
-&gt; Parser Hostname
forall (f :: * -&gt; *) a b. Functor f =&gt; a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;$</span></span><span> </span><span class="annot"><span class="annottext">Parser ByteString (Word8, Word8, Word8, Word8)
</span><a href="Chainweb.HostAddress.html#ipV4Parser"><span class="hs-identifier hs-var">ipV4Parser</span></a></span><span>
</span><span id="line-444"></span><span>        </span><span class="annot"><span class="annottext">Parser Hostname -&gt; Parser Hostname -&gt; Parser Hostname
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="annot"><span class="annottext">CI ByteString -&gt; Hostname
</span><a href="Chainweb.HostAddress.html#HostnameIPv6"><span class="hs-identifier hs-var">HostnameIPv6</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; CI ByteString
forall s. FoldCase s =&gt; s -&gt; CI s
</span><span class="hs-identifier hs-var">CI.mk</span></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; CI ByteString) -&gt; ByteString -&gt; CI ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString
</span><span class="hs-identifier hs-var">B8.init</span></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; ByteString) -&gt; ByteString -&gt; ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString
</span><span class="hs-identifier hs-var">B8.tail</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621681467633"><span class="hs-identifier hs-var">host</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Hostname -&gt; Parser ByteString ByteString -&gt; Parser Hostname
forall (f :: * -&gt; *) a b. Functor f =&gt; a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;$</span></span><span> </span><span class="annot"><span class="hs-string">&quot;[&quot;</span></span><span> </span><span class="annot"><span class="annottext">Parser Hostname
-&gt; Parser ByteString [Maybe Word16] -&gt; Parser Hostname
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;*</span></span><span> </span><span class="annot"><span class="annottext">Parser ByteString [Maybe Word16]
</span><a href="Chainweb.HostAddress.html#ipV6Parser"><span class="hs-identifier hs-var">ipV6Parser</span></a></span><span> </span><span class="annot"><span class="annottext">Parser Hostname -&gt; Parser ByteString ByteString -&gt; Parser Hostname
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;*</span></span><span> </span><span class="annot"><span class="hs-string">&quot;]&quot;</span></span><span>
</span><span id="line-445"></span><span>        </span><span class="annot"><span class="annottext">Parser Hostname -&gt; String -&gt; Parser Hostname
forall i a. Parser i a -&gt; String -&gt; Parser i a
</span><span class="hs-operator hs-var">&lt;?&gt;</span></span><span> </span><span class="annot"><span class="hs-string">&quot;host&quot;</span></span><span>
</span><span id="line-446"></span><span>
</span><span id="line-447"></span><span class="annot"><a href="Chainweb.HostAddress.html#hostAddressToText"><span class="hs-identifier hs-type">hostAddressToText</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Chainweb.HostAddress.html#HostAddress"><span class="hs-identifier hs-type">HostAddress</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span>
</span><span id="line-448"></span><span id="hostAddressToText"><span class="annot"><span class="annottext">hostAddressToText :: HostAddress -&gt; Text
</span><a href="Chainweb.HostAddress.html#hostAddressToText"><span class="hs-identifier hs-var hs-var">hostAddressToText</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Text
</span><span class="hs-identifier hs-var">T.decodeUtf8</span></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; Text)
-&gt; (HostAddress -&gt; ByteString) -&gt; HostAddress -&gt; Text
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">HostAddress -&gt; ByteString
</span><a href="Chainweb.HostAddress.html#hostAddressBytes"><span class="hs-identifier hs-var">hostAddressBytes</span></a></span><span>
</span><span id="line-449"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Chainweb.HostAddress.html#hostAddressToText"><span class="hs-pragma hs-type">hostAddressToText</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-450"></span><span>
</span><span id="line-451"></span><span id="local-6989586621681468078"><span class="annot"><a href="Chainweb.HostAddress.html#hostAddressFromText"><span class="hs-identifier hs-type">hostAddressFromText</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadThrow</span></span><span> </span><span class="annot"><a href="#local-6989586621681468078"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681468078"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Chainweb.HostAddress.html#HostAddress"><span class="hs-identifier hs-type">HostAddress</span></a></span></span><span>
</span><span id="line-452"></span><span id="hostAddressFromText"><span class="annot"><span class="annottext">hostAddressFromText :: Text -&gt; m HostAddress
</span><a href="Chainweb.HostAddress.html#hostAddressFromText"><span class="hs-identifier hs-var hs-var">hostAddressFromText</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; m HostAddress
forall (m :: * -&gt; *). MonadThrow m =&gt; ByteString -&gt; m HostAddress
</span><a href="Chainweb.HostAddress.html#readHostAddressBytes"><span class="hs-identifier hs-var">readHostAddressBytes</span></a></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; m HostAddress)
-&gt; (Text -&gt; ByteString) -&gt; Text -&gt; m HostAddress
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; ByteString
</span><span class="hs-identifier hs-var">T.encodeUtf8</span></span><span>
</span><span id="line-453"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Chainweb.HostAddress.html#hostAddressFromText"><span class="hs-pragma hs-type">hostAddressFromText</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-454"></span><span>
</span><span id="line-455"></span><span class="annot"><a href="Chainweb.HostAddress.html#unsafeHostAddressFromText"><span class="hs-identifier hs-type">unsafeHostAddressFromText</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">HasCallStack</span></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Chainweb.HostAddress.html#HostAddress"><span class="hs-identifier hs-type">HostAddress</span></a></span><span>
</span><span id="line-456"></span><span id="unsafeHostAddressFromText"><span class="annot"><span class="annottext">unsafeHostAddressFromText :: Text -&gt; HostAddress
</span><a href="Chainweb.HostAddress.html#unsafeHostAddressFromText"><span class="hs-identifier hs-var hs-var">unsafeHostAddressFromText</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe HostAddress -&gt; HostAddress
forall a. HasCallStack =&gt; Maybe a -&gt; a
</span><a href="Chainweb.Utils.html#fromJuste"><span class="hs-identifier hs-var">fromJuste</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe HostAddress -&gt; HostAddress)
-&gt; (Text -&gt; Maybe HostAddress) -&gt; Text -&gt; HostAddress
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Maybe HostAddress
forall (m :: * -&gt; *). MonadThrow m =&gt; Text -&gt; m HostAddress
</span><a href="Chainweb.HostAddress.html#hostAddressFromText"><span class="hs-identifier hs-var">hostAddressFromText</span></a></span><span>
</span><span id="line-457"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Chainweb.HostAddress.html#unsafeHostAddressFromText"><span class="hs-pragma hs-type">unsafeHostAddressFromText</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-458"></span><span>
</span><span id="line-459"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Chainweb.Utils.html#HasTextRepresentation"><span class="hs-identifier hs-type">HasTextRepresentation</span></a></span><span> </span><span class="annot"><a href="Chainweb.HostAddress.html#HostAddress"><span class="hs-identifier hs-type">HostAddress</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-460"></span><span>    </span><span id="local-6989586621681467627"><span class="annot"><span class="annottext">toText :: HostAddress -&gt; Text
</span><a href="#local-6989586621681467627"><span class="hs-identifier hs-var hs-var hs-var hs-var">toText</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HostAddress -&gt; Text
</span><a href="Chainweb.HostAddress.html#hostAddressToText"><span class="hs-identifier hs-var">hostAddressToText</span></a></span><span>
</span><span id="line-461"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Chainweb.Utils.html#toText"><span class="hs-pragma hs-type">toText</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-462"></span><span>    </span><span id="local-6989586621681467626"><span class="annot"><span class="annottext">fromText :: Text -&gt; m HostAddress
</span><a href="#local-6989586621681467626"><span class="hs-identifier hs-var hs-var hs-var hs-var">fromText</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; m HostAddress
forall (m :: * -&gt; *). MonadThrow m =&gt; Text -&gt; m HostAddress
</span><a href="Chainweb.HostAddress.html#hostAddressFromText"><span class="hs-identifier hs-var">hostAddressFromText</span></a></span><span>
</span><span id="line-463"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Chainweb.Utils.html#fromText"><span class="hs-pragma hs-type">fromText</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-464"></span><span>
</span><span id="line-465"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681467619"><span id="local-6989586621681467621"><span id="local-6989586621681467623"><span class="annot"><span class="hs-identifier hs-type">ToJSON</span></span><span> </span><span class="annot"><a href="Chainweb.HostAddress.html#HostAddress"><span class="hs-identifier hs-type">HostAddress</span></a></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-466"></span><span>    </span><span id="local-6989586621681467618"><span class="annot"><span class="annottext">toJSON :: HostAddress -&gt; Value
</span><a href="#local-6989586621681467618"><span class="hs-identifier hs-var hs-var hs-var hs-var">toJSON</span></a></span></span><span> </span><span id="local-6989586621681467617"><span class="annot"><span class="annottext">o :: HostAddress
</span><a href="#local-6989586621681467617"><span class="hs-identifier hs-var">o</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Pair] -&gt; Value
</span><span class="hs-identifier hs-var">object</span></span><span>
</span><span id="line-467"></span><span>        </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="hs-string">&quot;hostname&quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Hostname -&gt; Pair
forall kv v. (KeyValue kv, ToJSON v) =&gt; Text -&gt; v -&gt; kv
</span><span class="hs-operator hs-var">.=</span></span><span> </span><span class="annot"><span class="annottext">HostAddress -&gt; Hostname
</span><a href="Chainweb.HostAddress.html#_hostAddressHost"><span class="hs-identifier hs-var hs-var">_hostAddressHost</span></a></span><span> </span><span class="annot"><span class="annottext">HostAddress
</span><a href="#local-6989586621681467617"><span class="hs-identifier hs-var">o</span></a></span><span>
</span><span id="line-468"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-string">&quot;port&quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Port -&gt; Pair
forall kv v. (KeyValue kv, ToJSON v) =&gt; Text -&gt; v -&gt; kv
</span><span class="hs-operator hs-var">.=</span></span><span> </span><span class="annot"><span class="annottext">HostAddress -&gt; Port
</span><a href="Chainweb.HostAddress.html#_hostAddressPort"><span class="hs-identifier hs-var hs-var">_hostAddressPort</span></a></span><span> </span><span class="annot"><span class="annottext">HostAddress
</span><a href="#local-6989586621681467617"><span class="hs-identifier hs-var">o</span></a></span><span>
</span><span id="line-469"></span><span>        </span><span class="hs-special">]</span><span>
</span><span id="line-470"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><span class="hs-pragma hs-type">toJSON</span></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-471"></span><span>
</span><span id="line-472"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681467612"><span class="annot"><span class="hs-identifier hs-type">FromJSON</span></span><span> </span><span class="annot"><a href="Chainweb.HostAddress.html#HostAddress"><span class="hs-identifier hs-type">HostAddress</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-473"></span><span>    </span><span id="local-6989586621681467611"><span class="annot"><span class="annottext">parseJSON :: Value -&gt; Parser HostAddress
</span><a href="#local-6989586621681467611"><span class="hs-identifier hs-var hs-var hs-var hs-var">parseJSON</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
-&gt; (Object -&gt; Parser HostAddress) -&gt; Value -&gt; Parser HostAddress
forall a. String -&gt; (Object -&gt; Parser a) -&gt; Value -&gt; Parser a
</span><span class="hs-identifier hs-var">withObject</span></span><span> </span><span class="annot"><span class="hs-string">&quot;HostAddress&quot;</span></span><span> </span><span class="annot"><span class="annottext">((Object -&gt; Parser HostAddress) -&gt; Value -&gt; Parser HostAddress)
-&gt; (Object -&gt; Parser HostAddress) -&gt; Value -&gt; Parser HostAddress
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621681467609"><span class="annot"><span class="annottext">o :: Object
</span><a href="#local-6989586621681467609"><span class="hs-identifier hs-var">o</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Hostname -&gt; Port -&gt; HostAddress
</span><a href="Chainweb.HostAddress.html#HostAddress"><span class="hs-identifier hs-var">HostAddress</span></a></span><span>
</span><span id="line-474"></span><span>        </span><span class="annot"><span class="annottext">(Hostname -&gt; Port -&gt; HostAddress)
-&gt; Parser Hostname -&gt; Parser (Port -&gt; HostAddress)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621681467609"><span class="hs-identifier hs-var">o</span></a></span><span> </span><span class="annot"><span class="annottext">Object -&gt; Text -&gt; Parser Hostname
forall a. FromJSON a =&gt; Object -&gt; Text -&gt; Parser a
</span><span class="hs-operator hs-var">.:</span></span><span> </span><span class="annot"><span class="hs-string">&quot;hostname&quot;</span></span><span>
</span><span id="line-475"></span><span>        </span><span class="annot"><span class="annottext">Parser (Port -&gt; HostAddress) -&gt; Parser Port -&gt; Parser HostAddress
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621681467609"><span class="hs-identifier hs-var">o</span></a></span><span> </span><span class="annot"><span class="annottext">Object -&gt; Text -&gt; Parser Port
forall a. FromJSON a =&gt; Object -&gt; Text -&gt; Parser a
</span><span class="hs-operator hs-var">.:</span></span><span> </span><span class="annot"><span class="hs-string">&quot;port&quot;</span></span><span>
</span><span id="line-476"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><span class="hs-pragma hs-type">parseJSON</span></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-477"></span><span>
</span><span id="line-478"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681467605"><span class="annot"><span class="hs-identifier hs-type">FromJSON</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Chainweb.HostAddress.html#HostAddress"><span class="hs-identifier hs-type">HostAddress</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Chainweb.HostAddress.html#HostAddress"><span class="hs-identifier hs-type">HostAddress</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-479"></span><span>    </span><span id="local-6989586621681467604"><span class="annot"><span class="annottext">parseJSON :: Value -&gt; Parser (HostAddress -&gt; HostAddress)
</span><a href="#local-6989586621681467604"><span class="hs-identifier hs-var hs-var hs-var hs-var">parseJSON</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
-&gt; (Object -&gt; Parser (HostAddress -&gt; HostAddress))
-&gt; Value
-&gt; Parser (HostAddress -&gt; HostAddress)
forall a. String -&gt; (Object -&gt; Parser a) -&gt; Value -&gt; Parser a
</span><span class="hs-identifier hs-var">withObject</span></span><span> </span><span class="annot"><span class="hs-string">&quot;HostAddress&quot;</span></span><span> </span><span class="annot"><span class="annottext">((Object -&gt; Parser (HostAddress -&gt; HostAddress))
 -&gt; Value -&gt; Parser (HostAddress -&gt; HostAddress))
-&gt; (Object -&gt; Parser (HostAddress -&gt; HostAddress))
-&gt; Value
-&gt; Parser (HostAddress -&gt; HostAddress)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621681467603"><span class="annot"><span class="annottext">o :: Object
</span><a href="#local-6989586621681467603"><span class="hs-identifier hs-var">o</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">HostAddress -&gt; HostAddress
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span>
</span><span id="line-480"></span><span>        </span><span class="annot"><span class="annottext">(HostAddress -&gt; HostAddress)
-&gt; Parser (HostAddress -&gt; HostAddress)
-&gt; Parser (HostAddress -&gt; HostAddress)
forall (f :: * -&gt; *) b c a.
Functor f =&gt;
(b -&gt; c) -&gt; f (a -&gt; b) -&gt; f (a -&gt; c)
</span><span class="hs-operator hs-var">&lt;$&lt;</span></span><span> </span><span class="annot"><span class="annottext">Lens' HostAddress Hostname
</span><a href="Chainweb.HostAddress.html#hostAddressHost"><span class="hs-identifier hs-var">hostAddressHost</span></a></span><span> </span><span class="annot"><span class="annottext">Lens' HostAddress Hostname
-&gt; Text -&gt; Object -&gt; Parser (HostAddress -&gt; HostAddress)
forall b a.
FromJSON b =&gt;
Lens' a b -&gt; Text -&gt; Object -&gt; Parser (a -&gt; a)
</span><span class="hs-operator hs-var">..:</span></span><span> </span><span class="annot"><span class="hs-string">&quot;hostname&quot;</span></span><span> </span><span class="annot"><span class="annottext">(Object -&gt; Parser (HostAddress -&gt; HostAddress))
-&gt; Object -&gt; Parser (HostAddress -&gt; HostAddress)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621681467603"><span class="hs-identifier hs-var">o</span></a></span><span>
</span><span id="line-481"></span><span>        </span><span class="annot"><span class="annottext">Parser (HostAddress -&gt; HostAddress)
-&gt; Parser (HostAddress -&gt; HostAddress)
-&gt; Parser (HostAddress -&gt; HostAddress)
forall (f :: * -&gt; *) b c a.
Applicative f =&gt;
f (b -&gt; c) -&gt; f (a -&gt; b) -&gt; f (a -&gt; c)
</span><span class="hs-operator hs-var">&lt;*&lt;</span></span><span> </span><span class="annot"><span class="annottext">Lens' HostAddress Port
</span><a href="Chainweb.HostAddress.html#hostAddressPort"><span class="hs-identifier hs-var">hostAddressPort</span></a></span><span> </span><span class="annot"><span class="annottext">Lens' HostAddress Port
-&gt; Text -&gt; Object -&gt; Parser (HostAddress -&gt; HostAddress)
forall b a.
FromJSON b =&gt;
Lens' a b -&gt; Text -&gt; Object -&gt; Parser (a -&gt; a)
</span><span class="hs-operator hs-var">..:</span></span><span> </span><span class="annot"><span class="hs-string">&quot;port&quot;</span></span><span> </span><span class="annot"><span class="annottext">(Object -&gt; Parser (HostAddress -&gt; HostAddress))
-&gt; Object -&gt; Parser (HostAddress -&gt; HostAddress)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621681467603"><span class="hs-identifier hs-var">o</span></a></span><span>
</span><span id="line-482"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><span class="hs-pragma hs-type">parseJSON</span></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-483"></span><span>
</span><span id="line-484"></span><span class="annot"><a href="Chainweb.HostAddress.html#pHostAddress"><span class="hs-identifier hs-type">pHostAddress</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MParser</span></span><span> </span><span class="annot"><a href="Chainweb.HostAddress.html#HostAddress"><span class="hs-identifier hs-type">HostAddress</span></a></span><span>
</span><span id="line-485"></span><span id="pHostAddress"><span class="annot"><span class="annottext">pHostAddress :: Maybe String -&gt; MParser HostAddress
</span><a href="Chainweb.HostAddress.html#pHostAddress"><span class="hs-identifier hs-var hs-var">pHostAddress</span></a></span></span><span> </span><span id="local-6989586621681467598"><span class="annot"><span class="annottext">service :: Maybe String
</span><a href="#local-6989586621681467598"><span class="hs-identifier hs-var">service</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HostAddress -&gt; HostAddress
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span>
</span><span id="line-486"></span><span>    </span><span class="annot"><span class="annottext">(HostAddress -&gt; HostAddress)
-&gt; MParser HostAddress -&gt; MParser HostAddress
forall (f :: * -&gt; *) b c a.
Functor f =&gt;
(b -&gt; c) -&gt; f (a -&gt; b) -&gt; f (a -&gt; c)
</span><span class="hs-operator hs-var">&lt;$&lt;</span></span><span> </span><span class="annot"><span class="annottext">Lens' HostAddress Hostname
</span><a href="Chainweb.HostAddress.html#hostAddressHost"><span class="hs-identifier hs-var">hostAddressHost</span></a></span><span> </span><span class="annot"><span class="annottext">Lens' HostAddress Hostname
-&gt; OptionParser Hostname -&gt; MParser HostAddress
forall (f :: * -&gt; *) a b.
(Alternative f, Applicative f) =&gt;
Lens' a b -&gt; f b -&gt; f (a -&gt; a)
</span><span class="hs-operator hs-var">.::</span></span><span> </span><span class="annot"><span class="annottext">Maybe String -&gt; OptionParser Hostname
</span><a href="Chainweb.HostAddress.html#pHostname"><span class="hs-identifier hs-var">pHostname</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe String
</span><a href="#local-6989586621681467598"><span class="hs-identifier hs-var">service</span></a></span><span>
</span><span id="line-487"></span><span>    </span><span class="annot"><span class="annottext">MParser HostAddress -&gt; MParser HostAddress -&gt; MParser HostAddress
forall (f :: * -&gt; *) b c a.
Applicative f =&gt;
f (b -&gt; c) -&gt; f (a -&gt; b) -&gt; f (a -&gt; c)
</span><span class="hs-operator hs-var">&lt;*&lt;</span></span><span> </span><span class="annot"><span class="annottext">Lens' HostAddress Port
</span><a href="Chainweb.HostAddress.html#hostAddressPort"><span class="hs-identifier hs-var">hostAddressPort</span></a></span><span> </span><span class="annot"><span class="annottext">Lens' HostAddress Port -&gt; OptionParser Port -&gt; MParser HostAddress
forall (f :: * -&gt; *) a b.
(Alternative f, Applicative f) =&gt;
Lens' a b -&gt; f b -&gt; f (a -&gt; a)
</span><span class="hs-operator hs-var">.::</span></span><span> </span><span class="annot"><span class="annottext">Maybe String -&gt; OptionParser Port
</span><a href="Chainweb.HostAddress.html#pPort"><span class="hs-identifier hs-var">pPort</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe String
</span><a href="#local-6989586621681467598"><span class="hs-identifier hs-var">service</span></a></span><span>
</span><span id="line-488"></span><span>
</span><span id="line-489"></span><span class="annot"><a href="Chainweb.HostAddress.html#pHostAddress%27"><span class="hs-identifier hs-type">pHostAddress'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Chainweb.Utils.html#OptionParser"><span class="hs-identifier hs-type">OptionParser</span></a></span><span> </span><span class="annot"><a href="Chainweb.HostAddress.html#HostAddress"><span class="hs-identifier hs-type">HostAddress</span></a></span><span>
</span><span id="line-490"></span><span id="pHostAddress%27"><span class="annot"><span class="annottext">pHostAddress' :: Maybe String -&gt; OptionParser HostAddress
</span><a href="Chainweb.HostAddress.html#pHostAddress%27"><span class="hs-identifier hs-var hs-var">pHostAddress'</span></a></span></span><span> </span><span id="local-6989586621681467596"><span class="annot"><span class="annottext">service :: Maybe String
</span><a href="#local-6989586621681467596"><span class="hs-identifier hs-var">service</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Hostname -&gt; Port -&gt; HostAddress
</span><a href="Chainweb.HostAddress.html#HostAddress"><span class="hs-identifier hs-var">HostAddress</span></a></span><span> </span><span class="annot"><span class="annottext">(Hostname -&gt; Port -&gt; HostAddress)
-&gt; OptionParser Hostname -&gt; Parser (Port -&gt; HostAddress)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Maybe String -&gt; OptionParser Hostname
</span><a href="Chainweb.HostAddress.html#pHostname"><span class="hs-identifier hs-var">pHostname</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe String
</span><a href="#local-6989586621681467596"><span class="hs-identifier hs-var">service</span></a></span><span> </span><span class="annot"><span class="annottext">Parser (Port -&gt; HostAddress)
-&gt; OptionParser Port -&gt; OptionParser HostAddress
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Maybe String -&gt; OptionParser Port
</span><a href="Chainweb.HostAddress.html#pPort"><span class="hs-identifier hs-var">pPort</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe String
</span><a href="#local-6989586621681467596"><span class="hs-identifier hs-var">service</span></a></span><span>
</span><span id="line-491"></span><span>
</span><span id="line-492"></span><span class="annot"><a href="Chainweb.HostAddress.html#arbitraryHostAddress"><span class="hs-identifier hs-type">arbitraryHostAddress</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Gen</span></span><span> </span><span class="annot"><a href="Chainweb.HostAddress.html#HostAddress"><span class="hs-identifier hs-type">HostAddress</span></a></span><span>
</span><span id="line-493"></span><span id="arbitraryHostAddress"><span class="annot"><span class="annottext">arbitraryHostAddress :: Gen HostAddress
</span><a href="Chainweb.HostAddress.html#arbitraryHostAddress"><span class="hs-identifier hs-var hs-var">arbitraryHostAddress</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Hostname -&gt; Port -&gt; HostAddress
</span><a href="Chainweb.HostAddress.html#HostAddress"><span class="hs-identifier hs-var">HostAddress</span></a></span><span> </span><span class="annot"><span class="annottext">(Hostname -&gt; Port -&gt; HostAddress)
-&gt; Gen Hostname -&gt; Gen (Port -&gt; HostAddress)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Gen Hostname
forall a. Arbitrary a =&gt; Gen a
</span><span class="hs-identifier hs-var">arbitrary</span></span><span> </span><span class="annot"><span class="annottext">Gen (Port -&gt; HostAddress) -&gt; Gen Port -&gt; Gen HostAddress
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Gen Port
forall a. Arbitrary a =&gt; Gen a
</span><span class="hs-identifier hs-var">arbitrary</span></span><span>
</span><span id="line-494"></span><span>
</span><span id="line-495"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681467593"><span class="annot"><span class="hs-identifier hs-type">Arbitrary</span></span><span> </span><span class="annot"><a href="Chainweb.HostAddress.html#HostAddress"><span class="hs-identifier hs-type">HostAddress</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-496"></span><span>    </span><span id="local-6989586621681467592"><span class="annot"><span class="annottext">arbitrary :: Gen HostAddress
</span><a href="#local-6989586621681467592"><span class="hs-identifier hs-var hs-var hs-var hs-var">arbitrary</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Gen HostAddress
</span><a href="Chainweb.HostAddress.html#arbitraryHostAddress"><span class="hs-identifier hs-var">arbitraryHostAddress</span></a></span><span>
</span><span id="line-497"></span><span>
</span><span id="line-498"></span><span class="annot"><a href="Chainweb.HostAddress.html#prop_readHostAddressBytes"><span class="hs-identifier hs-type">prop_readHostAddressBytes</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Chainweb.HostAddress.html#HostAddress"><span class="hs-identifier hs-type">HostAddress</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Property</span></span><span>
</span><span id="line-499"></span><span id="prop_readHostAddressBytes"><span class="annot"><span class="annottext">prop_readHostAddressBytes :: HostAddress -&gt; Property
</span><a href="Chainweb.HostAddress.html#prop_readHostAddressBytes"><span class="hs-identifier hs-var hs-var">prop_readHostAddressBytes</span></a></span></span><span> </span><span id="local-6989586621681467590"><span class="annot"><span class="annottext">a :: HostAddress
</span><a href="#local-6989586621681467590"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Maybe HostAddress
forall (m :: * -&gt; *). MonadThrow m =&gt; ByteString -&gt; m HostAddress
</span><a href="Chainweb.HostAddress.html#readHostAddressBytes"><span class="hs-identifier hs-var">readHostAddressBytes</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HostAddress -&gt; ByteString
</span><a href="Chainweb.HostAddress.html#hostAddressBytes"><span class="hs-identifier hs-var">hostAddressBytes</span></a></span><span> </span><span class="annot"><span class="annottext">HostAddress
</span><a href="#local-6989586621681467590"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe HostAddress -&gt; Maybe HostAddress -&gt; Property
forall a. (Eq a, Show a) =&gt; a -&gt; a -&gt; Property
</span><span class="hs-operator hs-var">===</span></span><span> </span><span class="annot"><span class="annottext">HostAddress -&gt; Maybe HostAddress
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">HostAddress
</span><a href="#local-6989586621681467590"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-500"></span><span>
</span><span id="line-501"></span><span class="annot"><a href="Chainweb.HostAddress.html#hostAddressToBaseUrl"><span class="hs-identifier hs-type">hostAddressToBaseUrl</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Scheme</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Chainweb.HostAddress.html#HostAddress"><span class="hs-identifier hs-type">HostAddress</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">BaseUrl</span></span><span>
</span><span id="line-502"></span><span id="hostAddressToBaseUrl"><span class="annot"><span class="annottext">hostAddressToBaseUrl :: Scheme -&gt; HostAddress -&gt; BaseUrl
</span><a href="Chainweb.HostAddress.html#hostAddressToBaseUrl"><span class="hs-identifier hs-var hs-var">hostAddressToBaseUrl</span></a></span></span><span> </span><span id="local-6989586621681467589"><span class="annot"><span class="annottext">s :: Scheme
</span><a href="#local-6989586621681467589"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Chainweb.HostAddress.html#HostAddress"><span class="hs-identifier hs-type">HostAddress</span></a></span><span> </span><span id="local-6989586621681467588"><span class="annot"><span class="annottext">hn :: Hostname
</span><a href="#local-6989586621681467588"><span class="hs-identifier hs-var">hn</span></a></span></span><span> </span><span id="local-6989586621681467587"><span class="annot"><span class="annottext">p :: Port
</span><a href="#local-6989586621681467587"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Scheme -&gt; String -&gt; Int -&gt; String -&gt; BaseUrl
</span><span class="hs-identifier hs-var">BaseUrl</span></span><span> </span><span class="annot"><span class="annottext">Scheme
</span><a href="#local-6989586621681467589"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621681467585"><span class="hs-identifier hs-var">hn'</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681467584"><span class="hs-identifier hs-var">p'</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-503"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-504"></span><span>    </span><span id="local-6989586621681467585"><span class="annot"><span class="annottext">hn' :: String
</span><a href="#local-6989586621681467585"><span class="hs-identifier hs-var hs-var">hn'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; String
</span><span class="hs-identifier hs-var">T.unpack</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; String) -&gt; Text -&gt; String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Hostname -&gt; Text
</span><a href="Chainweb.HostAddress.html#hostnameToText"><span class="hs-identifier hs-var">hostnameToText</span></a></span><span> </span><span class="annot"><span class="annottext">Hostname
</span><a href="#local-6989586621681467588"><span class="hs-identifier hs-var">hn</span></a></span><span>
</span><span id="line-505"></span><span>    </span><span id="local-6989586621681467584"><span class="annot"><span class="annottext">p' :: Int
</span><a href="#local-6989586621681467584"><span class="hs-identifier hs-var hs-var">p'</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Port -&gt; Int
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Port
</span><a href="#local-6989586621681467587"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-506"></span><span>
</span><span id="line-507"></span><span class="hs-comment">-- -------------------------------------------------------------------------- --</span><span>
</span><span id="line-508"></span><span class="hs-comment">-- Host Preference Utils</span><span>
</span><span id="line-509"></span><span>
</span><span id="line-510"></span><span class="annot"><a href="Chainweb.HostAddress.html#hostPreferenceToText"><span class="hs-identifier hs-type">hostPreferenceToText</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">HostPreference</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span>
</span><span id="line-511"></span><span id="hostPreferenceToText"><span class="annot"><span class="annottext">hostPreferenceToText :: HostPreference -&gt; Text
</span><a href="Chainweb.HostAddress.html#hostPreferenceToText"><span class="hs-identifier hs-var hs-var">hostPreferenceToText</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">HostAny</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-string">&quot;*&quot;</span></span><span>
</span><span id="line-512"></span><span class="annot"><a href="Chainweb.HostAddress.html#hostPreferenceToText"><span class="hs-identifier hs-var">hostPreferenceToText</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">HostIPv4</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-string">&quot;*4&quot;</span></span><span>
</span><span id="line-513"></span><span class="annot"><a href="Chainweb.HostAddress.html#hostPreferenceToText"><span class="hs-identifier hs-var">hostPreferenceToText</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">HostIPv4Only</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-string">&quot;!4&quot;</span></span><span>
</span><span id="line-514"></span><span class="annot"><a href="Chainweb.HostAddress.html#hostPreferenceToText"><span class="hs-identifier hs-var">hostPreferenceToText</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">HostIPv6</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-string">&quot;*6&quot;</span></span><span>
</span><span id="line-515"></span><span class="annot"><a href="Chainweb.HostAddress.html#hostPreferenceToText"><span class="hs-identifier hs-var">hostPreferenceToText</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">HostIPv6Only</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-string">&quot;!6&quot;</span></span><span>
</span><span id="line-516"></span><span class="annot"><a href="Chainweb.HostAddress.html#hostPreferenceToText"><span class="hs-identifier hs-var">hostPreferenceToText</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Host</span></span><span> </span><span id="local-6989586621681467576"><span class="annot"><span class="annottext">s :: String
</span><a href="#local-6989586621681467576"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Text
</span><span class="hs-identifier hs-var">T.pack</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621681467576"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-517"></span><span>
</span><span id="line-518"></span><span id="local-6989586621681467575"><span class="annot"><a href="Chainweb.HostAddress.html#hostPreferenceFromText"><span class="hs-identifier hs-type">hostPreferenceFromText</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadThrow</span></span><span> </span><span class="annot"><a href="#local-6989586621681467575"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681467575"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">HostPreference</span></span></span><span>
</span><span id="line-519"></span><span id="hostPreferenceFromText"><span class="annot"><span class="annottext">hostPreferenceFromText :: Text -&gt; m HostPreference
</span><a href="Chainweb.HostAddress.html#hostPreferenceFromText"><span class="hs-identifier hs-var hs-var">hostPreferenceFromText</span></a></span></span><span> </span><span class="hs-string">&quot;*&quot;</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HostPreference -&gt; m HostPreference
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">HostPreference
</span><span class="hs-identifier hs-var">HostAny</span></span><span>
</span><span id="line-520"></span><span class="annot"><a href="Chainweb.HostAddress.html#hostPreferenceFromText"><span class="hs-identifier hs-var">hostPreferenceFromText</span></a></span><span> </span><span class="hs-string">&quot;*4&quot;</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HostPreference -&gt; m HostPreference
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">HostPreference
</span><span class="hs-identifier hs-var">HostIPv4</span></span><span>
</span><span id="line-521"></span><span class="annot"><a href="Chainweb.HostAddress.html#hostPreferenceFromText"><span class="hs-identifier hs-var">hostPreferenceFromText</span></a></span><span> </span><span class="hs-string">&quot;!4&quot;</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HostPreference -&gt; m HostPreference
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">HostPreference
</span><span class="hs-identifier hs-var">HostIPv4Only</span></span><span>
</span><span id="line-522"></span><span class="annot"><a href="Chainweb.HostAddress.html#hostPreferenceFromText"><span class="hs-identifier hs-var">hostPreferenceFromText</span></a></span><span> </span><span class="hs-string">&quot;*6&quot;</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HostPreference -&gt; m HostPreference
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">HostPreference
</span><span class="hs-identifier hs-var">HostIPv6</span></span><span>
</span><span id="line-523"></span><span class="annot"><a href="Chainweb.HostAddress.html#hostPreferenceFromText"><span class="hs-identifier hs-var">hostPreferenceFromText</span></a></span><span> </span><span class="hs-string">&quot;!6&quot;</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HostPreference -&gt; m HostPreference
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">HostPreference
</span><span class="hs-identifier hs-var">HostIPv6Only</span></span><span>
</span><span id="line-524"></span><span class="annot"><a href="Chainweb.HostAddress.html#hostPreferenceFromText"><span class="hs-identifier hs-var">hostPreferenceFromText</span></a></span><span> </span><span id="local-6989586621681467574"><span class="annot"><span class="annottext">s :: Text
</span><a href="#local-6989586621681467574"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; HostPreference
</span><span class="hs-identifier hs-var">Host</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; HostPreference)
-&gt; (Hostname -&gt; String) -&gt; Hostname -&gt; HostPreference
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; String
</span><span class="hs-identifier hs-var">T.unpack</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; String) -&gt; (Hostname -&gt; Text) -&gt; Hostname -&gt; String
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Hostname -&gt; Text
forall a. HasTextRepresentation a =&gt; a -&gt; Text
</span><a href="Chainweb.Utils.html#toText"><span class="hs-identifier hs-var">toText</span></a></span><span> </span><span class="annot"><span class="annottext">(Hostname -&gt; HostPreference) -&gt; m Hostname -&gt; m HostPreference
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; m Hostname
forall (m :: * -&gt; *). MonadThrow m =&gt; Text -&gt; m Hostname
</span><a href="Chainweb.HostAddress.html#hostnameFromText"><span class="hs-identifier hs-var">hostnameFromText</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621681467574"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-525"></span><span>
</span><span id="line-526"></span><span class="hs-comment">-- Orphan instance</span><span>
</span><span id="line-527"></span><span class="hs-comment">--</span><span>
</span><span id="line-528"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Chainweb.Utils.html#HasTextRepresentation"><span class="hs-identifier hs-type">HasTextRepresentation</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">HostPreference</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-529"></span><span>    </span><span id="local-6989586621681467571"><span class="annot"><span class="annottext">toText :: HostPreference -&gt; Text
</span><a href="#local-6989586621681467571"><span class="hs-identifier hs-var hs-var hs-var hs-var">toText</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HostPreference -&gt; Text
</span><a href="Chainweb.HostAddress.html#hostPreferenceToText"><span class="hs-identifier hs-var">hostPreferenceToText</span></a></span><span>
</span><span id="line-530"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Chainweb.Utils.html#toText"><span class="hs-pragma hs-type">toText</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-531"></span><span>    </span><span id="local-6989586621681467570"><span class="annot"><span class="annottext">fromText :: Text -&gt; m HostPreference
</span><a href="#local-6989586621681467570"><span class="hs-identifier hs-var hs-var hs-var hs-var">fromText</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; m HostPreference
forall (m :: * -&gt; *). MonadThrow m =&gt; Text -&gt; m HostPreference
</span><a href="Chainweb.HostAddress.html#hostPreferenceFromText"><span class="hs-identifier hs-var">hostPreferenceFromText</span></a></span><span>
</span><span id="line-532"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Chainweb.Utils.html#fromText"><span class="hs-pragma hs-type">fromText</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-533"></span><span>
</span><span id="line-534"></span><span class="hs-comment">-- -------------------------------------------------------------------------- --</span><span>
</span><span id="line-535"></span><span class="hs-comment">-- Properties</span><span>
</span><span id="line-536"></span><span>
</span><span id="line-537"></span><span class="annot"><a href="Chainweb.HostAddress.html#properties"><span class="hs-identifier hs-type">properties</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Property</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-538"></span><span id="properties"><span class="annot"><span class="annottext">properties :: [(String, Property)]
</span><a href="Chainweb.HostAddress.html#properties"><span class="hs-identifier hs-var hs-var">properties</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-539"></span><span>    </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-string">&quot;readHostnameBytes&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(Hostname -&gt; Property) -&gt; Property
forall prop. Testable prop =&gt; prop -&gt; Property
</span><span class="hs-identifier hs-var">property</span></span><span> </span><span class="annot"><span class="annottext">Hostname -&gt; Property
</span><a href="Chainweb.HostAddress.html#prop_readHostnameBytes"><span class="hs-identifier hs-var">prop_readHostnameBytes</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-540"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-string">&quot;readHostAddressBytes&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(HostAddress -&gt; Property) -&gt; Property
forall prop. Testable prop =&gt; prop -&gt; Property
</span><span class="hs-identifier hs-var">property</span></span><span> </span><span class="annot"><span class="annottext">HostAddress -&gt; Property
</span><a href="Chainweb.HostAddress.html#prop_readHostAddressBytes"><span class="hs-identifier hs-var">prop_readHostAddressBytes</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-541"></span><span>    </span><span class="hs-special">]</span><span>
</span><span id="line-542"></span></pre></body></html>