<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE AllowAmbiguousTypes #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE DataKinds #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE DefaultSignatures #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE DeriveAnyClass #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# LANGUAGE DeriveGeneric #-}</span><span>
</span><span id="line-6"></span><span class="hs-pragma">{-# LANGUAGE DerivingStrategies #-}</span><span>
</span><span id="line-7"></span><span class="hs-pragma">{-# LANGUAGE ExistentialQuantification #-}</span><span>
</span><span id="line-8"></span><span class="hs-pragma">{-# LANGUAGE GeneralizedNewtypeDeriving #-}</span><span>
</span><span id="line-9"></span><span class="hs-pragma">{-# LANGUAGE KindSignatures #-}</span><span>
</span><span id="line-10"></span><span class="hs-pragma">{-# LANGUAGE RankNTypes #-}</span><span>
</span><span id="line-11"></span><span class="hs-pragma">{-# LANGUAGE ScopedTypeVariables #-}</span><span>
</span><span id="line-12"></span><span class="hs-pragma">{-# LANGUAGE TypeApplications #-}</span><span>
</span><span id="line-13"></span><span>
</span><span id="line-14"></span><span class="hs-comment">-- |</span><span>
</span><span id="line-15"></span><span class="hs-comment">-- Module: Data.LogMessage</span><span>
</span><span id="line-16"></span><span class="hs-comment">-- Copyright: Copyright &#169; 2018 Kadena LLC.</span><span>
</span><span id="line-17"></span><span class="hs-comment">-- License: MIT</span><span>
</span><span id="line-18"></span><span class="hs-comment">-- Maintainer: Lars Kuhtz &lt;lars@kadena.io&gt;</span><span>
</span><span id="line-19"></span><span class="hs-comment">-- Stability: experimental</span><span>
</span><span id="line-20"></span><span class="hs-comment">--</span><span>
</span><span id="line-21"></span><span class="hs-comment">-- This module defines log messages that are similar to Haskell exceptions from</span><span>
</span><span id="line-22"></span><span class="hs-comment">-- 'Control.Exception'. Like exceptions, log messages in this module are typed</span><span>
</span><span id="line-23"></span><span class="hs-comment">-- dynamically and classes of log messages types are extensible.</span><span>
</span><span id="line-24"></span><span class="hs-comment">--</span><span>
</span><span id="line-25"></span><span class="hs-comment">-- Log messages and exceptions are similar in that they can be emitted/thrown</span><span>
</span><span id="line-26"></span><span class="hs-comment">-- anywhere in the code base (in the IO monad, for logs) and are propagated to</span><span>
</span><span id="line-27"></span><span class="hs-comment">-- handlers that are defined upward in the call stack until they are eventually</span><span>
</span><span id="line-28"></span><span class="hs-comment">-- picked up. The difference is that exceptions synchronously interrupt the</span><span>
</span><span id="line-29"></span><span class="hs-comment">-- computation that throws them, while log messages are usually handled</span><span>
</span><span id="line-30"></span><span class="hs-comment">-- asynchronously and the computation that emits them continues while the</span><span>
</span><span id="line-31"></span><span class="hs-comment">-- message is handled.</span><span>
</span><span id="line-32"></span><span class="hs-comment">--</span><span>
</span><span id="line-33"></span><span class="hs-comment">-- Log messages are usually handled only at the top level by a global handler</span><span>
</span><span id="line-34"></span><span class="hs-comment">-- (or stack of handlers), but that depends on the implementation of the logger</span><span>
</span><span id="line-35"></span><span class="hs-comment">-- (usually a queue, but sometimes just an IO callback), which is orthorgonal to</span><span>
</span><span id="line-36"></span><span class="hs-comment">-- the definitions in this module.</span><span>
</span><span id="line-37"></span><span class="hs-comment">--</span><span>
</span><span id="line-38"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Data.LogMessage</span><span>
</span><span id="line-39"></span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Data.LogMessage.html#SomeLogMessage"><span class="hs-identifier">SomeLogMessage</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-40"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.LogMessage.html#LogMessage"><span class="hs-identifier">LogMessage</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-41"></span><span>
</span><span id="line-42"></span><span class="annot"><span class="hs-comment">-- * Log Function</span></span><span>
</span><span id="line-43"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.LogMessage.html#LogFunction"><span class="hs-identifier">LogFunction</span></a></span><span>
</span><span id="line-44"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.LogMessage.html#LogFunctionText"><span class="hs-identifier">LogFunctionText</span></a></span><span>
</span><span id="line-45"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.LogMessage.html#LogFunctionJson"><span class="hs-identifier">LogFunctionJson</span></a></span><span>
</span><span id="line-46"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.LogMessage.html#ALogFunction"><span class="hs-identifier">ALogFunction</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-47"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.LogMessage.html#alogFunction"><span class="hs-identifier">alogFunction</span></a></span><span>
</span><span id="line-48"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.LogMessage.html#aNoLog"><span class="hs-identifier">aNoLog</span></a></span><span>
</span><span id="line-49"></span><span>
</span><span id="line-50"></span><span class="annot"><span class="hs-comment">-- * LogMessage types</span></span><span>
</span><span id="line-51"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.LogMessage.html#JsonLog"><span class="hs-identifier">JsonLog</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-52"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.LogMessage.html#SomeJsonLog"><span class="hs-identifier">SomeJsonLog</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-53"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.LogMessage.html#TextLog"><span class="hs-identifier">TextLog</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-54"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.LogMessage.html#BinaryLog"><span class="hs-identifier">BinaryLog</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-55"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.LogMessage.html#SomeSymbolLog"><span class="hs-identifier">SomeSymbolLog</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-56"></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-57"></span><span>
</span><span id="line-58"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.DeepSeq</span></span><span>
</span><span id="line-59"></span><span>
</span><span id="line-60"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Aeson</span></span><span>
</span><span id="line-61"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.ByteString</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">B</span></span><span>
</span><span id="line-62"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.ByteString.Base64.URL</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">B64</span></span><span>
</span><span id="line-63"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.ByteString.Lazy</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">BL</span></span><span>
</span><span id="line-64"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Proxy</span></span><span>
</span><span id="line-65"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.String</span></span><span>
</span><span id="line-66"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Text</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">T</span></span><span>
</span><span id="line-67"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Text.Encoding</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">T</span></span><span>
</span><span id="line-68"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Typeable</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Typeable</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">cast</span></span><span class="hs-special">)</span><span>
</span><span id="line-69"></span><span>
</span><span id="line-70"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">GHC.Generics</span></span><span>
</span><span id="line-71"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">GHC.TypeLits</span></span><span>
</span><span id="line-72"></span><span>
</span><span id="line-73"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">System.LogLevel</span></span><span>
</span><span id="line-74"></span><span>
</span><span id="line-75"></span><span class="hs-comment">-- -------------------------------------------------------------------------- --</span><span>
</span><span id="line-76"></span><span class="hs-comment">-- SomeLogMessage</span><span>
</span><span id="line-77"></span><span>
</span><span id="line-78"></span><span class="hs-comment">-- | The 'SomeLogMessage' type is the root of the log message type hierarchy.</span><span>
</span><span id="line-79"></span><span class="hs-comment">-- When a log message of type 'a' is emitted, behind the scenes it is</span><span>
</span><span id="line-80"></span><span class="hs-comment">-- encapsulated in a 'SomeLogMessage'.</span><span>
</span><span id="line-81"></span><span class="hs-comment">--</span><span>
</span><span id="line-82"></span><span class="hs-keyword">data</span><span> </span><span id="SomeLogMessage"><span class="annot"><a href="Data.LogMessage.html#SomeLogMessage"><span class="hs-identifier hs-var">SomeLogMessage</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621681473512"><span class="annot"><a href="#local-6989586621681473512"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="Data.LogMessage.html#LogMessage"><span class="hs-identifier hs-type">LogMessage</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681473512"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span id="SomeLogMessage"><span class="annot"><a href="Data.LogMessage.html#SomeLogMessage"><span class="hs-identifier hs-var">SomeLogMessage</span></a></span></span><span> </span><span class="annot"><a href="#local-6989586621681473512"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-83"></span><span>
</span><span id="line-84"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NFData</span></span><span> </span><span class="annot"><a href="Data.LogMessage.html#SomeLogMessage"><span class="hs-identifier hs-type">SomeLogMessage</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-85"></span><span>    </span><span id="local-6989586621681473454"><span class="annot"><span class="annottext">rnf :: SomeLogMessage -&gt; ()
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">rnf</span></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.LogMessage.html#SomeLogMessage"><span class="hs-identifier hs-type">SomeLogMessage</span></a></span><span> </span><span id="local-6989586621681473452"><span class="annot"><span class="annottext">a :: a
</span><a href="#local-6989586621681473452"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; ()
forall a. NFData a =&gt; a -&gt; ()
</span><span class="hs-identifier hs-var">rnf</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681473452"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-86"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><span class="hs-pragma hs-type">rnf</span></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-87"></span><span>
</span><span id="line-88"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681473447"><span id="local-6989586621681473450"><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="Data.LogMessage.html#SomeLogMessage"><span class="hs-identifier hs-type">SomeLogMessage</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-89"></span><span>    </span><span id="local-6989586621681473445"><span class="annot"><span class="annottext">show :: SomeLogMessage -&gt; String
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">show</span></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.LogMessage.html#SomeLogMessage"><span class="hs-identifier hs-type">SomeLogMessage</span></a></span><span> </span><span id="local-6989586621681473443"><span class="annot"><span class="annottext">a :: a
</span><a href="#local-6989586621681473443"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; String
</span><span class="hs-identifier hs-var">T.unpack</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; String) -&gt; Text -&gt; String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; Text
forall a. LogMessage a =&gt; a -&gt; Text
</span><a href="Data.LogMessage.html#logText"><span class="hs-identifier hs-var">logText</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681473443"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-90"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><span class="hs-pragma hs-type">show</span></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-91"></span><span>
</span><span id="line-92"></span><span class="hs-comment">-- -------------------------------------------------------------------------- --</span><span>
</span><span id="line-93"></span><span class="hs-comment">-- LogMessage</span><span>
</span><span id="line-94"></span><span>
</span><span id="line-95"></span><span class="hs-comment">-- | The class of log messages.</span><span>
</span><span id="line-96"></span><span class="hs-comment">--</span><span>
</span><span id="line-97"></span><span class="hs-comment">-- Log messages must be instances of 'NFData' and 'Typeable' and must have a</span><span>
</span><span id="line-98"></span><span class="hs-comment">-- textual representation. The default instance uses the 'Show' instance of a</span><span>
</span><span id="line-99"></span><span class="hs-comment">-- type.</span><span>
</span><span id="line-100"></span><span class="hs-comment">--</span><span>
</span><span id="line-101"></span><span class="hs-keyword">class</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">NFData</span></span><span> </span><span class="annot"><a href="#local-6989586621681473514"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Typeable</span></span><span> </span><span class="annot"><a href="#local-6989586621681473514"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span id="LogMessage"><span class="annot"><a href="Data.LogMessage.html#LogMessage"><span class="hs-identifier hs-var">LogMessage</span></a></span></span><span> </span><span id="local-6989586621681473514"><span class="annot"><a href="#local-6989586621681473514"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-102"></span><span>    </span><span id="logText"><span class="annot"><a href="Data.LogMessage.html#logText"><span class="hs-identifier hs-type">logText</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621681473514"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span>
</span><span id="line-103"></span><span>    </span><span id="toLogMessage"><span class="annot"><a href="Data.LogMessage.html#toLogMessage"><span class="hs-identifier hs-type">toLogMessage</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621681473514"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.LogMessage.html#SomeLogMessage"><span class="hs-identifier hs-type">SomeLogMessage</span></a></span><span>
</span><span id="line-104"></span><span>    </span><span id="fromLogMessage"><span class="annot"><a href="Data.LogMessage.html#fromLogMessage"><span class="hs-identifier hs-type">fromLogMessage</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.LogMessage.html#SomeLogMessage"><span class="hs-identifier hs-type">SomeLogMessage</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621681473514"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-105"></span><span>
</span><span id="line-106"></span><span>    </span><span id="local-6989586621681473438"><span class="annot"><a href="Data.LogMessage.html#toLogMessage"><span class="hs-identifier hs-var hs-var">toLogMessage</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; SomeLogMessage
forall a. LogMessage a =&gt; a -&gt; SomeLogMessage
</span><a href="Data.LogMessage.html#SomeLogMessage"><span class="hs-identifier hs-var">SomeLogMessage</span></a></span></span><span>
</span><span id="line-107"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.LogMessage.html#toLogMessage"><span class="hs-pragma hs-type">toLogMessage</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-108"></span><span>
</span><span id="line-109"></span><span>    </span><span id="local-6989586621681473437"><span class="annot"><a href="Data.LogMessage.html#fromLogMessage"><span class="hs-identifier hs-var hs-var">fromLogMessage</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.LogMessage.html#SomeLogMessage"><span class="hs-identifier hs-type">SomeLogMessage</span></a></span><span> </span><span id="local-6989586621681473436"><span class="annot"><span class="annottext">a :: a
</span><a href="#local-6989586621681473436"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; Maybe a
forall a b. (Typeable a, Typeable b) =&gt; a -&gt; Maybe b
</span><span class="hs-identifier hs-var">cast</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681473436"><span class="hs-identifier hs-var">a</span></a></span></span><span>
</span><span id="line-110"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.LogMessage.html#fromLogMessage"><span class="hs-pragma hs-type">fromLogMessage</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-111"></span><span>
</span><span id="line-112"></span><span>    </span><span class="hs-keyword">default</span><span> </span><span id="logText"><span class="annot"><a href="Data.LogMessage.html#logText"><span class="hs-identifier hs-type">logText</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621681473514"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681473514"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span>
</span><span id="line-113"></span><span>    </span><span id="local-6989586621681473435"><span class="annot"><a href="Data.LogMessage.html#logText"><span class="hs-identifier hs-var hs-var">logText</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Text
</span><span class="hs-identifier hs-var">T.pack</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Text) -&gt; (a -&gt; String) -&gt; a -&gt; Text
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span></span><span>
</span><span id="line-114"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.LogMessage.html#logText"><span class="hs-pragma hs-type">logText</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-115"></span><span>
</span><span id="line-116"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Data.LogMessage.html#LogMessage"><span class="hs-identifier hs-type">LogMessage</span></a></span><span> </span><span class="annot"><a href="Data.LogMessage.html#SomeLogMessage"><span class="hs-identifier hs-type">SomeLogMessage</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-117"></span><span>    </span><span id="local-6989586621681473426"><span class="annot"><span class="annottext">logText :: SomeLogMessage -&gt; Text
</span><a href="#local-6989586621681473426"><span class="hs-identifier hs-var hs-var hs-var hs-var">logText</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.LogMessage.html#SomeLogMessage"><span class="hs-identifier hs-type">SomeLogMessage</span></a></span><span> </span><span id="local-6989586621681473425"><span class="annot"><span class="annottext">a :: a
</span><a href="#local-6989586621681473425"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; Text
forall a. LogMessage a =&gt; a -&gt; Text
</span><a href="Data.LogMessage.html#logText"><span class="hs-identifier hs-var">logText</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681473425"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-118"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.LogMessage.html#logText"><span class="hs-pragma hs-type">logText</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-119"></span><span>
</span><span id="line-120"></span><span>    </span><span id="local-6989586621681473424"><span class="annot"><span class="annottext">toLogMessage :: SomeLogMessage -&gt; SomeLogMessage
</span><a href="#local-6989586621681473424"><span class="hs-identifier hs-var hs-var hs-var hs-var">toLogMessage</span></a></span></span><span> </span><span id="local-6989586621681473423"><span class="annot"><span class="annottext">a :: SomeLogMessage
</span><a href="#local-6989586621681473423"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SomeLogMessage
</span><a href="#local-6989586621681473423"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-121"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.LogMessage.html#toLogMessage"><span class="hs-pragma hs-type">toLogMessage</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-122"></span><span>
</span><span id="line-123"></span><span>    </span><span id="local-6989586621681473422"><span class="annot"><span class="annottext">fromLogMessage :: SomeLogMessage -&gt; Maybe SomeLogMessage
</span><a href="#local-6989586621681473422"><span class="hs-identifier hs-var hs-var hs-var hs-var">fromLogMessage</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SomeLogMessage -&gt; Maybe SomeLogMessage
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span>
</span><span id="line-124"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.LogMessage.html#fromLogMessage"><span class="hs-pragma hs-type">fromLogMessage</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-125"></span><span>
</span><span id="line-126"></span><span class="hs-comment">-- | TODO: is this instance a good idea or should we use a</span><span>
</span><span id="line-127"></span><span class="hs-comment">-- newtype wrapper?</span><span>
</span><span id="line-128"></span><span class="hs-comment">--</span><span>
</span><span id="line-129"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681473415"><span id="local-6989586621681473417"><span class="annot"><a href="Data.LogMessage.html#LogMessage"><span class="hs-identifier hs-type">LogMessage</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-130"></span><span>    </span><span id="local-6989586621681473414"><span class="annot"><span class="annottext">logText :: Text -&gt; Text
</span><a href="#local-6989586621681473414"><span class="hs-identifier hs-var hs-var hs-var hs-var">logText</span></a></span></span><span> </span><span id="local-6989586621681473413"><span class="annot"><span class="annottext">t :: Text
</span><a href="#local-6989586621681473413"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621681473413"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-131"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.LogMessage.html#logText"><span class="hs-pragma hs-type">logText</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-132"></span><span>
</span><span id="line-133"></span><span class="hs-comment">-- -------------------------------------------------------------------------- --</span><span>
</span><span id="line-134"></span><span class="hs-comment">-- LogFunction</span><span>
</span><span id="line-135"></span><span>
</span><span id="line-136"></span><span class="hs-comment">-- | Type of a log functions</span><span>
</span><span id="line-137"></span><span class="hs-comment">--</span><span>
</span><span id="line-138"></span><span class="hs-keyword">type</span><span> </span><span id="LogFunction"><span class="annot"><a href="Data.LogMessage.html#LogFunction"><span class="hs-identifier hs-var">LogFunction</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621681473502"><span class="annot"><a href="#local-6989586621681473502"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="Data.LogMessage.html#LogMessage"><span class="hs-identifier hs-type">LogMessage</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681473502"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">LogLevel</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681473502"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-139"></span><span>
</span><span id="line-140"></span><span class="hs-comment">-- | 'LogFunction' type specialized to 'T.Text'</span><span>
</span><span id="line-141"></span><span class="hs-comment">--</span><span>
</span><span id="line-142"></span><span class="hs-keyword">type</span><span> </span><span id="LogFunctionText"><span class="annot"><a href="Data.LogMessage.html#LogFunctionText"><span class="hs-identifier hs-var">LogFunctionText</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">LogLevel</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-143"></span><span>
</span><span id="line-144"></span><span class="hs-comment">-- | 'LogFunction' type specialized to JSON</span><span>
</span><span id="line-145"></span><span class="hs-comment">--</span><span>
</span><span id="line-146"></span><span class="hs-keyword">type</span><span> </span><span id="LogFunctionJson"><span class="annot"><a href="Data.LogMessage.html#LogFunctionJson"><span class="hs-identifier hs-var">LogFunctionJson</span></a></span></span><span> </span><span id="local-6989586621681473412"><span class="annot"><a href="#local-6989586621681473412"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-147"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Typeable</span></span><span> </span><span class="annot"><a href="#local-6989586621681473412"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NFData</span></span><span> </span><span class="annot"><a href="#local-6989586621681473412"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ToJSON</span></span><span> </span><span class="annot"><a href="#local-6989586621681473412"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">LogLevel</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681473412"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-148"></span><span>
</span><span id="line-149"></span><span class="hs-comment">-- | A newtype wrapper that allows to store a 'LogFunction' without running into</span><span>
</span><span id="line-150"></span><span class="hs-comment">-- impredicative types.</span><span>
</span><span id="line-151"></span><span class="hs-comment">--</span><span>
</span><span id="line-152"></span><span class="hs-keyword">newtype</span><span> </span><span id="ALogFunction"><span class="annot"><a href="Data.LogMessage.html#ALogFunction"><span class="hs-identifier hs-var">ALogFunction</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="ALogFunction"><span class="annot"><a href="Data.LogMessage.html#ALogFunction"><span class="hs-identifier hs-var">ALogFunction</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="_getLogFunction"><span class="annot"><span class="annottext">ALogFunction -&gt; forall a. LogMessage a =&gt; LogLevel -&gt; a -&gt; IO ()
</span><a href="Data.LogMessage.html#_getLogFunction"><span class="hs-identifier hs-var hs-var">_getLogFunction</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.LogMessage.html#LogFunction"><span class="hs-identifier hs-type">LogFunction</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-153"></span><span>
</span><span id="line-154"></span><span class="hs-comment">-- | Get a 'LogFunction' from 'ALogFunction'</span><span>
</span><span id="line-155"></span><span class="hs-comment">--</span><span>
</span><span id="line-156"></span><span class="annot"><a href="Data.LogMessage.html#alogFunction"><span class="hs-identifier hs-type">alogFunction</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621681473409"><span class="annot"><a href="#local-6989586621681473409"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="Data.LogMessage.html#LogMessage"><span class="hs-identifier hs-type">LogMessage</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681473409"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.LogMessage.html#ALogFunction"><span class="hs-identifier hs-type">ALogFunction</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">LogLevel</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681473409"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-157"></span><span id="alogFunction"><span class="annot"><span class="annottext">alogFunction :: ALogFunction -&gt; LogLevel -&gt; a -&gt; IO ()
</span><a href="Data.LogMessage.html#alogFunction"><span class="hs-identifier hs-var hs-var">alogFunction</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.LogMessage.html#ALogFunction"><span class="hs-identifier hs-type">ALogFunction</span></a></span><span> </span><span id="local-6989586621681473408"><span class="annot"><span class="annottext">l :: forall a. LogMessage a =&gt; LogLevel -&gt; a -&gt; IO ()
</span><a href="#local-6989586621681473408"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LogLevel -&gt; a -&gt; IO ()
forall a. LogMessage a =&gt; LogLevel -&gt; a -&gt; IO ()
</span><a href="#local-6989586621681473408"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-158"></span><span>
</span><span id="line-159"></span><span class="hs-comment">-- | 'ALogFunction' that discards all log messages</span><span>
</span><span id="line-160"></span><span class="hs-comment">--</span><span>
</span><span id="line-161"></span><span class="annot"><a href="Data.LogMessage.html#aNoLog"><span class="hs-identifier hs-type">aNoLog</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.LogMessage.html#ALogFunction"><span class="hs-identifier hs-type">ALogFunction</span></a></span><span>
</span><span id="line-162"></span><span id="aNoLog"><span class="annot"><span class="annottext">aNoLog :: ALogFunction
</span><a href="Data.LogMessage.html#aNoLog"><span class="hs-identifier hs-var hs-var">aNoLog</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall a. LogMessage a =&gt; LogLevel -&gt; a -&gt; IO ()) -&gt; ALogFunction
</span><a href="Data.LogMessage.html#ALogFunction"><span class="hs-identifier hs-var">ALogFunction</span></a></span><span> </span><span class="annot"><span class="annottext">((forall a. LogMessage a =&gt; LogLevel -&gt; a -&gt; IO ())
 -&gt; ALogFunction)
-&gt; (forall a. LogMessage a =&gt; LogLevel -&gt; a -&gt; IO ())
-&gt; ALogFunction
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">() -&gt; IO ()
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-163"></span><span>
</span><span id="line-164"></span><span class="hs-comment">-- -------------------------------------------------------------------------- --</span><span>
</span><span id="line-165"></span><span class="hs-comment">-- LogMessage Types</span><span>
</span><span id="line-166"></span><span>
</span><span id="line-167"></span><span class="hs-comment">-- | A newtype wrapper for log messages types with a 'ToJSON' instance.</span><span>
</span><span id="line-168"></span><span class="hs-comment">--</span><span>
</span><span id="line-169"></span><span class="hs-keyword">newtype</span><span> </span><span id="JsonLog"><span class="annot"><a href="Data.LogMessage.html#JsonLog"><span class="hs-identifier hs-var">JsonLog</span></a></span></span><span> </span><span id="local-6989586621681473407"><span class="annot"><a href="#local-6989586621681473407"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="JsonLog"><span class="annot"><a href="Data.LogMessage.html#JsonLog"><span class="hs-identifier hs-var">JsonLog</span></a></span></span><span> </span><span class="annot"><a href="#local-6989586621681473407"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-170"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">newtype</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621681473404"><span class="annot"><span class="annottext">JsonLog a -&gt; ()
(JsonLog a -&gt; ()) -&gt; NFData (JsonLog a)
forall a. NFData a =&gt; JsonLog a -&gt; ()
forall a. (a -&gt; ()) -&gt; NFData a
rnf :: JsonLog a -&gt; ()
$crnf :: forall a. NFData a =&gt; JsonLog a -&gt; ()
</span><a href="#local-6989586621681473404"><span class="hs-identifier hs-var hs-var hs-var hs-var">NFData</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681473396"><span id="local-6989586621681473398"><span id="local-6989586621681473400"><span id="local-6989586621681473402"><span class="annot"><span class="annottext">[JsonLog a] -&gt; Encoding
[JsonLog a] -&gt; Value
JsonLog a -&gt; Encoding
JsonLog a -&gt; Value
(JsonLog a -&gt; Value)
-&gt; (JsonLog a -&gt; Encoding)
-&gt; ([JsonLog a] -&gt; Value)
-&gt; ([JsonLog a] -&gt; Encoding)
-&gt; ToJSON (JsonLog a)
forall a. ToJSON a =&gt; [JsonLog a] -&gt; Encoding
forall a. ToJSON a =&gt; [JsonLog a] -&gt; Value
forall a. ToJSON a =&gt; JsonLog a -&gt; Encoding
forall a. ToJSON a =&gt; JsonLog a -&gt; Value
forall a.
(a -&gt; Value)
-&gt; (a -&gt; Encoding)
-&gt; ([a] -&gt; Value)
-&gt; ([a] -&gt; Encoding)
-&gt; ToJSON a
toEncodingList :: [JsonLog a] -&gt; Encoding
$ctoEncodingList :: forall a. ToJSON a =&gt; [JsonLog a] -&gt; Encoding
toJSONList :: [JsonLog a] -&gt; Value
$ctoJSONList :: forall a. ToJSON a =&gt; [JsonLog a] -&gt; Value
toEncoding :: JsonLog a -&gt; Encoding
$ctoEncoding :: forall a. ToJSON a =&gt; JsonLog a -&gt; Encoding
toJSON :: JsonLog a -&gt; Value
$ctoJSON :: forall a. ToJSON a =&gt; JsonLog a -&gt; Value
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">ToJSON</span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681473391"><span id="local-6989586621681473393"><span class="annot"><span class="annottext">Value -&gt; Parser [JsonLog a]
Value -&gt; Parser (JsonLog a)
(Value -&gt; Parser (JsonLog a))
-&gt; (Value -&gt; Parser [JsonLog a]) -&gt; FromJSON (JsonLog a)
forall a. FromJSON a =&gt; Value -&gt; Parser [JsonLog a]
forall a. FromJSON a =&gt; Value -&gt; Parser (JsonLog a)
forall a.
(Value -&gt; Parser a) -&gt; (Value -&gt; Parser [a]) -&gt; FromJSON a
parseJSONList :: Value -&gt; Parser [JsonLog a]
$cparseJSONList :: forall a. FromJSON a =&gt; Value -&gt; Parser [JsonLog a]
parseJSON :: Value -&gt; Parser (JsonLog a)
$cparseJSON :: forall a. FromJSON a =&gt; Value -&gt; Parser (JsonLog a)
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">FromJSON</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-171"></span><span>
</span><span id="line-172"></span><span id="local-6989586621681473389"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681473382"><span id="local-6989586621681473384"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Typeable</span></span><span> </span><span class="annot"><a href="#local-6989586621681473389"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NFData</span></span><span> </span><span class="annot"><a href="#local-6989586621681473389"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ToJSON</span></span><span> </span><span class="annot"><a href="#local-6989586621681473389"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.LogMessage.html#LogMessage"><span class="hs-identifier hs-type">LogMessage</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.LogMessage.html#JsonLog"><span class="hs-identifier hs-type">JsonLog</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681473389"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-173"></span><span>    </span><span id="local-6989586621681473381"><span class="annot"><span class="annottext">logText :: JsonLog a -&gt; Text
</span><a href="#local-6989586621681473381"><span class="hs-identifier hs-var hs-var hs-var hs-var">logText</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.LogMessage.html#JsonLog"><span class="hs-identifier hs-type">JsonLog</span></a></span><span> </span><span id="local-6989586621681473380"><span class="annot"><span class="annottext">a :: a
</span><a href="#local-6989586621681473380"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Text
</span><span class="hs-identifier hs-var">T.decodeUtf8</span></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; Text)
-&gt; (ByteString -&gt; ByteString) -&gt; ByteString -&gt; Text
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString
</span><span class="hs-identifier hs-var">BL.toStrict</span></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; Text) -&gt; ByteString -&gt; Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; ByteString
forall a. ToJSON a =&gt; a -&gt; ByteString
</span><span class="hs-identifier hs-var">encode</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681473380"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-174"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.LogMessage.html#logText"><span class="hs-pragma hs-type">logText</span></a></span><span> </span><span class="hs-pragma">#-}</span></span><span>
</span><span id="line-175"></span><span>
</span><span id="line-176"></span><span class="hs-comment">-- | A dynamically polymorphic wrapper for any log message type that has a</span><span>
</span><span id="line-177"></span><span class="hs-comment">-- 'ToJSON' instance.</span><span>
</span><span id="line-178"></span><span class="hs-comment">--</span><span>
</span><span id="line-179"></span><span class="hs-keyword">data</span><span> </span><span id="SomeJsonLog"><span class="annot"><a href="Data.LogMessage.html#SomeJsonLog"><span class="hs-identifier hs-var">SomeJsonLog</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621681473376"><span class="annot"><a href="#local-6989586621681473376"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">NFData</span></span><span> </span><span class="annot"><a href="#local-6989586621681473376"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ToJSON</span></span><span> </span><span class="annot"><a href="#local-6989586621681473376"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span id="SomeJsonLog"><span class="annot"><a href="Data.LogMessage.html#SomeJsonLog"><span class="hs-identifier hs-var">SomeJsonLog</span></a></span></span><span> </span><span class="annot"><a href="#local-6989586621681473376"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-180"></span><span>
</span><span id="line-181"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NFData</span></span><span> </span><span class="annot"><a href="Data.LogMessage.html#SomeJsonLog"><span class="hs-identifier hs-type">SomeJsonLog</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-182"></span><span>    </span><span id="local-6989586621681473373"><span class="annot"><span class="annottext">rnf :: SomeJsonLog -&gt; ()
</span><a href="#local-6989586621681473373"><span class="hs-identifier hs-var hs-var hs-var hs-var">rnf</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.LogMessage.html#SomeJsonLog"><span class="hs-identifier hs-type">SomeJsonLog</span></a></span><span> </span><span id="local-6989586621681473372"><span class="annot"><span class="annottext">a :: a
</span><a href="#local-6989586621681473372"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; ()
forall a. NFData a =&gt; a -&gt; ()
</span><span class="hs-identifier hs-var">rnf</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681473372"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-183"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><span class="hs-pragma hs-type">rnf</span></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-184"></span><span>
</span><span id="line-185"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681473365"><span id="local-6989586621681473367"><span class="annot"><a href="Data.LogMessage.html#LogMessage"><span class="hs-identifier hs-type">LogMessage</span></a></span><span> </span><span class="annot"><a href="Data.LogMessage.html#SomeJsonLog"><span class="hs-identifier hs-type">SomeJsonLog</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-186"></span><span>    </span><span id="local-6989586621681473364"><span class="annot"><span class="annottext">logText :: SomeJsonLog -&gt; Text
</span><a href="#local-6989586621681473364"><span class="hs-identifier hs-var hs-var hs-var hs-var">logText</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.LogMessage.html#SomeJsonLog"><span class="hs-identifier hs-type">SomeJsonLog</span></a></span><span> </span><span id="local-6989586621681473363"><span class="annot"><span class="annottext">a :: a
</span><a href="#local-6989586621681473363"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Text
</span><span class="hs-identifier hs-var">T.decodeUtf8</span></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; Text)
-&gt; (ByteString -&gt; ByteString) -&gt; ByteString -&gt; Text
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString
</span><span class="hs-identifier hs-var">BL.toStrict</span></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; Text) -&gt; ByteString -&gt; Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; ByteString
forall a. ToJSON a =&gt; a -&gt; ByteString
</span><span class="hs-identifier hs-var">encode</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681473363"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-187"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.LogMessage.html#logText"><span class="hs-pragma hs-type">logText</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-188"></span><span>
</span><span id="line-189"></span><span class="hs-comment">-- | A newtype wrapper for textual log messages.</span><span>
</span><span id="line-190"></span><span class="hs-comment">--</span><span>
</span><span id="line-191"></span><span class="hs-keyword">newtype</span><span> </span><span id="TextLog"><span class="annot"><a href="Data.LogMessage.html#TextLog"><span class="hs-identifier hs-var">TextLog</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="TextLog"><span class="annot"><a href="Data.LogMessage.html#TextLog"><span class="hs-identifier hs-var">TextLog</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span>
</span><span id="line-192"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">newtype</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621681473360"><span class="annot"><span class="annottext">TextLog -&gt; ()
(TextLog -&gt; ()) -&gt; NFData TextLog
forall a. (a -&gt; ()) -&gt; NFData a
rnf :: TextLog -&gt; ()
$crnf :: TextLog -&gt; ()
</span><a href="#local-6989586621681473360"><span class="hs-identifier hs-var hs-var hs-var hs-var">NFData</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681473352"><span id="local-6989586621681473354"><span id="local-6989586621681473356"><span class="annot"><span class="annottext">Typeable TextLog
NFData TextLog
(NFData TextLog, Typeable TextLog) =&gt;
(TextLog -&gt; Text)
-&gt; (TextLog -&gt; SomeLogMessage)
-&gt; (SomeLogMessage -&gt; Maybe TextLog)
-&gt; LogMessage TextLog
TextLog -&gt; Text
TextLog -&gt; SomeLogMessage
SomeLogMessage -&gt; Maybe TextLog
forall a.
(NFData a, Typeable a) =&gt;
(a -&gt; Text)
-&gt; (a -&gt; SomeLogMessage)
-&gt; (SomeLogMessage -&gt; Maybe a)
-&gt; LogMessage a
fromLogMessage :: SomeLogMessage -&gt; Maybe TextLog
$cfromLogMessage :: SomeLogMessage -&gt; Maybe TextLog
toLogMessage :: TextLog -&gt; SomeLogMessage
$ctoLogMessage :: TextLog -&gt; SomeLogMessage
logText :: TextLog -&gt; Text
$clogText :: TextLog -&gt; Text
$cp2LogMessage :: Typeable TextLog
$cp1LogMessage :: NFData TextLog
</span><a href="#local-6989586621681473352"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">LogMessage</span></a></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681473350"><span class="annot"><span class="annottext">String -&gt; TextLog
(String -&gt; TextLog) -&gt; IsString TextLog
forall a. (String -&gt; a) -&gt; IsString a
fromString :: String -&gt; TextLog
$cfromString :: String -&gt; TextLog
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">IsString</span></span></span><span class="hs-special">)</span><span>
</span><span id="line-193"></span><span>
</span><span id="line-194"></span><span class="hs-comment">-- | Binary log messages.</span><span>
</span><span id="line-195"></span><span class="hs-comment">--</span><span>
</span><span id="line-196"></span><span id="local-6989586621681473347"><span id="local-6989586621681473348"></span></span><span class="hs-keyword">data</span><span> </span><span id="BinaryLog"><span class="annot"><a href="Data.LogMessage.html#BinaryLog"><span class="hs-identifier hs-var">BinaryLog</span></a></span></span><span>
</span><span id="line-197"></span><span>    </span><span class="hs-glyph">=</span><span> </span><span id="BinaryLog"><span class="annot"><a href="Data.LogMessage.html#BinaryLog"><span class="hs-identifier hs-var">BinaryLog</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">B.ByteString</span></span><span>
</span><span id="line-198"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="BinaryLogLazy"><span class="annot"><a href="Data.LogMessage.html#BinaryLogLazy"><span class="hs-identifier hs-var">BinaryLogLazy</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">BL.ByteString</span></span><span>
</span><span id="line-199"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(forall x. BinaryLog -&gt; Rep BinaryLog x)
-&gt; (forall x. Rep BinaryLog x -&gt; BinaryLog) -&gt; Generic BinaryLog
forall x. Rep BinaryLog x -&gt; BinaryLog
forall x. BinaryLog -&gt; Rep BinaryLog x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
$cto :: forall x. Rep BinaryLog x -&gt; BinaryLog
$cfrom :: forall x. BinaryLog -&gt; Rep BinaryLog x
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">Generic</span></span><span class="hs-special">)</span><span>
</span><span id="line-200"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">anyclass</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621681473340"><span class="annot"><span class="annottext">BinaryLog -&gt; ()
(BinaryLog -&gt; ()) -&gt; NFData BinaryLog
forall a. (a -&gt; ()) -&gt; NFData a
rnf :: BinaryLog -&gt; ()
$crnf :: BinaryLog -&gt; ()
</span><a href="#local-6989586621681473340"><span class="hs-identifier hs-var hs-var hs-var hs-var">NFData</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-201"></span><span>
</span><span id="line-202"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681473333"><span id="local-6989586621681473335"><span class="annot"><a href="Data.LogMessage.html#LogMessage"><span class="hs-identifier hs-type">LogMessage</span></a></span><span> </span><span class="annot"><a href="Data.LogMessage.html#BinaryLog"><span class="hs-identifier hs-type">BinaryLog</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-203"></span><span>    </span><span id="local-6989586621681473332"><span class="annot"><span class="annottext">logText :: BinaryLog -&gt; Text
</span><a href="#local-6989586621681473332"><span class="hs-identifier hs-var hs-var hs-var hs-var">logText</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.LogMessage.html#BinaryLog"><span class="hs-identifier hs-type">BinaryLog</span></a></span><span> </span><span id="local-6989586621681473331"><span class="annot"><span class="annottext">a :: ByteString
</span><a href="#local-6989586621681473331"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Text
</span><span class="hs-identifier hs-var">T.decodeUtf8</span></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; Text) -&gt; ByteString -&gt; Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString
</span><span class="hs-identifier hs-var">B64.encode</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621681473331"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-204"></span><span>    </span><span class="annot"><a href="Data.LogMessage.html#logText"><span class="hs-identifier hs-var">logText</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.LogMessage.html#BinaryLogLazy"><span class="hs-identifier hs-type">BinaryLogLazy</span></a></span><span> </span><span id="local-6989586621681473329"><span class="annot"><span class="annottext">a :: ByteString
</span><a href="#local-6989586621681473329"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Text
</span><span class="hs-identifier hs-var">T.decodeUtf8</span></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; Text)
-&gt; (ByteString -&gt; ByteString) -&gt; ByteString -&gt; Text
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString
</span><span class="hs-identifier hs-var">B64.encode</span></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; Text) -&gt; ByteString -&gt; Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString
</span><span class="hs-identifier hs-var">BL.toStrict</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621681473329"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-205"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.LogMessage.html#logText"><span class="hs-pragma hs-type">logText</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-206"></span><span>
</span><span id="line-207"></span><span class="hs-comment">-- | Static textual log messages using 'Symbol' literals from 'GHC.TypeLits'.</span><span>
</span><span id="line-208"></span><span class="hs-comment">--</span><span>
</span><span id="line-209"></span><span class="hs-keyword">data</span><span> </span><span id="SomeSymbolLog"><span class="annot"><a href="Data.LogMessage.html#SomeSymbolLog"><span class="hs-identifier hs-var">SomeSymbolLog</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">forall</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681473328"><span class="annot"><a href="#local-6989586621681473328"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Symbol</span></span><span class="hs-special">)</span><span> </span><span class="hs-operator">.</span><span> </span><span class="annot"><span class="hs-identifier hs-type">KnownSymbol</span></span><span> </span><span class="annot"><a href="#local-6989586621681473328"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span id="SomeSymbolLog"><span class="annot"><a href="Data.LogMessage.html#SomeSymbolLog"><span class="hs-identifier hs-var">SomeSymbolLog</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Proxy</span></span><span> </span><span class="annot"><a href="#local-6989586621681473328"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-210"></span><span>
</span><span id="line-211"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NFData</span></span><span> </span><span class="annot"><a href="Data.LogMessage.html#SomeSymbolLog"><span class="hs-identifier hs-type">SomeSymbolLog</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-212"></span><span>    </span><span id="local-6989586621681473325"><span class="annot"><span class="annottext">rnf :: SomeSymbolLog -&gt; ()
</span><a href="#local-6989586621681473325"><span class="hs-identifier hs-var hs-var hs-var hs-var">rnf</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.LogMessage.html#SomeSymbolLog"><span class="hs-identifier hs-type">SomeSymbolLog</span></a></span><span> </span><span id="local-6989586621681473324"><span class="annot"><span class="annottext">a :: Proxy a
</span><a href="#local-6989586621681473324"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Proxy a -&gt; ()
forall a. NFData a =&gt; a -&gt; ()
</span><span class="hs-identifier hs-var">rnf</span></span><span> </span><span class="annot"><span class="annottext">Proxy a
</span><a href="#local-6989586621681473324"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-213"></span><span>
</span><span id="line-214"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681473317"><span id="local-6989586621681473319"><span class="annot"><a href="Data.LogMessage.html#LogMessage"><span class="hs-identifier hs-type">LogMessage</span></a></span><span> </span><span class="annot"><a href="Data.LogMessage.html#SomeSymbolLog"><span class="hs-identifier hs-type">SomeSymbolLog</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-215"></span><span>    </span><span id="local-6989586621681473316"><span class="annot"><span class="annottext">logText :: SomeSymbolLog -&gt; Text
</span><a href="#local-6989586621681473316"><span class="hs-identifier hs-var hs-var hs-var hs-var">logText</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.LogMessage.html#SomeSymbolLog"><span class="hs-identifier hs-type">SomeSymbolLog</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621681473315"><span class="annot"><span class="annottext">Proxy a
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Proxy</span></span><span> </span><span class="annot"><a href="#local-6989586621681473315"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Text
</span><span class="hs-identifier hs-var">T.pack</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Text) -&gt; String -&gt; Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Proxy a -&gt; String
forall (n :: Symbol) (proxy :: Symbol -&gt; *).
KnownSymbol n =&gt;
proxy n -&gt; String
</span><span class="hs-identifier hs-var">symbolVal</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy a
forall k (t :: k). Proxy t
</span><span class="hs-identifier hs-var">Proxy</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621681473315"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-216"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.LogMessage.html#logText"><span class="hs-pragma hs-type">logText</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-217"></span><span>
</span><span id="line-218"></span></pre></body></html>