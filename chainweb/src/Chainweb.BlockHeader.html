<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE AllowAmbiguousTypes #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE BangPatterns #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE ConstraintKinds #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE DeriveAnyClass #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# LANGUAGE DeriveGeneric #-}</span><span>
</span><span id="line-6"></span><span class="hs-pragma">{-# LANGUAGE DerivingStrategies #-}</span><span>
</span><span id="line-7"></span><span class="hs-pragma">{-# LANGUAGE EmptyCase #-}</span><span>
</span><span id="line-8"></span><span class="hs-pragma">{-# LANGUAGE FlexibleContexts #-}</span><span>
</span><span id="line-9"></span><span class="hs-pragma">{-# LANGUAGE FlexibleInstances #-}</span><span>
</span><span id="line-10"></span><span class="hs-pragma">{-# LANGUAGE GADTs #-}</span><span>
</span><span id="line-11"></span><span class="hs-pragma">{-# LANGUAGE GeneralizedNewtypeDeriving #-}</span><span>
</span><span id="line-12"></span><span class="hs-pragma">{-# LANGUAGE KindSignatures #-}</span><span>
</span><span id="line-13"></span><span class="hs-pragma">{-# LANGUAGE LambdaCase #-}</span><span>
</span><span id="line-14"></span><span class="hs-pragma">{-# LANGUAGE MultiParamTypeClasses #-}</span><span>
</span><span id="line-15"></span><span class="hs-pragma">{-# LANGUAGE MultiWayIf #-}</span><span>
</span><span id="line-16"></span><span class="hs-pragma">{-# LANGUAGE OverloadedStrings #-}</span><span>
</span><span id="line-17"></span><span class="hs-pragma">{-# LANGUAGE RankNTypes #-}</span><span>
</span><span id="line-18"></span><span class="hs-pragma">{-# LANGUAGE ScopedTypeVariables #-}</span><span>
</span><span id="line-19"></span><span class="hs-pragma">{-# LANGUAGE StandaloneDeriving #-}</span><span>
</span><span id="line-20"></span><span class="hs-pragma">{-# LANGUAGE TemplateHaskell #-}</span><span>
</span><span id="line-21"></span><span class="hs-pragma">{-# LANGUAGE TypeApplications #-}</span><span>
</span><span id="line-22"></span><span class="hs-pragma">{-# LANGUAGE TypeFamilies #-}</span><span>
</span><span id="line-23"></span><span class="hs-pragma">{-# LANGUAGE TypeInType #-}</span><span>
</span><span id="line-24"></span><span class="hs-pragma">{-# LANGUAGE TypeOperators #-}</span><span>
</span><span id="line-25"></span><span class="hs-pragma">{-# LANGUAGE UndecidableInstances #-}</span><span>
</span><span id="line-26"></span><span>
</span><span id="line-27"></span><span class="hs-comment">-- |</span><span>
</span><span id="line-28"></span><span class="hs-comment">-- Module: Chainweb.BlockHeader</span><span>
</span><span id="line-29"></span><span class="hs-comment">-- Copyright: Copyright &#169; 2018 Kadena LLC.</span><span>
</span><span id="line-30"></span><span class="hs-comment">-- License: MIT</span><span>
</span><span id="line-31"></span><span class="hs-comment">-- Maintainer: Lars Kuhtz &lt;lars@kadena.io&gt;</span><span>
</span><span id="line-32"></span><span class="hs-comment">-- Stability: experimental</span><span>
</span><span id="line-33"></span><span class="hs-comment">--</span><span>
</span><span id="line-34"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Chainweb.BlockHeader</span><span>
</span><span id="line-35"></span><span class="hs-special">(</span><span>
</span><span id="line-36"></span><span class="annot"><span class="hs-comment">-- * Block Height</span></span><span>
</span><span id="line-37"></span><span>  </span><span class="annot"><a href="Chainweb.BlockHeader.html#BlockHeight"><span class="hs-identifier">BlockHeight</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-38"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Chainweb.BlockHeader.html#encodeBlockHeight"><span class="hs-identifier">encodeBlockHeight</span></a></span><span>
</span><span id="line-39"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Chainweb.BlockHeader.html#decodeBlockHeight"><span class="hs-identifier">decodeBlockHeight</span></a></span><span>
</span><span id="line-40"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Chainweb.BlockHeader.html#encodeBlockHeightBe"><span class="hs-identifier">encodeBlockHeightBe</span></a></span><span>
</span><span id="line-41"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Chainweb.BlockHeader.html#decodeBlockHeightBe"><span class="hs-identifier">decodeBlockHeightBe</span></a></span><span>
</span><span id="line-42"></span><span>
</span><span id="line-43"></span><span class="annot"><span class="hs-comment">-- * Block Weight</span></span><span>
</span><span id="line-44"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Chainweb.BlockHeader.html#BlockWeight"><span class="hs-identifier">BlockWeight</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-45"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Chainweb.BlockHeader.html#encodeBlockWeight"><span class="hs-identifier">encodeBlockWeight</span></a></span><span>
</span><span id="line-46"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Chainweb.BlockHeader.html#decodeBlockWeight"><span class="hs-identifier">decodeBlockWeight</span></a></span><span>
</span><span id="line-47"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Chainweb.BlockHeader.html#encodeBlockWeightBe"><span class="hs-identifier">encodeBlockWeightBe</span></a></span><span>
</span><span id="line-48"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Chainweb.BlockHeader.html#decodeBlockWeightBe"><span class="hs-identifier">decodeBlockWeightBe</span></a></span><span>
</span><span id="line-49"></span><span>
</span><span id="line-50"></span><span class="annot"><span class="hs-comment">-- * Block Payload Hash</span></span><span>
</span><span id="line-51"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Chainweb.Payload.html#BlockPayloadHash"><span class="hs-identifier">BlockPayloadHash</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-52"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Chainweb.Payload.html#encodeBlockPayloadHash"><span class="hs-identifier">encodeBlockPayloadHash</span></a></span><span>
</span><span id="line-53"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Chainweb.Payload.html#decodeBlockPayloadHash"><span class="hs-identifier">decodeBlockPayloadHash</span></a></span><span>
</span><span id="line-54"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Chainweb.BlockHeader.html#hashPayload"><span class="hs-identifier">hashPayload</span></a></span><span>
</span><span id="line-55"></span><span>
</span><span id="line-56"></span><span class="annot"><span class="hs-comment">-- * Nonce</span></span><span>
</span><span id="line-57"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Chainweb.BlockHeader.html#Nonce"><span class="hs-identifier">Nonce</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-58"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Chainweb.BlockHeader.html#encodeNonce"><span class="hs-identifier">encodeNonce</span></a></span><span>
</span><span id="line-59"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Chainweb.BlockHeader.html#encodeNonceToWord64"><span class="hs-identifier">encodeNonceToWord64</span></a></span><span>
</span><span id="line-60"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Chainweb.BlockHeader.html#decodeNonce"><span class="hs-identifier">decodeNonce</span></a></span><span>
</span><span id="line-61"></span><span>
</span><span id="line-62"></span><span class="annot"><span class="hs-comment">-- * BlockCreationTime</span></span><span>
</span><span id="line-63"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Chainweb.BlockHeader.html#BlockCreationTime"><span class="hs-identifier">BlockCreationTime</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-64"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Chainweb.BlockHeader.html#encodeBlockCreationTime"><span class="hs-identifier">encodeBlockCreationTime</span></a></span><span>
</span><span id="line-65"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Chainweb.BlockHeader.html#decodeBlockCreationTime"><span class="hs-identifier">decodeBlockCreationTime</span></a></span><span>
</span><span id="line-66"></span><span>
</span><span id="line-67"></span><span class="annot"><span class="hs-comment">-- * EpochStartTime</span></span><span>
</span><span id="line-68"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Chainweb.BlockHeader.html#EpochStartTime"><span class="hs-identifier">EpochStartTime</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-69"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Chainweb.BlockHeader.html#encodeEpochStartTime"><span class="hs-identifier">encodeEpochStartTime</span></a></span><span>
</span><span id="line-70"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Chainweb.BlockHeader.html#decodeEpochStartTime"><span class="hs-identifier">decodeEpochStartTime</span></a></span><span>
</span><span id="line-71"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Chainweb.BlockHeader.html#epochStart"><span class="hs-identifier">epochStart</span></a></span><span>
</span><span id="line-72"></span><span>
</span><span id="line-73"></span><span class="annot"><span class="hs-comment">-- * FeatureFlags</span></span><span>
</span><span id="line-74"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Chainweb.BlockHeader.html#FeatureFlags"><span class="hs-identifier">FeatureFlags</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-75"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Chainweb.BlockHeader.html#encodeFeatureFlags"><span class="hs-identifier">encodeFeatureFlags</span></a></span><span>
</span><span id="line-76"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Chainweb.BlockHeader.html#decodeFeatureFlags"><span class="hs-identifier">decodeFeatureFlags</span></a></span><span>
</span><span id="line-77"></span><span>
</span><span id="line-78"></span><span class="annot"><span class="hs-comment">-- * POW Target</span></span><span>
</span><span id="line-79"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Chainweb.BlockHeader.html#powTarget"><span class="hs-identifier">powTarget</span></a></span><span>
</span><span id="line-80"></span><span>
</span><span id="line-81"></span><span class="annot"><span class="hs-comment">-- * BlockHeader</span></span><span>
</span><span id="line-82"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Chainweb.BlockHeader.html#BlockHeader"><span class="hs-identifier">BlockHeader</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-83"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Chainweb.BlockHeader.html#blockNonce"><span class="hs-identifier">blockNonce</span></a></span><span>
</span><span id="line-84"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Chainweb.BlockHeader.html#blockChainId"><span class="hs-identifier">blockChainId</span></a></span><span>
</span><span id="line-85"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Chainweb.BlockHeader.html#blockHeight"><span class="hs-identifier">blockHeight</span></a></span><span>
</span><span id="line-86"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Chainweb.BlockHeader.html#blockWeight"><span class="hs-identifier">blockWeight</span></a></span><span>
</span><span id="line-87"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Chainweb.BlockHeader.html#blockChainwebVersion"><span class="hs-identifier">blockChainwebVersion</span></a></span><span>
</span><span id="line-88"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Chainweb.BlockHeader.html#blockAdjacentHashes"><span class="hs-identifier">blockAdjacentHashes</span></a></span><span>
</span><span id="line-89"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Chainweb.BlockHeader.html#blockCreationTime"><span class="hs-identifier">blockCreationTime</span></a></span><span>
</span><span id="line-90"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Chainweb.BlockHeader.html#blockHash"><span class="hs-identifier">blockHash</span></a></span><span>
</span><span id="line-91"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Chainweb.BlockHeader.html#blockParent"><span class="hs-identifier">blockParent</span></a></span><span>
</span><span id="line-92"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Chainweb.BlockHeader.html#blockPayloadHash"><span class="hs-identifier">blockPayloadHash</span></a></span><span>
</span><span id="line-93"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Chainweb.BlockHeader.html#blockTarget"><span class="hs-identifier">blockTarget</span></a></span><span>
</span><span id="line-94"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Chainweb.BlockHeader.html#blockEpochStart"><span class="hs-identifier">blockEpochStart</span></a></span><span>
</span><span id="line-95"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Chainweb.BlockHeader.html#blockFlags"><span class="hs-identifier">blockFlags</span></a></span><span>
</span><span id="line-96"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Chainweb.BlockHeader.html#_blockPow"><span class="hs-identifier">_blockPow</span></a></span><span>
</span><span id="line-97"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Chainweb.BlockHeader.html#blockPow"><span class="hs-identifier">blockPow</span></a></span><span>
</span><span id="line-98"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Chainweb.BlockHeader.html#_blockAdjacentChainIds"><span class="hs-identifier">_blockAdjacentChainIds</span></a></span><span>
</span><span id="line-99"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Chainweb.BlockHeader.html#blockAdjacentChainIds"><span class="hs-identifier">blockAdjacentChainIds</span></a></span><span>
</span><span id="line-100"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Chainweb.BlockHeader.html#encodeBlockHeader"><span class="hs-identifier">encodeBlockHeader</span></a></span><span>
</span><span id="line-101"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Chainweb.BlockHeader.html#encodeBlockHeaderWithoutHash"><span class="hs-identifier">encodeBlockHeaderWithoutHash</span></a></span><span>
</span><span id="line-102"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Chainweb.BlockHeader.html#decodeBlockHeader"><span class="hs-identifier">decodeBlockHeader</span></a></span><span>
</span><span id="line-103"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Chainweb.BlockHeader.html#decodeBlockHeaderWithoutHash"><span class="hs-identifier">decodeBlockHeaderWithoutHash</span></a></span><span>
</span><span id="line-104"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Chainweb.BlockHeader.html#decodeBlockHeaderChecked"><span class="hs-identifier">decodeBlockHeaderChecked</span></a></span><span>
</span><span id="line-105"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Chainweb.BlockHeader.html#decodeBlockHeaderCheckedChainId"><span class="hs-identifier">decodeBlockHeaderCheckedChainId</span></a></span><span>
</span><span id="line-106"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Chainweb.BlockHeader.html#ObjectEncoded"><span class="hs-identifier">ObjectEncoded</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-107"></span><span>
</span><span id="line-108"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Chainweb.BlockHeader.html#timeBetween"><span class="hs-identifier">timeBetween</span></a></span><span>
</span><span id="line-109"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Chainweb.BlockHeader.html#getAdjacentHash"><span class="hs-identifier">getAdjacentHash</span></a></span><span>
</span><span id="line-110"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Chainweb.BlockHeader.html#computeBlockHash"><span class="hs-identifier">computeBlockHash</span></a></span><span>
</span><span id="line-111"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Chainweb.Graph.html#adjacentChainIds"><span class="hs-identifier">adjacentChainIds</span></a></span><span>
</span><span id="line-112"></span><span>
</span><span id="line-113"></span><span class="annot"><span class="hs-comment">-- * IsBlockHeader</span></span><span>
</span><span id="line-114"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Chainweb.BlockHeader.html#IsBlockHeader"><span class="hs-identifier">IsBlockHeader</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-115"></span><span>
</span><span id="line-116"></span><span class="annot"><span class="hs-comment">-- * Genesis BlockHeader</span></span><span>
</span><span id="line-117"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Chainweb.BlockHeader.html#isGenesisBlockHeader"><span class="hs-identifier">isGenesisBlockHeader</span></a></span><span>
</span><span id="line-118"></span><span>
</span><span id="line-119"></span><span class="annot"><span class="hs-comment">-- * Create a new BlockHeader</span></span><span>
</span><span id="line-120"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Chainweb.BlockHeader.html#newBlockHeader"><span class="hs-identifier">newBlockHeader</span></a></span><span>
</span><span id="line-121"></span><span>
</span><span id="line-122"></span><span class="annot"><span class="hs-comment">-- * Testing</span></span><span>
</span><span id="line-123"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Chainweb.BlockHeader.html#testBlockHeader"><span class="hs-identifier">testBlockHeader</span></a></span><span>
</span><span id="line-124"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Chainweb.BlockHeader.html#testBlockHeaders"><span class="hs-identifier">testBlockHeaders</span></a></span><span>
</span><span id="line-125"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Chainweb.BlockHeader.html#testBlockHeadersWithNonce"><span class="hs-identifier">testBlockHeadersWithNonce</span></a></span><span>
</span><span id="line-126"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Chainweb.BlockHeader.html#testBlockPayload"><span class="hs-identifier">testBlockPayload</span></a></span><span>
</span><span id="line-127"></span><span>
</span><span id="line-128"></span><span class="annot"><span class="hs-comment">-- * CAS Constraint</span></span><span>
</span><span id="line-129"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Chainweb.BlockHeader.html#BlockHeaderCas"><span class="hs-identifier">BlockHeaderCas</span></a></span><span>
</span><span id="line-130"></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-131"></span><span>
</span><span id="line-132"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Arrow</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-operator">(&amp;&amp;&amp;)</span></span><span class="hs-special">)</span><span>
</span><span id="line-133"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.DeepSeq</span></span><span>
</span><span id="line-134"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Lens</span></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-operator">(.=)</span></span><span class="hs-special">)</span><span>
</span><span id="line-135"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Catch</span></span><span>
</span><span id="line-136"></span><span>
</span><span id="line-137"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Aeson</span></span><span>
</span><span id="line-138"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Aeson.Types</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Parser</span></span><span class="hs-special">)</span><span>
</span><span id="line-139"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Bytes.Get</span></span><span>
</span><span id="line-140"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Bytes.Put</span></span><span>
</span><span id="line-141"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.ByteString.Char8</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">ByteString</span></span><span class="hs-special">)</span><span>
</span><span id="line-142"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Function</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">on</span></span><span class="hs-special">)</span><span>
</span><span id="line-143"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Hashable</span></span><span>
</span><span id="line-144"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.HashMap.Strict</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">HM</span></span><span>
</span><span id="line-145"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.HashSet</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">HS</span></span><span>
</span><span id="line-146"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Kind</span></span><span>
</span><span id="line-147"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.List</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">unfoldr</span></span><span class="hs-special">)</span><span>
</span><span id="line-148"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Memory.Endian</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">BA</span></span><span>
</span><span id="line-149"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.MerkleLog</span></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Actual</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">Expected</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">MerkleHash</span></span><span class="hs-special">)</span><span>
</span><span id="line-150"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Serialize</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Serialize</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-151"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Text</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">T</span></span><span>
</span><span id="line-152"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Word</span></span><span>
</span><span id="line-153"></span><span>
</span><span id="line-154"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">GHC.Generics</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Generic</span></span><span class="hs-special">)</span><span>
</span><span id="line-155"></span><span>
</span><span id="line-156"></span><span class="hs-comment">-- Internal imports</span><span>
</span><span id="line-157"></span><span>
</span><span id="line-158"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Chainweb.BlockHash.html"><span class="hs-identifier">Chainweb.BlockHash</span></a></span><span>
</span><span id="line-159"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Chainweb.ChainId.html"><span class="hs-identifier">Chainweb.ChainId</span></a></span><span>
</span><span id="line-160"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Chainweb.Crypto.MerkleLog.html"><span class="hs-identifier">Chainweb.Crypto.MerkleLog</span></a></span><span>
</span><span id="line-161"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Chainweb.Difficulty.html"><span class="hs-identifier">Chainweb.Difficulty</span></a></span><span>
</span><span id="line-162"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Chainweb.Graph.html"><span class="hs-identifier">Chainweb.Graph</span></a></span><span>
</span><span id="line-163"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Chainweb.MerkleLogHash.html"><span class="hs-identifier">Chainweb.MerkleLogHash</span></a></span><span>
</span><span id="line-164"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Chainweb.MerkleUniverse.html"><span class="hs-identifier">Chainweb.MerkleUniverse</span></a></span><span>
</span><span id="line-165"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Chainweb.Payload.html"><span class="hs-identifier">Chainweb.Payload</span></a></span><span>
</span><span id="line-166"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Chainweb.PowHash.html"><span class="hs-identifier">Chainweb.PowHash</span></a></span><span>
</span><span id="line-167"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Chainweb.Time.html"><span class="hs-identifier">Chainweb.Time</span></a></span><span>
</span><span id="line-168"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Chainweb.TreeDB.html"><span class="hs-identifier">Chainweb.TreeDB</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Chainweb.TreeDB.html#TreeDbEntry"><span class="hs-identifier">TreeDbEntry</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-169"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Chainweb.Utils.html"><span class="hs-identifier">Chainweb.Utils</span></a></span><span>
</span><span id="line-170"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Chainweb.Version.html"><span class="hs-identifier">Chainweb.Version</span></a></span><span>
</span><span id="line-171"></span><span>
</span><span id="line-172"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.CAS</span></span><span>
</span><span id="line-173"></span><span>
</span><span id="line-174"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Numeric.Additive.html"><span class="hs-identifier">Numeric.Additive</span></a></span><span>
</span><span id="line-175"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Numeric.AffineSpace.html"><span class="hs-identifier">Numeric.AffineSpace</span></a></span><span>
</span><span id="line-176"></span><span>
</span><span id="line-177"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Text.Read</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">readEither</span></span><span class="hs-special">)</span><span>
</span><span id="line-178"></span><span>
</span><span id="line-179"></span><span class="hs-comment">-- -------------------------------------------------------------------------- --</span><span>
</span><span id="line-180"></span><span class="hs-comment">-- | BlockHeight</span><span>
</span><span id="line-181"></span><span class="hs-comment">--</span><span>
</span><span id="line-182"></span><span id="local-6989586621681481119"><span id="local-6989586621681481120"></span></span><span class="hs-keyword">newtype</span><span> </span><span id="BlockHeight"><span class="annot"><a href="Chainweb.BlockHeader.html#BlockHeight"><span class="hs-identifier hs-var">BlockHeight</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="BlockHeight"><span class="annot"><a href="Chainweb.BlockHeader.html#BlockHeight"><span class="hs-identifier hs-var">BlockHeight</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="_height"><span class="annot"><span class="annottext">BlockHeight -&gt; Word64
</span><a href="Chainweb.BlockHeader.html#_height"><span class="hs-identifier hs-var hs-var">_height</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word64</span></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-183"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681481113"><span id="local-6989586621681481115"><span class="annot"><span class="annottext">BlockHeight -&gt; BlockHeight -&gt; Bool
(BlockHeight -&gt; BlockHeight -&gt; Bool)
-&gt; (BlockHeight -&gt; BlockHeight -&gt; Bool) -&gt; Eq BlockHeight
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: BlockHeight -&gt; BlockHeight -&gt; Bool
$c/= :: BlockHeight -&gt; BlockHeight -&gt; Bool
== :: BlockHeight -&gt; BlockHeight -&gt; Bool
$c== :: BlockHeight -&gt; BlockHeight -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681481097"><span id="local-6989586621681481099"><span id="local-6989586621681481101"><span id="local-6989586621681481103"><span id="local-6989586621681481105"><span id="local-6989586621681481107"><span id="local-6989586621681481109"><span class="annot"><span class="annottext">Eq BlockHeight
Eq BlockHeight =&gt;
(BlockHeight -&gt; BlockHeight -&gt; Ordering)
-&gt; (BlockHeight -&gt; BlockHeight -&gt; Bool)
-&gt; (BlockHeight -&gt; BlockHeight -&gt; Bool)
-&gt; (BlockHeight -&gt; BlockHeight -&gt; Bool)
-&gt; (BlockHeight -&gt; BlockHeight -&gt; Bool)
-&gt; (BlockHeight -&gt; BlockHeight -&gt; BlockHeight)
-&gt; (BlockHeight -&gt; BlockHeight -&gt; BlockHeight)
-&gt; Ord BlockHeight
BlockHeight -&gt; BlockHeight -&gt; Bool
BlockHeight -&gt; BlockHeight -&gt; Ordering
BlockHeight -&gt; BlockHeight -&gt; BlockHeight
forall a.
Eq a =&gt;
(a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
min :: BlockHeight -&gt; BlockHeight -&gt; BlockHeight
$cmin :: BlockHeight -&gt; BlockHeight -&gt; BlockHeight
max :: BlockHeight -&gt; BlockHeight -&gt; BlockHeight
$cmax :: BlockHeight -&gt; BlockHeight -&gt; BlockHeight
&gt;= :: BlockHeight -&gt; BlockHeight -&gt; Bool
$c&gt;= :: BlockHeight -&gt; BlockHeight -&gt; Bool
&gt; :: BlockHeight -&gt; BlockHeight -&gt; Bool
$c&gt; :: BlockHeight -&gt; BlockHeight -&gt; Bool
&lt;= :: BlockHeight -&gt; BlockHeight -&gt; Bool
$c&lt;= :: BlockHeight -&gt; BlockHeight -&gt; Bool
&lt; :: BlockHeight -&gt; BlockHeight -&gt; Bool
$c&lt; :: BlockHeight -&gt; BlockHeight -&gt; Bool
compare :: BlockHeight -&gt; BlockHeight -&gt; Ordering
$ccompare :: BlockHeight -&gt; BlockHeight -&gt; Ordering
$cp1Ord :: Eq BlockHeight
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(forall x. BlockHeight -&gt; Rep BlockHeight x)
-&gt; (forall x. Rep BlockHeight x -&gt; BlockHeight)
-&gt; Generic BlockHeight
forall x. Rep BlockHeight x -&gt; BlockHeight
forall x. BlockHeight -&gt; Rep BlockHeight x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
$cto :: forall x. Rep BlockHeight x -&gt; BlockHeight
$cfrom :: forall x. BlockHeight -&gt; Rep BlockHeight x
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">Generic</span></span><span class="hs-special">)</span><span>
</span><span id="line-184"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">anyclass</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621681481091"><span class="annot"><span class="annottext">BlockHeight -&gt; ()
(BlockHeight -&gt; ()) -&gt; NFData BlockHeight
forall a. (a -&gt; ()) -&gt; NFData a
rnf :: BlockHeight -&gt; ()
$crnf :: BlockHeight -&gt; ()
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">NFData</span></span></span><span class="hs-special">)</span><span>
</span><span id="line-185"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">newtype</span></span><span>
</span><span id="line-186"></span><span>        </span><span class="hs-special">(</span><span> </span><span id="local-6989586621681481086"><span id="local-6989586621681481088"><span class="annot"><span class="annottext">Int -&gt; BlockHeight -&gt; Int
BlockHeight -&gt; Int
(Int -&gt; BlockHeight -&gt; Int)
-&gt; (BlockHeight -&gt; Int) -&gt; Hashable BlockHeight
forall a. (Int -&gt; a -&gt; Int) -&gt; (a -&gt; Int) -&gt; Hashable a
hash :: BlockHeight -&gt; Int
$chash :: BlockHeight -&gt; Int
hashWithSalt :: Int -&gt; BlockHeight -&gt; Int
$chashWithSalt :: Int -&gt; BlockHeight -&gt; Int
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Hashable</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681481077"><span id="local-6989586621681481079"><span id="local-6989586621681481081"><span id="local-6989586621681481083"><span class="annot"><span class="annottext">[BlockHeight] -&gt; Encoding
[BlockHeight] -&gt; Value
BlockHeight -&gt; Encoding
BlockHeight -&gt; Value
(BlockHeight -&gt; Value)
-&gt; (BlockHeight -&gt; Encoding)
-&gt; ([BlockHeight] -&gt; Value)
-&gt; ([BlockHeight] -&gt; Encoding)
-&gt; ToJSON BlockHeight
forall a.
(a -&gt; Value)
-&gt; (a -&gt; Encoding)
-&gt; ([a] -&gt; Value)
-&gt; ([a] -&gt; Encoding)
-&gt; ToJSON a
toEncodingList :: [BlockHeight] -&gt; Encoding
$ctoEncodingList :: [BlockHeight] -&gt; Encoding
toJSONList :: [BlockHeight] -&gt; Value
$ctoJSONList :: [BlockHeight] -&gt; Value
toEncoding :: BlockHeight -&gt; Encoding
$ctoEncoding :: BlockHeight -&gt; Encoding
toJSON :: BlockHeight -&gt; Value
$ctoJSON :: BlockHeight -&gt; Value
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">ToJSON</span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681481072"><span id="local-6989586621681481074"><span class="annot"><span class="annottext">Value -&gt; Parser [BlockHeight]
Value -&gt; Parser BlockHeight
(Value -&gt; Parser BlockHeight)
-&gt; (Value -&gt; Parser [BlockHeight]) -&gt; FromJSON BlockHeight
forall a.
(Value -&gt; Parser a) -&gt; (Value -&gt; Parser [a]) -&gt; FromJSON a
parseJSONList :: Value -&gt; Parser [BlockHeight]
$cparseJSONList :: Value -&gt; Parser [BlockHeight]
parseJSON :: Value -&gt; Parser BlockHeight
$cparseJSON :: Value -&gt; Parser BlockHeight
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">FromJSON</span></span></span></span><span>
</span><span id="line-187"></span><span>        </span><span class="hs-special">,</span><span> </span><span id="local-6989586621681481069"><span class="annot"><span class="annottext">BlockHeight -&gt; BlockHeight -&gt; BlockHeight
(BlockHeight -&gt; BlockHeight -&gt; BlockHeight)
-&gt; AdditiveSemigroup BlockHeight
forall g. (g -&gt; g -&gt; g) -&gt; AdditiveSemigroup g
plus :: BlockHeight -&gt; BlockHeight -&gt; BlockHeight
$cplus :: BlockHeight -&gt; BlockHeight -&gt; BlockHeight
</span><a href="Numeric.Additive.html#C%3AAdditiveSemigroup"><span class="hs-identifier hs-var hs-var hs-var hs-var">AdditiveSemigroup</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">AdditiveSemigroup BlockHeight
AdditiveSemigroup BlockHeight =&gt;
AdditiveAbelianSemigroup BlockHeight
forall g. AdditiveSemigroup g =&gt; AdditiveAbelianSemigroup g
</span><a href="Numeric.Additive.html#C%3AAdditiveAbelianSemigroup"><span class="hs-identifier hs-var hs-var hs-var">AdditiveAbelianSemigroup</span></a></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681481063"><span class="annot"><span class="annottext">AdditiveSemigroup BlockHeight
BlockHeight
AdditiveSemigroup BlockHeight =&gt;
BlockHeight -&gt; AdditiveMonoid BlockHeight
forall g. AdditiveSemigroup g =&gt; g -&gt; AdditiveMonoid g
zero :: BlockHeight
$czero :: BlockHeight
$cp1AdditiveMonoid :: AdditiveSemigroup BlockHeight
</span><a href="Numeric.Additive.html#C%3AAdditiveMonoid"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var">AdditiveMonoid</span></a></span></span><span>
</span><span id="line-188"></span><span>        </span><span class="hs-special">,</span><span> </span><span id="local-6989586621681481048"><span id="local-6989586621681481050"><span id="local-6989586621681481052"><span id="local-6989586621681481054"><span id="local-6989586621681481056"><span id="local-6989586621681481058"><span id="local-6989586621681481060"><span class="annot"><span class="annottext">Integer -&gt; BlockHeight
BlockHeight -&gt; BlockHeight
BlockHeight -&gt; BlockHeight -&gt; BlockHeight
(BlockHeight -&gt; BlockHeight -&gt; BlockHeight)
-&gt; (BlockHeight -&gt; BlockHeight -&gt; BlockHeight)
-&gt; (BlockHeight -&gt; BlockHeight -&gt; BlockHeight)
-&gt; (BlockHeight -&gt; BlockHeight)
-&gt; (BlockHeight -&gt; BlockHeight)
-&gt; (BlockHeight -&gt; BlockHeight)
-&gt; (Integer -&gt; BlockHeight)
-&gt; Num BlockHeight
forall a.
(a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a)
-&gt; (a -&gt; a)
-&gt; (a -&gt; a)
-&gt; (Integer -&gt; a)
-&gt; Num a
fromInteger :: Integer -&gt; BlockHeight
$cfromInteger :: Integer -&gt; BlockHeight
signum :: BlockHeight -&gt; BlockHeight
$csignum :: BlockHeight -&gt; BlockHeight
abs :: BlockHeight -&gt; BlockHeight
$cabs :: BlockHeight -&gt; BlockHeight
negate :: BlockHeight -&gt; BlockHeight
$cnegate :: BlockHeight -&gt; BlockHeight
* :: BlockHeight -&gt; BlockHeight -&gt; BlockHeight
$c* :: BlockHeight -&gt; BlockHeight -&gt; BlockHeight
- :: BlockHeight -&gt; BlockHeight -&gt; BlockHeight
$c- :: BlockHeight -&gt; BlockHeight -&gt; BlockHeight
+ :: BlockHeight -&gt; BlockHeight -&gt; BlockHeight
$c+ :: BlockHeight -&gt; BlockHeight -&gt; BlockHeight
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Num</span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681481031"><span id="local-6989586621681481033"><span id="local-6989586621681481035"><span id="local-6989586621681481037"><span id="local-6989586621681481039"><span id="local-6989586621681481041"><span id="local-6989586621681481043"><span class="annot"><span class="annottext">Enum BlockHeight
Real BlockHeight
(Real BlockHeight, Enum BlockHeight) =&gt;
(BlockHeight -&gt; BlockHeight -&gt; BlockHeight)
-&gt; (BlockHeight -&gt; BlockHeight -&gt; BlockHeight)
-&gt; (BlockHeight -&gt; BlockHeight -&gt; BlockHeight)
-&gt; (BlockHeight -&gt; BlockHeight -&gt; BlockHeight)
-&gt; (BlockHeight -&gt; BlockHeight -&gt; (BlockHeight, BlockHeight))
-&gt; (BlockHeight -&gt; BlockHeight -&gt; (BlockHeight, BlockHeight))
-&gt; (BlockHeight -&gt; Integer)
-&gt; Integral BlockHeight
BlockHeight -&gt; Integer
BlockHeight -&gt; BlockHeight -&gt; (BlockHeight, BlockHeight)
BlockHeight -&gt; BlockHeight -&gt; BlockHeight
forall a.
(Real a, Enum a) =&gt;
(a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; (a, a))
-&gt; (a -&gt; a -&gt; (a, a))
-&gt; (a -&gt; Integer)
-&gt; Integral a
toInteger :: BlockHeight -&gt; Integer
$ctoInteger :: BlockHeight -&gt; Integer
divMod :: BlockHeight -&gt; BlockHeight -&gt; (BlockHeight, BlockHeight)
$cdivMod :: BlockHeight -&gt; BlockHeight -&gt; (BlockHeight, BlockHeight)
quotRem :: BlockHeight -&gt; BlockHeight -&gt; (BlockHeight, BlockHeight)
$cquotRem :: BlockHeight -&gt; BlockHeight -&gt; (BlockHeight, BlockHeight)
mod :: BlockHeight -&gt; BlockHeight -&gt; BlockHeight
$cmod :: BlockHeight -&gt; BlockHeight -&gt; BlockHeight
div :: BlockHeight -&gt; BlockHeight -&gt; BlockHeight
$cdiv :: BlockHeight -&gt; BlockHeight -&gt; BlockHeight
rem :: BlockHeight -&gt; BlockHeight -&gt; BlockHeight
$crem :: BlockHeight -&gt; BlockHeight -&gt; BlockHeight
quot :: BlockHeight -&gt; BlockHeight -&gt; BlockHeight
$cquot :: BlockHeight -&gt; BlockHeight -&gt; BlockHeight
$cp2Integral :: Enum BlockHeight
$cp1Integral :: Real BlockHeight
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Integral</span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681481026"><span class="annot"><span class="annottext">Num BlockHeight
Ord BlockHeight
(Num BlockHeight, Ord BlockHeight) =&gt;
(BlockHeight -&gt; Rational) -&gt; Real BlockHeight
BlockHeight -&gt; Rational
forall a. (Num a, Ord a) =&gt; (a -&gt; Rational) -&gt; Real a
toRational :: BlockHeight -&gt; Rational
$ctoRational :: BlockHeight -&gt; Rational
$cp2Real :: Ord BlockHeight
$cp1Real :: Num BlockHeight
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Real</span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681481009"><span id="local-6989586621681481011"><span id="local-6989586621681481013"><span id="local-6989586621681481015"><span id="local-6989586621681481017"><span id="local-6989586621681481019"><span id="local-6989586621681481021"><span id="local-6989586621681481023"><span class="annot"><span class="annottext">Int -&gt; BlockHeight
BlockHeight -&gt; Int
BlockHeight -&gt; [BlockHeight]
BlockHeight -&gt; BlockHeight
BlockHeight -&gt; BlockHeight -&gt; [BlockHeight]
BlockHeight -&gt; BlockHeight -&gt; BlockHeight -&gt; [BlockHeight]
(BlockHeight -&gt; BlockHeight)
-&gt; (BlockHeight -&gt; BlockHeight)
-&gt; (Int -&gt; BlockHeight)
-&gt; (BlockHeight -&gt; Int)
-&gt; (BlockHeight -&gt; [BlockHeight])
-&gt; (BlockHeight -&gt; BlockHeight -&gt; [BlockHeight])
-&gt; (BlockHeight -&gt; BlockHeight -&gt; [BlockHeight])
-&gt; (BlockHeight -&gt; BlockHeight -&gt; BlockHeight -&gt; [BlockHeight])
-&gt; Enum BlockHeight
forall a.
(a -&gt; a)
-&gt; (a -&gt; a)
-&gt; (Int -&gt; a)
-&gt; (a -&gt; Int)
-&gt; (a -&gt; [a])
-&gt; (a -&gt; a -&gt; [a])
-&gt; (a -&gt; a -&gt; [a])
-&gt; (a -&gt; a -&gt; a -&gt; [a])
-&gt; Enum a
enumFromThenTo :: BlockHeight -&gt; BlockHeight -&gt; BlockHeight -&gt; [BlockHeight]
$cenumFromThenTo :: BlockHeight -&gt; BlockHeight -&gt; BlockHeight -&gt; [BlockHeight]
enumFromTo :: BlockHeight -&gt; BlockHeight -&gt; [BlockHeight]
$cenumFromTo :: BlockHeight -&gt; BlockHeight -&gt; [BlockHeight]
enumFromThen :: BlockHeight -&gt; BlockHeight -&gt; [BlockHeight]
$cenumFromThen :: BlockHeight -&gt; BlockHeight -&gt; [BlockHeight]
enumFrom :: BlockHeight -&gt; [BlockHeight]
$cenumFrom :: BlockHeight -&gt; [BlockHeight]
fromEnum :: BlockHeight -&gt; Int
$cfromEnum :: BlockHeight -&gt; Int
toEnum :: Int -&gt; BlockHeight
$ctoEnum :: Int -&gt; BlockHeight
pred :: BlockHeight -&gt; BlockHeight
$cpred :: BlockHeight -&gt; BlockHeight
succ :: BlockHeight -&gt; BlockHeight
$csucc :: BlockHeight -&gt; BlockHeight
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Enum</span></span></span></span></span></span></span></span></span></span><span>
</span><span id="line-189"></span><span>        </span><span class="hs-special">)</span><span>
</span><span id="line-190"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681481003"><span id="local-6989586621681481006"><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="Chainweb.BlockHeader.html#BlockHeight"><span class="hs-identifier hs-type">BlockHeight</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621681481001"><span class="annot"><span class="annottext">show :: BlockHeight -&gt; String
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">show</span></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Chainweb.BlockHeader.html#BlockHeight"><span class="hs-identifier hs-type">BlockHeight</span></a></span><span> </span><span id="local-6989586621681480999"><span class="annot"><span class="annottext">b :: Word64
</span><a href="#local-6989586621681480999"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621681480999"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-191"></span><span>
</span><span id="line-192"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Chainweb.Crypto.MerkleLog.html#IsMerkleLogEntry"><span class="hs-identifier hs-type">IsMerkleLogEntry</span></a></span><span> </span><span class="annot"><a href="Chainweb.MerkleUniverse.html#ChainwebHashTag"><span class="hs-identifier hs-type">ChainwebHashTag</span></a></span><span> </span><span class="annot"><a href="Chainweb.BlockHeader.html#BlockHeight"><span class="hs-identifier hs-type">BlockHeight</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-193"></span><span>    </span><span class="hs-keyword">type</span><span> </span><span id="Tag"><span class="annot"><a href="Chainweb.Crypto.MerkleLog.html#Tag"><span class="hs-identifier hs-var">Tag</span></a></span></span><span> </span><span class="annot"><a href="Chainweb.BlockHeader.html#BlockHeight"><span class="hs-identifier hs-type">BlockHeight</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Chainweb.MerkleUniverse.html#BlockHeightTag"><span class="hs-identifier hs-type">BlockHeightTag</span></a></span><span>
</span><span id="line-194"></span><span>    </span><span id="local-6989586621681480993"><span class="annot"><span class="annottext">toMerkleNode :: BlockHeight -&gt; MerkleNodeType (HashAlg ChainwebHashTag) ByteString
</span><a href="Chainweb.Crypto.MerkleLog.html#toMerkleNode"><span class="hs-identifier hs-var hs-var hs-var hs-var">toMerkleNode</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall (m :: * -&gt; *). MonadPut m =&gt; BlockHeight -&gt; m ())
-&gt; BlockHeight -&gt; MerkleNodeType SHA512t_256 ByteString
forall b a.
(forall (m :: * -&gt; *). MonadPut m =&gt; b -&gt; m ())
-&gt; b -&gt; MerkleNodeType a ByteString
</span><a href="Chainweb.Crypto.MerkleLog.html#encodeMerkleInputNode"><span class="hs-identifier hs-var">encodeMerkleInputNode</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). MonadPut m =&gt; BlockHeight -&gt; m ()
</span><a href="Chainweb.BlockHeader.html#encodeBlockHeight"><span class="hs-identifier hs-var">encodeBlockHeight</span></a></span><span>
</span><span id="line-195"></span><span>    </span><span id="local-6989586621681480990"><span class="annot"><span class="annottext">fromMerkleNode :: MerkleNodeType (HashAlg ChainwebHashTag) ByteString
-&gt; Either SomeException BlockHeight
</span><a href="Chainweb.Crypto.MerkleLog.html#fromMerkleNode"><span class="hs-identifier hs-var hs-var hs-var hs-var">fromMerkleNode</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall (n :: * -&gt; *). MonadGet n =&gt; n BlockHeight)
-&gt; MerkleNodeType SHA512t_256 ByteString
-&gt; Either SomeException BlockHeight
forall (m :: * -&gt; *) b a.
MonadThrow m =&gt;
(forall (n :: * -&gt; *). MonadGet n =&gt; n b)
-&gt; MerkleNodeType a ByteString -&gt; m b
</span><a href="Chainweb.Crypto.MerkleLog.html#decodeMerkleInputNode"><span class="hs-identifier hs-var">decodeMerkleInputNode</span></a></span><span> </span><span class="annot"><span class="annottext">forall (n :: * -&gt; *). MonadGet n =&gt; n BlockHeight
</span><a href="Chainweb.BlockHeader.html#decodeBlockHeight"><span class="hs-identifier hs-var">decodeBlockHeight</span></a></span><span>
</span><span id="line-196"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Chainweb.Crypto.MerkleLog.html#toMerkleNode"><span class="hs-pragma hs-type">toMerkleNode</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-197"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Chainweb.Crypto.MerkleLog.html#fromMerkleNode"><span class="hs-pragma hs-type">fromMerkleNode</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-198"></span><span>
</span><span id="line-199"></span><span id="local-6989586621681480987"><span class="annot"><a href="Chainweb.BlockHeader.html#encodeBlockHeight"><span class="hs-identifier hs-type">encodeBlockHeight</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadPut</span></span><span> </span><span class="annot"><a href="#local-6989586621681480987"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Chainweb.BlockHeader.html#BlockHeight"><span class="hs-identifier hs-type">BlockHeight</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681480987"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-200"></span><span id="encodeBlockHeight"><span class="annot"><span class="annottext">encodeBlockHeight :: BlockHeight -&gt; m ()
</span><a href="Chainweb.BlockHeader.html#encodeBlockHeight"><span class="hs-identifier hs-var hs-var">encodeBlockHeight</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Chainweb.BlockHeader.html#BlockHeight"><span class="hs-identifier hs-type">BlockHeight</span></a></span><span> </span><span id="local-6989586621681480986"><span class="annot"><span class="annottext">h :: Word64
</span><a href="#local-6989586621681480986"><span class="hs-identifier hs-var">h</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; m ()
forall (m :: * -&gt; *). MonadPut m =&gt; Word64 -&gt; m ()
</span><span class="hs-identifier hs-var">putWord64le</span></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621681480986"><span class="hs-identifier hs-var">h</span></a></span><span>
</span><span id="line-201"></span><span>
</span><span id="line-202"></span><span id="local-6989586621681480984"><span class="annot"><a href="Chainweb.BlockHeader.html#decodeBlockHeight"><span class="hs-identifier hs-type">decodeBlockHeight</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadGet</span></span><span> </span><span class="annot"><a href="#local-6989586621681480984"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681480984"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Chainweb.BlockHeader.html#BlockHeight"><span class="hs-identifier hs-type">BlockHeight</span></a></span></span><span>
</span><span id="line-203"></span><span id="decodeBlockHeight"><span class="annot"><span class="annottext">decodeBlockHeight :: m BlockHeight
</span><a href="Chainweb.BlockHeader.html#decodeBlockHeight"><span class="hs-identifier hs-var hs-var">decodeBlockHeight</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; BlockHeight
</span><a href="Chainweb.BlockHeader.html#BlockHeight"><span class="hs-identifier hs-var">BlockHeight</span></a></span><span> </span><span class="annot"><span class="annottext">(Word64 -&gt; BlockHeight) -&gt; m Word64 -&gt; m BlockHeight
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">m Word64
forall (m :: * -&gt; *). MonadGet m =&gt; m Word64
</span><span class="hs-identifier hs-var">getWord64le</span></span><span>
</span><span id="line-204"></span><span>
</span><span id="line-205"></span><span id="local-6989586621681480981"><span class="annot"><a href="Chainweb.BlockHeader.html#encodeBlockHeightBe"><span class="hs-identifier hs-type">encodeBlockHeightBe</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadPut</span></span><span> </span><span class="annot"><a href="#local-6989586621681480981"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Chainweb.BlockHeader.html#BlockHeight"><span class="hs-identifier hs-type">BlockHeight</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681480981"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-206"></span><span id="encodeBlockHeightBe"><span class="annot"><span class="annottext">encodeBlockHeightBe :: BlockHeight -&gt; m ()
</span><a href="Chainweb.BlockHeader.html#encodeBlockHeightBe"><span class="hs-identifier hs-var hs-var">encodeBlockHeightBe</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Chainweb.BlockHeader.html#BlockHeight"><span class="hs-identifier hs-type">BlockHeight</span></a></span><span> </span><span id="local-6989586621681480980"><span class="annot"><span class="annottext">r :: Word64
</span><a href="#local-6989586621681480980"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; m ()
forall (m :: * -&gt; *). MonadPut m =&gt; Word64 -&gt; m ()
</span><span class="hs-identifier hs-var">putWord64be</span></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621681480980"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-207"></span><span>
</span><span id="line-208"></span><span id="local-6989586621681480978"><span class="annot"><a href="Chainweb.BlockHeader.html#decodeBlockHeightBe"><span class="hs-identifier hs-type">decodeBlockHeightBe</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadGet</span></span><span> </span><span class="annot"><a href="#local-6989586621681480978"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681480978"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Chainweb.BlockHeader.html#BlockHeight"><span class="hs-identifier hs-type">BlockHeight</span></a></span></span><span>
</span><span id="line-209"></span><span id="decodeBlockHeightBe"><span class="annot"><span class="annottext">decodeBlockHeightBe :: m BlockHeight
</span><a href="Chainweb.BlockHeader.html#decodeBlockHeightBe"><span class="hs-identifier hs-var hs-var">decodeBlockHeightBe</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; BlockHeight
</span><a href="Chainweb.BlockHeader.html#BlockHeight"><span class="hs-identifier hs-var">BlockHeight</span></a></span><span> </span><span class="annot"><span class="annottext">(Word64 -&gt; BlockHeight) -&gt; m Word64 -&gt; m BlockHeight
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">m Word64
forall (m :: * -&gt; *). MonadGet m =&gt; m Word64
</span><span class="hs-identifier hs-var">getWord64be</span></span><span>
</span><span id="line-210"></span><span>
</span><span id="line-211"></span><span class="hs-comment">-- -------------------------------------------------------------------------- --</span><span>
</span><span id="line-212"></span><span class="hs-comment">-- Block Weight</span><span>
</span><span id="line-213"></span><span class="hs-comment">--</span><span>
</span><span id="line-214"></span><span class="hs-comment">-- This is the accumulated Hash difficulty</span><span>
</span><span id="line-215"></span><span class="hs-comment">--</span><span>
</span><span id="line-216"></span><span id="local-6989586621681480975"><span id="local-6989586621681480976"></span></span><span class="hs-keyword">newtype</span><span> </span><span id="BlockWeight"><span class="annot"><a href="Chainweb.BlockHeader.html#BlockWeight"><span class="hs-identifier hs-var">BlockWeight</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="BlockWeight"><span class="annot"><a href="Chainweb.BlockHeader.html#BlockWeight"><span class="hs-identifier hs-var">BlockWeight</span></a></span></span><span> </span><span class="annot"><a href="Chainweb.Difficulty.html#HashDifficulty"><span class="hs-identifier hs-type">HashDifficulty</span></a></span><span>
</span><span id="line-217"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681480968"><span id="local-6989586621681480970"><span id="local-6989586621681480972"><span class="annot"><span class="annottext">Int -&gt; BlockWeight -&gt; ShowS
[BlockWeight] -&gt; ShowS
BlockWeight -&gt; String
(Int -&gt; BlockWeight -&gt; ShowS)
-&gt; (BlockWeight -&gt; String)
-&gt; ([BlockWeight] -&gt; ShowS)
-&gt; Show BlockWeight
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [BlockWeight] -&gt; ShowS
$cshowList :: [BlockWeight] -&gt; ShowS
show :: BlockWeight -&gt; String
$cshow :: BlockWeight -&gt; String
showsPrec :: Int -&gt; BlockWeight -&gt; ShowS
$cshowsPrec :: Int -&gt; BlockWeight -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681480964"><span id="local-6989586621681480966"><span class="annot"><span class="annottext">BlockWeight -&gt; BlockWeight -&gt; Bool
(BlockWeight -&gt; BlockWeight -&gt; Bool)
-&gt; (BlockWeight -&gt; BlockWeight -&gt; Bool) -&gt; Eq BlockWeight
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: BlockWeight -&gt; BlockWeight -&gt; Bool
$c/= :: BlockWeight -&gt; BlockWeight -&gt; Bool
== :: BlockWeight -&gt; BlockWeight -&gt; Bool
$c== :: BlockWeight -&gt; BlockWeight -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681480949"><span id="local-6989586621681480951"><span id="local-6989586621681480953"><span id="local-6989586621681480955"><span id="local-6989586621681480957"><span id="local-6989586621681480959"><span id="local-6989586621681480961"><span class="annot"><span class="annottext">Eq BlockWeight
Eq BlockWeight =&gt;
(BlockWeight -&gt; BlockWeight -&gt; Ordering)
-&gt; (BlockWeight -&gt; BlockWeight -&gt; Bool)
-&gt; (BlockWeight -&gt; BlockWeight -&gt; Bool)
-&gt; (BlockWeight -&gt; BlockWeight -&gt; Bool)
-&gt; (BlockWeight -&gt; BlockWeight -&gt; Bool)
-&gt; (BlockWeight -&gt; BlockWeight -&gt; BlockWeight)
-&gt; (BlockWeight -&gt; BlockWeight -&gt; BlockWeight)
-&gt; Ord BlockWeight
BlockWeight -&gt; BlockWeight -&gt; Bool
BlockWeight -&gt; BlockWeight -&gt; Ordering
BlockWeight -&gt; BlockWeight -&gt; BlockWeight
forall a.
Eq a =&gt;
(a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
min :: BlockWeight -&gt; BlockWeight -&gt; BlockWeight
$cmin :: BlockWeight -&gt; BlockWeight -&gt; BlockWeight
max :: BlockWeight -&gt; BlockWeight -&gt; BlockWeight
$cmax :: BlockWeight -&gt; BlockWeight -&gt; BlockWeight
&gt;= :: BlockWeight -&gt; BlockWeight -&gt; Bool
$c&gt;= :: BlockWeight -&gt; BlockWeight -&gt; Bool
&gt; :: BlockWeight -&gt; BlockWeight -&gt; Bool
$c&gt; :: BlockWeight -&gt; BlockWeight -&gt; Bool
&lt;= :: BlockWeight -&gt; BlockWeight -&gt; Bool
$c&lt;= :: BlockWeight -&gt; BlockWeight -&gt; Bool
&lt; :: BlockWeight -&gt; BlockWeight -&gt; Bool
$c&lt; :: BlockWeight -&gt; BlockWeight -&gt; Bool
compare :: BlockWeight -&gt; BlockWeight -&gt; Ordering
$ccompare :: BlockWeight -&gt; BlockWeight -&gt; Ordering
$cp1Ord :: Eq BlockWeight
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(forall x. BlockWeight -&gt; Rep BlockWeight x)
-&gt; (forall x. Rep BlockWeight x -&gt; BlockWeight)
-&gt; Generic BlockWeight
forall x. Rep BlockWeight x -&gt; BlockWeight
forall x. BlockWeight -&gt; Rep BlockWeight x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
$cto :: forall x. Rep BlockWeight x -&gt; BlockWeight
$cfrom :: forall x. BlockWeight -&gt; Rep BlockWeight x
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">Generic</span></span><span class="hs-special">)</span><span>
</span><span id="line-218"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">anyclass</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621681480945"><span class="annot"><span class="annottext">BlockWeight -&gt; ()
(BlockWeight -&gt; ()) -&gt; NFData BlockWeight
forall a. (a -&gt; ()) -&gt; NFData a
rnf :: BlockWeight -&gt; ()
$crnf :: BlockWeight -&gt; ()
</span><a href="#local-6989586621681480945"><span class="hs-identifier hs-var hs-var hs-var hs-var">NFData</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-219"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">newtype</span></span><span>
</span><span id="line-220"></span><span>        </span><span class="hs-special">(</span><span> </span><span id="local-6989586621681480941"><span id="local-6989586621681480943"><span class="annot"><span class="annottext">Int -&gt; BlockWeight -&gt; Int
BlockWeight -&gt; Int
(Int -&gt; BlockWeight -&gt; Int)
-&gt; (BlockWeight -&gt; Int) -&gt; Hashable BlockWeight
forall a. (Int -&gt; a -&gt; Int) -&gt; (a -&gt; Int) -&gt; Hashable a
hash :: BlockWeight -&gt; Int
$chash :: BlockWeight -&gt; Int
hashWithSalt :: Int -&gt; BlockWeight -&gt; Int
$chashWithSalt :: Int -&gt; BlockWeight -&gt; Int
</span><a href="#local-6989586621681480941"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Hashable</span></a></span></span></span><span>
</span><span id="line-221"></span><span>        </span><span class="hs-special">,</span><span> </span><span id="local-6989586621681480933"><span id="local-6989586621681480935"><span id="local-6989586621681480937"><span id="local-6989586621681480939"><span class="annot"><span class="annottext">[BlockWeight] -&gt; Encoding
[BlockWeight] -&gt; Value
BlockWeight -&gt; Encoding
BlockWeight -&gt; Value
(BlockWeight -&gt; Value)
-&gt; (BlockWeight -&gt; Encoding)
-&gt; ([BlockWeight] -&gt; Value)
-&gt; ([BlockWeight] -&gt; Encoding)
-&gt; ToJSON BlockWeight
forall a.
(a -&gt; Value)
-&gt; (a -&gt; Encoding)
-&gt; ([a] -&gt; Value)
-&gt; ([a] -&gt; Encoding)
-&gt; ToJSON a
toEncodingList :: [BlockWeight] -&gt; Encoding
$ctoEncodingList :: [BlockWeight] -&gt; Encoding
toJSONList :: [BlockWeight] -&gt; Value
$ctoJSONList :: [BlockWeight] -&gt; Value
toEncoding :: BlockWeight -&gt; Encoding
$ctoEncoding :: BlockWeight -&gt; Encoding
toJSON :: BlockWeight -&gt; Value
$ctoJSON :: BlockWeight -&gt; Value
</span><a href="#local-6989586621681480933"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">ToJSON</span></a></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681480929"><span id="local-6989586621681480931"><span class="annot"><span class="annottext">Value -&gt; Parser [BlockWeight]
Value -&gt; Parser BlockWeight
(Value -&gt; Parser BlockWeight)
-&gt; (Value -&gt; Parser [BlockWeight]) -&gt; FromJSON BlockWeight
forall a.
(Value -&gt; Parser a) -&gt; (Value -&gt; Parser [a]) -&gt; FromJSON a
parseJSONList :: Value -&gt; Parser [BlockWeight]
$cparseJSONList :: Value -&gt; Parser [BlockWeight]
parseJSON :: Value -&gt; Parser BlockWeight
$cparseJSON :: Value -&gt; Parser BlockWeight
</span><a href="#local-6989586621681480929"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">FromJSON</span></a></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681480925"><span id="local-6989586621681480927"><span class="annot"><span class="annottext">ToJSONKeyFunction [BlockWeight]
ToJSONKeyFunction BlockWeight
ToJSONKeyFunction BlockWeight
-&gt; ToJSONKeyFunction [BlockWeight] -&gt; ToJSONKey BlockWeight
forall a.
ToJSONKeyFunction a -&gt; ToJSONKeyFunction [a] -&gt; ToJSONKey a
toJSONKeyList :: ToJSONKeyFunction [BlockWeight]
$ctoJSONKeyList :: ToJSONKeyFunction [BlockWeight]
toJSONKey :: ToJSONKeyFunction BlockWeight
$ctoJSONKey :: ToJSONKeyFunction BlockWeight
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">ToJSONKey</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681480920"><span id="local-6989586621681480922"><span class="annot"><span class="annottext">FromJSONKeyFunction [BlockWeight]
FromJSONKeyFunction BlockWeight
FromJSONKeyFunction BlockWeight
-&gt; FromJSONKeyFunction [BlockWeight] -&gt; FromJSONKey BlockWeight
forall a.
FromJSONKeyFunction a -&gt; FromJSONKeyFunction [a] -&gt; FromJSONKey a
fromJSONKeyList :: FromJSONKeyFunction [BlockWeight]
$cfromJSONKeyList :: FromJSONKeyFunction [BlockWeight]
fromJSONKey :: FromJSONKeyFunction BlockWeight
$cfromJSONKey :: FromJSONKeyFunction BlockWeight
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">FromJSONKey</span></span></span></span><span>
</span><span id="line-222"></span><span>        </span><span class="hs-special">,</span><span> </span><span id="local-6989586621681480917"><span class="annot"><span class="annottext">BlockWeight -&gt; BlockWeight -&gt; BlockWeight
(BlockWeight -&gt; BlockWeight -&gt; BlockWeight)
-&gt; AdditiveSemigroup BlockWeight
forall g. (g -&gt; g -&gt; g) -&gt; AdditiveSemigroup g
plus :: BlockWeight -&gt; BlockWeight -&gt; BlockWeight
$cplus :: BlockWeight -&gt; BlockWeight -&gt; BlockWeight
</span><a href="#local-6989586621681480917"><span class="hs-identifier hs-var hs-var hs-var hs-var">AdditiveSemigroup</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">AdditiveSemigroup BlockWeight
AdditiveSemigroup BlockWeight =&gt;
AdditiveAbelianSemigroup BlockWeight
forall g. AdditiveSemigroup g =&gt; AdditiveAbelianSemigroup g
</span><a href="#local-6989586621681480916"><span class="hs-identifier hs-var hs-var hs-var">AdditiveAbelianSemigroup</span></a></span><span>
</span><span id="line-223"></span><span>        </span><span class="hs-special">,</span><span> </span><span id="local-6989586621681480902"><span id="local-6989586621681480904"><span id="local-6989586621681480906"><span id="local-6989586621681480908"><span id="local-6989586621681480910"><span id="local-6989586621681480912"><span id="local-6989586621681480914"><span class="annot"><span class="annottext">Integer -&gt; BlockWeight
BlockWeight -&gt; BlockWeight
BlockWeight -&gt; BlockWeight -&gt; BlockWeight
(BlockWeight -&gt; BlockWeight -&gt; BlockWeight)
-&gt; (BlockWeight -&gt; BlockWeight -&gt; BlockWeight)
-&gt; (BlockWeight -&gt; BlockWeight -&gt; BlockWeight)
-&gt; (BlockWeight -&gt; BlockWeight)
-&gt; (BlockWeight -&gt; BlockWeight)
-&gt; (BlockWeight -&gt; BlockWeight)
-&gt; (Integer -&gt; BlockWeight)
-&gt; Num BlockWeight
forall a.
(a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a)
-&gt; (a -&gt; a)
-&gt; (a -&gt; a)
-&gt; (Integer -&gt; a)
-&gt; Num a
fromInteger :: Integer -&gt; BlockWeight
$cfromInteger :: Integer -&gt; BlockWeight
signum :: BlockWeight -&gt; BlockWeight
$csignum :: BlockWeight -&gt; BlockWeight
abs :: BlockWeight -&gt; BlockWeight
$cabs :: BlockWeight -&gt; BlockWeight
negate :: BlockWeight -&gt; BlockWeight
$cnegate :: BlockWeight -&gt; BlockWeight
* :: BlockWeight -&gt; BlockWeight -&gt; BlockWeight
$c* :: BlockWeight -&gt; BlockWeight -&gt; BlockWeight
- :: BlockWeight -&gt; BlockWeight -&gt; BlockWeight
$c- :: BlockWeight -&gt; BlockWeight -&gt; BlockWeight
+ :: BlockWeight -&gt; BlockWeight -&gt; BlockWeight
$c+ :: BlockWeight -&gt; BlockWeight -&gt; BlockWeight
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Num</span></span></span></span></span></span></span></span></span><span>
</span><span id="line-224"></span><span>        </span><span class="hs-special">)</span><span>
</span><span id="line-225"></span><span>
</span><span id="line-226"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Chainweb.Crypto.MerkleLog.html#IsMerkleLogEntry"><span class="hs-identifier hs-type">IsMerkleLogEntry</span></a></span><span> </span><span class="annot"><a href="Chainweb.MerkleUniverse.html#ChainwebHashTag"><span class="hs-identifier hs-type">ChainwebHashTag</span></a></span><span> </span><span class="annot"><a href="Chainweb.BlockHeader.html#BlockWeight"><span class="hs-identifier hs-type">BlockWeight</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-227"></span><span>    </span><span class="hs-keyword">type</span><span> </span><span id="Tag"><span class="annot"><a href="Chainweb.Crypto.MerkleLog.html#Tag"><span class="hs-identifier hs-var">Tag</span></a></span></span><span> </span><span class="annot"><a href="Chainweb.BlockHeader.html#BlockWeight"><span class="hs-identifier hs-type">BlockWeight</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Chainweb.MerkleUniverse.html#BlockWeightTag"><span class="hs-identifier hs-type">BlockWeightTag</span></a></span><span>
</span><span id="line-228"></span><span>    </span><span id="local-6989586621681480897"><span class="annot"><span class="annottext">toMerkleNode :: BlockWeight -&gt; MerkleNodeType (HashAlg ChainwebHashTag) ByteString
</span><a href="#local-6989586621681480897"><span class="hs-identifier hs-var hs-var hs-var hs-var">toMerkleNode</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall (m :: * -&gt; *). MonadPut m =&gt; BlockWeight -&gt; m ())
-&gt; BlockWeight -&gt; MerkleNodeType SHA512t_256 ByteString
forall b a.
(forall (m :: * -&gt; *). MonadPut m =&gt; b -&gt; m ())
-&gt; b -&gt; MerkleNodeType a ByteString
</span><a href="Chainweb.Crypto.MerkleLog.html#encodeMerkleInputNode"><span class="hs-identifier hs-var">encodeMerkleInputNode</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). MonadPut m =&gt; BlockWeight -&gt; m ()
</span><a href="Chainweb.BlockHeader.html#encodeBlockWeight"><span class="hs-identifier hs-var">encodeBlockWeight</span></a></span><span>
</span><span id="line-229"></span><span>    </span><span id="local-6989586621681480896"><span class="annot"><span class="annottext">fromMerkleNode :: MerkleNodeType (HashAlg ChainwebHashTag) ByteString
-&gt; Either SomeException BlockWeight
</span><a href="#local-6989586621681480896"><span class="hs-identifier hs-var hs-var hs-var hs-var">fromMerkleNode</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall (n :: * -&gt; *). MonadGet n =&gt; n BlockWeight)
-&gt; MerkleNodeType SHA512t_256 ByteString
-&gt; Either SomeException BlockWeight
forall (m :: * -&gt; *) b a.
MonadThrow m =&gt;
(forall (n :: * -&gt; *). MonadGet n =&gt; n b)
-&gt; MerkleNodeType a ByteString -&gt; m b
</span><a href="Chainweb.Crypto.MerkleLog.html#decodeMerkleInputNode"><span class="hs-identifier hs-var">decodeMerkleInputNode</span></a></span><span> </span><span class="annot"><span class="annottext">forall (n :: * -&gt; *). MonadGet n =&gt; n BlockWeight
</span><a href="Chainweb.BlockHeader.html#decodeBlockWeight"><span class="hs-identifier hs-var">decodeBlockWeight</span></a></span><span>
</span><span id="line-230"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Chainweb.Crypto.MerkleLog.html#toMerkleNode"><span class="hs-pragma hs-type">toMerkleNode</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-231"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Chainweb.Crypto.MerkleLog.html#fromMerkleNode"><span class="hs-pragma hs-type">fromMerkleNode</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-232"></span><span>
</span><span id="line-233"></span><span id="local-6989586621681480895"><span class="annot"><a href="Chainweb.BlockHeader.html#encodeBlockWeight"><span class="hs-identifier hs-type">encodeBlockWeight</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadPut</span></span><span> </span><span class="annot"><a href="#local-6989586621681480895"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Chainweb.BlockHeader.html#BlockWeight"><span class="hs-identifier hs-type">BlockWeight</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681480895"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-234"></span><span id="encodeBlockWeight"><span class="annot"><span class="annottext">encodeBlockWeight :: BlockWeight -&gt; m ()
</span><a href="Chainweb.BlockHeader.html#encodeBlockWeight"><span class="hs-identifier hs-var hs-var">encodeBlockWeight</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Chainweb.BlockHeader.html#BlockWeight"><span class="hs-identifier hs-type">BlockWeight</span></a></span><span> </span><span id="local-6989586621681480894"><span class="annot"><span class="annottext">w :: HashDifficulty
</span><a href="#local-6989586621681480894"><span class="hs-identifier hs-var">w</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HashDifficulty -&gt; m ()
forall (m :: * -&gt; *). MonadPut m =&gt; HashDifficulty -&gt; m ()
</span><a href="Chainweb.Difficulty.html#encodeHashDifficulty"><span class="hs-identifier hs-var">encodeHashDifficulty</span></a></span><span> </span><span class="annot"><span class="annottext">HashDifficulty
</span><a href="#local-6989586621681480894"><span class="hs-identifier hs-var">w</span></a></span><span>
</span><span id="line-235"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Chainweb.BlockHeader.html#encodeBlockWeight"><span class="hs-pragma hs-type">encodeBlockWeight</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-236"></span><span>
</span><span id="line-237"></span><span id="local-6989586621681480892"><span class="annot"><a href="Chainweb.BlockHeader.html#decodeBlockWeight"><span class="hs-identifier hs-type">decodeBlockWeight</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadGet</span></span><span> </span><span class="annot"><a href="#local-6989586621681480892"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681480892"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Chainweb.BlockHeader.html#BlockWeight"><span class="hs-identifier hs-type">BlockWeight</span></a></span></span><span>
</span><span id="line-238"></span><span id="decodeBlockWeight"><span class="annot"><span class="annottext">decodeBlockWeight :: m BlockWeight
</span><a href="Chainweb.BlockHeader.html#decodeBlockWeight"><span class="hs-identifier hs-var hs-var">decodeBlockWeight</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HashDifficulty -&gt; BlockWeight
</span><a href="Chainweb.BlockHeader.html#BlockWeight"><span class="hs-identifier hs-var">BlockWeight</span></a></span><span> </span><span class="annot"><span class="annottext">(HashDifficulty -&gt; BlockWeight)
-&gt; m HashDifficulty -&gt; m BlockWeight
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">m HashDifficulty
forall (m :: * -&gt; *). MonadGet m =&gt; m HashDifficulty
</span><a href="Chainweb.Difficulty.html#decodeHashDifficulty"><span class="hs-identifier hs-var">decodeHashDifficulty</span></a></span><span>
</span><span id="line-239"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Chainweb.BlockHeader.html#decodeBlockWeight"><span class="hs-pragma hs-type">decodeBlockWeight</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-240"></span><span>
</span><span id="line-241"></span><span id="local-6989586621681480890"><span class="annot"><a href="Chainweb.BlockHeader.html#encodeBlockWeightBe"><span class="hs-identifier hs-type">encodeBlockWeightBe</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadPut</span></span><span> </span><span class="annot"><a href="#local-6989586621681480890"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Chainweb.BlockHeader.html#BlockWeight"><span class="hs-identifier hs-type">BlockWeight</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681480890"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-242"></span><span id="encodeBlockWeightBe"><span class="annot"><span class="annottext">encodeBlockWeightBe :: BlockWeight -&gt; m ()
</span><a href="Chainweb.BlockHeader.html#encodeBlockWeightBe"><span class="hs-identifier hs-var hs-var">encodeBlockWeightBe</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Chainweb.BlockHeader.html#BlockWeight"><span class="hs-identifier hs-type">BlockWeight</span></a></span><span> </span><span id="local-6989586621681480889"><span class="annot"><span class="annottext">w :: HashDifficulty
</span><a href="#local-6989586621681480889"><span class="hs-identifier hs-var">w</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HashDifficulty -&gt; m ()
forall (m :: * -&gt; *). MonadPut m =&gt; HashDifficulty -&gt; m ()
</span><a href="Chainweb.Difficulty.html#encodeHashDifficultyBe"><span class="hs-identifier hs-var">encodeHashDifficultyBe</span></a></span><span> </span><span class="annot"><span class="annottext">HashDifficulty
</span><a href="#local-6989586621681480889"><span class="hs-identifier hs-var">w</span></a></span><span>
</span><span id="line-243"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Chainweb.BlockHeader.html#encodeBlockWeightBe"><span class="hs-pragma hs-type">encodeBlockWeightBe</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-244"></span><span>
</span><span id="line-245"></span><span id="local-6989586621681480887"><span class="annot"><a href="Chainweb.BlockHeader.html#decodeBlockWeightBe"><span class="hs-identifier hs-type">decodeBlockWeightBe</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadGet</span></span><span> </span><span class="annot"><a href="#local-6989586621681480887"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681480887"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Chainweb.BlockHeader.html#BlockWeight"><span class="hs-identifier hs-type">BlockWeight</span></a></span></span><span>
</span><span id="line-246"></span><span id="decodeBlockWeightBe"><span class="annot"><span class="annottext">decodeBlockWeightBe :: m BlockWeight
</span><a href="Chainweb.BlockHeader.html#decodeBlockWeightBe"><span class="hs-identifier hs-var hs-var">decodeBlockWeightBe</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HashDifficulty -&gt; BlockWeight
</span><a href="Chainweb.BlockHeader.html#BlockWeight"><span class="hs-identifier hs-var">BlockWeight</span></a></span><span> </span><span class="annot"><span class="annottext">(HashDifficulty -&gt; BlockWeight)
-&gt; m HashDifficulty -&gt; m BlockWeight
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">m HashDifficulty
forall (m :: * -&gt; *). MonadGet m =&gt; m HashDifficulty
</span><a href="Chainweb.Difficulty.html#decodeHashDifficultyBe"><span class="hs-identifier hs-var">decodeHashDifficultyBe</span></a></span><span>
</span><span id="line-247"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Chainweb.BlockHeader.html#decodeBlockWeightBe"><span class="hs-pragma hs-type">decodeBlockWeightBe</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-248"></span><span>
</span><span id="line-249"></span><span class="hs-comment">-- -------------------------------------------------------------------------- --</span><span>
</span><span id="line-250"></span><span class="hs-comment">-- Nonce</span><span>
</span><span id="line-251"></span><span>
</span><span id="line-252"></span><span class="hs-comment">-- | FIXME: is 64 bit enough for the nonce. It seems that it may not be</span><span>
</span><span id="line-253"></span><span class="hs-comment">-- sufficient for the current hashpower of the bitcoin network.</span><span>
</span><span id="line-254"></span><span class="hs-comment">--</span><span>
</span><span id="line-255"></span><span id="local-6989586621681480884"><span id="local-6989586621681480885"></span></span><span class="hs-keyword">newtype</span><span> </span><span id="Nonce"><span class="annot"><a href="Chainweb.BlockHeader.html#Nonce"><span class="hs-identifier hs-var">Nonce</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Nonce"><span class="annot"><a href="Chainweb.BlockHeader.html#Nonce"><span class="hs-identifier hs-var">Nonce</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word64</span></span><span>
</span><span id="line-256"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">stock</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621681480877"><span id="local-6989586621681480879"><span id="local-6989586621681480881"><span class="annot"><span class="annottext">Int -&gt; Nonce -&gt; ShowS
[Nonce] -&gt; ShowS
Nonce -&gt; String
(Int -&gt; Nonce -&gt; ShowS)
-&gt; (Nonce -&gt; String) -&gt; ([Nonce] -&gt; ShowS) -&gt; Show Nonce
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [Nonce] -&gt; ShowS
$cshowList :: [Nonce] -&gt; ShowS
show :: Nonce -&gt; String
$cshow :: Nonce -&gt; String
showsPrec :: Int -&gt; Nonce -&gt; ShowS
$cshowsPrec :: Int -&gt; Nonce -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681480873"><span id="local-6989586621681480875"><span class="annot"><span class="annottext">Nonce -&gt; Nonce -&gt; Bool
(Nonce -&gt; Nonce -&gt; Bool) -&gt; (Nonce -&gt; Nonce -&gt; Bool) -&gt; Eq Nonce
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: Nonce -&gt; Nonce -&gt; Bool
$c/= :: Nonce -&gt; Nonce -&gt; Bool
== :: Nonce -&gt; Nonce -&gt; Bool
$c== :: Nonce -&gt; Nonce -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681480858"><span id="local-6989586621681480860"><span id="local-6989586621681480862"><span id="local-6989586621681480864"><span id="local-6989586621681480866"><span id="local-6989586621681480868"><span id="local-6989586621681480870"><span class="annot"><span class="annottext">Eq Nonce
Eq Nonce =&gt;
(Nonce -&gt; Nonce -&gt; Ordering)
-&gt; (Nonce -&gt; Nonce -&gt; Bool)
-&gt; (Nonce -&gt; Nonce -&gt; Bool)
-&gt; (Nonce -&gt; Nonce -&gt; Bool)
-&gt; (Nonce -&gt; Nonce -&gt; Bool)
-&gt; (Nonce -&gt; Nonce -&gt; Nonce)
-&gt; (Nonce -&gt; Nonce -&gt; Nonce)
-&gt; Ord Nonce
Nonce -&gt; Nonce -&gt; Bool
Nonce -&gt; Nonce -&gt; Ordering
Nonce -&gt; Nonce -&gt; Nonce
forall a.
Eq a =&gt;
(a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
min :: Nonce -&gt; Nonce -&gt; Nonce
$cmin :: Nonce -&gt; Nonce -&gt; Nonce
max :: Nonce -&gt; Nonce -&gt; Nonce
$cmax :: Nonce -&gt; Nonce -&gt; Nonce
&gt;= :: Nonce -&gt; Nonce -&gt; Bool
$c&gt;= :: Nonce -&gt; Nonce -&gt; Bool
&gt; :: Nonce -&gt; Nonce -&gt; Bool
$c&gt; :: Nonce -&gt; Nonce -&gt; Bool
&lt;= :: Nonce -&gt; Nonce -&gt; Bool
$c&lt;= :: Nonce -&gt; Nonce -&gt; Bool
&lt; :: Nonce -&gt; Nonce -&gt; Bool
$c&lt; :: Nonce -&gt; Nonce -&gt; Bool
compare :: Nonce -&gt; Nonce -&gt; Ordering
$ccompare :: Nonce -&gt; Nonce -&gt; Ordering
$cp1Ord :: Eq Nonce
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(forall x. Nonce -&gt; Rep Nonce x)
-&gt; (forall x. Rep Nonce x -&gt; Nonce) -&gt; Generic Nonce
forall x. Rep Nonce x -&gt; Nonce
forall x. Nonce -&gt; Rep Nonce x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
$cto :: forall x. Rep Nonce x -&gt; Nonce
$cfrom :: forall x. Nonce -&gt; Rep Nonce x
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">Generic</span></span><span class="hs-special">)</span><span>
</span><span id="line-257"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">anyclass</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621681480854"><span class="annot"><span class="annottext">Nonce -&gt; ()
(Nonce -&gt; ()) -&gt; NFData Nonce
forall a. (a -&gt; ()) -&gt; NFData a
rnf :: Nonce -&gt; ()
$crnf :: Nonce -&gt; ()
</span><a href="#local-6989586621681480854"><span class="hs-identifier hs-var hs-var hs-var hs-var">NFData</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-258"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">newtype</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621681480850"><span id="local-6989586621681480852"><span class="annot"><span class="annottext">Int -&gt; Nonce -&gt; Int
Nonce -&gt; Int
(Int -&gt; Nonce -&gt; Int) -&gt; (Nonce -&gt; Int) -&gt; Hashable Nonce
forall a. (Int -&gt; a -&gt; Int) -&gt; (a -&gt; Int) -&gt; Hashable a
hash :: Nonce -&gt; Int
$chash :: Nonce -&gt; Int
hashWithSalt :: Int -&gt; Nonce -&gt; Int
$chashWithSalt :: Int -&gt; Nonce -&gt; Int
</span><a href="#local-6989586621681480850"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Hashable</span></a></span></span></span><span class="hs-special">,</span><span id="local-6989586621681480834"><span id="local-6989586621681480836"><span id="local-6989586621681480838"><span id="local-6989586621681480840"><span id="local-6989586621681480842"><span id="local-6989586621681480844"><span id="local-6989586621681480846"><span id="local-6989586621681480848"><span class="annot"><span class="annottext">Int -&gt; Nonce
Nonce -&gt; Int
Nonce -&gt; [Nonce]
Nonce -&gt; Nonce
Nonce -&gt; Nonce -&gt; [Nonce]
Nonce -&gt; Nonce -&gt; Nonce -&gt; [Nonce]
(Nonce -&gt; Nonce)
-&gt; (Nonce -&gt; Nonce)
-&gt; (Int -&gt; Nonce)
-&gt; (Nonce -&gt; Int)
-&gt; (Nonce -&gt; [Nonce])
-&gt; (Nonce -&gt; Nonce -&gt; [Nonce])
-&gt; (Nonce -&gt; Nonce -&gt; [Nonce])
-&gt; (Nonce -&gt; Nonce -&gt; Nonce -&gt; [Nonce])
-&gt; Enum Nonce
forall a.
(a -&gt; a)
-&gt; (a -&gt; a)
-&gt; (Int -&gt; a)
-&gt; (a -&gt; Int)
-&gt; (a -&gt; [a])
-&gt; (a -&gt; a -&gt; [a])
-&gt; (a -&gt; a -&gt; [a])
-&gt; (a -&gt; a -&gt; a -&gt; [a])
-&gt; Enum a
enumFromThenTo :: Nonce -&gt; Nonce -&gt; Nonce -&gt; [Nonce]
$cenumFromThenTo :: Nonce -&gt; Nonce -&gt; Nonce -&gt; [Nonce]
enumFromTo :: Nonce -&gt; Nonce -&gt; [Nonce]
$cenumFromTo :: Nonce -&gt; Nonce -&gt; [Nonce]
enumFromThen :: Nonce -&gt; Nonce -&gt; [Nonce]
$cenumFromThen :: Nonce -&gt; Nonce -&gt; [Nonce]
enumFrom :: Nonce -&gt; [Nonce]
$cenumFrom :: Nonce -&gt; [Nonce]
fromEnum :: Nonce -&gt; Int
$cfromEnum :: Nonce -&gt; Int
toEnum :: Int -&gt; Nonce
$ctoEnum :: Int -&gt; Nonce
pred :: Nonce -&gt; Nonce
$cpred :: Nonce -&gt; Nonce
succ :: Nonce -&gt; Nonce
$csucc :: Nonce -&gt; Nonce
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Enum</span></span></span></span></span></span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-259"></span><span>
</span><span id="line-260"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Chainweb.Crypto.MerkleLog.html#IsMerkleLogEntry"><span class="hs-identifier hs-type">IsMerkleLogEntry</span></a></span><span> </span><span class="annot"><a href="Chainweb.MerkleUniverse.html#ChainwebHashTag"><span class="hs-identifier hs-type">ChainwebHashTag</span></a></span><span> </span><span class="annot"><a href="Chainweb.BlockHeader.html#Nonce"><span class="hs-identifier hs-type">Nonce</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-261"></span><span>    </span><span class="hs-keyword">type</span><span> </span><span id="Tag"><span class="annot"><a href="Chainweb.Crypto.MerkleLog.html#Tag"><span class="hs-identifier hs-var">Tag</span></a></span></span><span> </span><span class="annot"><a href="Chainweb.BlockHeader.html#Nonce"><span class="hs-identifier hs-type">Nonce</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Chainweb.MerkleUniverse.html#BlockNonceTag"><span class="hs-identifier hs-type">BlockNonceTag</span></a></span><span>
</span><span id="line-262"></span><span>    </span><span id="local-6989586621681480829"><span class="annot"><span class="annottext">toMerkleNode :: Nonce -&gt; MerkleNodeType (HashAlg ChainwebHashTag) ByteString
</span><a href="#local-6989586621681480829"><span class="hs-identifier hs-var hs-var hs-var hs-var">toMerkleNode</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall (m :: * -&gt; *). MonadPut m =&gt; Nonce -&gt; m ())
-&gt; Nonce -&gt; MerkleNodeType SHA512t_256 ByteString
forall b a.
(forall (m :: * -&gt; *). MonadPut m =&gt; b -&gt; m ())
-&gt; b -&gt; MerkleNodeType a ByteString
</span><a href="Chainweb.Crypto.MerkleLog.html#encodeMerkleInputNode"><span class="hs-identifier hs-var">encodeMerkleInputNode</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). MonadPut m =&gt; Nonce -&gt; m ()
</span><a href="Chainweb.BlockHeader.html#encodeNonce"><span class="hs-identifier hs-var">encodeNonce</span></a></span><span>
</span><span id="line-263"></span><span>    </span><span id="local-6989586621681480828"><span class="annot"><span class="annottext">fromMerkleNode :: MerkleNodeType (HashAlg ChainwebHashTag) ByteString
-&gt; Either SomeException Nonce
</span><a href="#local-6989586621681480828"><span class="hs-identifier hs-var hs-var hs-var hs-var">fromMerkleNode</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall (n :: * -&gt; *). MonadGet n =&gt; n Nonce)
-&gt; MerkleNodeType SHA512t_256 ByteString
-&gt; Either SomeException Nonce
forall (m :: * -&gt; *) b a.
MonadThrow m =&gt;
(forall (n :: * -&gt; *). MonadGet n =&gt; n b)
-&gt; MerkleNodeType a ByteString -&gt; m b
</span><a href="Chainweb.Crypto.MerkleLog.html#decodeMerkleInputNode"><span class="hs-identifier hs-var">decodeMerkleInputNode</span></a></span><span> </span><span class="annot"><span class="annottext">forall (n :: * -&gt; *). MonadGet n =&gt; n Nonce
</span><a href="Chainweb.BlockHeader.html#decodeNonce"><span class="hs-identifier hs-var">decodeNonce</span></a></span><span>
</span><span id="line-264"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Chainweb.Crypto.MerkleLog.html#toMerkleNode"><span class="hs-pragma hs-type">toMerkleNode</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-265"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Chainweb.Crypto.MerkleLog.html#fromMerkleNode"><span class="hs-pragma hs-type">fromMerkleNode</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-266"></span><span>
</span><span id="line-267"></span><span id="local-6989586621681480827"><span class="annot"><a href="Chainweb.BlockHeader.html#encodeNonce"><span class="hs-identifier hs-type">encodeNonce</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadPut</span></span><span> </span><span class="annot"><a href="#local-6989586621681480827"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Chainweb.BlockHeader.html#Nonce"><span class="hs-identifier hs-type">Nonce</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681480827"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-268"></span><span id="encodeNonce"><span class="annot"><span class="annottext">encodeNonce :: Nonce -&gt; m ()
</span><a href="Chainweb.BlockHeader.html#encodeNonce"><span class="hs-identifier hs-var hs-var">encodeNonce</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Chainweb.BlockHeader.html#Nonce"><span class="hs-identifier hs-type">Nonce</span></a></span><span> </span><span id="local-6989586621681480826"><span class="annot"><span class="annottext">n :: Word64
</span><a href="#local-6989586621681480826"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; m ()
forall (m :: * -&gt; *). MonadPut m =&gt; Word64 -&gt; m ()
</span><span class="hs-identifier hs-var">putWord64le</span></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621681480826"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-269"></span><span>
</span><span id="line-270"></span><span class="annot"><a href="Chainweb.BlockHeader.html#encodeNonceToWord64"><span class="hs-identifier hs-type">encodeNonceToWord64</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Chainweb.BlockHeader.html#Nonce"><span class="hs-identifier hs-type">Nonce</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word64</span></span><span>
</span><span id="line-271"></span><span id="encodeNonceToWord64"><span class="annot"><span class="annottext">encodeNonceToWord64 :: Nonce -&gt; Word64
</span><a href="Chainweb.BlockHeader.html#encodeNonceToWord64"><span class="hs-identifier hs-var hs-var">encodeNonceToWord64</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Chainweb.BlockHeader.html#Nonce"><span class="hs-identifier hs-type">Nonce</span></a></span><span> </span><span id="local-6989586621681480825"><span class="annot"><span class="annottext">n :: Word64
</span><a href="#local-6989586621681480825"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LE Word64 -&gt; Word64
forall a. LE a -&gt; a
</span><span class="hs-identifier hs-var hs-var">BA.unLE</span></span><span> </span><span class="annot"><span class="annottext">(LE Word64 -&gt; Word64) -&gt; LE Word64 -&gt; Word64
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; LE Word64
forall a. ByteSwap a =&gt; a -&gt; LE a
</span><span class="hs-identifier hs-var">BA.toLE</span></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621681480825"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-272"></span><span>
</span><span id="line-273"></span><span id="local-6989586621681480822"><span class="annot"><a href="Chainweb.BlockHeader.html#decodeNonce"><span class="hs-identifier hs-type">decodeNonce</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadGet</span></span><span> </span><span class="annot"><a href="#local-6989586621681480822"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681480822"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Chainweb.BlockHeader.html#Nonce"><span class="hs-identifier hs-type">Nonce</span></a></span></span><span>
</span><span id="line-274"></span><span id="decodeNonce"><span class="annot"><span class="annottext">decodeNonce :: m Nonce
</span><a href="Chainweb.BlockHeader.html#decodeNonce"><span class="hs-identifier hs-var hs-var">decodeNonce</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Nonce
</span><a href="Chainweb.BlockHeader.html#Nonce"><span class="hs-identifier hs-var">Nonce</span></a></span><span> </span><span class="annot"><span class="annottext">(Word64 -&gt; Nonce) -&gt; m Word64 -&gt; m Nonce
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">m Word64
forall (m :: * -&gt; *). MonadGet m =&gt; m Word64
</span><span class="hs-identifier hs-var">getWord64le</span></span><span>
</span><span id="line-275"></span><span>
</span><span id="line-276"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681480815"><span id="local-6989586621681480817"><span id="local-6989586621681480819"><span class="annot"><span class="hs-identifier hs-type">ToJSON</span></span><span> </span><span class="annot"><a href="Chainweb.BlockHeader.html#Nonce"><span class="hs-identifier hs-type">Nonce</span></a></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-277"></span><span>    </span><span id="local-6989586621681480814"><span class="annot"><span class="annottext">toJSON :: Nonce -&gt; Value
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">toJSON</span></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Chainweb.BlockHeader.html#Nonce"><span class="hs-identifier hs-type">Nonce</span></a></span><span> </span><span id="local-6989586621681480812"><span class="annot"><span class="annottext">i :: Word64
</span><a href="#local-6989586621681480812"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Value
forall a. ToJSON a =&gt; a -&gt; Value
</span><span class="hs-identifier hs-var">toJSON</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Value) -&gt; String -&gt; Value
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621681480812"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-278"></span><span>
</span><span id="line-279"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681480809"><span class="annot"><span class="hs-identifier hs-type">FromJSON</span></span><span> </span><span class="annot"><a href="Chainweb.BlockHeader.html#Nonce"><span class="hs-identifier hs-type">Nonce</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-280"></span><span>    </span><span id="local-6989586621681480808"><span class="annot"><span class="annottext">parseJSON :: Value -&gt; Parser Nonce
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">parseJSON</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; (Text -&gt; Parser Nonce) -&gt; Value -&gt; Parser Nonce
forall a. String -&gt; (Text -&gt; Parser a) -&gt; Value -&gt; Parser a
</span><span class="hs-identifier hs-var">withText</span></span><span> </span><span class="annot"><span class="hs-string">&quot;Nonce&quot;</span></span><span>
</span><span id="line-281"></span><span>        </span><span class="annot"><span class="annottext">((Text -&gt; Parser Nonce) -&gt; Value -&gt; Parser Nonce)
-&gt; (Text -&gt; Parser Nonce) -&gt; Value -&gt; Parser Nonce
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Parser Nonce)
-&gt; (Word64 -&gt; Parser Nonce) -&gt; Either String Word64 -&gt; Parser Nonce
forall a c b. (a -&gt; c) -&gt; (b -&gt; c) -&gt; Either a b -&gt; c
</span><span class="hs-identifier hs-var">either</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Parser Nonce
forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><span class="hs-identifier hs-var">fail</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Nonce -&gt; Parser Nonce
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Nonce -&gt; Parser Nonce)
-&gt; (Word64 -&gt; Nonce) -&gt; Word64 -&gt; Parser Nonce
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Nonce
</span><a href="Chainweb.BlockHeader.html#Nonce"><span class="hs-identifier hs-var">Nonce</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Either String Word64 -&gt; Parser Nonce)
-&gt; (Text -&gt; Either String Word64) -&gt; Text -&gt; Parser Nonce
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Either String Word64
forall a. Read a =&gt; String -&gt; Either String a
</span><span class="hs-identifier hs-var">readEither</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Either String Word64)
-&gt; (Text -&gt; String) -&gt; Text -&gt; Either String Word64
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; String
</span><span class="hs-identifier hs-var">T.unpack</span></span><span>
</span><span id="line-282"></span><span>
</span><span id="line-283"></span><span class="hs-comment">-- -------------------------------------------------------------------------- --</span><span>
</span><span id="line-284"></span><span class="hs-comment">-- Block Creation Time</span><span>
</span><span id="line-285"></span><span>
</span><span id="line-286"></span><span id="local-6989586621681480801"><span id="local-6989586621681480802"></span></span><span class="hs-keyword">newtype</span><span> </span><span id="BlockCreationTime"><span class="annot"><a href="Chainweb.BlockHeader.html#BlockCreationTime"><span class="hs-identifier hs-var">BlockCreationTime</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="BlockCreationTime"><span class="annot"><a href="Chainweb.BlockHeader.html#BlockCreationTime"><span class="hs-identifier hs-var">BlockCreationTime</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="_bct"><span class="annot"><span class="annottext">BlockCreationTime -&gt; Time Micros
</span><a href="Chainweb.BlockHeader.html#_bct"><span class="hs-identifier hs-var hs-var">_bct</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Chainweb.Time.html#Time"><span class="hs-identifier hs-type">Time</span></a></span><span> </span><span class="annot"><a href="Chainweb.Time.html#Micros"><span class="hs-identifier hs-type">Micros</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-287"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">stock</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621681480793"><span id="local-6989586621681480795"><span id="local-6989586621681480797"><span class="annot"><span class="annottext">Int -&gt; BlockCreationTime -&gt; ShowS
[BlockCreationTime] -&gt; ShowS
BlockCreationTime -&gt; String
(Int -&gt; BlockCreationTime -&gt; ShowS)
-&gt; (BlockCreationTime -&gt; String)
-&gt; ([BlockCreationTime] -&gt; ShowS)
-&gt; Show BlockCreationTime
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [BlockCreationTime] -&gt; ShowS
$cshowList :: [BlockCreationTime] -&gt; ShowS
show :: BlockCreationTime -&gt; String
$cshow :: BlockCreationTime -&gt; String
showsPrec :: Int -&gt; BlockCreationTime -&gt; ShowS
$cshowsPrec :: Int -&gt; BlockCreationTime -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681480789"><span id="local-6989586621681480791"><span class="annot"><span class="annottext">BlockCreationTime -&gt; BlockCreationTime -&gt; Bool
(BlockCreationTime -&gt; BlockCreationTime -&gt; Bool)
-&gt; (BlockCreationTime -&gt; BlockCreationTime -&gt; Bool)
-&gt; Eq BlockCreationTime
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: BlockCreationTime -&gt; BlockCreationTime -&gt; Bool
$c/= :: BlockCreationTime -&gt; BlockCreationTime -&gt; Bool
== :: BlockCreationTime -&gt; BlockCreationTime -&gt; Bool
$c== :: BlockCreationTime -&gt; BlockCreationTime -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681480774"><span id="local-6989586621681480776"><span id="local-6989586621681480778"><span id="local-6989586621681480780"><span id="local-6989586621681480782"><span id="local-6989586621681480784"><span id="local-6989586621681480786"><span class="annot"><span class="annottext">Eq BlockCreationTime
Eq BlockCreationTime =&gt;
(BlockCreationTime -&gt; BlockCreationTime -&gt; Ordering)
-&gt; (BlockCreationTime -&gt; BlockCreationTime -&gt; Bool)
-&gt; (BlockCreationTime -&gt; BlockCreationTime -&gt; Bool)
-&gt; (BlockCreationTime -&gt; BlockCreationTime -&gt; Bool)
-&gt; (BlockCreationTime -&gt; BlockCreationTime -&gt; Bool)
-&gt; (BlockCreationTime -&gt; BlockCreationTime -&gt; BlockCreationTime)
-&gt; (BlockCreationTime -&gt; BlockCreationTime -&gt; BlockCreationTime)
-&gt; Ord BlockCreationTime
BlockCreationTime -&gt; BlockCreationTime -&gt; Bool
BlockCreationTime -&gt; BlockCreationTime -&gt; Ordering
BlockCreationTime -&gt; BlockCreationTime -&gt; BlockCreationTime
forall a.
Eq a =&gt;
(a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
min :: BlockCreationTime -&gt; BlockCreationTime -&gt; BlockCreationTime
$cmin :: BlockCreationTime -&gt; BlockCreationTime -&gt; BlockCreationTime
max :: BlockCreationTime -&gt; BlockCreationTime -&gt; BlockCreationTime
$cmax :: BlockCreationTime -&gt; BlockCreationTime -&gt; BlockCreationTime
&gt;= :: BlockCreationTime -&gt; BlockCreationTime -&gt; Bool
$c&gt;= :: BlockCreationTime -&gt; BlockCreationTime -&gt; Bool
&gt; :: BlockCreationTime -&gt; BlockCreationTime -&gt; Bool
$c&gt; :: BlockCreationTime -&gt; BlockCreationTime -&gt; Bool
&lt;= :: BlockCreationTime -&gt; BlockCreationTime -&gt; Bool
$c&lt;= :: BlockCreationTime -&gt; BlockCreationTime -&gt; Bool
&lt; :: BlockCreationTime -&gt; BlockCreationTime -&gt; Bool
$c&lt; :: BlockCreationTime -&gt; BlockCreationTime -&gt; Bool
compare :: BlockCreationTime -&gt; BlockCreationTime -&gt; Ordering
$ccompare :: BlockCreationTime -&gt; BlockCreationTime -&gt; Ordering
$cp1Ord :: Eq BlockCreationTime
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(forall x. BlockCreationTime -&gt; Rep BlockCreationTime x)
-&gt; (forall x. Rep BlockCreationTime x -&gt; BlockCreationTime)
-&gt; Generic BlockCreationTime
forall x. Rep BlockCreationTime x -&gt; BlockCreationTime
forall x. BlockCreationTime -&gt; Rep BlockCreationTime x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
$cto :: forall x. Rep BlockCreationTime x -&gt; BlockCreationTime
$cfrom :: forall x. BlockCreationTime -&gt; Rep BlockCreationTime x
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">Generic</span></span><span class="hs-special">)</span><span>
</span><span id="line-288"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">anyclass</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621681480770"><span class="annot"><span class="annottext">BlockCreationTime -&gt; ()
(BlockCreationTime -&gt; ()) -&gt; NFData BlockCreationTime
forall a. (a -&gt; ()) -&gt; NFData a
rnf :: BlockCreationTime -&gt; ()
$crnf :: BlockCreationTime -&gt; ()
</span><a href="#local-6989586621681480770"><span class="hs-identifier hs-var hs-var hs-var hs-var">NFData</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-289"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">newtype</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621681480762"><span id="local-6989586621681480764"><span id="local-6989586621681480766"><span id="local-6989586621681480768"><span class="annot"><span class="annottext">[BlockCreationTime] -&gt; Encoding
[BlockCreationTime] -&gt; Value
BlockCreationTime -&gt; Encoding
BlockCreationTime -&gt; Value
(BlockCreationTime -&gt; Value)
-&gt; (BlockCreationTime -&gt; Encoding)
-&gt; ([BlockCreationTime] -&gt; Value)
-&gt; ([BlockCreationTime] -&gt; Encoding)
-&gt; ToJSON BlockCreationTime
forall a.
(a -&gt; Value)
-&gt; (a -&gt; Encoding)
-&gt; ([a] -&gt; Value)
-&gt; ([a] -&gt; Encoding)
-&gt; ToJSON a
toEncodingList :: [BlockCreationTime] -&gt; Encoding
$ctoEncodingList :: [BlockCreationTime] -&gt; Encoding
toJSONList :: [BlockCreationTime] -&gt; Value
$ctoJSONList :: [BlockCreationTime] -&gt; Value
toEncoding :: BlockCreationTime -&gt; Encoding
$ctoEncoding :: BlockCreationTime -&gt; Encoding
toJSON :: BlockCreationTime -&gt; Value
$ctoJSON :: BlockCreationTime -&gt; Value
</span><a href="#local-6989586621681480762"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">ToJSON</span></a></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681480758"><span id="local-6989586621681480760"><span class="annot"><span class="annottext">Value -&gt; Parser [BlockCreationTime]
Value -&gt; Parser BlockCreationTime
(Value -&gt; Parser BlockCreationTime)
-&gt; (Value -&gt; Parser [BlockCreationTime])
-&gt; FromJSON BlockCreationTime
forall a.
(Value -&gt; Parser a) -&gt; (Value -&gt; Parser [a]) -&gt; FromJSON a
parseJSONList :: Value -&gt; Parser [BlockCreationTime]
$cparseJSONList :: Value -&gt; Parser [BlockCreationTime]
parseJSON :: Value -&gt; Parser BlockCreationTime
$cparseJSON :: Value -&gt; Parser BlockCreationTime
</span><a href="#local-6989586621681480758"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">FromJSON</span></a></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681480754"><span id="local-6989586621681480756"><span class="annot"><span class="annottext">Int -&gt; BlockCreationTime -&gt; Int
BlockCreationTime -&gt; Int
(Int -&gt; BlockCreationTime -&gt; Int)
-&gt; (BlockCreationTime -&gt; Int) -&gt; Hashable BlockCreationTime
forall a. (Int -&gt; a -&gt; Int) -&gt; (a -&gt; Int) -&gt; Hashable a
hash :: BlockCreationTime -&gt; Int
$chash :: BlockCreationTime -&gt; Int
hashWithSalt :: Int -&gt; BlockCreationTime -&gt; Int
$chashWithSalt :: Int -&gt; BlockCreationTime -&gt; Int
</span><a href="#local-6989586621681480754"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Hashable</span></a></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681480749"><span id="local-6989586621681480751"><span class="annot"><span class="annottext">AdditiveGroup (Diff BlockCreationTime)
AdditiveGroup (Diff BlockCreationTime) =&gt;
(Diff BlockCreationTime -&gt; BlockCreationTime -&gt; BlockCreationTime)
-&gt; (BlockCreationTime
    -&gt; BlockCreationTime -&gt; Diff BlockCreationTime)
-&gt; LeftTorsor BlockCreationTime
Diff BlockCreationTime -&gt; BlockCreationTime -&gt; BlockCreationTime
BlockCreationTime -&gt; BlockCreationTime -&gt; Diff BlockCreationTime
forall t.
AdditiveGroup (Diff t) =&gt;
(Diff t -&gt; t -&gt; t) -&gt; (t -&gt; t -&gt; Diff t) -&gt; LeftTorsor t
diff :: BlockCreationTime -&gt; BlockCreationTime -&gt; Diff BlockCreationTime
$cdiff :: BlockCreationTime -&gt; BlockCreationTime -&gt; Diff BlockCreationTime
add :: Diff BlockCreationTime -&gt; BlockCreationTime -&gt; BlockCreationTime
$cadd :: Diff BlockCreationTime -&gt; BlockCreationTime -&gt; BlockCreationTime
$cp1LeftTorsor :: AdditiveGroup (Diff BlockCreationTime)
</span><a href="Numeric.AffineSpace.html#C%3ALeftTorsor"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var">LeftTorsor</span></a></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-290"></span><span>
</span><span id="line-291"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Chainweb.Crypto.MerkleLog.html#IsMerkleLogEntry"><span class="hs-identifier hs-type">IsMerkleLogEntry</span></a></span><span> </span><span class="annot"><a href="Chainweb.MerkleUniverse.html#ChainwebHashTag"><span class="hs-identifier hs-type">ChainwebHashTag</span></a></span><span> </span><span class="annot"><a href="Chainweb.BlockHeader.html#BlockCreationTime"><span class="hs-identifier hs-type">BlockCreationTime</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-292"></span><span>    </span><span class="hs-keyword">type</span><span> </span><span id="Tag"><span class="annot"><a href="Chainweb.Crypto.MerkleLog.html#Tag"><span class="hs-identifier hs-var">Tag</span></a></span></span><span> </span><span class="annot"><a href="Chainweb.BlockHeader.html#BlockCreationTime"><span class="hs-identifier hs-type">BlockCreationTime</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Chainweb.MerkleUniverse.html#BlockCreationTimeTag"><span class="hs-identifier hs-type">BlockCreationTimeTag</span></a></span><span>
</span><span id="line-293"></span><span>    </span><span id="local-6989586621681480743"><span class="annot"><span class="annottext">toMerkleNode :: BlockCreationTime
-&gt; MerkleNodeType (HashAlg ChainwebHashTag) ByteString
</span><a href="#local-6989586621681480743"><span class="hs-identifier hs-var hs-var hs-var hs-var">toMerkleNode</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall (m :: * -&gt; *). MonadPut m =&gt; BlockCreationTime -&gt; m ())
-&gt; BlockCreationTime -&gt; MerkleNodeType SHA512t_256 ByteString
forall b a.
(forall (m :: * -&gt; *). MonadPut m =&gt; b -&gt; m ())
-&gt; b -&gt; MerkleNodeType a ByteString
</span><a href="Chainweb.Crypto.MerkleLog.html#encodeMerkleInputNode"><span class="hs-identifier hs-var">encodeMerkleInputNode</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). MonadPut m =&gt; BlockCreationTime -&gt; m ()
</span><a href="Chainweb.BlockHeader.html#encodeBlockCreationTime"><span class="hs-identifier hs-var">encodeBlockCreationTime</span></a></span><span>
</span><span id="line-294"></span><span>    </span><span id="local-6989586621681480742"><span class="annot"><span class="annottext">fromMerkleNode :: MerkleNodeType (HashAlg ChainwebHashTag) ByteString
-&gt; Either SomeException BlockCreationTime
</span><a href="#local-6989586621681480742"><span class="hs-identifier hs-var hs-var hs-var hs-var">fromMerkleNode</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall (n :: * -&gt; *). MonadGet n =&gt; n BlockCreationTime)
-&gt; MerkleNodeType SHA512t_256 ByteString
-&gt; Either SomeException BlockCreationTime
forall (m :: * -&gt; *) b a.
MonadThrow m =&gt;
(forall (n :: * -&gt; *). MonadGet n =&gt; n b)
-&gt; MerkleNodeType a ByteString -&gt; m b
</span><a href="Chainweb.Crypto.MerkleLog.html#decodeMerkleInputNode"><span class="hs-identifier hs-var">decodeMerkleInputNode</span></a></span><span> </span><span class="annot"><span class="annottext">forall (n :: * -&gt; *). MonadGet n =&gt; n BlockCreationTime
</span><a href="Chainweb.BlockHeader.html#decodeBlockCreationTime"><span class="hs-identifier hs-var">decodeBlockCreationTime</span></a></span><span>
</span><span id="line-295"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Chainweb.Crypto.MerkleLog.html#toMerkleNode"><span class="hs-pragma hs-type">toMerkleNode</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-296"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Chainweb.Crypto.MerkleLog.html#fromMerkleNode"><span class="hs-pragma hs-type">fromMerkleNode</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-297"></span><span>
</span><span id="line-298"></span><span id="local-6989586621681480741"><span class="annot"><a href="Chainweb.BlockHeader.html#encodeBlockCreationTime"><span class="hs-identifier hs-type">encodeBlockCreationTime</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadPut</span></span><span> </span><span class="annot"><a href="#local-6989586621681480741"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Chainweb.BlockHeader.html#BlockCreationTime"><span class="hs-identifier hs-type">BlockCreationTime</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681480741"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-299"></span><span id="encodeBlockCreationTime"><span class="annot"><span class="annottext">encodeBlockCreationTime :: BlockCreationTime -&gt; m ()
</span><a href="Chainweb.BlockHeader.html#encodeBlockCreationTime"><span class="hs-identifier hs-var hs-var">encodeBlockCreationTime</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Chainweb.BlockHeader.html#BlockCreationTime"><span class="hs-identifier hs-type">BlockCreationTime</span></a></span><span> </span><span id="local-6989586621681480740"><span class="annot"><span class="annottext">t :: Time Micros
</span><a href="#local-6989586621681480740"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Time Micros -&gt; m ()
forall (m :: * -&gt; *). MonadPut m =&gt; Time Micros -&gt; m ()
</span><a href="Chainweb.Time.html#encodeTime"><span class="hs-identifier hs-var">encodeTime</span></a></span><span> </span><span class="annot"><span class="annottext">Time Micros
</span><a href="#local-6989586621681480740"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-300"></span><span>
</span><span id="line-301"></span><span id="local-6989586621681480738"><span class="annot"><a href="Chainweb.BlockHeader.html#decodeBlockCreationTime"><span class="hs-identifier hs-type">decodeBlockCreationTime</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadGet</span></span><span> </span><span class="annot"><a href="#local-6989586621681480738"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681480738"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Chainweb.BlockHeader.html#BlockCreationTime"><span class="hs-identifier hs-type">BlockCreationTime</span></a></span></span><span>
</span><span id="line-302"></span><span id="decodeBlockCreationTime"><span class="annot"><span class="annottext">decodeBlockCreationTime :: m BlockCreationTime
</span><a href="Chainweb.BlockHeader.html#decodeBlockCreationTime"><span class="hs-identifier hs-var hs-var">decodeBlockCreationTime</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Time Micros -&gt; BlockCreationTime
</span><a href="Chainweb.BlockHeader.html#BlockCreationTime"><span class="hs-identifier hs-var">BlockCreationTime</span></a></span><span> </span><span class="annot"><span class="annottext">(Time Micros -&gt; BlockCreationTime)
-&gt; m (Time Micros) -&gt; m BlockCreationTime
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">m (Time Micros)
forall (m :: * -&gt; *). MonadGet m =&gt; m (Time Micros)
</span><a href="Chainweb.Time.html#decodeTime"><span class="hs-identifier hs-var">decodeTime</span></a></span><span>
</span><span id="line-303"></span><span>
</span><span id="line-304"></span><span class="hs-comment">-- -------------------------------------------------------------------------- --</span><span>
</span><span id="line-305"></span><span class="hs-comment">-- POW Target Computation</span><span>
</span><span id="line-306"></span><span>
</span><span id="line-307"></span><span id="local-6989586621681480735"><span id="local-6989586621681480736"></span></span><span class="hs-keyword">newtype</span><span> </span><span id="EpochStartTime"><span class="annot"><a href="Chainweb.BlockHeader.html#EpochStartTime"><span class="hs-identifier hs-var">EpochStartTime</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="EpochStartTime"><span class="annot"><a href="Chainweb.BlockHeader.html#EpochStartTime"><span class="hs-identifier hs-var">EpochStartTime</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Chainweb.Time.html#Time"><span class="hs-identifier hs-type">Time</span></a></span><span> </span><span class="annot"><a href="Chainweb.Time.html#Micros"><span class="hs-identifier hs-type">Micros</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-308"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">stock</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621681480728"><span id="local-6989586621681480730"><span id="local-6989586621681480732"><span class="annot"><span class="annottext">Int -&gt; EpochStartTime -&gt; ShowS
[EpochStartTime] -&gt; ShowS
EpochStartTime -&gt; String
(Int -&gt; EpochStartTime -&gt; ShowS)
-&gt; (EpochStartTime -&gt; String)
-&gt; ([EpochStartTime] -&gt; ShowS)
-&gt; Show EpochStartTime
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [EpochStartTime] -&gt; ShowS
$cshowList :: [EpochStartTime] -&gt; ShowS
show :: EpochStartTime -&gt; String
$cshow :: EpochStartTime -&gt; String
showsPrec :: Int -&gt; EpochStartTime -&gt; ShowS
$cshowsPrec :: Int -&gt; EpochStartTime -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681480724"><span id="local-6989586621681480726"><span class="annot"><span class="annottext">EpochStartTime -&gt; EpochStartTime -&gt; Bool
(EpochStartTime -&gt; EpochStartTime -&gt; Bool)
-&gt; (EpochStartTime -&gt; EpochStartTime -&gt; Bool) -&gt; Eq EpochStartTime
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: EpochStartTime -&gt; EpochStartTime -&gt; Bool
$c/= :: EpochStartTime -&gt; EpochStartTime -&gt; Bool
== :: EpochStartTime -&gt; EpochStartTime -&gt; Bool
$c== :: EpochStartTime -&gt; EpochStartTime -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681480709"><span id="local-6989586621681480711"><span id="local-6989586621681480713"><span id="local-6989586621681480715"><span id="local-6989586621681480717"><span id="local-6989586621681480719"><span id="local-6989586621681480721"><span class="annot"><span class="annottext">Eq EpochStartTime
Eq EpochStartTime =&gt;
(EpochStartTime -&gt; EpochStartTime -&gt; Ordering)
-&gt; (EpochStartTime -&gt; EpochStartTime -&gt; Bool)
-&gt; (EpochStartTime -&gt; EpochStartTime -&gt; Bool)
-&gt; (EpochStartTime -&gt; EpochStartTime -&gt; Bool)
-&gt; (EpochStartTime -&gt; EpochStartTime -&gt; Bool)
-&gt; (EpochStartTime -&gt; EpochStartTime -&gt; EpochStartTime)
-&gt; (EpochStartTime -&gt; EpochStartTime -&gt; EpochStartTime)
-&gt; Ord EpochStartTime
EpochStartTime -&gt; EpochStartTime -&gt; Bool
EpochStartTime -&gt; EpochStartTime -&gt; Ordering
EpochStartTime -&gt; EpochStartTime -&gt; EpochStartTime
forall a.
Eq a =&gt;
(a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
min :: EpochStartTime -&gt; EpochStartTime -&gt; EpochStartTime
$cmin :: EpochStartTime -&gt; EpochStartTime -&gt; EpochStartTime
max :: EpochStartTime -&gt; EpochStartTime -&gt; EpochStartTime
$cmax :: EpochStartTime -&gt; EpochStartTime -&gt; EpochStartTime
&gt;= :: EpochStartTime -&gt; EpochStartTime -&gt; Bool
$c&gt;= :: EpochStartTime -&gt; EpochStartTime -&gt; Bool
&gt; :: EpochStartTime -&gt; EpochStartTime -&gt; Bool
$c&gt; :: EpochStartTime -&gt; EpochStartTime -&gt; Bool
&lt;= :: EpochStartTime -&gt; EpochStartTime -&gt; Bool
$c&lt;= :: EpochStartTime -&gt; EpochStartTime -&gt; Bool
&lt; :: EpochStartTime -&gt; EpochStartTime -&gt; Bool
$c&lt; :: EpochStartTime -&gt; EpochStartTime -&gt; Bool
compare :: EpochStartTime -&gt; EpochStartTime -&gt; Ordering
$ccompare :: EpochStartTime -&gt; EpochStartTime -&gt; Ordering
$cp1Ord :: Eq EpochStartTime
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(forall x. EpochStartTime -&gt; Rep EpochStartTime x)
-&gt; (forall x. Rep EpochStartTime x -&gt; EpochStartTime)
-&gt; Generic EpochStartTime
forall x. Rep EpochStartTime x -&gt; EpochStartTime
forall x. EpochStartTime -&gt; Rep EpochStartTime x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
$cto :: forall x. Rep EpochStartTime x -&gt; EpochStartTime
$cfrom :: forall x. EpochStartTime -&gt; Rep EpochStartTime x
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">Generic</span></span><span class="hs-special">)</span><span>
</span><span id="line-309"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">anyclass</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621681480705"><span class="annot"><span class="annottext">EpochStartTime -&gt; ()
(EpochStartTime -&gt; ()) -&gt; NFData EpochStartTime
forall a. (a -&gt; ()) -&gt; NFData a
rnf :: EpochStartTime -&gt; ()
$crnf :: EpochStartTime -&gt; ()
</span><a href="#local-6989586621681480705"><span class="hs-identifier hs-var hs-var hs-var hs-var">NFData</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-310"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">newtype</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621681480697"><span id="local-6989586621681480699"><span id="local-6989586621681480701"><span id="local-6989586621681480703"><span class="annot"><span class="annottext">[EpochStartTime] -&gt; Encoding
[EpochStartTime] -&gt; Value
EpochStartTime -&gt; Encoding
EpochStartTime -&gt; Value
(EpochStartTime -&gt; Value)
-&gt; (EpochStartTime -&gt; Encoding)
-&gt; ([EpochStartTime] -&gt; Value)
-&gt; ([EpochStartTime] -&gt; Encoding)
-&gt; ToJSON EpochStartTime
forall a.
(a -&gt; Value)
-&gt; (a -&gt; Encoding)
-&gt; ([a] -&gt; Value)
-&gt; ([a] -&gt; Encoding)
-&gt; ToJSON a
toEncodingList :: [EpochStartTime] -&gt; Encoding
$ctoEncodingList :: [EpochStartTime] -&gt; Encoding
toJSONList :: [EpochStartTime] -&gt; Value
$ctoJSONList :: [EpochStartTime] -&gt; Value
toEncoding :: EpochStartTime -&gt; Encoding
$ctoEncoding :: EpochStartTime -&gt; Encoding
toJSON :: EpochStartTime -&gt; Value
$ctoJSON :: EpochStartTime -&gt; Value
</span><a href="#local-6989586621681480697"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">ToJSON</span></a></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681480693"><span id="local-6989586621681480695"><span class="annot"><span class="annottext">Value -&gt; Parser [EpochStartTime]
Value -&gt; Parser EpochStartTime
(Value -&gt; Parser EpochStartTime)
-&gt; (Value -&gt; Parser [EpochStartTime]) -&gt; FromJSON EpochStartTime
forall a.
(Value -&gt; Parser a) -&gt; (Value -&gt; Parser [a]) -&gt; FromJSON a
parseJSONList :: Value -&gt; Parser [EpochStartTime]
$cparseJSONList :: Value -&gt; Parser [EpochStartTime]
parseJSON :: Value -&gt; Parser EpochStartTime
$cparseJSON :: Value -&gt; Parser EpochStartTime
</span><a href="#local-6989586621681480693"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">FromJSON</span></a></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681480689"><span id="local-6989586621681480691"><span class="annot"><span class="annottext">Int -&gt; EpochStartTime -&gt; Int
EpochStartTime -&gt; Int
(Int -&gt; EpochStartTime -&gt; Int)
-&gt; (EpochStartTime -&gt; Int) -&gt; Hashable EpochStartTime
forall a. (Int -&gt; a -&gt; Int) -&gt; (a -&gt; Int) -&gt; Hashable a
hash :: EpochStartTime -&gt; Int
$chash :: EpochStartTime -&gt; Int
hashWithSalt :: Int -&gt; EpochStartTime -&gt; Int
$chashWithSalt :: Int -&gt; EpochStartTime -&gt; Int
</span><a href="#local-6989586621681480689"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Hashable</span></a></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681480684"><span id="local-6989586621681480686"><span class="annot"><span class="annottext">AdditiveGroup (Diff EpochStartTime)
AdditiveGroup (Diff EpochStartTime) =&gt;
(Diff EpochStartTime -&gt; EpochStartTime -&gt; EpochStartTime)
-&gt; (EpochStartTime -&gt; EpochStartTime -&gt; Diff EpochStartTime)
-&gt; LeftTorsor EpochStartTime
Diff EpochStartTime -&gt; EpochStartTime -&gt; EpochStartTime
EpochStartTime -&gt; EpochStartTime -&gt; Diff EpochStartTime
forall t.
AdditiveGroup (Diff t) =&gt;
(Diff t -&gt; t -&gt; t) -&gt; (t -&gt; t -&gt; Diff t) -&gt; LeftTorsor t
diff :: EpochStartTime -&gt; EpochStartTime -&gt; Diff EpochStartTime
$cdiff :: EpochStartTime -&gt; EpochStartTime -&gt; Diff EpochStartTime
add :: Diff EpochStartTime -&gt; EpochStartTime -&gt; EpochStartTime
$cadd :: Diff EpochStartTime -&gt; EpochStartTime -&gt; EpochStartTime
$cp1LeftTorsor :: AdditiveGroup (Diff EpochStartTime)
</span><a href="#local-6989586621681480684"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var">LeftTorsor</span></a></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-311"></span><span>
</span><span id="line-312"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Chainweb.Crypto.MerkleLog.html#IsMerkleLogEntry"><span class="hs-identifier hs-type">IsMerkleLogEntry</span></a></span><span> </span><span class="annot"><a href="Chainweb.MerkleUniverse.html#ChainwebHashTag"><span class="hs-identifier hs-type">ChainwebHashTag</span></a></span><span> </span><span class="annot"><a href="Chainweb.BlockHeader.html#EpochStartTime"><span class="hs-identifier hs-type">EpochStartTime</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-313"></span><span>    </span><span class="hs-keyword">type</span><span> </span><span id="Tag"><span class="annot"><a href="Chainweb.Crypto.MerkleLog.html#Tag"><span class="hs-identifier hs-var">Tag</span></a></span></span><span> </span><span class="annot"><a href="Chainweb.BlockHeader.html#EpochStartTime"><span class="hs-identifier hs-type">EpochStartTime</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Chainweb.MerkleUniverse.html#EpochStartTimeTag"><span class="hs-identifier hs-type">EpochStartTimeTag</span></a></span><span>
</span><span id="line-314"></span><span>    </span><span id="local-6989586621681480679"><span class="annot"><span class="annottext">toMerkleNode :: EpochStartTime
-&gt; MerkleNodeType (HashAlg ChainwebHashTag) ByteString
</span><a href="#local-6989586621681480679"><span class="hs-identifier hs-var hs-var hs-var hs-var">toMerkleNode</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall (m :: * -&gt; *). MonadPut m =&gt; EpochStartTime -&gt; m ())
-&gt; EpochStartTime -&gt; MerkleNodeType SHA512t_256 ByteString
forall b a.
(forall (m :: * -&gt; *). MonadPut m =&gt; b -&gt; m ())
-&gt; b -&gt; MerkleNodeType a ByteString
</span><a href="Chainweb.Crypto.MerkleLog.html#encodeMerkleInputNode"><span class="hs-identifier hs-var">encodeMerkleInputNode</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). MonadPut m =&gt; EpochStartTime -&gt; m ()
</span><a href="Chainweb.BlockHeader.html#encodeEpochStartTime"><span class="hs-identifier hs-var">encodeEpochStartTime</span></a></span><span>
</span><span id="line-315"></span><span>    </span><span id="local-6989586621681480678"><span class="annot"><span class="annottext">fromMerkleNode :: MerkleNodeType (HashAlg ChainwebHashTag) ByteString
-&gt; Either SomeException EpochStartTime
</span><a href="#local-6989586621681480678"><span class="hs-identifier hs-var hs-var hs-var hs-var">fromMerkleNode</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall (n :: * -&gt; *). MonadGet n =&gt; n EpochStartTime)
-&gt; MerkleNodeType SHA512t_256 ByteString
-&gt; Either SomeException EpochStartTime
forall (m :: * -&gt; *) b a.
MonadThrow m =&gt;
(forall (n :: * -&gt; *). MonadGet n =&gt; n b)
-&gt; MerkleNodeType a ByteString -&gt; m b
</span><a href="Chainweb.Crypto.MerkleLog.html#decodeMerkleInputNode"><span class="hs-identifier hs-var">decodeMerkleInputNode</span></a></span><span> </span><span class="annot"><span class="annottext">forall (n :: * -&gt; *). MonadGet n =&gt; n EpochStartTime
</span><a href="Chainweb.BlockHeader.html#decodeEpochStartTime"><span class="hs-identifier hs-var">decodeEpochStartTime</span></a></span><span>
</span><span id="line-316"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Chainweb.Crypto.MerkleLog.html#toMerkleNode"><span class="hs-pragma hs-type">toMerkleNode</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-317"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Chainweb.Crypto.MerkleLog.html#fromMerkleNode"><span class="hs-pragma hs-type">fromMerkleNode</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-318"></span><span>
</span><span id="line-319"></span><span id="local-6989586621681480677"><span class="annot"><a href="Chainweb.BlockHeader.html#encodeEpochStartTime"><span class="hs-identifier hs-type">encodeEpochStartTime</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadPut</span></span><span> </span><span class="annot"><a href="#local-6989586621681480677"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Chainweb.BlockHeader.html#EpochStartTime"><span class="hs-identifier hs-type">EpochStartTime</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681480677"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-320"></span><span id="encodeEpochStartTime"><span class="annot"><span class="annottext">encodeEpochStartTime :: EpochStartTime -&gt; m ()
</span><a href="Chainweb.BlockHeader.html#encodeEpochStartTime"><span class="hs-identifier hs-var hs-var">encodeEpochStartTime</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Chainweb.BlockHeader.html#EpochStartTime"><span class="hs-identifier hs-type">EpochStartTime</span></a></span><span> </span><span id="local-6989586621681480676"><span class="annot"><span class="annottext">t :: Time Micros
</span><a href="#local-6989586621681480676"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Time Micros -&gt; m ()
forall (m :: * -&gt; *). MonadPut m =&gt; Time Micros -&gt; m ()
</span><a href="Chainweb.Time.html#encodeTime"><span class="hs-identifier hs-var">encodeTime</span></a></span><span> </span><span class="annot"><span class="annottext">Time Micros
</span><a href="#local-6989586621681480676"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-321"></span><span>
</span><span id="line-322"></span><span id="local-6989586621681480675"><span class="annot"><a href="Chainweb.BlockHeader.html#decodeEpochStartTime"><span class="hs-identifier hs-type">decodeEpochStartTime</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadGet</span></span><span> </span><span class="annot"><a href="#local-6989586621681480675"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681480675"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Chainweb.BlockHeader.html#EpochStartTime"><span class="hs-identifier hs-type">EpochStartTime</span></a></span></span><span>
</span><span id="line-323"></span><span id="decodeEpochStartTime"><span class="annot"><span class="annottext">decodeEpochStartTime :: m EpochStartTime
</span><a href="Chainweb.BlockHeader.html#decodeEpochStartTime"><span class="hs-identifier hs-var hs-var">decodeEpochStartTime</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Time Micros -&gt; EpochStartTime
</span><a href="Chainweb.BlockHeader.html#EpochStartTime"><span class="hs-identifier hs-var">EpochStartTime</span></a></span><span> </span><span class="annot"><span class="annottext">(Time Micros -&gt; EpochStartTime)
-&gt; m (Time Micros) -&gt; m EpochStartTime
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">m (Time Micros)
forall (m :: * -&gt; *). MonadGet m =&gt; m (Time Micros)
</span><a href="Chainweb.Time.html#decodeTime"><span class="hs-identifier hs-var">decodeTime</span></a></span><span>
</span><span id="line-324"></span><span>
</span><span id="line-325"></span><span class="hs-comment">-- | During the first epoch after genesis there are 10 extra difficulty</span><span>
</span><span id="line-326"></span><span class="hs-comment">-- adjustments. This is to account for rapidly changing total hash power in the</span><span>
</span><span id="line-327"></span><span class="hs-comment">-- early stages of the network.</span><span>
</span><span id="line-328"></span><span class="hs-comment">--</span><span>
</span><span id="line-329"></span><span class="annot"><a href="Chainweb.BlockHeader.html#effectiveWindow"><span class="hs-identifier hs-type">effectiveWindow</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Chainweb.BlockHeader.html#BlockHeader"><span class="hs-identifier hs-type">BlockHeader</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Chainweb.Version.html#WindowWidth"><span class="hs-identifier hs-type">WindowWidth</span></a></span><span>
</span><span id="line-330"></span><span id="effectiveWindow"><span class="annot"><span class="annottext">effectiveWindow :: BlockHeader -&gt; Maybe WindowWidth
</span><a href="Chainweb.BlockHeader.html#effectiveWindow"><span class="hs-identifier hs-var hs-var">effectiveWindow</span></a></span></span><span> </span><span id="local-6989586621681480673"><span class="annot"><span class="annottext">h :: BlockHeader
</span><a href="#local-6989586621681480673"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Natural -&gt; WindowWidth
</span><a href="Chainweb.Version.html#WindowWidth"><span class="hs-identifier hs-var">WindowWidth</span></a></span><span> </span><span class="annot"><span class="annottext">(Natural -&gt; WindowWidth) -&gt; Maybe Natural -&gt; Maybe WindowWidth
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ChainwebVersion -&gt; Maybe WindowWidth
</span><a href="Chainweb.Version.html#window"><span class="hs-identifier hs-var">window</span></a></span><span> </span><span class="annot"><span class="annottext">ChainwebVersion
</span><a href="#local-6989586621681480670"><span class="hs-identifier hs-var">ver</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-331"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe Natural
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-332"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Chainweb.Version.html#WindowWidth"><span class="hs-identifier hs-type">WindowWidth</span></a></span><span> </span><span id="local-6989586621681480669"><span class="annot"><span class="annottext">w :: Natural
</span><a href="#local-6989586621681480669"><span class="hs-identifier hs-var">w</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-333"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">BlockHeight -&gt; Natural
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="Chainweb.Utils.html#int"><span class="hs-identifier hs-var">int</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BlockHeader -&gt; BlockHeight
</span><a href="Chainweb.BlockHeader.html#_blockHeight"><span class="hs-identifier hs-var hs-var">_blockHeight</span></a></span><span> </span><span class="annot"><span class="annottext">BlockHeader
</span><a href="#local-6989586621681480673"><span class="hs-identifier hs-var">h</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Natural -&gt; Natural -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621681480669"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Natural -&gt; Maybe Natural
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(Natural -&gt; Maybe Natural) -&gt; Natural -&gt; Maybe Natural
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Natural -&gt; Natural -&gt; Natural
forall a. Ord a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">max</span></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">(Natural -&gt; Natural) -&gt; Natural -&gt; Natural
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621681480669"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Natural -&gt; Natural -&gt; Natural
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`div`</span></span><span> </span><span class="annot"><span class="hs-number">10</span></span><span>
</span><span id="line-334"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Natural -&gt; Maybe Natural
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621681480669"><span class="hs-identifier hs-var">w</span></a></span><span>
</span><span id="line-335"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-336"></span><span>    </span><span id="local-6989586621681480670"><span class="annot"><span class="annottext">ver :: ChainwebVersion
</span><a href="#local-6989586621681480670"><span class="hs-identifier hs-var hs-var">ver</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BlockHeader -&gt; ChainwebVersion
</span><a href="Chainweb.BlockHeader.html#_blockChainwebVersion"><span class="hs-identifier hs-var hs-var">_blockChainwebVersion</span></a></span><span> </span><span class="annot"><span class="annottext">BlockHeader
</span><a href="#local-6989586621681480673"><span class="hs-identifier hs-var">h</span></a></span><span>
</span><span id="line-337"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Chainweb.BlockHeader.html#effectiveWindow"><span class="hs-pragma hs-type">effectiveWindow</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-338"></span><span>
</span><span id="line-339"></span><span class="hs-comment">-- | Return whether the given 'BlockHeader' is the last header in its epoch.</span><span>
</span><span id="line-340"></span><span class="hs-comment">--</span><span>
</span><span id="line-341"></span><span class="annot"><a href="Chainweb.BlockHeader.html#isLastInEpoch"><span class="hs-identifier hs-type">isLastInEpoch</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Chainweb.BlockHeader.html#BlockHeader"><span class="hs-identifier hs-type">BlockHeader</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-342"></span><span id="isLastInEpoch"><span class="annot"><span class="annottext">isLastInEpoch :: BlockHeader -&gt; Bool
</span><a href="Chainweb.BlockHeader.html#isLastInEpoch"><span class="hs-identifier hs-var hs-var">isLastInEpoch</span></a></span></span><span> </span><span id="local-6989586621681480661"><span class="annot"><span class="annottext">h :: BlockHeader
</span><a href="#local-6989586621681480661"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">BlockHeader -&gt; Maybe WindowWidth
</span><a href="Chainweb.BlockHeader.html#effectiveWindow"><span class="hs-identifier hs-var">effectiveWindow</span></a></span><span> </span><span class="annot"><span class="annottext">BlockHeader
</span><a href="#local-6989586621681480661"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-343"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-344"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Chainweb.Version.html#WindowWidth"><span class="hs-identifier hs-type">WindowWidth</span></a></span><span> </span><span id="local-6989586621681480660"><span class="annot"><span class="annottext">w :: Natural
</span><a href="#local-6989586621681480660"><span class="hs-identifier hs-var">w</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-345"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BlockHeight -&gt; Natural
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="Chainweb.Utils.html#int"><span class="hs-identifier hs-var">int</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BlockHeader -&gt; BlockHeight
</span><a href="Chainweb.BlockHeader.html#_blockHeight"><span class="hs-identifier hs-var hs-var">_blockHeight</span></a></span><span> </span><span class="annot"><span class="annottext">BlockHeader
</span><a href="#local-6989586621681480661"><span class="hs-identifier hs-var">h</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Natural -&gt; Natural -&gt; Natural
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Natural -&gt; Natural -&gt; Natural
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`mod`</span></span><span> </span><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621681480660"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Natural -&gt; Natural -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-346"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-347"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Chainweb.BlockHeader.html#isLastInEpoch"><span class="hs-pragma hs-type">isLastInEpoch</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-348"></span><span>
</span><span id="line-349"></span><span class="hs-comment">-- | If it is discovered that the last DA occured significantly in the past, we</span><span>
</span><span id="line-350"></span><span class="hs-comment">-- assume that a large amount of hash power has suddenly dropped out of the</span><span>
</span><span id="line-351"></span><span class="hs-comment">-- network. Thus we must perform Emergency Difficulty Adjustment to avoid</span><span>
</span><span id="line-352"></span><span class="hs-comment">-- stalling the chain.</span><span>
</span><span id="line-353"></span><span class="hs-comment">--</span><span>
</span><span id="line-354"></span><span class="annot"><a href="Chainweb.BlockHeader.html#slowEpoch"><span class="hs-identifier hs-type">slowEpoch</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Chainweb.BlockHeader.html#BlockHeader"><span class="hs-identifier hs-type">BlockHeader</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Chainweb.BlockHeader.html#BlockCreationTime"><span class="hs-identifier hs-type">BlockCreationTime</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-355"></span><span id="slowEpoch"><span class="annot"><span class="annottext">slowEpoch :: BlockHeader -&gt; BlockCreationTime -&gt; Bool
</span><a href="Chainweb.BlockHeader.html#slowEpoch"><span class="hs-identifier hs-var hs-var">slowEpoch</span></a></span></span><span> </span><span id="local-6989586621681480656"><span class="annot"><span class="annottext">p :: BlockHeader
</span><a href="#local-6989586621681480656"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Chainweb.BlockHeader.html#BlockCreationTime"><span class="hs-identifier hs-type">BlockCreationTime</span></a></span><span> </span><span id="local-6989586621681480655"><span class="annot"><span class="annottext">ct :: Time Micros
</span><a href="#local-6989586621681480655"><span class="hs-identifier hs-var">ct</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Seconds
</span><a href="#local-6989586621681480654"><span class="hs-identifier hs-var">actual</span></a></span><span> </span><span class="annot"><span class="annottext">Seconds -&gt; Seconds -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Seconds
</span><a href="#local-6989586621681480652"><span class="hs-identifier hs-var">expected</span></a></span><span> </span><span class="annot"><span class="annottext">Seconds -&gt; Seconds -&gt; Seconds
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="hs-number">5</span></span><span class="hs-special">)</span><span>
</span><span id="line-356"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-357"></span><span>    </span><span class="annot"><a href="Chainweb.BlockHeader.html#EpochStartTime"><span class="hs-identifier hs-type">EpochStartTime</span></a></span><span> </span><span id="local-6989586621681480650"><span class="annot"><span class="annottext">es :: Time Micros
</span><a href="#local-6989586621681480650"><span class="hs-identifier hs-var">es</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BlockHeader -&gt; EpochStartTime
</span><a href="Chainweb.BlockHeader.html#_blockEpochStart"><span class="hs-identifier hs-var hs-var">_blockEpochStart</span></a></span><span> </span><span class="annot"><span class="annottext">BlockHeader
</span><a href="#local-6989586621681480656"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-358"></span><span>    </span><span class="annot"><a href="Chainweb.Version.html#BlockRate"><span class="hs-identifier hs-type">BlockRate</span></a></span><span> </span><span id="local-6989586621681480647"><span class="annot"><span class="annottext">s :: Seconds
</span><a href="#local-6989586621681480647"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ChainwebVersion -&gt; BlockRate
</span><a href="Chainweb.Version.html#blockRate"><span class="hs-identifier hs-var">blockRate</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BlockHeader -&gt; ChainwebVersion
</span><a href="Chainweb.BlockHeader.html#_blockChainwebVersion"><span class="hs-identifier hs-var hs-var">_blockChainwebVersion</span></a></span><span> </span><span class="annot"><span class="annottext">BlockHeader
</span><a href="#local-6989586621681480656"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-359"></span><span>    </span><span class="annot"><a href="Chainweb.Version.html#WindowWidth"><span class="hs-identifier hs-type">WindowWidth</span></a></span><span> </span><span id="local-6989586621681480645"><span class="annot"><span class="annottext">ww :: Natural
</span><a href="#local-6989586621681480645"><span class="hs-identifier hs-var">ww</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe WindowWidth -&gt; WindowWidth
forall a. HasCallStack =&gt; Maybe a -&gt; a
</span><a href="Chainweb.Utils.html#fromJuste"><span class="hs-identifier hs-var">fromJuste</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe WindowWidth -&gt; WindowWidth)
-&gt; Maybe WindowWidth -&gt; WindowWidth
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ChainwebVersion -&gt; Maybe WindowWidth
</span><a href="Chainweb.Version.html#window"><span class="hs-identifier hs-var">window</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BlockHeader -&gt; ChainwebVersion
</span><a href="Chainweb.BlockHeader.html#_blockChainwebVersion"><span class="hs-identifier hs-var hs-var">_blockChainwebVersion</span></a></span><span> </span><span class="annot"><span class="annottext">BlockHeader
</span><a href="#local-6989586621681480656"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-360"></span><span>
</span><span id="line-361"></span><span>    </span><span class="annot"><a href="#local-6989586621681480652"><span class="hs-identifier hs-type">expected</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Chainweb.Time.html#Seconds"><span class="hs-identifier hs-type">Seconds</span></a></span><span>
</span><span id="line-362"></span><span>    </span><span id="local-6989586621681480652"><span class="annot"><span class="annottext">expected :: Seconds
</span><a href="#local-6989586621681480652"><span class="hs-identifier hs-var hs-var">expected</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Seconds
</span><a href="#local-6989586621681480647"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">Seconds -&gt; Seconds -&gt; Seconds
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Natural -&gt; Seconds
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="Chainweb.Utils.html#int"><span class="hs-identifier hs-var">int</span></a></span><span> </span><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621681480645"><span class="hs-identifier hs-var">ww</span></a></span><span>
</span><span id="line-363"></span><span>
</span><span id="line-364"></span><span>    </span><span class="annot"><a href="#local-6989586621681480654"><span class="hs-identifier hs-type">actual</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Chainweb.Time.html#Seconds"><span class="hs-identifier hs-type">Seconds</span></a></span><span>
</span><span id="line-365"></span><span>    </span><span id="local-6989586621681480654"><span class="annot"><span class="annottext">actual :: Seconds
</span><a href="#local-6989586621681480654"><span class="hs-identifier hs-var hs-var">actual</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TimeSpan Micros -&gt; Seconds
forall a. Integral a =&gt; TimeSpan a -&gt; Seconds
</span><a href="Chainweb.Time.html#timeSpanToSeconds"><span class="hs-identifier hs-var">timeSpanToSeconds</span></a></span><span> </span><span class="annot"><span class="annottext">(TimeSpan Micros -&gt; Seconds) -&gt; TimeSpan Micros -&gt; Seconds
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Time Micros
</span><a href="#local-6989586621681480655"><span class="hs-identifier hs-var">ct</span></a></span><span> </span><span class="annot"><span class="annottext">Time Micros -&gt; Time Micros -&gt; Diff (Time Micros)
forall t.
(AdditiveAbelianGroup (Diff t), LeftTorsor t) =&gt;
t -&gt; t -&gt; Diff t
</span><a href="Numeric.AffineSpace.html#.-."><span class="hs-operator hs-var">.-.</span></a></span><span> </span><span class="annot"><span class="annottext">Time Micros
</span><a href="#local-6989586621681480650"><span class="hs-identifier hs-var">es</span></a></span><span>
</span><span id="line-366"></span><span>
</span><span id="line-367"></span><span class="hs-comment">-- | Compute the POW target for a new BlockHeader.</span><span>
</span><span id="line-368"></span><span class="hs-comment">--</span><span>
</span><span id="line-369"></span><span class="annot"><a href="Chainweb.BlockHeader.html#powTarget"><span class="hs-identifier hs-type">powTarget</span></a></span><span>
</span><span id="line-370"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Chainweb.BlockHeader.html#BlockHeader"><span class="hs-identifier hs-type">BlockHeader</span></a></span><span>
</span><span id="line-371"></span><span>        </span><span class="hs-comment">-- ^ parent header</span><span>
</span><span id="line-372"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Chainweb.BlockHeader.html#BlockCreationTime"><span class="hs-identifier hs-type">BlockCreationTime</span></a></span><span>
</span><span id="line-373"></span><span>        </span><span class="hs-comment">-- ^ block creation time of new block</span><span>
</span><span id="line-374"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Chainweb.Difficulty.html#HashTarget"><span class="hs-identifier hs-type">HashTarget</span></a></span><span>
</span><span id="line-375"></span><span>        </span><span class="hs-comment">-- ^ POW target of new block</span><span>
</span><span id="line-376"></span><span id="powTarget"><span class="annot"><span class="annottext">powTarget :: BlockHeader -&gt; BlockCreationTime -&gt; HashTarget
</span><a href="Chainweb.BlockHeader.html#powTarget"><span class="hs-identifier hs-var hs-var">powTarget</span></a></span></span><span> </span><span id="local-6989586621681480641"><span class="annot"><span class="annottext">p :: BlockHeader
</span><a href="#local-6989586621681480641"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621681480640"><span class="annot"><span class="annottext">bct :: BlockCreationTime
</span><a href="#local-6989586621681480640"><span class="hs-identifier hs-var">bct</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Chainweb.BlockHeader.html#BlockCreationTime"><span class="hs-identifier hs-type">BlockCreationTime</span></a></span><span> </span><span id="local-6989586621681480639"><span class="annot"><span class="annottext">bt :: Time Micros
</span><a href="#local-6989586621681480639"><span class="hs-identifier hs-var">bt</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">BlockHeader -&gt; Maybe WindowWidth
</span><a href="Chainweb.BlockHeader.html#effectiveWindow"><span class="hs-identifier hs-var">effectiveWindow</span></a></span><span> </span><span class="annot"><span class="annottext">BlockHeader
</span><a href="#local-6989586621681480641"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-377"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">HashTarget
</span><a href="Chainweb.Difficulty.html#maxTarget"><span class="hs-identifier hs-var">maxTarget</span></a></span><span>
</span><span id="line-378"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621681480637"><span class="annot"><span class="annottext">w :: WindowWidth
</span><a href="#local-6989586621681480637"><span class="hs-identifier hs-var">w</span></a></span></span><span>
</span><span id="line-379"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">BlockHeader -&gt; Bool
</span><a href="Chainweb.BlockHeader.html#isLastInEpoch"><span class="hs-identifier hs-var">isLastInEpoch</span></a></span><span> </span><span class="annot"><span class="annottext">BlockHeader
</span><a href="#local-6989586621681480641"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">BlockHeader -&gt; BlockCreationTime -&gt; Bool
</span><a href="Chainweb.BlockHeader.html#slowEpoch"><span class="hs-identifier hs-var">slowEpoch</span></a></span><span> </span><span class="annot"><span class="annottext">BlockHeader
</span><a href="#local-6989586621681480641"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">BlockCreationTime
</span><a href="#local-6989586621681480640"><span class="hs-identifier hs-var">bct</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-380"></span><span>            </span><span class="annot"><span class="annottext">ChainwebVersion
-&gt; WindowWidth -&gt; TimeSpan Micros -&gt; HashTarget -&gt; HashTarget
</span><a href="Chainweb.Difficulty.html#adjust"><span class="hs-identifier hs-var">adjust</span></a></span><span> </span><span class="annot"><span class="annottext">ChainwebVersion
</span><a href="#local-6989586621681480634"><span class="hs-identifier hs-var">ver</span></a></span><span> </span><span class="annot"><span class="annottext">WindowWidth
</span><a href="#local-6989586621681480637"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">EpochStartTime
</span><a href="#local-6989586621681480633"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">EpochStartTime -&gt; EpochStartTime -&gt; Diff EpochStartTime
forall t.
(AdditiveAbelianGroup (Diff t), LeftTorsor t) =&gt;
t -&gt; t -&gt; Diff t
</span><a href="Numeric.AffineSpace.html#.-."><span class="hs-operator hs-var">.-.</span></a></span><span> </span><span class="annot"><span class="annottext">BlockHeader -&gt; EpochStartTime
</span><a href="Chainweb.BlockHeader.html#_blockEpochStart"><span class="hs-identifier hs-var hs-var">_blockEpochStart</span></a></span><span> </span><span class="annot"><span class="annottext">BlockHeader
</span><a href="#local-6989586621681480641"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BlockHeader -&gt; HashTarget
</span><a href="Chainweb.BlockHeader.html#_blockTarget"><span class="hs-identifier hs-var hs-var">_blockTarget</span></a></span><span> </span><span class="annot"><span class="annottext">BlockHeader
</span><a href="#local-6989586621681480641"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-381"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">BlockHeader -&gt; HashTarget
</span><a href="Chainweb.BlockHeader.html#_blockTarget"><span class="hs-identifier hs-var hs-var">_blockTarget</span></a></span><span> </span><span class="annot"><span class="annottext">BlockHeader
</span><a href="#local-6989586621681480641"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-382"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-383"></span><span>    </span><span id="local-6989586621681480633"><span class="annot"><span class="annottext">t :: EpochStartTime
</span><a href="#local-6989586621681480633"><span class="hs-identifier hs-var hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Time Micros -&gt; EpochStartTime
</span><a href="Chainweb.BlockHeader.html#EpochStartTime"><span class="hs-identifier hs-var">EpochStartTime</span></a></span><span> </span><span class="annot"><span class="annottext">Time Micros
</span><a href="#local-6989586621681480639"><span class="hs-identifier hs-var">bt</span></a></span><span>
</span><span id="line-384"></span><span>    </span><span id="local-6989586621681480634"><span class="annot"><span class="annottext">ver :: ChainwebVersion
</span><a href="#local-6989586621681480634"><span class="hs-identifier hs-var hs-var">ver</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BlockHeader -&gt; ChainwebVersion
</span><a href="Chainweb.BlockHeader.html#_blockChainwebVersion"><span class="hs-identifier hs-var hs-var">_blockChainwebVersion</span></a></span><span> </span><span class="annot"><span class="annottext">BlockHeader
</span><a href="#local-6989586621681480641"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-385"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Chainweb.BlockHeader.html#powTarget"><span class="hs-pragma hs-type">powTarget</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-386"></span><span>
</span><span id="line-387"></span><span class="hs-comment">-- | Compute the epoch start value for a new BlockHeader</span><span>
</span><span id="line-388"></span><span class="hs-comment">--</span><span>
</span><span id="line-389"></span><span class="annot"><a href="Chainweb.BlockHeader.html#epochStart"><span class="hs-identifier hs-type">epochStart</span></a></span><span>
</span><span id="line-390"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Chainweb.BlockHeader.html#BlockHeader"><span class="hs-identifier hs-type">BlockHeader</span></a></span><span>
</span><span id="line-391"></span><span>        </span><span class="hs-comment">-- ^ parent header</span><span>
</span><span id="line-392"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Chainweb.BlockHeader.html#BlockCreationTime"><span class="hs-identifier hs-type">BlockCreationTime</span></a></span><span>
</span><span id="line-393"></span><span>        </span><span class="hs-comment">-- ^ block creation time of new block</span><span>
</span><span id="line-394"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Chainweb.BlockHeader.html#EpochStartTime"><span class="hs-identifier hs-type">EpochStartTime</span></a></span><span>
</span><span id="line-395"></span><span>        </span><span class="hs-comment">-- ^ epoch start time of new block</span><span>
</span><span id="line-396"></span><span id="epochStart"><span class="annot"><span class="annottext">epochStart :: BlockHeader -&gt; BlockCreationTime -&gt; EpochStartTime
</span><a href="Chainweb.BlockHeader.html#epochStart"><span class="hs-identifier hs-var hs-var">epochStart</span></a></span></span><span> </span><span id="local-6989586621681480631"><span class="annot"><span class="annottext">p :: BlockHeader
</span><a href="#local-6989586621681480631"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Chainweb.BlockHeader.html#BlockCreationTime"><span class="hs-identifier hs-type">BlockCreationTime</span></a></span><span> </span><span id="local-6989586621681480630"><span class="annot"><span class="annottext">bt :: Time Micros
</span><a href="#local-6989586621681480630"><span class="hs-identifier hs-var">bt</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-397"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">BlockHeader -&gt; Bool
</span><a href="Chainweb.BlockHeader.html#isLastInEpoch"><span class="hs-identifier hs-var">isLastInEpoch</span></a></span><span> </span><span class="annot"><span class="annottext">BlockHeader
</span><a href="#local-6989586621681480631"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Time Micros -&gt; EpochStartTime
</span><a href="Chainweb.BlockHeader.html#EpochStartTime"><span class="hs-identifier hs-var">EpochStartTime</span></a></span><span> </span><span class="annot"><span class="annottext">Time Micros
</span><a href="#local-6989586621681480630"><span class="hs-identifier hs-var">bt</span></a></span><span>
</span><span id="line-398"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BlockHeader -&gt; EpochStartTime
</span><a href="Chainweb.BlockHeader.html#_blockEpochStart"><span class="hs-identifier hs-var hs-var">_blockEpochStart</span></a></span><span> </span><span class="annot"><span class="annottext">BlockHeader
</span><a href="#local-6989586621681480631"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-399"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Chainweb.BlockHeader.html#epochStart"><span class="hs-pragma hs-type">epochStart</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-400"></span><span>
</span><span id="line-401"></span><span class="hs-comment">-- -----------------------------------------------------------------------------</span><span>
</span><span id="line-402"></span><span class="hs-comment">-- Feature Flags</span><span>
</span><span id="line-403"></span><span>
</span><span id="line-404"></span><span id="local-6989586621681480628"><span id="local-6989586621681480629"></span></span><span class="hs-keyword">newtype</span><span> </span><span id="FeatureFlags"><span class="annot"><a href="Chainweb.BlockHeader.html#FeatureFlags"><span class="hs-identifier hs-var">FeatureFlags</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="FeatureFlags"><span class="annot"><a href="Chainweb.BlockHeader.html#FeatureFlags"><span class="hs-identifier hs-var">FeatureFlags</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word64</span></span><span>
</span><span id="line-405"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">stock</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621681480621"><span id="local-6989586621681480623"><span id="local-6989586621681480625"><span class="annot"><span class="annottext">Int -&gt; FeatureFlags -&gt; ShowS
[FeatureFlags] -&gt; ShowS
FeatureFlags -&gt; String
(Int -&gt; FeatureFlags -&gt; ShowS)
-&gt; (FeatureFlags -&gt; String)
-&gt; ([FeatureFlags] -&gt; ShowS)
-&gt; Show FeatureFlags
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [FeatureFlags] -&gt; ShowS
$cshowList :: [FeatureFlags] -&gt; ShowS
show :: FeatureFlags -&gt; String
$cshow :: FeatureFlags -&gt; String
showsPrec :: Int -&gt; FeatureFlags -&gt; ShowS
$cshowsPrec :: Int -&gt; FeatureFlags -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(forall x. FeatureFlags -&gt; Rep FeatureFlags x)
-&gt; (forall x. Rep FeatureFlags x -&gt; FeatureFlags)
-&gt; Generic FeatureFlags
forall x. Rep FeatureFlags x -&gt; FeatureFlags
forall x. FeatureFlags -&gt; Rep FeatureFlags x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
$cto :: forall x. Rep FeatureFlags x -&gt; FeatureFlags
$cfrom :: forall x. FeatureFlags -&gt; Rep FeatureFlags x
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">Generic</span></span><span class="hs-special">)</span><span>
</span><span id="line-406"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">anyclass</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621681480617"><span class="annot"><span class="annottext">FeatureFlags -&gt; ()
(FeatureFlags -&gt; ()) -&gt; NFData FeatureFlags
forall a. (a -&gt; ()) -&gt; NFData a
rnf :: FeatureFlags -&gt; ()
$crnf :: FeatureFlags -&gt; ()
</span><a href="#local-6989586621681480617"><span class="hs-identifier hs-var hs-var hs-var hs-var">NFData</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-407"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">newtype</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621681480609"><span id="local-6989586621681480611"><span id="local-6989586621681480613"><span id="local-6989586621681480615"><span class="annot"><span class="annottext">[FeatureFlags] -&gt; Encoding
[FeatureFlags] -&gt; Value
FeatureFlags -&gt; Encoding
FeatureFlags -&gt; Value
(FeatureFlags -&gt; Value)
-&gt; (FeatureFlags -&gt; Encoding)
-&gt; ([FeatureFlags] -&gt; Value)
-&gt; ([FeatureFlags] -&gt; Encoding)
-&gt; ToJSON FeatureFlags
forall a.
(a -&gt; Value)
-&gt; (a -&gt; Encoding)
-&gt; ([a] -&gt; Value)
-&gt; ([a] -&gt; Encoding)
-&gt; ToJSON a
toEncodingList :: [FeatureFlags] -&gt; Encoding
$ctoEncodingList :: [FeatureFlags] -&gt; Encoding
toJSONList :: [FeatureFlags] -&gt; Value
$ctoJSONList :: [FeatureFlags] -&gt; Value
toEncoding :: FeatureFlags -&gt; Encoding
$ctoEncoding :: FeatureFlags -&gt; Encoding
toJSON :: FeatureFlags -&gt; Value
$ctoJSON :: FeatureFlags -&gt; Value
</span><a href="#local-6989586621681480609"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">ToJSON</span></a></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681480605"><span id="local-6989586621681480607"><span class="annot"><span class="annottext">Value -&gt; Parser [FeatureFlags]
Value -&gt; Parser FeatureFlags
(Value -&gt; Parser FeatureFlags)
-&gt; (Value -&gt; Parser [FeatureFlags]) -&gt; FromJSON FeatureFlags
forall a.
(Value -&gt; Parser a) -&gt; (Value -&gt; Parser [a]) -&gt; FromJSON a
parseJSONList :: Value -&gt; Parser [FeatureFlags]
$cparseJSONList :: Value -&gt; Parser [FeatureFlags]
parseJSON :: Value -&gt; Parser FeatureFlags
$cparseJSON :: Value -&gt; Parser FeatureFlags
</span><a href="#local-6989586621681480605"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">FromJSON</span></a></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-408"></span><span>
</span><span id="line-409"></span><span id="local-6989586621681480604"><span class="annot"><a href="Chainweb.BlockHeader.html#encodeFeatureFlags"><span class="hs-identifier hs-type">encodeFeatureFlags</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadPut</span></span><span> </span><span class="annot"><a href="#local-6989586621681480604"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Chainweb.BlockHeader.html#FeatureFlags"><span class="hs-identifier hs-type">FeatureFlags</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681480604"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-410"></span><span id="encodeFeatureFlags"><span class="annot"><span class="annottext">encodeFeatureFlags :: FeatureFlags -&gt; m ()
</span><a href="Chainweb.BlockHeader.html#encodeFeatureFlags"><span class="hs-identifier hs-var hs-var">encodeFeatureFlags</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Chainweb.BlockHeader.html#FeatureFlags"><span class="hs-identifier hs-type">FeatureFlags</span></a></span><span> </span><span id="local-6989586621681480603"><span class="annot"><span class="annottext">ff :: Word64
</span><a href="#local-6989586621681480603"><span class="hs-identifier hs-var">ff</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; m ()
forall (m :: * -&gt; *). MonadPut m =&gt; Word64 -&gt; m ()
</span><span class="hs-identifier hs-var">putWord64le</span></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621681480603"><span class="hs-identifier hs-var">ff</span></a></span><span>
</span><span id="line-411"></span><span>
</span><span id="line-412"></span><span id="local-6989586621681480602"><span class="annot"><a href="Chainweb.BlockHeader.html#decodeFeatureFlags"><span class="hs-identifier hs-type">decodeFeatureFlags</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadGet</span></span><span> </span><span class="annot"><a href="#local-6989586621681480602"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681480602"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Chainweb.BlockHeader.html#FeatureFlags"><span class="hs-identifier hs-type">FeatureFlags</span></a></span></span><span>
</span><span id="line-413"></span><span id="decodeFeatureFlags"><span class="annot"><span class="annottext">decodeFeatureFlags :: m FeatureFlags
</span><a href="Chainweb.BlockHeader.html#decodeFeatureFlags"><span class="hs-identifier hs-var hs-var">decodeFeatureFlags</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; FeatureFlags
</span><a href="Chainweb.BlockHeader.html#FeatureFlags"><span class="hs-identifier hs-var">FeatureFlags</span></a></span><span> </span><span class="annot"><span class="annottext">(Word64 -&gt; FeatureFlags) -&gt; m Word64 -&gt; m FeatureFlags
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">m Word64
forall (m :: * -&gt; *). MonadGet m =&gt; m Word64
</span><span class="hs-identifier hs-var">getWord64le</span></span><span>
</span><span id="line-414"></span><span>
</span><span id="line-415"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Chainweb.Crypto.MerkleLog.html#IsMerkleLogEntry"><span class="hs-identifier hs-type">IsMerkleLogEntry</span></a></span><span> </span><span class="annot"><a href="Chainweb.MerkleUniverse.html#ChainwebHashTag"><span class="hs-identifier hs-type">ChainwebHashTag</span></a></span><span> </span><span class="annot"><a href="Chainweb.BlockHeader.html#FeatureFlags"><span class="hs-identifier hs-type">FeatureFlags</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-416"></span><span>    </span><span class="hs-keyword">type</span><span> </span><span id="Tag"><span class="annot"><a href="Chainweb.Crypto.MerkleLog.html#Tag"><span class="hs-identifier hs-var">Tag</span></a></span></span><span> </span><span class="annot"><a href="Chainweb.BlockHeader.html#FeatureFlags"><span class="hs-identifier hs-type">FeatureFlags</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Chainweb.MerkleUniverse.html#FeatureFlagsTag"><span class="hs-identifier hs-type">FeatureFlagsTag</span></a></span><span>
</span><span id="line-417"></span><span>    </span><span id="local-6989586621681480597"><span class="annot"><span class="annottext">toMerkleNode :: FeatureFlags -&gt; MerkleNodeType (HashAlg ChainwebHashTag) ByteString
</span><a href="#local-6989586621681480597"><span class="hs-identifier hs-var hs-var hs-var hs-var">toMerkleNode</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall (m :: * -&gt; *). MonadPut m =&gt; FeatureFlags -&gt; m ())
-&gt; FeatureFlags -&gt; MerkleNodeType SHA512t_256 ByteString
forall b a.
(forall (m :: * -&gt; *). MonadPut m =&gt; b -&gt; m ())
-&gt; b -&gt; MerkleNodeType a ByteString
</span><a href="Chainweb.Crypto.MerkleLog.html#encodeMerkleInputNode"><span class="hs-identifier hs-var">encodeMerkleInputNode</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). MonadPut m =&gt; FeatureFlags -&gt; m ()
</span><a href="Chainweb.BlockHeader.html#encodeFeatureFlags"><span class="hs-identifier hs-var">encodeFeatureFlags</span></a></span><span>
</span><span id="line-418"></span><span>    </span><span id="local-6989586621681480596"><span class="annot"><span class="annottext">fromMerkleNode :: MerkleNodeType (HashAlg ChainwebHashTag) ByteString
-&gt; Either SomeException FeatureFlags
</span><a href="#local-6989586621681480596"><span class="hs-identifier hs-var hs-var hs-var hs-var">fromMerkleNode</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall (n :: * -&gt; *). MonadGet n =&gt; n FeatureFlags)
-&gt; MerkleNodeType SHA512t_256 ByteString
-&gt; Either SomeException FeatureFlags
forall (m :: * -&gt; *) b a.
MonadThrow m =&gt;
(forall (n :: * -&gt; *). MonadGet n =&gt; n b)
-&gt; MerkleNodeType a ByteString -&gt; m b
</span><a href="Chainweb.Crypto.MerkleLog.html#decodeMerkleInputNode"><span class="hs-identifier hs-var">decodeMerkleInputNode</span></a></span><span> </span><span class="annot"><span class="annottext">forall (n :: * -&gt; *). MonadGet n =&gt; n FeatureFlags
</span><a href="Chainweb.BlockHeader.html#decodeFeatureFlags"><span class="hs-identifier hs-var">decodeFeatureFlags</span></a></span><span>
</span><span id="line-419"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Chainweb.Crypto.MerkleLog.html#toMerkleNode"><span class="hs-pragma hs-type">toMerkleNode</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-420"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Chainweb.Crypto.MerkleLog.html#fromMerkleNode"><span class="hs-pragma hs-type">fromMerkleNode</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-421"></span><span>
</span><span id="line-422"></span><span class="hs-comment">-- -------------------------------------------------------------------------- --</span><span>
</span><span id="line-423"></span><span class="hs-comment">-- Block Header</span><span>
</span><span id="line-424"></span><span>
</span><span id="line-425"></span><span class="hs-comment">-- | BlockHeader</span><span>
</span><span id="line-426"></span><span class="hs-comment">--</span><span>
</span><span id="line-427"></span><span class="hs-comment">-- Some redundant, aggregated information is included in the block and the block</span><span>
</span><span id="line-428"></span><span class="hs-comment">-- hash. This enables nodes to be checked inductively with respect to existing</span><span>
</span><span id="line-429"></span><span class="hs-comment">-- blocks without recalculating the aggregated value from the genesis block</span><span>
</span><span id="line-430"></span><span class="hs-comment">-- onward.</span><span>
</span><span id="line-431"></span><span class="hs-comment">--</span><span>
</span><span id="line-432"></span><span class="hs-comment">-- The POW hash is not include, since it can be derived from the Nonce and the</span><span>
</span><span id="line-433"></span><span class="hs-comment">-- other fields of the 'BlockHeader'.</span><span>
</span><span id="line-434"></span><span class="hs-comment">--</span><span>
</span><span id="line-435"></span><span class="hs-comment">-- /IMPORTANT/: Fields in this record must have pairwise distinct types.</span><span>
</span><span id="line-436"></span><span class="hs-comment">--</span><span>
</span><span id="line-437"></span><span id="local-6989586621681480594"><span id="local-6989586621681480595"></span></span><span class="hs-keyword">data</span><span> </span><span id="BlockHeader"><span class="annot"><a href="Chainweb.BlockHeader.html#BlockHeader"><span class="hs-identifier hs-var">BlockHeader</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-438"></span><span>    </span><span id="BlockHeader"><span class="annot"><a href="Chainweb.BlockHeader.html#BlockHeader"><span class="hs-identifier hs-var">BlockHeader</span></a></span></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-439"></span><span>        </span><span class="hs-special">{</span><span> </span><span id="_blockNonce"><span class="annot"><span class="annottext">BlockHeader -&gt; Nonce
</span><a href="Chainweb.BlockHeader.html#_blockNonce"><span class="hs-identifier hs-var hs-var">_blockNonce</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-pragma">{-# UNPACK</span><span> </span><span class="hs-pragma">#-}</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="Chainweb.BlockHeader.html#Nonce"><span class="hs-identifier hs-type">Nonce</span></a></span><span>
</span><span id="line-440"></span><span>            </span><span class="hs-comment">-- ^ authoritative</span><span>
</span><span id="line-441"></span><span>
</span><span id="line-442"></span><span>        </span><span class="hs-special">,</span><span> </span><span id="_blockCreationTime"><span class="annot"><span class="annottext">BlockHeader -&gt; BlockCreationTime
</span><a href="Chainweb.BlockHeader.html#_blockCreationTime"><span class="hs-identifier hs-var hs-var">_blockCreationTime</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-pragma">{-# UNPACK</span><span> </span><span class="hs-pragma">#-}</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="Chainweb.BlockHeader.html#BlockCreationTime"><span class="hs-identifier hs-type">BlockCreationTime</span></a></span><span>
</span><span id="line-443"></span><span>            </span><span class="hs-comment">-- ^ the time when the block was creates as recorded by the miner</span><span>
</span><span id="line-444"></span><span>            </span><span class="hs-comment">-- of the block. The value must be strictly monotonically increasing</span><span>
</span><span id="line-445"></span><span>            </span><span class="hs-comment">-- with in the chain of blocks. The smallest allowed increment is</span><span>
</span><span id="line-446"></span><span>            </span><span class="hs-comment">-- 'smallestBlockTimeIncrement'. Nodes are supposed to ignore blocks</span><span>
</span><span id="line-447"></span><span>            </span><span class="hs-comment">-- with values that are in the future and reconsider a block when its</span><span>
</span><span id="line-448"></span><span>            </span><span class="hs-comment">-- value is in the past.</span><span>
</span><span id="line-449"></span><span>            </span><span class="hs-comment">--</span><span>
</span><span id="line-450"></span><span>            </span><span class="hs-comment">-- The block creation time is used to determine the block difficulty for</span><span>
</span><span id="line-451"></span><span>            </span><span class="hs-comment">-- future blocks.</span><span>
</span><span id="line-452"></span><span>            </span><span class="hs-comment">--</span><span>
</span><span id="line-453"></span><span>            </span><span class="hs-comment">-- Nodes are not supposed to consider the creation time when choosing</span><span>
</span><span id="line-454"></span><span>            </span><span class="hs-comment">-- between two valid (this include that creation times must not be in</span><span>
</span><span id="line-455"></span><span>            </span><span class="hs-comment">-- the future) forks.</span><span>
</span><span id="line-456"></span><span>            </span><span class="hs-comment">--</span><span>
</span><span id="line-457"></span><span>            </span><span class="hs-comment">-- This creates an incentive for nodes to maintain an accurate clock</span><span>
</span><span id="line-458"></span><span>            </span><span class="hs-comment">-- with respect to a (unspecified) commonly accepted time source,</span><span>
</span><span id="line-459"></span><span>            </span><span class="hs-comment">-- such as the public NTP network.</span><span>
</span><span id="line-460"></span><span>            </span><span class="hs-comment">--</span><span>
</span><span id="line-461"></span><span>            </span><span class="hs-comment">-- It is possible that a miner always chooses the smallest possible</span><span>
</span><span id="line-462"></span><span>            </span><span class="hs-comment">-- creation time value. It is not clear what advantage a miner would</span><span>
</span><span id="line-463"></span><span>            </span><span class="hs-comment">-- gain from doing so, but attack models should consider and investigate</span><span>
</span><span id="line-464"></span><span>            </span><span class="hs-comment">-- such behavior.</span><span>
</span><span id="line-465"></span><span>            </span><span class="hs-comment">--</span><span>
</span><span id="line-466"></span><span>            </span><span class="hs-comment">-- On the other hand miners may choose to compute forks with creation</span><span>
</span><span id="line-467"></span><span>            </span><span class="hs-comment">-- time long in the future. By doing so, the difficulty on such a fork</span><span>
</span><span id="line-468"></span><span>            </span><span class="hs-comment">-- would decrease allowing the miner to compute very long chains very</span><span>
</span><span id="line-469"></span><span>            </span><span class="hs-comment">-- quickly. However, those chains would become valid only after a long</span><span>
</span><span id="line-470"></span><span>            </span><span class="hs-comment">-- time passed. The algorithm for computing the difficulty must ensure</span><span>
</span><span id="line-471"></span><span>            </span><span class="hs-comment">-- this strategy doesn't give an advantage to an attacker that would</span><span>
</span><span id="line-472"></span><span>            </span><span class="hs-comment">-- increase the success probability for an attack.</span><span>
</span><span id="line-473"></span><span>
</span><span id="line-474"></span><span>        </span><span class="hs-special">,</span><span> </span><span id="_blockParent"><span class="annot"><span class="annottext">BlockHeader -&gt; BlockHash
</span><a href="Chainweb.BlockHeader.html#_blockParent"><span class="hs-identifier hs-var hs-var">_blockParent</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-pragma">{-# UNPACK</span><span> </span><span class="hs-pragma">#-}</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="Chainweb.BlockHash.html#BlockHash"><span class="hs-identifier hs-type">BlockHash</span></a></span><span>
</span><span id="line-475"></span><span>            </span><span class="hs-comment">-- ^ authoritative</span><span>
</span><span id="line-476"></span><span>
</span><span id="line-477"></span><span>        </span><span class="hs-special">,</span><span> </span><span id="_blockAdjacentHashes"><span class="annot"><span class="annottext">BlockHeader -&gt; BlockHashRecord
</span><a href="Chainweb.BlockHeader.html#_blockAdjacentHashes"><span class="hs-identifier hs-var hs-var">_blockAdjacentHashes</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="Chainweb.BlockHash.html#BlockHashRecord"><span class="hs-identifier hs-type">BlockHashRecord</span></a></span><span>
</span><span id="line-478"></span><span>            </span><span class="hs-comment">-- ^ authoritative</span><span>
</span><span id="line-479"></span><span>
</span><span id="line-480"></span><span>        </span><span class="hs-special">,</span><span> </span><span id="_blockTarget"><span class="annot"><span class="annottext">BlockHeader -&gt; HashTarget
</span><a href="Chainweb.BlockHeader.html#_blockTarget"><span class="hs-identifier hs-var hs-var">_blockTarget</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-pragma">{-# UNPACK</span><span> </span><span class="hs-pragma">#-}</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="Chainweb.Difficulty.html#HashTarget"><span class="hs-identifier hs-type">HashTarget</span></a></span><span>
</span><span id="line-481"></span><span>            </span><span class="hs-comment">-- ^ authoritative</span><span>
</span><span id="line-482"></span><span>
</span><span id="line-483"></span><span>        </span><span class="hs-special">,</span><span> </span><span id="_blockPayloadHash"><span class="annot"><span class="annottext">BlockHeader -&gt; BlockPayloadHash
</span><a href="Chainweb.BlockHeader.html#_blockPayloadHash"><span class="hs-identifier hs-var hs-var">_blockPayloadHash</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-pragma">{-# UNPACK</span><span> </span><span class="hs-pragma">#-}</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="Chainweb.Payload.html#BlockPayloadHash"><span class="hs-identifier hs-type">BlockPayloadHash</span></a></span><span>
</span><span id="line-484"></span><span>            </span><span class="hs-comment">-- ^ authoritative</span><span>
</span><span id="line-485"></span><span>
</span><span id="line-486"></span><span>        </span><span class="hs-special">,</span><span> </span><span id="_blockChainId"><span class="annot"><span class="annottext">BlockHeader -&gt; ChainId
</span><a href="Chainweb.BlockHeader.html#_blockChainId"><span class="hs-identifier hs-var hs-var">_blockChainId</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-pragma">{-# UNPACK</span><span> </span><span class="hs-pragma">#-}</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="Chainweb.ChainId.html#ChainId"><span class="hs-identifier hs-type">ChainId</span></a></span><span>
</span><span id="line-487"></span><span>
</span><span id="line-488"></span><span>        </span><span class="hs-special">,</span><span> </span><span id="_blockWeight"><span class="annot"><span class="annottext">BlockHeader -&gt; BlockWeight
</span><a href="Chainweb.BlockHeader.html#_blockWeight"><span class="hs-identifier hs-var hs-var">_blockWeight</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-pragma">{-# UNPACK</span><span> </span><span class="hs-pragma">#-}</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="Chainweb.BlockHeader.html#BlockWeight"><span class="hs-identifier hs-type">BlockWeight</span></a></span><span>
</span><span id="line-489"></span><span>            </span><span class="hs-comment">-- ^ the accumulated weight of the chain. It is redundant information</span><span>
</span><span id="line-490"></span><span>            </span><span class="hs-comment">-- that is subject to the inductive property that the block weight</span><span>
</span><span id="line-491"></span><span>            </span><span class="hs-comment">-- of a block is the block weight of the parent plus the difficulty</span><span>
</span><span id="line-492"></span><span>            </span><span class="hs-comment">-- of the block.</span><span>
</span><span id="line-493"></span><span>
</span><span id="line-494"></span><span>        </span><span class="hs-special">,</span><span> </span><span id="_blockHeight"><span class="annot"><span class="annottext">BlockHeader -&gt; BlockHeight
</span><a href="Chainweb.BlockHeader.html#_blockHeight"><span class="hs-identifier hs-var hs-var">_blockHeight</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-pragma">{-# UNPACK</span><span> </span><span class="hs-pragma">#-}</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="Chainweb.BlockHeader.html#BlockHeight"><span class="hs-identifier hs-type">BlockHeight</span></a></span><span>
</span><span id="line-495"></span><span>            </span><span class="hs-comment">-- ^ block height records the length of the chain. It is redundant</span><span>
</span><span id="line-496"></span><span>            </span><span class="hs-comment">-- information and thus subject the inductive property that</span><span>
</span><span id="line-497"></span><span>            </span><span class="hs-comment">-- the block height of a block is the block height of its parent</span><span>
</span><span id="line-498"></span><span>            </span><span class="hs-comment">-- plus one.</span><span>
</span><span id="line-499"></span><span>
</span><span id="line-500"></span><span>        </span><span class="hs-special">,</span><span> </span><span id="_blockChainwebVersion"><span class="annot"><span class="annottext">BlockHeader -&gt; ChainwebVersion
</span><a href="Chainweb.BlockHeader.html#_blockChainwebVersion"><span class="hs-identifier hs-var hs-var">_blockChainwebVersion</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="Chainweb.Version.html#ChainwebVersion"><span class="hs-identifier hs-type">ChainwebVersion</span></a></span><span>
</span><span id="line-501"></span><span>            </span><span class="hs-comment">-- ^ the Chainweb version is a constant for the chain. A chain</span><span>
</span><span id="line-502"></span><span>            </span><span class="hs-comment">-- is uniquely identified by its genesis block. Thus this is</span><span>
</span><span id="line-503"></span><span>            </span><span class="hs-comment">-- redundant information and thus subject to the inductive property</span><span>
</span><span id="line-504"></span><span>            </span><span class="hs-comment">-- that the Chainweb version of a block equals the Chainweb version</span><span>
</span><span id="line-505"></span><span>            </span><span class="hs-comment">-- of its parent.</span><span>
</span><span id="line-506"></span><span>
</span><span id="line-507"></span><span>        </span><span class="hs-special">,</span><span> </span><span id="_blockEpochStart"><span class="annot"><span class="annottext">BlockHeader -&gt; EpochStartTime
</span><a href="Chainweb.BlockHeader.html#_blockEpochStart"><span class="hs-identifier hs-var hs-var">_blockEpochStart</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-pragma">{-# UNPACK</span><span> </span><span class="hs-pragma">#-}</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="Chainweb.BlockHeader.html#EpochStartTime"><span class="hs-identifier hs-type">EpochStartTime</span></a></span><span>
</span><span id="line-508"></span><span>            </span><span class="hs-comment">-- ^ The start time of the current difficulty adjustment epoch.</span><span>
</span><span id="line-509"></span><span>            </span><span class="hs-comment">-- Epochs divide the sequence of blocks in the chain into continuous</span><span>
</span><span id="line-510"></span><span>            </span><span class="hs-comment">-- ranges of blocks. Each epoch is defined by the minimal block</span><span>
</span><span id="line-511"></span><span>            </span><span class="hs-comment">-- height of the blocks in the epoch.</span><span>
</span><span id="line-512"></span><span>
</span><span id="line-513"></span><span>        </span><span class="hs-special">,</span><span> </span><span id="_blockFlags"><span class="annot"><span class="annottext">BlockHeader -&gt; FeatureFlags
</span><a href="Chainweb.BlockHeader.html#_blockFlags"><span class="hs-identifier hs-var hs-var">_blockFlags</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-pragma">{-# UNPACK</span><span> </span><span class="hs-pragma">#-}</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="Chainweb.BlockHeader.html#FeatureFlags"><span class="hs-identifier hs-type">FeatureFlags</span></a></span><span>
</span><span id="line-514"></span><span>            </span><span class="hs-comment">-- ^ An 8-byte bitmask reserved for the future addition of boolean</span><span>
</span><span id="line-515"></span><span>            </span><span class="hs-comment">-- &quot;feature flags&quot;.</span><span>
</span><span id="line-516"></span><span>
</span><span id="line-517"></span><span>        </span><span class="hs-special">,</span><span> </span><span id="_blockHash"><span class="annot"><span class="annottext">BlockHeader -&gt; BlockHash
</span><a href="Chainweb.BlockHeader.html#_blockHash"><span class="hs-identifier hs-var hs-var">_blockHash</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-pragma">{-# UNPACK</span><span> </span><span class="hs-pragma">#-}</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="Chainweb.BlockHash.html#BlockHash"><span class="hs-identifier hs-type">BlockHash</span></a></span><span>
</span><span id="line-518"></span><span>            </span><span class="hs-comment">-- ^ the hash of the block. It includes all of the above block properties.</span><span>
</span><span id="line-519"></span><span>        </span><span class="hs-special">}</span><span>
</span><span id="line-520"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Chainweb.BlockHeader.html#BlockHeader"><span class="hs-identifier hs-type">BlockHeader</span></a></span><span>
</span><span id="line-521"></span><span>        </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681480578"><span id="local-6989586621681480580"><span id="local-6989586621681480582"><span class="annot"><span class="annottext">Int -&gt; BlockHeader -&gt; ShowS
[BlockHeader] -&gt; ShowS
BlockHeader -&gt; String
(Int -&gt; BlockHeader -&gt; ShowS)
-&gt; (BlockHeader -&gt; String)
-&gt; ([BlockHeader] -&gt; ShowS)
-&gt; Show BlockHeader
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [BlockHeader] -&gt; ShowS
$cshowList :: [BlockHeader] -&gt; ShowS
show :: BlockHeader -&gt; String
$cshow :: BlockHeader -&gt; String
showsPrec :: Int -&gt; BlockHeader -&gt; ShowS
$cshowsPrec :: Int -&gt; BlockHeader -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(forall x. BlockHeader -&gt; Rep BlockHeader x)
-&gt; (forall x. Rep BlockHeader x -&gt; BlockHeader)
-&gt; Generic BlockHeader
forall x. Rep BlockHeader x -&gt; BlockHeader
forall x. BlockHeader -&gt; Rep BlockHeader x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
$cto :: forall x. Rep BlockHeader x -&gt; BlockHeader
$cfrom :: forall x. BlockHeader -&gt; Rep BlockHeader x
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">Generic</span></span><span class="hs-special">)</span><span>
</span><span id="line-522"></span><span>        </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">anyclass</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621681480574"><span class="annot"><span class="annottext">BlockHeader -&gt; ()
(BlockHeader -&gt; ()) -&gt; NFData BlockHeader
forall a. (a -&gt; ()) -&gt; NFData a
rnf :: BlockHeader -&gt; ()
$crnf :: BlockHeader -&gt; ()
</span><a href="#local-6989586621681480574"><span class="hs-identifier hs-var hs-var hs-var hs-var">NFData</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-523"></span><span>
</span><span id="line-524"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681480571"><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="Chainweb.BlockHeader.html#BlockHeader"><span class="hs-identifier hs-type">BlockHeader</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-525"></span><span>     </span><span id="local-6989586621681480570"><span class="annot"><span class="annottext">== :: BlockHeader -&gt; BlockHeader -&gt; Bool
</span><span class="hs-operator hs-var hs-var hs-var hs-var">(==)</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BlockHash -&gt; BlockHash -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">(==)</span></span><span> </span><span class="annot"><span class="annottext">(BlockHash -&gt; BlockHash -&gt; Bool)
-&gt; (BlockHeader -&gt; BlockHash) -&gt; BlockHeader -&gt; BlockHeader -&gt; Bool
forall b c a. (b -&gt; b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; a -&gt; c
</span><span class="hs-operator hs-var">`on`</span></span><span> </span><span class="annot"><span class="annottext">BlockHeader -&gt; BlockHash
</span><a href="Chainweb.BlockHeader.html#_blockHash"><span class="hs-identifier hs-var hs-var">_blockHash</span></a></span><span>
</span><span id="line-526"></span><span>     </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">==</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-527"></span><span>
</span><span id="line-528"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681480556"><span id="local-6989586621681480558"><span id="local-6989586621681480560"><span id="local-6989586621681480562"><span id="local-6989586621681480564"><span id="local-6989586621681480566"><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="Chainweb.BlockHeader.html#BlockHeader"><span class="hs-identifier hs-type">BlockHeader</span></a></span></span></span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-529"></span><span>     </span><span id="local-6989586621681480555"><span class="annot"><span class="annottext">compare :: BlockHeader -&gt; BlockHeader -&gt; Ordering
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">compare</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BlockHash -&gt; BlockHash -&gt; Ordering
forall a. Ord a =&gt; a -&gt; a -&gt; Ordering
</span><span class="hs-identifier hs-var">compare</span></span><span> </span><span class="annot"><span class="annottext">(BlockHash -&gt; BlockHash -&gt; Ordering)
-&gt; (BlockHeader -&gt; BlockHash)
-&gt; BlockHeader
-&gt; BlockHeader
-&gt; Ordering
forall b c a. (b -&gt; b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; a -&gt; c
</span><span class="hs-operator hs-var">`on`</span></span><span> </span><span class="annot"><span class="annottext">BlockHeader -&gt; BlockHash
</span><a href="Chainweb.BlockHeader.html#_blockHash"><span class="hs-identifier hs-var hs-var">_blockHash</span></a></span><span>
</span><span id="line-530"></span><span>     </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><span class="hs-pragma hs-type">compare</span></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-531"></span><span>
</span><span id="line-532"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681480551"><span class="annot"><span class="hs-identifier hs-type">Hashable</span></span><span> </span><span class="annot"><a href="Chainweb.BlockHeader.html#BlockHeader"><span class="hs-identifier hs-type">BlockHeader</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-533"></span><span>    </span><span id="local-6989586621681480550"><span class="annot"><span class="annottext">hashWithSalt :: Int -&gt; BlockHeader -&gt; Int
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">hashWithSalt</span></span></span><span> </span><span id="local-6989586621681480548"><span class="annot"><span class="annottext">s :: Int
</span><a href="#local-6989586621681480548"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; BlockHash -&gt; Int
forall a. Hashable a =&gt; Int -&gt; a -&gt; Int
</span><span class="hs-identifier hs-var">hashWithSalt</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681480548"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">(BlockHash -&gt; Int)
-&gt; (BlockHeader -&gt; BlockHash) -&gt; BlockHeader -&gt; Int
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">BlockHeader -&gt; BlockHash
</span><a href="Chainweb.BlockHeader.html#_blockHash"><span class="hs-identifier hs-var hs-var">_blockHash</span></a></span><span>
</span><span id="line-534"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><span class="hs-pragma hs-type">hashWithSalt</span></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-535"></span><span>
</span><span id="line-536"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681480545"><span class="annot"><a href="Chainweb.ChainId.html#HasChainId"><span class="hs-identifier hs-type">HasChainId</span></a></span><span> </span><span class="annot"><a href="Chainweb.BlockHeader.html#BlockHeader"><span class="hs-identifier hs-type">BlockHeader</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-537"></span><span>    </span><span id="local-6989586621681480543"><span class="annot"><span class="annottext">_chainId :: BlockHeader -&gt; ChainId
</span><a href="Chainweb.ChainId.html#_chainId"><span class="hs-identifier hs-var hs-var hs-var hs-var">_chainId</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BlockHeader -&gt; ChainId
</span><a href="Chainweb.BlockHeader.html#_blockChainId"><span class="hs-identifier hs-var hs-var">_blockChainId</span></a></span><span>
</span><span id="line-538"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Chainweb.ChainId.html#_chainId"><span class="hs-pragma hs-type">_chainId</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-539"></span><span>
</span><span id="line-540"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681480539"><span class="annot"><a href="Chainweb.Graph.html#HasChainGraph"><span class="hs-identifier hs-type">HasChainGraph</span></a></span><span> </span><span class="annot"><a href="Chainweb.BlockHeader.html#BlockHeader"><span class="hs-identifier hs-type">BlockHeader</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-541"></span><span>    </span><span id="local-6989586621681480537"><span class="annot"><span class="annottext">_chainGraph :: BlockHeader -&gt; ChainGraph
</span><a href="Chainweb.Graph.html#_chainGraph"><span class="hs-identifier hs-var hs-var hs-var hs-var">_chainGraph</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ChainwebVersion -&gt; ChainGraph
forall a. HasChainGraph a =&gt; a -&gt; ChainGraph
</span><a href="Chainweb.Graph.html#_chainGraph"><span class="hs-identifier hs-var">_chainGraph</span></a></span><span> </span><span class="annot"><span class="annottext">(ChainwebVersion -&gt; ChainGraph)
-&gt; (BlockHeader -&gt; ChainwebVersion) -&gt; BlockHeader -&gt; ChainGraph
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">BlockHeader -&gt; ChainwebVersion
</span><a href="Chainweb.BlockHeader.html#_blockChainwebVersion"><span class="hs-identifier hs-var hs-var">_blockChainwebVersion</span></a></span><span>
</span><span id="line-542"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Chainweb.Graph.html#_chainGraph"><span class="hs-pragma hs-type">_chainGraph</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-543"></span><span>
</span><span id="line-544"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681480533"><span class="annot"><a href="Chainweb.Version.html#HasChainwebVersion"><span class="hs-identifier hs-type">HasChainwebVersion</span></a></span><span> </span><span class="annot"><a href="Chainweb.BlockHeader.html#BlockHeader"><span class="hs-identifier hs-type">BlockHeader</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-545"></span><span>    </span><span id="local-6989586621681480531"><span class="annot"><span class="annottext">_chainwebVersion :: BlockHeader -&gt; ChainwebVersion
</span><a href="Chainweb.Version.html#_chainwebVersion"><span class="hs-identifier hs-var hs-var hs-var hs-var">_chainwebVersion</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BlockHeader -&gt; ChainwebVersion
</span><a href="Chainweb.BlockHeader.html#_blockChainwebVersion"><span class="hs-identifier hs-var hs-var">_blockChainwebVersion</span></a></span><span>
</span><span id="line-546"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Chainweb.Version.html#_chainwebVersion"><span class="hs-pragma hs-type">_chainwebVersion</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-547"></span><span>
</span><span id="line-548"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IsCasValue</span></span><span> </span><span class="annot"><a href="Chainweb.BlockHeader.html#BlockHeader"><span class="hs-identifier hs-type">BlockHeader</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-549"></span><span>    </span><span class="hs-keyword">type</span><span> </span><span id="CasKeyType"><span class="annot"><span class="hs-identifier hs-var">CasKeyType</span></span></span><span> </span><span class="annot"><a href="Chainweb.BlockHeader.html#BlockHeader"><span class="hs-identifier hs-type">BlockHeader</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Chainweb.BlockHash.html#BlockHash"><span class="hs-identifier hs-type">BlockHash</span></a></span><span>
</span><span id="line-550"></span><span>    </span><span id="local-6989586621681480526"><span class="annot"><span class="annottext">casKey :: BlockHeader -&gt; CasKeyType BlockHeader
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">casKey</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BlockHeader -&gt; CasKeyType BlockHeader
BlockHeader -&gt; BlockHash
</span><a href="Chainweb.BlockHeader.html#_blockHash"><span class="hs-identifier hs-var hs-var">_blockHash</span></a></span><span>
</span><span id="line-551"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><span class="hs-pragma hs-type">casKey</span></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-552"></span><span>
</span><span id="line-553"></span><span class="hs-keyword">type</span><span> </span><span id="BlockHeaderCas"><span class="annot"><a href="Chainweb.BlockHeader.html#BlockHeaderCas"><span class="hs-identifier hs-var">BlockHeaderCas</span></a></span></span><span> </span><span id="local-6989586621681480524"><span class="annot"><a href="#local-6989586621681480524"><span class="hs-identifier hs-type">cas</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">CasConstraint</span></span><span> </span><span class="annot"><a href="#local-6989586621681480524"><span class="hs-identifier hs-type">cas</span></a></span><span> </span><span class="annot"><a href="Chainweb.BlockHeader.html#BlockHeader"><span class="hs-identifier hs-type">BlockHeader</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-554"></span><span>
</span><span id="line-555"></span><span id="blockFlags"><span id="blockEpochStart"><span id="blockTarget"><span id="blockPayloadHash"><span id="blockParent"><span id="blockHash"><span id="blockCreationTime"><span id="blockAdjacentHashes"><span id="blockChainwebVersion"><span id="blockWeight"><span id="blockHeight"><span id="blockChainId"><span id="blockNonce"><span class="hs-identifier">makeLenses</span><span> </span><span class="hs-special">''</span><span class="hs-identifier">BlockHeader</span></span></span></span></span></span></span></span></span></span></span></span></span></span><span>
</span><span id="line-556"></span><span>
</span><span id="line-557"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Serialize</span></span><span> </span><span class="annot"><a href="Chainweb.BlockHeader.html#BlockHeader"><span class="hs-identifier hs-type">BlockHeader</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-558"></span><span>    </span><span id="local-6989586621681480519"><span class="annot"><span class="annottext">put :: Putter BlockHeader
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">put</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Putter BlockHeader
forall (m :: * -&gt; *). MonadPut m =&gt; BlockHeader -&gt; m ()
</span><a href="Chainweb.BlockHeader.html#encodeBlockHeader"><span class="hs-identifier hs-var">encodeBlockHeader</span></a></span><span>
</span><span id="line-559"></span><span>    </span><span id="local-6989586621681480517"><span class="annot"><span class="annottext">get :: Get BlockHeader
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">get</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Get BlockHeader
forall (m :: * -&gt; *). MonadGet m =&gt; m BlockHeader
</span><a href="Chainweb.BlockHeader.html#decodeBlockHeader"><span class="hs-identifier hs-var">decodeBlockHeader</span></a></span><span>
</span><span id="line-560"></span><span>
</span><span id="line-561"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Chainweb.Crypto.MerkleLog.html#HasMerkleLog"><span class="hs-identifier hs-type">HasMerkleLog</span></a></span><span> </span><span class="annot"><a href="Chainweb.MerkleUniverse.html#ChainwebHashTag"><span class="hs-identifier hs-type">ChainwebHashTag</span></a></span><span> </span><span class="annot"><a href="Chainweb.BlockHeader.html#BlockHeader"><span class="hs-identifier hs-type">BlockHeader</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-562"></span><span>
</span><span id="line-563"></span><span>    </span><span class="hs-comment">-- /IMPORTANT/ a types must occur at most once in this list</span><span>
</span><span id="line-564"></span><span>    </span><span class="hs-keyword">type</span><span> </span><span id="MerkleLogHeader"><span class="annot"><a href="Chainweb.Crypto.MerkleLog.html#MerkleLogHeader"><span class="hs-identifier hs-var">MerkleLogHeader</span></a></span></span><span> </span><span class="annot"><a href="Chainweb.BlockHeader.html#BlockHeader"><span class="hs-identifier hs-type">BlockHeader</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-565"></span><span>        </span><span class="hs-special">'</span><span class="hs-special">[</span><span> </span><span class="annot"><a href="Chainweb.BlockHeader.html#Nonce"><span class="hs-identifier hs-type">Nonce</span></a></span><span>
</span><span id="line-566"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Chainweb.BlockHeader.html#BlockCreationTime"><span class="hs-identifier hs-type">BlockCreationTime</span></a></span><span>
</span><span id="line-567"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Chainweb.BlockHash.html#BlockHash"><span class="hs-identifier hs-type">BlockHash</span></a></span><span>
</span><span id="line-568"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Chainweb.Difficulty.html#HashTarget"><span class="hs-identifier hs-type">HashTarget</span></a></span><span>
</span><span id="line-569"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Chainweb.Payload.html#BlockPayloadHash"><span class="hs-identifier hs-type">BlockPayloadHash</span></a></span><span>
</span><span id="line-570"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Chainweb.ChainId.html#ChainId"><span class="hs-identifier hs-type">ChainId</span></a></span><span>
</span><span id="line-571"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Chainweb.BlockHeader.html#BlockWeight"><span class="hs-identifier hs-type">BlockWeight</span></a></span><span>
</span><span id="line-572"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Chainweb.BlockHeader.html#BlockHeight"><span class="hs-identifier hs-type">BlockHeight</span></a></span><span>
</span><span id="line-573"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Chainweb.Version.html#ChainwebVersion"><span class="hs-identifier hs-type">ChainwebVersion</span></a></span><span>
</span><span id="line-574"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Chainweb.BlockHeader.html#EpochStartTime"><span class="hs-identifier hs-type">EpochStartTime</span></a></span><span>
</span><span id="line-575"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Chainweb.BlockHeader.html#FeatureFlags"><span class="hs-identifier hs-type">FeatureFlags</span></a></span><span>
</span><span id="line-576"></span><span>        </span><span class="hs-special">]</span><span>
</span><span id="line-577"></span><span>    </span><span class="hs-keyword">type</span><span> </span><span id="MerkleLogBody"><span class="annot"><a href="Chainweb.Crypto.MerkleLog.html#MerkleLogBody"><span class="hs-identifier hs-var">MerkleLogBody</span></a></span></span><span> </span><span class="annot"><a href="Chainweb.BlockHeader.html#BlockHeader"><span class="hs-identifier hs-type">BlockHeader</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Chainweb.BlockHash.html#BlockHash"><span class="hs-identifier hs-type">BlockHash</span></a></span><span>
</span><span id="line-578"></span><span>
</span><span id="line-579"></span><span>    </span><span id="local-6989586621681480510"><span class="annot"><span class="annottext">toLog :: BlockHeader
-&gt; MerkleLog
     ChainwebHashTag
     (MerkleLogHeader BlockHeader)
     (MerkleLogBody BlockHeader)
</span><a href="Chainweb.Crypto.MerkleLog.html#toLog"><span class="hs-identifier hs-var hs-var hs-var hs-var">toLog</span></a></span></span><span> </span><span id="local-6989586621681480508"><span class="annot"><span class="annottext">bh :: BlockHeader
</span><a href="#local-6989586621681480508"><span class="hs-identifier hs-var">bh</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MerkleRoot (HashAlg ChainwebHashTag)
-&gt; MerkleLogEntries
     ChainwebHashTag
     '[Nonce, BlockCreationTime, BlockHash, HashTarget,
       BlockPayloadHash, ChainId, BlockWeight, BlockHeight,
       ChainwebVersion, EpochStartTime, FeatureFlags]
     BlockHash
-&gt; MerkleLog
     ChainwebHashTag
     '[Nonce, BlockCreationTime, BlockHash, HashTarget,
       BlockPayloadHash, ChainId, BlockWeight, BlockHeight,
       ChainwebVersion, EpochStartTime, FeatureFlags]
     BlockHash
forall u (h :: [*]) b.
HashAlgorithm (HashAlg u) =&gt;
MerkleRoot (HashAlg u) -&gt; MerkleLogEntries u h b -&gt; MerkleLog u h b
</span><a href="Chainweb.Crypto.MerkleLog.html#merkleLog"><span class="hs-identifier hs-var">merkleLog</span></a></span><span> </span><span class="annot"><span class="annottext">MerkleRoot (HashAlg ChainwebHashTag)
</span><a href="#local-6989586621681480506"><span class="hs-identifier hs-var">root</span></a></span><span> </span><span class="annot"><span class="annottext">MerkleLogEntries
  ChainwebHashTag
  '[Nonce, BlockCreationTime, BlockHash, HashTarget,
    BlockPayloadHash, ChainId, BlockWeight, BlockHeight,
    ChainwebVersion, EpochStartTime, FeatureFlags]
  BlockHash
</span><a href="#local-6989586621681480505"><span class="hs-identifier hs-var">entries</span></a></span><span>
</span><span id="line-580"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-581"></span><span>        </span><span class="annot"><a href="Chainweb.BlockHash.html#BlockHash"><span class="hs-identifier hs-type">BlockHash</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Chainweb.MerkleLogHash.html#MerkleLogHash"><span class="hs-identifier hs-type">MerkleLogHash</span></a></span><span> </span><span id="local-6989586621681480506"><span class="annot"><span class="annottext">root :: MerkleRoot (HashAlg ChainwebHashTag)
</span><a href="#local-6989586621681480506"><span class="hs-identifier hs-var">root</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BlockHeader -&gt; BlockHash
</span><a href="Chainweb.BlockHeader.html#_blockHash"><span class="hs-identifier hs-var hs-var">_blockHash</span></a></span><span> </span><span class="annot"><span class="annottext">BlockHeader
</span><a href="#local-6989586621681480508"><span class="hs-identifier hs-var">bh</span></a></span><span>
</span><span id="line-582"></span><span>        </span><span id="local-6989586621681480505"><span class="annot"><span class="annottext">entries :: MerkleLogEntries
  ChainwebHashTag
  '[Nonce, BlockCreationTime, BlockHash, HashTarget,
    BlockPayloadHash, ChainId, BlockWeight, BlockHeight,
    ChainwebVersion, EpochStartTime, FeatureFlags]
  BlockHash
</span><a href="#local-6989586621681480505"><span class="hs-identifier hs-var hs-var">entries</span></a></span></span><span>
</span><span id="line-583"></span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BlockHeader -&gt; Nonce
</span><a href="Chainweb.BlockHeader.html#_blockNonce"><span class="hs-identifier hs-var hs-var">_blockNonce</span></a></span><span> </span><span class="annot"><span class="annottext">BlockHeader
</span><a href="#local-6989586621681480508"><span class="hs-identifier hs-var">bh</span></a></span><span>
</span><span id="line-584"></span><span>            </span><span class="annot"><span class="annottext">Nonce
-&gt; MerkleLogEntries
     ChainwebHashTag
     '[BlockCreationTime, BlockHash, HashTarget, BlockPayloadHash,
       ChainId, BlockWeight, BlockHeight, ChainwebVersion, EpochStartTime,
       FeatureFlags]
     BlockHash
-&gt; MerkleLogEntries
     ChainwebHashTag
     '[Nonce, BlockCreationTime, BlockHash, HashTarget,
       BlockPayloadHash, ChainId, BlockWeight, BlockHeight,
       ChainwebVersion, EpochStartTime, FeatureFlags]
     BlockHash
forall u h (t :: [*]) b.
IsMerkleLogEntry u h =&gt;
h -&gt; MerkleLogEntries u t b -&gt; MerkleLogEntries u (h : t) b
</span><a href="Chainweb.Crypto.MerkleLog.html#%3A%2B%3A"><span class="hs-operator hs-var">:+:</span></a></span><span> </span><span class="annot"><span class="annottext">BlockHeader -&gt; BlockCreationTime
</span><a href="Chainweb.BlockHeader.html#_blockCreationTime"><span class="hs-identifier hs-var hs-var">_blockCreationTime</span></a></span><span> </span><span class="annot"><span class="annottext">BlockHeader
</span><a href="#local-6989586621681480508"><span class="hs-identifier hs-var">bh</span></a></span><span>
</span><span id="line-585"></span><span>            </span><span class="annot"><span class="annottext">BlockCreationTime
-&gt; MerkleLogEntries
     ChainwebHashTag
     '[BlockHash, HashTarget, BlockPayloadHash, ChainId, BlockWeight,
       BlockHeight, ChainwebVersion, EpochStartTime, FeatureFlags]
     BlockHash
-&gt; MerkleLogEntries
     ChainwebHashTag
     '[BlockCreationTime, BlockHash, HashTarget, BlockPayloadHash,
       ChainId, BlockWeight, BlockHeight, ChainwebVersion, EpochStartTime,
       FeatureFlags]
     BlockHash
forall u h (t :: [*]) b.
IsMerkleLogEntry u h =&gt;
h -&gt; MerkleLogEntries u t b -&gt; MerkleLogEntries u (h : t) b
</span><a href="Chainweb.Crypto.MerkleLog.html#%3A%2B%3A"><span class="hs-operator hs-var">:+:</span></a></span><span> </span><span class="annot"><span class="annottext">BlockHeader -&gt; BlockHash
</span><a href="Chainweb.BlockHeader.html#_blockParent"><span class="hs-identifier hs-var hs-var">_blockParent</span></a></span><span> </span><span class="annot"><span class="annottext">BlockHeader
</span><a href="#local-6989586621681480508"><span class="hs-identifier hs-var">bh</span></a></span><span>
</span><span id="line-586"></span><span>            </span><span class="annot"><span class="annottext">BlockHash
-&gt; MerkleLogEntries
     ChainwebHashTag
     '[HashTarget, BlockPayloadHash, ChainId, BlockWeight, BlockHeight,
       ChainwebVersion, EpochStartTime, FeatureFlags]
     BlockHash
-&gt; MerkleLogEntries
     ChainwebHashTag
     '[BlockHash, HashTarget, BlockPayloadHash, ChainId, BlockWeight,
       BlockHeight, ChainwebVersion, EpochStartTime, FeatureFlags]
     BlockHash
forall u h (t :: [*]) b.
IsMerkleLogEntry u h =&gt;
h -&gt; MerkleLogEntries u t b -&gt; MerkleLogEntries u (h : t) b
</span><a href="Chainweb.Crypto.MerkleLog.html#%3A%2B%3A"><span class="hs-operator hs-var">:+:</span></a></span><span> </span><span class="annot"><span class="annottext">BlockHeader -&gt; HashTarget
</span><a href="Chainweb.BlockHeader.html#_blockTarget"><span class="hs-identifier hs-var hs-var">_blockTarget</span></a></span><span> </span><span class="annot"><span class="annottext">BlockHeader
</span><a href="#local-6989586621681480508"><span class="hs-identifier hs-var">bh</span></a></span><span>
</span><span id="line-587"></span><span>            </span><span class="annot"><span class="annottext">HashTarget
-&gt; MerkleLogEntries
     ChainwebHashTag
     '[BlockPayloadHash, ChainId, BlockWeight, BlockHeight,
       ChainwebVersion, EpochStartTime, FeatureFlags]
     BlockHash
-&gt; MerkleLogEntries
     ChainwebHashTag
     '[HashTarget, BlockPayloadHash, ChainId, BlockWeight, BlockHeight,
       ChainwebVersion, EpochStartTime, FeatureFlags]
     BlockHash
forall u h (t :: [*]) b.
IsMerkleLogEntry u h =&gt;
h -&gt; MerkleLogEntries u t b -&gt; MerkleLogEntries u (h : t) b
</span><a href="Chainweb.Crypto.MerkleLog.html#%3A%2B%3A"><span class="hs-operator hs-var">:+:</span></a></span><span> </span><span class="annot"><span class="annottext">BlockHeader -&gt; BlockPayloadHash
</span><a href="Chainweb.BlockHeader.html#_blockPayloadHash"><span class="hs-identifier hs-var hs-var">_blockPayloadHash</span></a></span><span> </span><span class="annot"><span class="annottext">BlockHeader
</span><a href="#local-6989586621681480508"><span class="hs-identifier hs-var">bh</span></a></span><span>
</span><span id="line-588"></span><span>            </span><span class="annot"><span class="annottext">BlockPayloadHash
-&gt; MerkleLogEntries
     ChainwebHashTag
     '[ChainId, BlockWeight, BlockHeight, ChainwebVersion,
       EpochStartTime, FeatureFlags]
     BlockHash
-&gt; MerkleLogEntries
     ChainwebHashTag
     '[BlockPayloadHash, ChainId, BlockWeight, BlockHeight,
       ChainwebVersion, EpochStartTime, FeatureFlags]
     BlockHash
forall u h (t :: [*]) b.
IsMerkleLogEntry u h =&gt;
h -&gt; MerkleLogEntries u t b -&gt; MerkleLogEntries u (h : t) b
</span><a href="Chainweb.Crypto.MerkleLog.html#%3A%2B%3A"><span class="hs-operator hs-var">:+:</span></a></span><span> </span><span class="annot"><span class="annottext">BlockHeader -&gt; ChainId
</span><a href="Chainweb.BlockHeader.html#_blockChainId"><span class="hs-identifier hs-var hs-var">_blockChainId</span></a></span><span> </span><span class="annot"><span class="annottext">BlockHeader
</span><a href="#local-6989586621681480508"><span class="hs-identifier hs-var">bh</span></a></span><span>
</span><span id="line-589"></span><span>            </span><span class="annot"><span class="annottext">ChainId
-&gt; MerkleLogEntries
     ChainwebHashTag
     '[BlockWeight, BlockHeight, ChainwebVersion, EpochStartTime,
       FeatureFlags]
     BlockHash
-&gt; MerkleLogEntries
     ChainwebHashTag
     '[ChainId, BlockWeight, BlockHeight, ChainwebVersion,
       EpochStartTime, FeatureFlags]
     BlockHash
forall u h (t :: [*]) b.
IsMerkleLogEntry u h =&gt;
h -&gt; MerkleLogEntries u t b -&gt; MerkleLogEntries u (h : t) b
</span><a href="Chainweb.Crypto.MerkleLog.html#%3A%2B%3A"><span class="hs-operator hs-var">:+:</span></a></span><span> </span><span class="annot"><span class="annottext">BlockHeader -&gt; BlockWeight
</span><a href="Chainweb.BlockHeader.html#_blockWeight"><span class="hs-identifier hs-var hs-var">_blockWeight</span></a></span><span> </span><span class="annot"><span class="annottext">BlockHeader
</span><a href="#local-6989586621681480508"><span class="hs-identifier hs-var">bh</span></a></span><span>
</span><span id="line-590"></span><span>            </span><span class="annot"><span class="annottext">BlockWeight
-&gt; MerkleLogEntries
     ChainwebHashTag
     '[BlockHeight, ChainwebVersion, EpochStartTime, FeatureFlags]
     BlockHash
-&gt; MerkleLogEntries
     ChainwebHashTag
     '[BlockWeight, BlockHeight, ChainwebVersion, EpochStartTime,
       FeatureFlags]
     BlockHash
forall u h (t :: [*]) b.
IsMerkleLogEntry u h =&gt;
h -&gt; MerkleLogEntries u t b -&gt; MerkleLogEntries u (h : t) b
</span><a href="Chainweb.Crypto.MerkleLog.html#%3A%2B%3A"><span class="hs-operator hs-var">:+:</span></a></span><span> </span><span class="annot"><span class="annottext">BlockHeader -&gt; BlockHeight
</span><a href="Chainweb.BlockHeader.html#_blockHeight"><span class="hs-identifier hs-var hs-var">_blockHeight</span></a></span><span> </span><span class="annot"><span class="annottext">BlockHeader
</span><a href="#local-6989586621681480508"><span class="hs-identifier hs-var">bh</span></a></span><span>
</span><span id="line-591"></span><span>            </span><span class="annot"><span class="annottext">BlockHeight
-&gt; MerkleLogEntries
     ChainwebHashTag
     '[ChainwebVersion, EpochStartTime, FeatureFlags]
     BlockHash
-&gt; MerkleLogEntries
     ChainwebHashTag
     '[BlockHeight, ChainwebVersion, EpochStartTime, FeatureFlags]
     BlockHash
forall u h (t :: [*]) b.
IsMerkleLogEntry u h =&gt;
h -&gt; MerkleLogEntries u t b -&gt; MerkleLogEntries u (h : t) b
</span><a href="Chainweb.Crypto.MerkleLog.html#%3A%2B%3A"><span class="hs-operator hs-var">:+:</span></a></span><span> </span><span class="annot"><span class="annottext">BlockHeader -&gt; ChainwebVersion
</span><a href="Chainweb.BlockHeader.html#_blockChainwebVersion"><span class="hs-identifier hs-var hs-var">_blockChainwebVersion</span></a></span><span> </span><span class="annot"><span class="annottext">BlockHeader
</span><a href="#local-6989586621681480508"><span class="hs-identifier hs-var">bh</span></a></span><span>
</span><span id="line-592"></span><span>            </span><span class="annot"><span class="annottext">ChainwebVersion
-&gt; MerkleLogEntries
     ChainwebHashTag '[EpochStartTime, FeatureFlags] BlockHash
-&gt; MerkleLogEntries
     ChainwebHashTag
     '[ChainwebVersion, EpochStartTime, FeatureFlags]
     BlockHash
forall u h (t :: [*]) b.
IsMerkleLogEntry u h =&gt;
h -&gt; MerkleLogEntries u t b -&gt; MerkleLogEntries u (h : t) b
</span><a href="Chainweb.Crypto.MerkleLog.html#%3A%2B%3A"><span class="hs-operator hs-var">:+:</span></a></span><span> </span><span class="annot"><span class="annottext">BlockHeader -&gt; EpochStartTime
</span><a href="Chainweb.BlockHeader.html#_blockEpochStart"><span class="hs-identifier hs-var hs-var">_blockEpochStart</span></a></span><span> </span><span class="annot"><span class="annottext">BlockHeader
</span><a href="#local-6989586621681480508"><span class="hs-identifier hs-var">bh</span></a></span><span>
</span><span id="line-593"></span><span>            </span><span class="annot"><span class="annottext">EpochStartTime
-&gt; MerkleLogEntries ChainwebHashTag '[FeatureFlags] BlockHash
-&gt; MerkleLogEntries
     ChainwebHashTag '[EpochStartTime, FeatureFlags] BlockHash
forall u h (t :: [*]) b.
IsMerkleLogEntry u h =&gt;
h -&gt; MerkleLogEntries u t b -&gt; MerkleLogEntries u (h : t) b
</span><a href="Chainweb.Crypto.MerkleLog.html#%3A%2B%3A"><span class="hs-operator hs-var">:+:</span></a></span><span> </span><span class="annot"><span class="annottext">BlockHeader -&gt; FeatureFlags
</span><a href="Chainweb.BlockHeader.html#_blockFlags"><span class="hs-identifier hs-var hs-var">_blockFlags</span></a></span><span> </span><span class="annot"><span class="annottext">BlockHeader
</span><a href="#local-6989586621681480508"><span class="hs-identifier hs-var">bh</span></a></span><span>
</span><span id="line-594"></span><span>            </span><span class="annot"><span class="annottext">FeatureFlags
-&gt; MerkleLogEntries ChainwebHashTag '[] BlockHash
-&gt; MerkleLogEntries ChainwebHashTag '[FeatureFlags] BlockHash
forall u h (t :: [*]) b.
IsMerkleLogEntry u h =&gt;
h -&gt; MerkleLogEntries u t b -&gt; MerkleLogEntries u (h : t) b
</span><a href="Chainweb.Crypto.MerkleLog.html#%3A%2B%3A"><span class="hs-operator hs-var">:+:</span></a></span><span> </span><span class="annot"><span class="annottext">Vector BlockHash -&gt; MerkleLogEntries ChainwebHashTag '[] BlockHash
forall u b.
IsMerkleLogEntry u b =&gt;
Vector b -&gt; MerkleLogEntries u '[] b
</span><a href="Chainweb.Crypto.MerkleLog.html#MerkleLogBody"><span class="hs-identifier hs-var">MerkleLogBody</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BlockHashRecord -&gt; Vector BlockHash
</span><a href="Chainweb.BlockHash.html#blockHashRecordToVector"><span class="hs-identifier hs-var">blockHashRecordToVector</span></a></span><span> </span><span class="annot"><span class="annottext">(BlockHashRecord -&gt; Vector BlockHash)
-&gt; BlockHashRecord -&gt; Vector BlockHash
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">BlockHeader -&gt; BlockHashRecord
</span><a href="Chainweb.BlockHeader.html#_blockAdjacentHashes"><span class="hs-identifier hs-var hs-var">_blockAdjacentHashes</span></a></span><span> </span><span class="annot"><span class="annottext">BlockHeader
</span><a href="#local-6989586621681480508"><span class="hs-identifier hs-var">bh</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-595"></span><span>
</span><span id="line-596"></span><span>    </span><span id="local-6989586621681480499"><span class="annot"><span class="annottext">fromLog :: MerkleLog
  ChainwebHashTag
  (MerkleLogHeader BlockHeader)
  (MerkleLogBody BlockHeader)
-&gt; BlockHeader
</span><a href="Chainweb.Crypto.MerkleLog.html#fromLog"><span class="hs-identifier hs-var hs-var hs-var hs-var">fromLog</span></a></span></span><span> </span><span id="local-6989586621681480497"><span class="annot"><span class="annottext">l :: MerkleLog
  ChainwebHashTag
  (MerkleLogHeader BlockHeader)
  (MerkleLogBody BlockHeader)
</span><a href="#local-6989586621681480497"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">$WBlockHeader :: Nonce
-&gt; BlockCreationTime
-&gt; BlockHash
-&gt; BlockHashRecord
-&gt; HashTarget
-&gt; BlockPayloadHash
-&gt; ChainId
-&gt; BlockWeight
-&gt; BlockHeight
-&gt; ChainwebVersion
-&gt; EpochStartTime
-&gt; FeatureFlags
-&gt; BlockHash
-&gt; BlockHeader
</span><a href="Chainweb.BlockHeader.html#%24WBlockHeader"><span class="hs-identifier hs-type hs-type">BlockHeader</span></a></span><span>
</span><span id="line-597"></span><span>            </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">_blockNonce :: Nonce
</span><a href="Chainweb.BlockHeader.html#_blockNonce"><span class="hs-identifier hs-var">_blockNonce</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Nonce
</span><a href="#local-6989586621681480495"><span class="hs-identifier hs-var">nonce</span></a></span><span>
</span><span id="line-598"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">_blockCreationTime :: BlockCreationTime
</span><a href="Chainweb.BlockHeader.html#_blockCreationTime"><span class="hs-identifier hs-var">_blockCreationTime</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BlockCreationTime
</span><a href="#local-6989586621681480494"><span class="hs-identifier hs-var">time</span></a></span><span>
</span><span id="line-599"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">_blockHash :: BlockHash
</span><a href="Chainweb.BlockHeader.html#_blockHash"><span class="hs-identifier hs-var">_blockHash</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MerkleLogHash -&gt; BlockHash
</span><a href="Chainweb.BlockHash.html#BlockHash"><span class="hs-identifier hs-var">BlockHash</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MerkleRoot (HashAlg ChainwebHashTag) -&gt; MerkleLogHash
</span><a href="Chainweb.MerkleLogHash.html#MerkleLogHash"><span class="hs-identifier hs-var">MerkleLogHash</span></a></span><span> </span><span class="annot"><span class="annottext">(MerkleRoot (HashAlg ChainwebHashTag) -&gt; MerkleLogHash)
-&gt; MerkleRoot (HashAlg ChainwebHashTag) -&gt; MerkleLogHash
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">MerkleLog
  ChainwebHashTag
  '[Nonce, BlockCreationTime, BlockHash, HashTarget,
    BlockPayloadHash, ChainId, BlockWeight, BlockHeight,
    ChainwebVersion, EpochStartTime, FeatureFlags]
  BlockHash
-&gt; MerkleRoot (HashAlg ChainwebHashTag)
forall u (h :: [*]) b. MerkleLog u h b -&gt; MerkleRoot (HashAlg u)
</span><a href="Chainweb.Crypto.MerkleLog.html#_merkleLogRoot"><span class="hs-identifier hs-var hs-var">_merkleLogRoot</span></a></span><span> </span><span class="annot"><span class="annottext">MerkleLog
  ChainwebHashTag
  '[Nonce, BlockCreationTime, BlockHash, HashTarget,
    BlockPayloadHash, ChainId, BlockWeight, BlockHeight,
    ChainwebVersion, EpochStartTime, FeatureFlags]
  BlockHash
MerkleLog
  ChainwebHashTag
  (MerkleLogHeader BlockHeader)
  (MerkleLogBody BlockHeader)
</span><a href="#local-6989586621681480497"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-600"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">_blockParent :: BlockHash
</span><a href="Chainweb.BlockHeader.html#_blockParent"><span class="hs-identifier hs-var">_blockParent</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BlockHash
</span><a href="#local-6989586621681480492"><span class="hs-identifier hs-var">parentHash</span></a></span><span>
</span><span id="line-601"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">_blockTarget :: HashTarget
</span><a href="Chainweb.BlockHeader.html#_blockTarget"><span class="hs-identifier hs-var">_blockTarget</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HashTarget
</span><a href="#local-6989586621681480491"><span class="hs-identifier hs-var">target</span></a></span><span>
</span><span id="line-602"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">_blockPayloadHash :: BlockPayloadHash
</span><a href="Chainweb.BlockHeader.html#_blockPayloadHash"><span class="hs-identifier hs-var">_blockPayloadHash</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BlockPayloadHash
</span><a href="#local-6989586621681480490"><span class="hs-identifier hs-var">payload</span></a></span><span>
</span><span id="line-603"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">_blockChainId :: ChainId
</span><a href="Chainweb.BlockHeader.html#_blockChainId"><span class="hs-identifier hs-var">_blockChainId</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ChainId
</span><a href="#local-6989586621681480489"><span class="hs-identifier hs-var">cid</span></a></span><span>
</span><span id="line-604"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">_blockWeight :: BlockWeight
</span><a href="Chainweb.BlockHeader.html#_blockWeight"><span class="hs-identifier hs-var">_blockWeight</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BlockWeight
</span><a href="#local-6989586621681480488"><span class="hs-identifier hs-var">weight</span></a></span><span>
</span><span id="line-605"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">_blockHeight :: BlockHeight
</span><a href="Chainweb.BlockHeader.html#_blockHeight"><span class="hs-identifier hs-var">_blockHeight</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BlockHeight
</span><a href="#local-6989586621681480487"><span class="hs-identifier hs-var">height</span></a></span><span>
</span><span id="line-606"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">_blockChainwebVersion :: ChainwebVersion
</span><a href="Chainweb.BlockHeader.html#_blockChainwebVersion"><span class="hs-identifier hs-var">_blockChainwebVersion</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ChainwebVersion
</span><a href="#local-6989586621681480486"><span class="hs-identifier hs-var">cwv</span></a></span><span>
</span><span id="line-607"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">_blockEpochStart :: EpochStartTime
</span><a href="Chainweb.BlockHeader.html#_blockEpochStart"><span class="hs-identifier hs-var">_blockEpochStart</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">EpochStartTime
</span><a href="#local-6989586621681480485"><span class="hs-identifier hs-var">es</span></a></span><span>
</span><span id="line-608"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">_blockFlags :: FeatureFlags
</span><a href="Chainweb.BlockHeader.html#_blockFlags"><span class="hs-identifier hs-var">_blockFlags</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FeatureFlags
</span><a href="#local-6989586621681480484"><span class="hs-identifier hs-var">flags</span></a></span><span>
</span><span id="line-609"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">_blockAdjacentHashes :: BlockHashRecord
</span><a href="Chainweb.BlockHeader.html#_blockAdjacentHashes"><span class="hs-identifier hs-var">_blockAdjacentHashes</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ChainwebVersion -&gt; ChainId -&gt; Vector BlockHash -&gt; BlockHashRecord
forall g c.
(HasChainGraph g, HasChainId c) =&gt;
g -&gt; c -&gt; Vector BlockHash -&gt; BlockHashRecord
</span><a href="Chainweb.BlockHash.html#blockHashRecordFromVector"><span class="hs-identifier hs-var">blockHashRecordFromVector</span></a></span><span> </span><span class="annot"><span class="annottext">ChainwebVersion
</span><a href="#local-6989586621681480486"><span class="hs-identifier hs-var">cwv</span></a></span><span> </span><span class="annot"><span class="annottext">ChainId
</span><a href="#local-6989586621681480489"><span class="hs-identifier hs-var">cid</span></a></span><span> </span><span class="annot"><span class="annottext">Vector BlockHash
</span><a href="#local-6989586621681480482"><span class="hs-identifier hs-var">adjParents</span></a></span><span>
</span><span id="line-610"></span><span>            </span><span class="hs-special">}</span><span>
</span><span id="line-611"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-612"></span><span>        </span><span class="hs-special">(</span><span> </span><span id="local-6989586621681480495"><span class="annot"><a href="#local-6989586621681480495"><span class="hs-identifier hs-var">nonce</span></a></span></span><span>
</span><span id="line-613"></span><span>            </span><span class="annot"><a href="Chainweb.Crypto.MerkleLog.html#%3A%2B%3A"><span class="hs-operator hs-type">:+:</span></a></span><span> </span><span id="local-6989586621681480494"><span class="annot"><a href="#local-6989586621681480494"><span class="hs-identifier hs-var">time</span></a></span></span><span>
</span><span id="line-614"></span><span>            </span><span class="annot"><a href="Chainweb.Crypto.MerkleLog.html#%3A%2B%3A"><span class="hs-operator hs-type">:+:</span></a></span><span> </span><span id="local-6989586621681480492"><span class="annot"><a href="#local-6989586621681480492"><span class="hs-identifier hs-var">parentHash</span></a></span></span><span>
</span><span id="line-615"></span><span>            </span><span class="annot"><a href="Chainweb.Crypto.MerkleLog.html#%3A%2B%3A"><span class="hs-operator hs-type">:+:</span></a></span><span> </span><span id="local-6989586621681480491"><span class="annot"><a href="#local-6989586621681480491"><span class="hs-identifier hs-var">target</span></a></span></span><span>
</span><span id="line-616"></span><span>            </span><span class="annot"><a href="Chainweb.Crypto.MerkleLog.html#%3A%2B%3A"><span class="hs-operator hs-type">:+:</span></a></span><span> </span><span id="local-6989586621681480490"><span class="annot"><a href="#local-6989586621681480490"><span class="hs-identifier hs-var">payload</span></a></span></span><span>
</span><span id="line-617"></span><span>            </span><span class="annot"><a href="Chainweb.Crypto.MerkleLog.html#%3A%2B%3A"><span class="hs-operator hs-type">:+:</span></a></span><span> </span><span id="local-6989586621681480489"><span class="annot"><a href="#local-6989586621681480489"><span class="hs-identifier hs-var">cid</span></a></span></span><span>
</span><span id="line-618"></span><span>            </span><span class="annot"><a href="Chainweb.Crypto.MerkleLog.html#%3A%2B%3A"><span class="hs-operator hs-type">:+:</span></a></span><span> </span><span id="local-6989586621681480488"><span class="annot"><a href="#local-6989586621681480488"><span class="hs-identifier hs-var">weight</span></a></span></span><span>
</span><span id="line-619"></span><span>            </span><span class="annot"><a href="Chainweb.Crypto.MerkleLog.html#%3A%2B%3A"><span class="hs-operator hs-type">:+:</span></a></span><span> </span><span id="local-6989586621681480487"><span class="annot"><a href="#local-6989586621681480487"><span class="hs-identifier hs-var">height</span></a></span></span><span>
</span><span id="line-620"></span><span>            </span><span class="annot"><a href="Chainweb.Crypto.MerkleLog.html#%3A%2B%3A"><span class="hs-operator hs-type">:+:</span></a></span><span> </span><span id="local-6989586621681480486"><span class="annot"><a href="#local-6989586621681480486"><span class="hs-identifier hs-var">cwv</span></a></span></span><span>
</span><span id="line-621"></span><span>            </span><span class="annot"><a href="Chainweb.Crypto.MerkleLog.html#%3A%2B%3A"><span class="hs-operator hs-type">:+:</span></a></span><span> </span><span id="local-6989586621681480485"><span class="annot"><a href="#local-6989586621681480485"><span class="hs-identifier hs-var">es</span></a></span></span><span>
</span><span id="line-622"></span><span>            </span><span class="annot"><a href="Chainweb.Crypto.MerkleLog.html#%3A%2B%3A"><span class="hs-operator hs-type">:+:</span></a></span><span> </span><span id="local-6989586621681480484"><span class="annot"><a href="#local-6989586621681480484"><span class="hs-identifier hs-var">flags</span></a></span></span><span>
</span><span id="line-623"></span><span>            </span><span class="annot"><a href="Chainweb.Crypto.MerkleLog.html#%3A%2B%3A"><span class="hs-operator hs-type">:+:</span></a></span><span> </span><span class="annot"><a href="Chainweb.Crypto.MerkleLog.html#MerkleLogBody"><span class="hs-identifier hs-type">MerkleLogBody</span></a></span><span> </span><span id="local-6989586621681480482"><span class="annot"><a href="#local-6989586621681480482"><span class="hs-identifier hs-var">adjParents</span></a></span></span><span>
</span><span id="line-624"></span><span>            </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MerkleLog
  ChainwebHashTag
  '[Nonce, BlockCreationTime, BlockHash, HashTarget,
    BlockPayloadHash, ChainId, BlockWeight, BlockHeight,
    ChainwebVersion, EpochStartTime, FeatureFlags]
  BlockHash
-&gt; MerkleLogEntries
     ChainwebHashTag
     '[Nonce, BlockCreationTime, BlockHash, HashTarget,
       BlockPayloadHash, ChainId, BlockWeight, BlockHeight,
       ChainwebVersion, EpochStartTime, FeatureFlags]
     BlockHash
forall u (h :: [*]) b. MerkleLog u h b -&gt; MerkleLogEntries u h b
</span><a href="Chainweb.Crypto.MerkleLog.html#_merkleLogEntries"><span class="hs-identifier hs-var hs-var">_merkleLogEntries</span></a></span><span> </span><span class="annot"><span class="annottext">MerkleLog
  ChainwebHashTag
  '[Nonce, BlockCreationTime, BlockHash, HashTarget,
    BlockPayloadHash, ChainId, BlockWeight, BlockHeight,
    ChainwebVersion, EpochStartTime, FeatureFlags]
  BlockHash
MerkleLog
  ChainwebHashTag
  (MerkleLogHeader BlockHeader)
  (MerkleLogBody BlockHeader)
</span><a href="#local-6989586621681480497"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-625"></span><span>
</span><span id="line-626"></span><span id="local-6989586621681480480"><span class="annot"><a href="Chainweb.BlockHeader.html#encodeBlockHeaderWithoutHash"><span class="hs-identifier hs-type">encodeBlockHeaderWithoutHash</span></a></span><span>
</span><span id="line-627"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadPut</span></span><span> </span><span class="annot"><a href="#local-6989586621681480480"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-628"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Chainweb.BlockHeader.html#BlockHeader"><span class="hs-identifier hs-type">BlockHeader</span></a></span><span>
</span><span id="line-629"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681480480"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-630"></span><span id="encodeBlockHeaderWithoutHash"><span class="annot"><span class="annottext">encodeBlockHeaderWithoutHash :: BlockHeader -&gt; m ()
</span><a href="Chainweb.BlockHeader.html#encodeBlockHeaderWithoutHash"><span class="hs-identifier hs-var hs-var">encodeBlockHeaderWithoutHash</span></a></span></span><span> </span><span id="local-6989586621681480479"><span class="annot"><span class="annottext">b :: BlockHeader
</span><a href="#local-6989586621681480479"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-631"></span><span>    </span><span class="annot"><span class="annottext">Nonce -&gt; m ()
forall (m :: * -&gt; *). MonadPut m =&gt; Nonce -&gt; m ()
</span><a href="Chainweb.BlockHeader.html#encodeNonce"><span class="hs-identifier hs-var">encodeNonce</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BlockHeader -&gt; Nonce
</span><a href="Chainweb.BlockHeader.html#_blockNonce"><span class="hs-identifier hs-var hs-var">_blockNonce</span></a></span><span> </span><span class="annot"><span class="annottext">BlockHeader
</span><a href="#local-6989586621681480479"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-632"></span><span>    </span><span class="annot"><span class="annottext">BlockCreationTime -&gt; m ()
forall (m :: * -&gt; *). MonadPut m =&gt; BlockCreationTime -&gt; m ()
</span><a href="Chainweb.BlockHeader.html#encodeBlockCreationTime"><span class="hs-identifier hs-var">encodeBlockCreationTime</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BlockHeader -&gt; BlockCreationTime
</span><a href="Chainweb.BlockHeader.html#_blockCreationTime"><span class="hs-identifier hs-var hs-var">_blockCreationTime</span></a></span><span> </span><span class="annot"><span class="annottext">BlockHeader
</span><a href="#local-6989586621681480479"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-633"></span><span>    </span><span class="annot"><span class="annottext">BlockHash -&gt; m ()
forall (m :: * -&gt; *). MonadPut m =&gt; BlockHash -&gt; m ()
</span><a href="Chainweb.BlockHash.html#encodeBlockHash"><span class="hs-identifier hs-var">encodeBlockHash</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BlockHeader -&gt; BlockHash
</span><a href="Chainweb.BlockHeader.html#_blockParent"><span class="hs-identifier hs-var hs-var">_blockParent</span></a></span><span> </span><span class="annot"><span class="annottext">BlockHeader
</span><a href="#local-6989586621681480479"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-634"></span><span>    </span><span class="annot"><span class="annottext">BlockHashRecord -&gt; m ()
forall (m :: * -&gt; *). MonadPut m =&gt; BlockHashRecord -&gt; m ()
</span><a href="Chainweb.BlockHash.html#encodeBlockHashRecord"><span class="hs-identifier hs-var">encodeBlockHashRecord</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BlockHeader -&gt; BlockHashRecord
</span><a href="Chainweb.BlockHeader.html#_blockAdjacentHashes"><span class="hs-identifier hs-var hs-var">_blockAdjacentHashes</span></a></span><span> </span><span class="annot"><span class="annottext">BlockHeader
</span><a href="#local-6989586621681480479"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-635"></span><span>    </span><span class="annot"><span class="annottext">HashTarget -&gt; m ()
forall (m :: * -&gt; *). MonadPut m =&gt; HashTarget -&gt; m ()
</span><a href="Chainweb.Difficulty.html#encodeHashTarget"><span class="hs-identifier hs-var">encodeHashTarget</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BlockHeader -&gt; HashTarget
</span><a href="Chainweb.BlockHeader.html#_blockTarget"><span class="hs-identifier hs-var hs-var">_blockTarget</span></a></span><span> </span><span class="annot"><span class="annottext">BlockHeader
</span><a href="#local-6989586621681480479"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-636"></span><span>    </span><span class="annot"><span class="annottext">BlockPayloadHash -&gt; m ()
forall (m :: * -&gt; *). MonadPut m =&gt; BlockPayloadHash -&gt; m ()
</span><a href="Chainweb.Payload.html#encodeBlockPayloadHash"><span class="hs-identifier hs-var">encodeBlockPayloadHash</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BlockHeader -&gt; BlockPayloadHash
</span><a href="Chainweb.BlockHeader.html#_blockPayloadHash"><span class="hs-identifier hs-var hs-var">_blockPayloadHash</span></a></span><span> </span><span class="annot"><span class="annottext">BlockHeader
</span><a href="#local-6989586621681480479"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-637"></span><span>    </span><span class="annot"><span class="annottext">ChainId -&gt; m ()
forall (m :: * -&gt; *). MonadPut m =&gt; ChainId -&gt; m ()
</span><a href="Chainweb.ChainId.html#encodeChainId"><span class="hs-identifier hs-var">encodeChainId</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BlockHeader -&gt; ChainId
</span><a href="Chainweb.BlockHeader.html#_blockChainId"><span class="hs-identifier hs-var hs-var">_blockChainId</span></a></span><span> </span><span class="annot"><span class="annottext">BlockHeader
</span><a href="#local-6989586621681480479"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-638"></span><span>    </span><span class="annot"><span class="annottext">BlockWeight -&gt; m ()
forall (m :: * -&gt; *). MonadPut m =&gt; BlockWeight -&gt; m ()
</span><a href="Chainweb.BlockHeader.html#encodeBlockWeight"><span class="hs-identifier hs-var">encodeBlockWeight</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BlockHeader -&gt; BlockWeight
</span><a href="Chainweb.BlockHeader.html#_blockWeight"><span class="hs-identifier hs-var hs-var">_blockWeight</span></a></span><span> </span><span class="annot"><span class="annottext">BlockHeader
</span><a href="#local-6989586621681480479"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-639"></span><span>    </span><span class="annot"><span class="annottext">BlockHeight -&gt; m ()
forall (m :: * -&gt; *). MonadPut m =&gt; BlockHeight -&gt; m ()
</span><a href="Chainweb.BlockHeader.html#encodeBlockHeight"><span class="hs-identifier hs-var">encodeBlockHeight</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BlockHeader -&gt; BlockHeight
</span><a href="Chainweb.BlockHeader.html#_blockHeight"><span class="hs-identifier hs-var hs-var">_blockHeight</span></a></span><span> </span><span class="annot"><span class="annottext">BlockHeader
</span><a href="#local-6989586621681480479"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-640"></span><span>    </span><span class="annot"><span class="annottext">ChainwebVersion -&gt; m ()
forall (m :: * -&gt; *). MonadPut m =&gt; ChainwebVersion -&gt; m ()
</span><a href="Chainweb.Version.html#encodeChainwebVersion"><span class="hs-identifier hs-var">encodeChainwebVersion</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BlockHeader -&gt; ChainwebVersion
</span><a href="Chainweb.BlockHeader.html#_blockChainwebVersion"><span class="hs-identifier hs-var hs-var">_blockChainwebVersion</span></a></span><span> </span><span class="annot"><span class="annottext">BlockHeader
</span><a href="#local-6989586621681480479"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-641"></span><span>    </span><span class="annot"><span class="annottext">EpochStartTime -&gt; m ()
forall (m :: * -&gt; *). MonadPut m =&gt; EpochStartTime -&gt; m ()
</span><a href="Chainweb.BlockHeader.html#encodeEpochStartTime"><span class="hs-identifier hs-var">encodeEpochStartTime</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BlockHeader -&gt; EpochStartTime
</span><a href="Chainweb.BlockHeader.html#_blockEpochStart"><span class="hs-identifier hs-var hs-var">_blockEpochStart</span></a></span><span> </span><span class="annot"><span class="annottext">BlockHeader
</span><a href="#local-6989586621681480479"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-642"></span><span>    </span><span class="annot"><span class="annottext">FeatureFlags -&gt; m ()
forall (m :: * -&gt; *). MonadPut m =&gt; FeatureFlags -&gt; m ()
</span><a href="Chainweb.BlockHeader.html#encodeFeatureFlags"><span class="hs-identifier hs-var">encodeFeatureFlags</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BlockHeader -&gt; FeatureFlags
</span><a href="Chainweb.BlockHeader.html#_blockFlags"><span class="hs-identifier hs-var hs-var">_blockFlags</span></a></span><span> </span><span class="annot"><span class="annottext">BlockHeader
</span><a href="#local-6989586621681480479"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-643"></span><span>
</span><span id="line-644"></span><span id="local-6989586621681481343"><span class="annot"><a href="Chainweb.BlockHeader.html#encodeBlockHeader"><span class="hs-identifier hs-type">encodeBlockHeader</span></a></span><span>
</span><span id="line-645"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadPut</span></span><span> </span><span class="annot"><a href="#local-6989586621681481343"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-646"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Chainweb.BlockHeader.html#BlockHeader"><span class="hs-identifier hs-type">BlockHeader</span></a></span><span>
</span><span id="line-647"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681481343"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-648"></span><span id="encodeBlockHeader"><span class="annot"><span class="annottext">encodeBlockHeader :: BlockHeader -&gt; m ()
</span><a href="Chainweb.BlockHeader.html#encodeBlockHeader"><span class="hs-identifier hs-var hs-var">encodeBlockHeader</span></a></span></span><span> </span><span id="local-6989586621681480473"><span class="annot"><span class="annottext">b :: BlockHeader
</span><a href="#local-6989586621681480473"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-649"></span><span>    </span><span class="annot"><span class="annottext">BlockHeader -&gt; m ()
forall (m :: * -&gt; *). MonadPut m =&gt; BlockHeader -&gt; m ()
</span><a href="Chainweb.BlockHeader.html#encodeBlockHeaderWithoutHash"><span class="hs-identifier hs-var">encodeBlockHeaderWithoutHash</span></a></span><span> </span><span class="annot"><span class="annottext">BlockHeader
</span><a href="#local-6989586621681480473"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-650"></span><span>    </span><span class="annot"><span class="annottext">BlockHash -&gt; m ()
forall (m :: * -&gt; *). MonadPut m =&gt; BlockHash -&gt; m ()
</span><a href="Chainweb.BlockHash.html#encodeBlockHash"><span class="hs-identifier hs-var">encodeBlockHash</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BlockHeader -&gt; BlockHash
</span><a href="Chainweb.BlockHeader.html#_blockHash"><span class="hs-identifier hs-var hs-var">_blockHash</span></a></span><span> </span><span class="annot"><span class="annottext">BlockHeader
</span><a href="#local-6989586621681480473"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-651"></span><span>
</span><span id="line-652"></span><span class="hs-comment">-- | Decode and check that</span><span>
</span><span id="line-653"></span><span class="hs-comment">--</span><span>
</span><span id="line-654"></span><span class="hs-comment">-- 1. chain id is in graph</span><span>
</span><span id="line-655"></span><span class="hs-comment">-- 2. all adjacentParent match adjacents in graph</span><span>
</span><span id="line-656"></span><span class="hs-comment">--</span><span>
</span><span id="line-657"></span><span id="local-6989586621681481297"><span class="annot"><a href="Chainweb.BlockHeader.html#decodeBlockHeaderChecked"><span class="hs-identifier hs-type">decodeBlockHeaderChecked</span></a></span><span>
</span><span id="line-658"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadThrow</span></span><span> </span><span class="annot"><a href="#local-6989586621681481297"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-659"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadGet</span></span><span> </span><span class="annot"><a href="#local-6989586621681481297"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-660"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681481297"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Chainweb.BlockHeader.html#BlockHeader"><span class="hs-identifier hs-type">BlockHeader</span></a></span></span><span>
</span><span id="line-661"></span><span id="decodeBlockHeaderChecked"><span class="annot"><span class="annottext">decodeBlockHeaderChecked :: m BlockHeader
</span><a href="Chainweb.BlockHeader.html#decodeBlockHeaderChecked"><span class="hs-identifier hs-var hs-var">decodeBlockHeaderChecked</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-662"></span><span>    </span><span class="hs-glyph">!</span><span id="local-6989586621681480472"><span class="annot"><span class="annottext">BlockHeader
</span><a href="#local-6989586621681480472"><span class="hs-identifier hs-var">bh</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">m BlockHeader
forall (m :: * -&gt; *). MonadGet m =&gt; m BlockHeader
</span><a href="Chainweb.BlockHeader.html#decodeBlockHeader"><span class="hs-identifier hs-var">decodeBlockHeader</span></a></span><span>
</span><span id="line-663"></span><span>    </span><span class="annot"><span class="annottext">HashSet ChainId
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">BlockHeader
-&gt; BlockHeader -&gt; Expected (HashSet ChainId) -&gt; m (HashSet ChainId)
forall (m :: * -&gt; *) g cid adj.
(MonadThrow m, HasChainGraph g, HasChainId cid, HasChainId adj) =&gt;
g -&gt; cid -&gt; Expected (HashSet adj) -&gt; m (HashSet adj)
</span><a href="Chainweb.Graph.html#checkAdjacentChainIds"><span class="hs-identifier hs-var">checkAdjacentChainIds</span></a></span><span> </span><span class="annot"><span class="annottext">BlockHeader
</span><a href="#local-6989586621681480472"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="annot"><span class="annottext">BlockHeader
</span><a href="#local-6989586621681480472"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HashSet ChainId -&gt; Expected (HashSet ChainId)
forall a. a -&gt; Expected a
</span><a href="Chainweb.Utils.html#Expected"><span class="hs-identifier hs-var">Expected</span></a></span><span> </span><span class="annot"><span class="annottext">(HashSet ChainId -&gt; Expected (HashSet ChainId))
-&gt; HashSet ChainId -&gt; Expected (HashSet ChainId)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">BlockHeader -&gt; HashSet ChainId
</span><a href="Chainweb.BlockHeader.html#_blockAdjacentChainIds"><span class="hs-identifier hs-var">_blockAdjacentChainIds</span></a></span><span> </span><span class="annot"><span class="annottext">BlockHeader
</span><a href="#local-6989586621681480472"><span class="hs-identifier hs-var">bh</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-664"></span><span>    </span><span class="annot"><span class="annottext">BlockHeader -&gt; m BlockHeader
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">BlockHeader
</span><a href="#local-6989586621681480472"><span class="hs-identifier hs-var">bh</span></a></span><span>
</span><span id="line-665"></span><span>
</span><span id="line-666"></span><span class="hs-comment">-- | Decode and check that</span><span>
</span><span id="line-667"></span><span class="hs-comment">--</span><span>
</span><span id="line-668"></span><span class="hs-comment">-- 1. chain id is in graph</span><span>
</span><span id="line-669"></span><span class="hs-comment">-- 2. all adjacentParent match adjacents in graph</span><span>
</span><span id="line-670"></span><span class="hs-comment">-- 3. chainId matches the expected chain id</span><span>
</span><span id="line-671"></span><span class="hs-comment">--</span><span>
</span><span id="line-672"></span><span id="local-6989586621681480468"><span id="local-6989586621681480469"><span class="annot"><a href="Chainweb.BlockHeader.html#decodeBlockHeaderCheckedChainId"><span class="hs-identifier hs-type">decodeBlockHeaderCheckedChainId</span></a></span><span>
</span><span id="line-673"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadThrow</span></span><span> </span><span class="annot"><a href="#local-6989586621681480469"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-674"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadGet</span></span><span> </span><span class="annot"><a href="#local-6989586621681480469"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-675"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Chainweb.ChainId.html#HasChainId"><span class="hs-identifier hs-type">HasChainId</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681480468"><span class="hs-identifier hs-type">p</span></a></span><span>
</span><span id="line-676"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Chainweb.Utils.html#Expected"><span class="hs-identifier hs-type">Expected</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681480468"><span class="hs-identifier hs-type">p</span></a></span><span>
</span><span id="line-677"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681480469"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Chainweb.BlockHeader.html#BlockHeader"><span class="hs-identifier hs-type">BlockHeader</span></a></span></span></span><span>
</span><span id="line-678"></span><span id="decodeBlockHeaderCheckedChainId"><span class="annot"><span class="annottext">decodeBlockHeaderCheckedChainId :: Expected p -&gt; m BlockHeader
</span><a href="Chainweb.BlockHeader.html#decodeBlockHeaderCheckedChainId"><span class="hs-identifier hs-var hs-var">decodeBlockHeaderCheckedChainId</span></a></span></span><span> </span><span id="local-6989586621681480467"><span class="annot"><span class="annottext">p :: Expected p
</span><a href="#local-6989586621681480467"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-679"></span><span>    </span><span class="hs-glyph">!</span><span id="local-6989586621681480466"><span class="annot"><span class="annottext">BlockHeader
</span><a href="#local-6989586621681480466"><span class="hs-identifier hs-var">bh</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">m BlockHeader
forall (m :: * -&gt; *). (MonadThrow m, MonadGet m) =&gt; m BlockHeader
</span><a href="Chainweb.BlockHeader.html#decodeBlockHeaderChecked"><span class="hs-identifier hs-var">decodeBlockHeaderChecked</span></a></span><span>
</span><span id="line-680"></span><span>    </span><span class="annot"><span class="annottext">ChainId
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Expected p -&gt; Actual ChainId -&gt; m ChainId
forall (m :: * -&gt; *) expected actual.
(MonadThrow m, HasChainId expected, HasChainId actual) =&gt;
Expected expected -&gt; Actual actual -&gt; m ChainId
</span><a href="Chainweb.ChainId.html#checkChainId"><span class="hs-identifier hs-var">checkChainId</span></a></span><span> </span><span class="annot"><span class="annottext">Expected p
</span><a href="#local-6989586621681480467"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ChainId -&gt; Actual ChainId
forall a. a -&gt; Actual a
</span><a href="Chainweb.Utils.html#Actual"><span class="hs-identifier hs-var">Actual</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BlockHeader -&gt; ChainId
forall a. HasChainId a =&gt; a -&gt; ChainId
</span><a href="Chainweb.ChainId.html#_chainId"><span class="hs-identifier hs-var">_chainId</span></a></span><span> </span><span class="annot"><span class="annottext">BlockHeader
</span><a href="#local-6989586621681480466"><span class="hs-identifier hs-var">bh</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-681"></span><span>    </span><span class="annot"><span class="annottext">BlockHeader -&gt; m BlockHeader
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">BlockHeader
</span><a href="#local-6989586621681480466"><span class="hs-identifier hs-var">bh</span></a></span><span>
</span><span id="line-682"></span><span>
</span><span id="line-683"></span><span class="hs-comment">-- | Decode a BlockHeader and trust the result</span><span>
</span><span id="line-684"></span><span class="hs-comment">--</span><span>
</span><span id="line-685"></span><span id="local-6989586621681480463"><span class="annot"><a href="Chainweb.BlockHeader.html#decodeBlockHeaderWithoutHash"><span class="hs-identifier hs-type">decodeBlockHeaderWithoutHash</span></a></span><span>
</span><span id="line-686"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadGet</span></span><span> </span><span class="annot"><a href="#local-6989586621681480463"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-687"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681480463"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Chainweb.BlockHeader.html#BlockHeader"><span class="hs-identifier hs-type">BlockHeader</span></a></span></span><span>
</span><span id="line-688"></span><span id="decodeBlockHeaderWithoutHash"><span class="annot"><span class="annottext">decodeBlockHeaderWithoutHash :: m BlockHeader
</span><a href="Chainweb.BlockHeader.html#decodeBlockHeaderWithoutHash"><span class="hs-identifier hs-var hs-var">decodeBlockHeaderWithoutHash</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-689"></span><span>    </span><span id="local-6989586621681480462"><span class="annot"><span class="annottext">Nonce
</span><a href="#local-6989586621681480462"><span class="hs-identifier hs-var">a0</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">m Nonce
forall (n :: * -&gt; *). MonadGet n =&gt; n Nonce
</span><a href="Chainweb.BlockHeader.html#decodeNonce"><span class="hs-identifier hs-var">decodeNonce</span></a></span><span>
</span><span id="line-690"></span><span>    </span><span id="local-6989586621681480461"><span class="annot"><span class="annottext">BlockCreationTime
</span><a href="#local-6989586621681480461"><span class="hs-identifier hs-var">a1</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">m BlockCreationTime
forall (n :: * -&gt; *). MonadGet n =&gt; n BlockCreationTime
</span><a href="Chainweb.BlockHeader.html#decodeBlockCreationTime"><span class="hs-identifier hs-var">decodeBlockCreationTime</span></a></span><span>
</span><span id="line-691"></span><span>    </span><span id="local-6989586621681480460"><span class="annot"><span class="annottext">BlockHash
</span><a href="#local-6989586621681480460"><span class="hs-identifier hs-var">a2</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">m BlockHash
forall (m :: * -&gt; *). MonadGet m =&gt; m BlockHash
</span><a href="Chainweb.BlockHash.html#decodeBlockHash"><span class="hs-identifier hs-var">decodeBlockHash</span></a></span><span> </span><span class="hs-comment">-- parent hash</span><span>
</span><span id="line-692"></span><span>    </span><span id="local-6989586621681480458"><span class="annot"><span class="annottext">BlockHashRecord
</span><a href="#local-6989586621681480458"><span class="hs-identifier hs-var">a3</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">m BlockHashRecord
forall (m :: * -&gt; *). MonadGet m =&gt; m BlockHashRecord
</span><a href="Chainweb.BlockHash.html#decodeBlockHashRecord"><span class="hs-identifier hs-var">decodeBlockHashRecord</span></a></span><span>
</span><span id="line-693"></span><span>    </span><span id="local-6989586621681480456"><span class="annot"><span class="annottext">HashTarget
</span><a href="#local-6989586621681480456"><span class="hs-identifier hs-var">a4</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">m HashTarget
forall (m :: * -&gt; *). MonadGet m =&gt; m HashTarget
</span><a href="Chainweb.Difficulty.html#decodeHashTarget"><span class="hs-identifier hs-var">decodeHashTarget</span></a></span><span>
</span><span id="line-694"></span><span>    </span><span id="local-6989586621681480454"><span class="annot"><span class="annottext">BlockPayloadHash
</span><a href="#local-6989586621681480454"><span class="hs-identifier hs-var">a5</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">m BlockPayloadHash
forall (m :: * -&gt; *). MonadGet m =&gt; m BlockPayloadHash
</span><a href="Chainweb.Payload.html#decodeBlockPayloadHash"><span class="hs-identifier hs-var">decodeBlockPayloadHash</span></a></span><span>
</span><span id="line-695"></span><span>    </span><span id="local-6989586621681480453"><span class="annot"><span class="annottext">ChainId
</span><a href="#local-6989586621681480453"><span class="hs-identifier hs-var">a6</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">m ChainId
forall (m :: * -&gt; *). MonadGet m =&gt; m ChainId
</span><a href="Chainweb.ChainId.html#decodeChainId"><span class="hs-identifier hs-var">decodeChainId</span></a></span><span>
</span><span id="line-696"></span><span>    </span><span id="local-6989586621681480451"><span class="annot"><span class="annottext">BlockWeight
</span><a href="#local-6989586621681480451"><span class="hs-identifier hs-var">a7</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">m BlockWeight
forall (n :: * -&gt; *). MonadGet n =&gt; n BlockWeight
</span><a href="Chainweb.BlockHeader.html#decodeBlockWeight"><span class="hs-identifier hs-var">decodeBlockWeight</span></a></span><span>
</span><span id="line-697"></span><span>    </span><span id="local-6989586621681480450"><span class="annot"><span class="annottext">BlockHeight
</span><a href="#local-6989586621681480450"><span class="hs-identifier hs-var">a8</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">m BlockHeight
forall (n :: * -&gt; *). MonadGet n =&gt; n BlockHeight
</span><a href="Chainweb.BlockHeader.html#decodeBlockHeight"><span class="hs-identifier hs-var">decodeBlockHeight</span></a></span><span>
</span><span id="line-698"></span><span>    </span><span id="local-6989586621681480449"><span class="annot"><span class="annottext">ChainwebVersion
</span><a href="#local-6989586621681480449"><span class="hs-identifier hs-var">a9</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">m ChainwebVersion
forall (m :: * -&gt; *). MonadGet m =&gt; m ChainwebVersion
</span><a href="Chainweb.Version.html#decodeChainwebVersion"><span class="hs-identifier hs-var">decodeChainwebVersion</span></a></span><span>
</span><span id="line-699"></span><span>    </span><span id="local-6989586621681480447"><span class="annot"><span class="annottext">EpochStartTime
</span><a href="#local-6989586621681480447"><span class="hs-identifier hs-var">a11</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">m EpochStartTime
forall (n :: * -&gt; *). MonadGet n =&gt; n EpochStartTime
</span><a href="Chainweb.BlockHeader.html#decodeEpochStartTime"><span class="hs-identifier hs-var">decodeEpochStartTime</span></a></span><span>
</span><span id="line-700"></span><span>    </span><span id="local-6989586621681480446"><span class="annot"><span class="annottext">FeatureFlags
</span><a href="#local-6989586621681480446"><span class="hs-identifier hs-var">a12</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">m FeatureFlags
forall (n :: * -&gt; *). MonadGet n =&gt; n FeatureFlags
</span><a href="Chainweb.BlockHeader.html#decodeFeatureFlags"><span class="hs-identifier hs-var">decodeFeatureFlags</span></a></span><span>
</span><span id="line-701"></span><span>    </span><span class="annot"><span class="annottext">BlockHeader -&gt; m BlockHeader
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span>
</span><span id="line-702"></span><span>        </span><span class="annot"><span class="annottext">(BlockHeader -&gt; m BlockHeader) -&gt; BlockHeader -&gt; m BlockHeader
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$!</span></span><span> </span><span class="annot"><span class="annottext">MerkleLog
  ChainwebHashTag
  (MerkleLogHeader BlockHeader)
  (MerkleLogBody BlockHeader)
-&gt; BlockHeader
forall u b.
HasMerkleLog u b =&gt;
MerkleLog u (MerkleLogHeader b) (MerkleLogBody b) -&gt; b
</span><a href="Chainweb.Crypto.MerkleLog.html#fromLog"><span class="hs-identifier hs-var">fromLog</span></a></span><span>
</span><span id="line-703"></span><span>        </span><span class="annot"><span class="annottext">(MerkleLog
   ChainwebHashTag
   (MerkleLogHeader BlockHeader)
   (MerkleLogBody BlockHeader)
 -&gt; BlockHeader)
-&gt; MerkleLog
     ChainwebHashTag
     (MerkleLogHeader BlockHeader)
     (MerkleLogBody BlockHeader)
-&gt; BlockHeader
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">MerkleLogEntries
  ChainwebHashTag
  '[Nonce, BlockCreationTime, BlockHash, HashTarget,
    BlockPayloadHash, ChainId, BlockWeight, BlockHeight,
    ChainwebVersion, EpochStartTime, FeatureFlags]
  BlockHash
-&gt; MerkleLog
     ChainwebHashTag
     (MerkleLogHeader BlockHeader)
     (MerkleLogBody BlockHeader)
forall u (h :: [*]) b.
MerkleUniverse u =&gt;
MerkleLogEntries u h b -&gt; MerkleLog u h b
</span><a href="Chainweb.Crypto.MerkleLog.html#newMerkleLog"><span class="hs-identifier hs-var">newMerkleLog</span></a></span><span>
</span><span id="line-704"></span><span>        </span><span class="annot"><span class="annottext">(MerkleLogEntries
   ChainwebHashTag
   '[Nonce, BlockCreationTime, BlockHash, HashTarget,
     BlockPayloadHash, ChainId, BlockWeight, BlockHeight,
     ChainwebVersion, EpochStartTime, FeatureFlags]
   BlockHash
 -&gt; MerkleLog
      ChainwebHashTag
      (MerkleLogHeader BlockHeader)
      (MerkleLogBody BlockHeader))
-&gt; MerkleLogEntries
     ChainwebHashTag
     '[Nonce, BlockCreationTime, BlockHash, HashTarget,
       BlockPayloadHash, ChainId, BlockWeight, BlockHeight,
       ChainwebVersion, EpochStartTime, FeatureFlags]
     BlockHash
-&gt; MerkleLog
     ChainwebHashTag
     (MerkleLogHeader BlockHeader)
     (MerkleLogBody BlockHeader)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Nonce
</span><a href="#local-6989586621681480462"><span class="hs-identifier hs-var">a0</span></a></span><span>
</span><span id="line-705"></span><span>        </span><span class="annot"><span class="annottext">Nonce
-&gt; MerkleLogEntries
     ChainwebHashTag
     '[BlockCreationTime, BlockHash, HashTarget, BlockPayloadHash,
       ChainId, BlockWeight, BlockHeight, ChainwebVersion, EpochStartTime,
       FeatureFlags]
     BlockHash
-&gt; MerkleLogEntries
     ChainwebHashTag
     '[Nonce, BlockCreationTime, BlockHash, HashTarget,
       BlockPayloadHash, ChainId, BlockWeight, BlockHeight,
       ChainwebVersion, EpochStartTime, FeatureFlags]
     BlockHash
forall u h (t :: [*]) b.
IsMerkleLogEntry u h =&gt;
h -&gt; MerkleLogEntries u t b -&gt; MerkleLogEntries u (h : t) b
</span><a href="Chainweb.Crypto.MerkleLog.html#%3A%2B%3A"><span class="hs-operator hs-var">:+:</span></a></span><span> </span><span class="annot"><span class="annottext">BlockCreationTime
</span><a href="#local-6989586621681480461"><span class="hs-identifier hs-var">a1</span></a></span><span>
</span><span id="line-706"></span><span>        </span><span class="annot"><span class="annottext">BlockCreationTime
-&gt; MerkleLogEntries
     ChainwebHashTag
     '[BlockHash, HashTarget, BlockPayloadHash, ChainId, BlockWeight,
       BlockHeight, ChainwebVersion, EpochStartTime, FeatureFlags]
     BlockHash
-&gt; MerkleLogEntries
     ChainwebHashTag
     '[BlockCreationTime, BlockHash, HashTarget, BlockPayloadHash,
       ChainId, BlockWeight, BlockHeight, ChainwebVersion, EpochStartTime,
       FeatureFlags]
     BlockHash
forall u h (t :: [*]) b.
IsMerkleLogEntry u h =&gt;
h -&gt; MerkleLogEntries u t b -&gt; MerkleLogEntries u (h : t) b
</span><a href="Chainweb.Crypto.MerkleLog.html#%3A%2B%3A"><span class="hs-operator hs-var">:+:</span></a></span><span> </span><span class="annot"><span class="annottext">BlockHash
</span><a href="#local-6989586621681480460"><span class="hs-identifier hs-var">a2</span></a></span><span>
</span><span id="line-707"></span><span>        </span><span class="annot"><span class="annottext">BlockHash
-&gt; MerkleLogEntries
     ChainwebHashTag
     '[HashTarget, BlockPayloadHash, ChainId, BlockWeight, BlockHeight,
       ChainwebVersion, EpochStartTime, FeatureFlags]
     BlockHash
-&gt; MerkleLogEntries
     ChainwebHashTag
     '[BlockHash, HashTarget, BlockPayloadHash, ChainId, BlockWeight,
       BlockHeight, ChainwebVersion, EpochStartTime, FeatureFlags]
     BlockHash
forall u h (t :: [*]) b.
IsMerkleLogEntry u h =&gt;
h -&gt; MerkleLogEntries u t b -&gt; MerkleLogEntries u (h : t) b
</span><a href="Chainweb.Crypto.MerkleLog.html#%3A%2B%3A"><span class="hs-operator hs-var">:+:</span></a></span><span> </span><span class="annot"><span class="annottext">HashTarget
</span><a href="#local-6989586621681480456"><span class="hs-identifier hs-var">a4</span></a></span><span>
</span><span id="line-708"></span><span>        </span><span class="annot"><span class="annottext">HashTarget
-&gt; MerkleLogEntries
     ChainwebHashTag
     '[BlockPayloadHash, ChainId, BlockWeight, BlockHeight,
       ChainwebVersion, EpochStartTime, FeatureFlags]
     BlockHash
-&gt; MerkleLogEntries
     ChainwebHashTag
     '[HashTarget, BlockPayloadHash, ChainId, BlockWeight, BlockHeight,
       ChainwebVersion, EpochStartTime, FeatureFlags]
     BlockHash
forall u h (t :: [*]) b.
IsMerkleLogEntry u h =&gt;
h -&gt; MerkleLogEntries u t b -&gt; MerkleLogEntries u (h : t) b
</span><a href="Chainweb.Crypto.MerkleLog.html#%3A%2B%3A"><span class="hs-operator hs-var">:+:</span></a></span><span> </span><span class="annot"><span class="annottext">BlockPayloadHash
</span><a href="#local-6989586621681480454"><span class="hs-identifier hs-var">a5</span></a></span><span>
</span><span id="line-709"></span><span>        </span><span class="annot"><span class="annottext">BlockPayloadHash
-&gt; MerkleLogEntries
     ChainwebHashTag
     '[ChainId, BlockWeight, BlockHeight, ChainwebVersion,
       EpochStartTime, FeatureFlags]
     BlockHash
-&gt; MerkleLogEntries
     ChainwebHashTag
     '[BlockPayloadHash, ChainId, BlockWeight, BlockHeight,
       ChainwebVersion, EpochStartTime, FeatureFlags]
     BlockHash
forall u h (t :: [*]) b.
IsMerkleLogEntry u h =&gt;
h -&gt; MerkleLogEntries u t b -&gt; MerkleLogEntries u (h : t) b
</span><a href="Chainweb.Crypto.MerkleLog.html#%3A%2B%3A"><span class="hs-operator hs-var">:+:</span></a></span><span> </span><span class="annot"><span class="annottext">ChainId
</span><a href="#local-6989586621681480453"><span class="hs-identifier hs-var">a6</span></a></span><span>
</span><span id="line-710"></span><span>        </span><span class="annot"><span class="annottext">ChainId
-&gt; MerkleLogEntries
     ChainwebHashTag
     '[BlockWeight, BlockHeight, ChainwebVersion, EpochStartTime,
       FeatureFlags]
     BlockHash
-&gt; MerkleLogEntries
     ChainwebHashTag
     '[ChainId, BlockWeight, BlockHeight, ChainwebVersion,
       EpochStartTime, FeatureFlags]
     BlockHash
forall u h (t :: [*]) b.
IsMerkleLogEntry u h =&gt;
h -&gt; MerkleLogEntries u t b -&gt; MerkleLogEntries u (h : t) b
</span><a href="Chainweb.Crypto.MerkleLog.html#%3A%2B%3A"><span class="hs-operator hs-var">:+:</span></a></span><span> </span><span class="annot"><span class="annottext">BlockWeight
</span><a href="#local-6989586621681480451"><span class="hs-identifier hs-var">a7</span></a></span><span>
</span><span id="line-711"></span><span>        </span><span class="annot"><span class="annottext">BlockWeight
-&gt; MerkleLogEntries
     ChainwebHashTag
     '[BlockHeight, ChainwebVersion, EpochStartTime, FeatureFlags]
     BlockHash
-&gt; MerkleLogEntries
     ChainwebHashTag
     '[BlockWeight, BlockHeight, ChainwebVersion, EpochStartTime,
       FeatureFlags]
     BlockHash
forall u h (t :: [*]) b.
IsMerkleLogEntry u h =&gt;
h -&gt; MerkleLogEntries u t b -&gt; MerkleLogEntries u (h : t) b
</span><a href="Chainweb.Crypto.MerkleLog.html#%3A%2B%3A"><span class="hs-operator hs-var">:+:</span></a></span><span> </span><span class="annot"><span class="annottext">BlockHeight
</span><a href="#local-6989586621681480450"><span class="hs-identifier hs-var">a8</span></a></span><span>
</span><span id="line-712"></span><span>        </span><span class="annot"><span class="annottext">BlockHeight
-&gt; MerkleLogEntries
     ChainwebHashTag
     '[ChainwebVersion, EpochStartTime, FeatureFlags]
     BlockHash
-&gt; MerkleLogEntries
     ChainwebHashTag
     '[BlockHeight, ChainwebVersion, EpochStartTime, FeatureFlags]
     BlockHash
forall u h (t :: [*]) b.
IsMerkleLogEntry u h =&gt;
h -&gt; MerkleLogEntries u t b -&gt; MerkleLogEntries u (h : t) b
</span><a href="Chainweb.Crypto.MerkleLog.html#%3A%2B%3A"><span class="hs-operator hs-var">:+:</span></a></span><span> </span><span class="annot"><span class="annottext">ChainwebVersion
</span><a href="#local-6989586621681480449"><span class="hs-identifier hs-var">a9</span></a></span><span>
</span><span id="line-713"></span><span>        </span><span class="annot"><span class="annottext">ChainwebVersion
-&gt; MerkleLogEntries
     ChainwebHashTag '[EpochStartTime, FeatureFlags] BlockHash
-&gt; MerkleLogEntries
     ChainwebHashTag
     '[ChainwebVersion, EpochStartTime, FeatureFlags]
     BlockHash
forall u h (t :: [*]) b.
IsMerkleLogEntry u h =&gt;
h -&gt; MerkleLogEntries u t b -&gt; MerkleLogEntries u (h : t) b
</span><a href="Chainweb.Crypto.MerkleLog.html#%3A%2B%3A"><span class="hs-operator hs-var">:+:</span></a></span><span> </span><span class="annot"><span class="annottext">EpochStartTime
</span><a href="#local-6989586621681480447"><span class="hs-identifier hs-var">a11</span></a></span><span>
</span><span id="line-714"></span><span>        </span><span class="annot"><span class="annottext">EpochStartTime
-&gt; MerkleLogEntries ChainwebHashTag '[FeatureFlags] BlockHash
-&gt; MerkleLogEntries
     ChainwebHashTag '[EpochStartTime, FeatureFlags] BlockHash
forall u h (t :: [*]) b.
IsMerkleLogEntry u h =&gt;
h -&gt; MerkleLogEntries u t b -&gt; MerkleLogEntries u (h : t) b
</span><a href="Chainweb.Crypto.MerkleLog.html#%3A%2B%3A"><span class="hs-operator hs-var">:+:</span></a></span><span> </span><span class="annot"><span class="annottext">FeatureFlags
</span><a href="#local-6989586621681480446"><span class="hs-identifier hs-var">a12</span></a></span><span>
</span><span id="line-715"></span><span>        </span><span class="annot"><span class="annottext">FeatureFlags
-&gt; MerkleLogEntries ChainwebHashTag '[] BlockHash
-&gt; MerkleLogEntries ChainwebHashTag '[FeatureFlags] BlockHash
forall u h (t :: [*]) b.
IsMerkleLogEntry u h =&gt;
h -&gt; MerkleLogEntries u t b -&gt; MerkleLogEntries u (h : t) b
</span><a href="Chainweb.Crypto.MerkleLog.html#%3A%2B%3A"><span class="hs-operator hs-var">:+:</span></a></span><span> </span><span class="annot"><span class="annottext">Vector BlockHash -&gt; MerkleLogEntries ChainwebHashTag '[] BlockHash
forall u b.
IsMerkleLogEntry u b =&gt;
Vector b -&gt; MerkleLogEntries u '[] b
</span><a href="Chainweb.Crypto.MerkleLog.html#MerkleLogBody"><span class="hs-identifier hs-var">MerkleLogBody</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BlockHashRecord -&gt; Vector BlockHash
</span><a href="Chainweb.BlockHash.html#blockHashRecordToVector"><span class="hs-identifier hs-var">blockHashRecordToVector</span></a></span><span> </span><span class="annot"><span class="annottext">BlockHashRecord
</span><a href="#local-6989586621681480458"><span class="hs-identifier hs-var">a3</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-716"></span><span>
</span><span id="line-717"></span><span class="hs-comment">-- | Decode a BlockHeader and trust the result</span><span>
</span><span id="line-718"></span><span class="hs-comment">--</span><span>
</span><span id="line-719"></span><span id="local-6989586621681481342"><span class="annot"><a href="Chainweb.BlockHeader.html#decodeBlockHeader"><span class="hs-identifier hs-type">decodeBlockHeader</span></a></span><span>
</span><span id="line-720"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadGet</span></span><span> </span><span class="annot"><a href="#local-6989586621681481342"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-721"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681481342"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Chainweb.BlockHeader.html#BlockHeader"><span class="hs-identifier hs-type">BlockHeader</span></a></span></span><span>
</span><span id="line-722"></span><span id="decodeBlockHeader"><span class="annot"><span class="annottext">decodeBlockHeader :: m BlockHeader
</span><a href="Chainweb.BlockHeader.html#decodeBlockHeader"><span class="hs-identifier hs-var hs-var">decodeBlockHeader</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Nonce
-&gt; BlockCreationTime
-&gt; BlockHash
-&gt; BlockHashRecord
-&gt; HashTarget
-&gt; BlockPayloadHash
-&gt; ChainId
-&gt; BlockWeight
-&gt; BlockHeight
-&gt; ChainwebVersion
-&gt; EpochStartTime
-&gt; FeatureFlags
-&gt; BlockHash
-&gt; BlockHeader
</span><a href="Chainweb.BlockHeader.html#BlockHeader"><span class="hs-identifier hs-var">BlockHeader</span></a></span><span>
</span><span id="line-723"></span><span>    </span><span class="annot"><span class="annottext">(Nonce
 -&gt; BlockCreationTime
 -&gt; BlockHash
 -&gt; BlockHashRecord
 -&gt; HashTarget
 -&gt; BlockPayloadHash
 -&gt; ChainId
 -&gt; BlockWeight
 -&gt; BlockHeight
 -&gt; ChainwebVersion
 -&gt; EpochStartTime
 -&gt; FeatureFlags
 -&gt; BlockHash
 -&gt; BlockHeader)
-&gt; m Nonce
-&gt; m (BlockCreationTime
      -&gt; BlockHash
      -&gt; BlockHashRecord
      -&gt; HashTarget
      -&gt; BlockPayloadHash
      -&gt; ChainId
      -&gt; BlockWeight
      -&gt; BlockHeight
      -&gt; ChainwebVersion
      -&gt; EpochStartTime
      -&gt; FeatureFlags
      -&gt; BlockHash
      -&gt; BlockHeader)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">m Nonce
forall (n :: * -&gt; *). MonadGet n =&gt; n Nonce
</span><a href="Chainweb.BlockHeader.html#decodeNonce"><span class="hs-identifier hs-var">decodeNonce</span></a></span><span>
</span><span id="line-724"></span><span>    </span><span class="annot"><span class="annottext">m (BlockCreationTime
   -&gt; BlockHash
   -&gt; BlockHashRecord
   -&gt; HashTarget
   -&gt; BlockPayloadHash
   -&gt; ChainId
   -&gt; BlockWeight
   -&gt; BlockHeight
   -&gt; ChainwebVersion
   -&gt; EpochStartTime
   -&gt; FeatureFlags
   -&gt; BlockHash
   -&gt; BlockHeader)
-&gt; m BlockCreationTime
-&gt; m (BlockHash
      -&gt; BlockHashRecord
      -&gt; HashTarget
      -&gt; BlockPayloadHash
      -&gt; ChainId
      -&gt; BlockWeight
      -&gt; BlockHeight
      -&gt; ChainwebVersion
      -&gt; EpochStartTime
      -&gt; FeatureFlags
      -&gt; BlockHash
      -&gt; BlockHeader)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">m BlockCreationTime
forall (n :: * -&gt; *). MonadGet n =&gt; n BlockCreationTime
</span><a href="Chainweb.BlockHeader.html#decodeBlockCreationTime"><span class="hs-identifier hs-var">decodeBlockCreationTime</span></a></span><span>
</span><span id="line-725"></span><span>    </span><span class="annot"><span class="annottext">m (BlockHash
   -&gt; BlockHashRecord
   -&gt; HashTarget
   -&gt; BlockPayloadHash
   -&gt; ChainId
   -&gt; BlockWeight
   -&gt; BlockHeight
   -&gt; ChainwebVersion
   -&gt; EpochStartTime
   -&gt; FeatureFlags
   -&gt; BlockHash
   -&gt; BlockHeader)
-&gt; m BlockHash
-&gt; m (BlockHashRecord
      -&gt; HashTarget
      -&gt; BlockPayloadHash
      -&gt; ChainId
      -&gt; BlockWeight
      -&gt; BlockHeight
      -&gt; ChainwebVersion
      -&gt; EpochStartTime
      -&gt; FeatureFlags
      -&gt; BlockHash
      -&gt; BlockHeader)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">m BlockHash
forall (m :: * -&gt; *). MonadGet m =&gt; m BlockHash
</span><a href="Chainweb.BlockHash.html#decodeBlockHash"><span class="hs-identifier hs-var">decodeBlockHash</span></a></span><span> </span><span class="hs-comment">-- parent hash</span><span>
</span><span id="line-726"></span><span>    </span><span class="annot"><span class="annottext">m (BlockHashRecord
   -&gt; HashTarget
   -&gt; BlockPayloadHash
   -&gt; ChainId
   -&gt; BlockWeight
   -&gt; BlockHeight
   -&gt; ChainwebVersion
   -&gt; EpochStartTime
   -&gt; FeatureFlags
   -&gt; BlockHash
   -&gt; BlockHeader)
-&gt; m BlockHashRecord
-&gt; m (HashTarget
      -&gt; BlockPayloadHash
      -&gt; ChainId
      -&gt; BlockWeight
      -&gt; BlockHeight
      -&gt; ChainwebVersion
      -&gt; EpochStartTime
      -&gt; FeatureFlags
      -&gt; BlockHash
      -&gt; BlockHeader)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">m BlockHashRecord
forall (m :: * -&gt; *). MonadGet m =&gt; m BlockHashRecord
</span><a href="Chainweb.BlockHash.html#decodeBlockHashRecord"><span class="hs-identifier hs-var">decodeBlockHashRecord</span></a></span><span>
</span><span id="line-727"></span><span>    </span><span class="annot"><span class="annottext">m (HashTarget
   -&gt; BlockPayloadHash
   -&gt; ChainId
   -&gt; BlockWeight
   -&gt; BlockHeight
   -&gt; ChainwebVersion
   -&gt; EpochStartTime
   -&gt; FeatureFlags
   -&gt; BlockHash
   -&gt; BlockHeader)
-&gt; m HashTarget
-&gt; m (BlockPayloadHash
      -&gt; ChainId
      -&gt; BlockWeight
      -&gt; BlockHeight
      -&gt; ChainwebVersion
      -&gt; EpochStartTime
      -&gt; FeatureFlags
      -&gt; BlockHash
      -&gt; BlockHeader)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">m HashTarget
forall (m :: * -&gt; *). MonadGet m =&gt; m HashTarget
</span><a href="Chainweb.Difficulty.html#decodeHashTarget"><span class="hs-identifier hs-var">decodeHashTarget</span></a></span><span>
</span><span id="line-728"></span><span>    </span><span class="annot"><span class="annottext">m (BlockPayloadHash
   -&gt; ChainId
   -&gt; BlockWeight
   -&gt; BlockHeight
   -&gt; ChainwebVersion
   -&gt; EpochStartTime
   -&gt; FeatureFlags
   -&gt; BlockHash
   -&gt; BlockHeader)
-&gt; m BlockPayloadHash
-&gt; m (ChainId
      -&gt; BlockWeight
      -&gt; BlockHeight
      -&gt; ChainwebVersion
      -&gt; EpochStartTime
      -&gt; FeatureFlags
      -&gt; BlockHash
      -&gt; BlockHeader)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">m BlockPayloadHash
forall (m :: * -&gt; *). MonadGet m =&gt; m BlockPayloadHash
</span><a href="Chainweb.Payload.html#decodeBlockPayloadHash"><span class="hs-identifier hs-var">decodeBlockPayloadHash</span></a></span><span>
</span><span id="line-729"></span><span>    </span><span class="annot"><span class="annottext">m (ChainId
   -&gt; BlockWeight
   -&gt; BlockHeight
   -&gt; ChainwebVersion
   -&gt; EpochStartTime
   -&gt; FeatureFlags
   -&gt; BlockHash
   -&gt; BlockHeader)
-&gt; m ChainId
-&gt; m (BlockWeight
      -&gt; BlockHeight
      -&gt; ChainwebVersion
      -&gt; EpochStartTime
      -&gt; FeatureFlags
      -&gt; BlockHash
      -&gt; BlockHeader)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">m ChainId
forall (m :: * -&gt; *). MonadGet m =&gt; m ChainId
</span><a href="Chainweb.ChainId.html#decodeChainId"><span class="hs-identifier hs-var">decodeChainId</span></a></span><span>
</span><span id="line-730"></span><span>    </span><span class="annot"><span class="annottext">m (BlockWeight
   -&gt; BlockHeight
   -&gt; ChainwebVersion
   -&gt; EpochStartTime
   -&gt; FeatureFlags
   -&gt; BlockHash
   -&gt; BlockHeader)
-&gt; m BlockWeight
-&gt; m (BlockHeight
      -&gt; ChainwebVersion
      -&gt; EpochStartTime
      -&gt; FeatureFlags
      -&gt; BlockHash
      -&gt; BlockHeader)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">m BlockWeight
forall (n :: * -&gt; *). MonadGet n =&gt; n BlockWeight
</span><a href="Chainweb.BlockHeader.html#decodeBlockWeight"><span class="hs-identifier hs-var">decodeBlockWeight</span></a></span><span>
</span><span id="line-731"></span><span>    </span><span class="annot"><span class="annottext">m (BlockHeight
   -&gt; ChainwebVersion
   -&gt; EpochStartTime
   -&gt; FeatureFlags
   -&gt; BlockHash
   -&gt; BlockHeader)
-&gt; m BlockHeight
-&gt; m (ChainwebVersion
      -&gt; EpochStartTime -&gt; FeatureFlags -&gt; BlockHash -&gt; BlockHeader)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">m BlockHeight
forall (n :: * -&gt; *). MonadGet n =&gt; n BlockHeight
</span><a href="Chainweb.BlockHeader.html#decodeBlockHeight"><span class="hs-identifier hs-var">decodeBlockHeight</span></a></span><span>
</span><span id="line-732"></span><span>    </span><span class="annot"><span class="annottext">m (ChainwebVersion
   -&gt; EpochStartTime -&gt; FeatureFlags -&gt; BlockHash -&gt; BlockHeader)
-&gt; m ChainwebVersion
-&gt; m (EpochStartTime -&gt; FeatureFlags -&gt; BlockHash -&gt; BlockHeader)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">m ChainwebVersion
forall (m :: * -&gt; *). MonadGet m =&gt; m ChainwebVersion
</span><a href="Chainweb.Version.html#decodeChainwebVersion"><span class="hs-identifier hs-var">decodeChainwebVersion</span></a></span><span>
</span><span id="line-733"></span><span>    </span><span class="annot"><span class="annottext">m (EpochStartTime -&gt; FeatureFlags -&gt; BlockHash -&gt; BlockHeader)
-&gt; m EpochStartTime -&gt; m (FeatureFlags -&gt; BlockHash -&gt; BlockHeader)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">m EpochStartTime
forall (n :: * -&gt; *). MonadGet n =&gt; n EpochStartTime
</span><a href="Chainweb.BlockHeader.html#decodeEpochStartTime"><span class="hs-identifier hs-var">decodeEpochStartTime</span></a></span><span>
</span><span id="line-734"></span><span>    </span><span class="annot"><span class="annottext">m (FeatureFlags -&gt; BlockHash -&gt; BlockHeader)
-&gt; m FeatureFlags -&gt; m (BlockHash -&gt; BlockHeader)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">m FeatureFlags
forall (n :: * -&gt; *). MonadGet n =&gt; n FeatureFlags
</span><a href="Chainweb.BlockHeader.html#decodeFeatureFlags"><span class="hs-identifier hs-var">decodeFeatureFlags</span></a></span><span>
</span><span id="line-735"></span><span>    </span><span class="annot"><span class="annottext">m (BlockHash -&gt; BlockHeader) -&gt; m BlockHash -&gt; m BlockHeader
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">m BlockHash
forall (m :: * -&gt; *). MonadGet m =&gt; m BlockHash
</span><a href="Chainweb.BlockHash.html#decodeBlockHash"><span class="hs-identifier hs-var">decodeBlockHash</span></a></span><span>
</span><span id="line-736"></span><span>
</span><span id="line-737"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681480437"><span id="local-6989586621681480439"><span id="local-6989586621681480441"><span class="annot"><span class="hs-identifier hs-type">ToJSON</span></span><span> </span><span class="annot"><a href="Chainweb.BlockHeader.html#BlockHeader"><span class="hs-identifier hs-type">BlockHeader</span></a></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-738"></span><span>    </span><span id="local-6989586621681480436"><span class="annot"><span class="annottext">toJSON :: BlockHeader -&gt; Value
</span><a href="#local-6989586621681480436"><span class="hs-identifier hs-var hs-var hs-var hs-var">toJSON</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Value
forall a. ToJSON a =&gt; a -&gt; Value
</span><span class="hs-identifier hs-var">toJSON</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Value) -&gt; (BlockHeader -&gt; Text) -&gt; BlockHeader -&gt; Value
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span>  </span><span class="annot"><span class="annottext">ByteString -&gt; Text
</span><a href="Chainweb.Utils.html#encodeB64UrlNoPaddingText"><span class="hs-identifier hs-var">encodeB64UrlNoPaddingText</span></a></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; Text)
-&gt; (BlockHeader -&gt; ByteString) -&gt; BlockHeader -&gt; Text
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Put -&gt; ByteString
</span><span class="hs-identifier hs-var">runPutS</span></span><span> </span><span class="annot"><span class="annottext">(Put -&gt; ByteString)
-&gt; Putter BlockHeader -&gt; BlockHeader -&gt; ByteString
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Putter BlockHeader
forall (m :: * -&gt; *). MonadPut m =&gt; BlockHeader -&gt; m ()
</span><a href="Chainweb.BlockHeader.html#encodeBlockHeader"><span class="hs-identifier hs-var">encodeBlockHeader</span></a></span><span>
</span><span id="line-739"></span><span>
</span><span id="line-740"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681480431"><span class="annot"><span class="hs-identifier hs-type">FromJSON</span></span><span> </span><span class="annot"><a href="Chainweb.BlockHeader.html#BlockHeader"><span class="hs-identifier hs-type">BlockHeader</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-741"></span><span>    </span><span id="local-6989586621681480430"><span class="annot"><span class="annottext">parseJSON :: Value -&gt; Parser BlockHeader
</span><a href="#local-6989586621681480430"><span class="hs-identifier hs-var hs-var hs-var hs-var">parseJSON</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
-&gt; (Text -&gt; Parser BlockHeader) -&gt; Value -&gt; Parser BlockHeader
forall a. String -&gt; (Text -&gt; Parser a) -&gt; Value -&gt; Parser a
</span><span class="hs-identifier hs-var">withText</span></span><span> </span><span class="annot"><span class="hs-string">&quot;BlockHeader&quot;</span></span><span> </span><span class="annot"><span class="annottext">((Text -&gt; Parser BlockHeader) -&gt; Value -&gt; Parser BlockHeader)
-&gt; (Text -&gt; Parser BlockHeader) -&gt; Value -&gt; Parser BlockHeader
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621681480429"><span class="annot"><span class="annottext">t :: Text
</span><a href="#local-6989586621681480429"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-742"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Get BlockHeader -&gt; ByteString -&gt; Either SomeException BlockHeader
forall (m :: * -&gt; *) a. MonadThrow m =&gt; Get a -&gt; ByteString -&gt; m a
</span><a href="Chainweb.Utils.html#runGet"><span class="hs-identifier hs-var">runGet</span></a></span><span> </span><span class="annot"><span class="annottext">Get BlockHeader
forall (m :: * -&gt; *). MonadGet m =&gt; m BlockHeader
</span><a href="Chainweb.BlockHeader.html#decodeBlockHeader"><span class="hs-identifier hs-var">decodeBlockHeader</span></a></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; Either SomeException BlockHeader)
-&gt; Either SomeException ByteString
-&gt; Either SomeException BlockHeader
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m b
</span><span class="hs-operator hs-var">=&lt;&lt;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Either SomeException ByteString
forall (m :: * -&gt; *). MonadThrow m =&gt; Text -&gt; m ByteString
</span><a href="Chainweb.Utils.html#decodeB64UrlNoPaddingText"><span class="hs-identifier hs-var">decodeB64UrlNoPaddingText</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621681480429"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-743"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621681480425"><span class="annot"><span class="annottext">SomeException
</span><a href="#local-6989586621681480425"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SomeException</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; Parser BlockHeader
forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><span class="hs-identifier hs-var">fail</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SomeException -&gt; String
forall a b. (Show a, IsString b) =&gt; a -&gt; b
</span><a href="Chainweb.Utils.html#sshow"><span class="hs-identifier hs-var">sshow</span></a></span><span> </span><span class="annot"><span class="annottext">SomeException
</span><a href="#local-6989586621681480425"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-744"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621681480423"><span class="annot"><span class="annottext">BlockHeader
</span><a href="#local-6989586621681480423"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">BlockHeader -&gt; Parser BlockHeader
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">BlockHeader
</span><a href="#local-6989586621681480423"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-745"></span><span>
</span><span id="line-746"></span><span class="annot"><a href="Chainweb.BlockHeader.html#_blockAdjacentChainIds"><span class="hs-identifier hs-type">_blockAdjacentChainIds</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Chainweb.BlockHeader.html#BlockHeader"><span class="hs-identifier hs-type">BlockHeader</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">HS.HashSet</span></span><span> </span><span class="annot"><a href="Chainweb.ChainId.html#ChainId"><span class="hs-identifier hs-type">ChainId</span></a></span><span>
</span><span id="line-747"></span><span id="_blockAdjacentChainIds"><span class="annot"><span class="annottext">_blockAdjacentChainIds :: BlockHeader -&gt; HashSet ChainId
</span><a href="Chainweb.BlockHeader.html#_blockAdjacentChainIds"><span class="hs-identifier hs-var hs-var">_blockAdjacentChainIds</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-748"></span><span>    </span><span class="annot"><span class="annottext">[ChainId] -&gt; HashSet ChainId
forall a. (Eq a, Hashable a) =&gt; [a] -&gt; HashSet a
</span><span class="hs-identifier hs-var">HS.fromList</span></span><span> </span><span class="annot"><span class="annottext">([ChainId] -&gt; HashSet ChainId)
-&gt; (BlockHeader -&gt; [ChainId]) -&gt; BlockHeader -&gt; HashSet ChainId
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">HashMap ChainId BlockHash -&gt; [ChainId]
forall k v. HashMap k v -&gt; [k]
</span><span class="hs-identifier hs-var">HM.keys</span></span><span> </span><span class="annot"><span class="annottext">(HashMap ChainId BlockHash -&gt; [ChainId])
-&gt; (BlockHeader -&gt; HashMap ChainId BlockHash)
-&gt; BlockHeader
-&gt; [ChainId]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">BlockHashRecord -&gt; HashMap ChainId BlockHash
</span><a href="Chainweb.BlockHash.html#_getBlockHashRecord"><span class="hs-identifier hs-var hs-var">_getBlockHashRecord</span></a></span><span> </span><span class="annot"><span class="annottext">(BlockHashRecord -&gt; HashMap ChainId BlockHash)
-&gt; (BlockHeader -&gt; BlockHashRecord)
-&gt; BlockHeader
-&gt; HashMap ChainId BlockHash
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">BlockHeader -&gt; BlockHashRecord
</span><a href="Chainweb.BlockHeader.html#_blockAdjacentHashes"><span class="hs-identifier hs-var hs-var">_blockAdjacentHashes</span></a></span><span>
</span><span id="line-749"></span><span>
</span><span id="line-750"></span><span class="annot"><a href="Chainweb.BlockHeader.html#blockAdjacentChainIds"><span class="hs-identifier hs-type">blockAdjacentChainIds</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Getter</span></span><span> </span><span class="annot"><a href="Chainweb.BlockHeader.html#BlockHeader"><span class="hs-identifier hs-type">BlockHeader</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">HS.HashSet</span></span><span> </span><span class="annot"><a href="Chainweb.ChainId.html#ChainId"><span class="hs-identifier hs-type">ChainId</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-751"></span><span id="blockAdjacentChainIds"><span class="annot"><span class="annottext">blockAdjacentChainIds :: (HashSet ChainId -&gt; f (HashSet ChainId))
-&gt; BlockHeader -&gt; f BlockHeader
</span><a href="Chainweb.BlockHeader.html#blockAdjacentChainIds"><span class="hs-identifier hs-var hs-var">blockAdjacentChainIds</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(BlockHeader -&gt; HashSet ChainId)
-&gt; (HashSet ChainId -&gt; f (HashSet ChainId))
-&gt; BlockHeader
-&gt; f BlockHeader
forall (p :: * -&gt; * -&gt; *) (f :: * -&gt; *) s a.
(Profunctor p, Contravariant f) =&gt;
(s -&gt; a) -&gt; Optic' p f s a
</span><span class="hs-identifier hs-var">to</span></span><span> </span><span class="annot"><span class="annottext">BlockHeader -&gt; HashSet ChainId
</span><a href="Chainweb.BlockHeader.html#_blockAdjacentChainIds"><span class="hs-identifier hs-var">_blockAdjacentChainIds</span></a></span><span>
</span><span id="line-752"></span><span>
</span><span id="line-753"></span><span id="local-6989586621681480417"><span id="local-6989586621681480418"><span class="annot"><a href="Chainweb.BlockHeader.html#getAdjacentHash"><span class="hs-identifier hs-type">getAdjacentHash</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadThrow</span></span><span> </span><span class="annot"><a href="#local-6989586621681480418"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Chainweb.ChainId.html#HasChainId"><span class="hs-identifier hs-type">HasChainId</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681480417"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681480417"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Chainweb.BlockHeader.html#BlockHeader"><span class="hs-identifier hs-type">BlockHeader</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681480418"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Chainweb.BlockHash.html#BlockHash"><span class="hs-identifier hs-type">BlockHash</span></a></span></span></span><span>
</span><span id="line-754"></span><span id="getAdjacentHash"><span class="annot"><span class="annottext">getAdjacentHash :: p -&gt; BlockHeader -&gt; m BlockHash
</span><a href="Chainweb.BlockHeader.html#getAdjacentHash"><span class="hs-identifier hs-var hs-var">getAdjacentHash</span></a></span></span><span> </span><span id="local-6989586621681480416"><span class="annot"><span class="annottext">p :: p
</span><a href="#local-6989586621681480416"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621681480415"><span class="annot"><span class="annottext">b :: BlockHeader
</span><a href="#local-6989586621681480415"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Getting (Leftmost BlockHash) BlockHeader BlockHash
-&gt; BlockHeader -&gt; Maybe BlockHash
forall a s. Getting (Leftmost a) s a -&gt; s -&gt; Maybe a
</span><span class="hs-identifier hs-var">firstOf</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(BlockHashRecord -&gt; Const (Leftmost BlockHash) BlockHashRecord)
-&gt; BlockHeader -&gt; Const (Leftmost BlockHash) BlockHeader
Lens' BlockHeader BlockHashRecord
</span><a href="Chainweb.BlockHeader.html#blockAdjacentHashes"><span class="hs-identifier hs-var">blockAdjacentHashes</span></a></span><span> </span><span class="annot"><span class="annottext">((BlockHashRecord -&gt; Const (Leftmost BlockHash) BlockHashRecord)
 -&gt; BlockHeader -&gt; Const (Leftmost BlockHash) BlockHeader)
-&gt; ((BlockHash -&gt; Const (Leftmost BlockHash) BlockHash)
    -&gt; BlockHashRecord -&gt; Const (Leftmost BlockHash) BlockHashRecord)
-&gt; Getting (Leftmost BlockHash) BlockHeader BlockHash
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Index BlockHashRecord
-&gt; Fold BlockHashRecord (IxValue BlockHashRecord)
forall a. IxedGet a =&gt; Index a -&gt; Fold a (IxValue a)
</span><a href="Chainweb.Utils.html#ixg"><span class="hs-identifier hs-var">ixg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">p -&gt; ChainId
forall a. HasChainId a =&gt; a -&gt; ChainId
</span><a href="Chainweb.ChainId.html#_chainId"><span class="hs-identifier hs-var">_chainId</span></a></span><span> </span><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621681480416"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">BlockHeader
</span><a href="#local-6989586621681480415"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-755"></span><span>    </span><span class="annot"><span class="annottext">Maybe BlockHash -&gt; ChainGraphException -&gt; m BlockHash
forall (m :: * -&gt; *) e a.
(MonadThrow m, Exception e) =&gt;
Maybe a -&gt; e -&gt; m a
</span><a href="Chainweb.Utils.html#%3F%3F%3F"><span class="hs-operator hs-var">???</span></a></span><span> </span><span class="annot"><span class="annottext">Expected ChainId -&gt; Actual (HashSet ChainId) -&gt; ChainGraphException
</span><a href="Chainweb.Graph.html#ChainNotAdjacentException"><span class="hs-identifier hs-var">ChainNotAdjacentException</span></a></span><span>
</span><span id="line-756"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ChainId -&gt; Expected ChainId
forall a. a -&gt; Expected a
</span><a href="Chainweb.Utils.html#Expected"><span class="hs-identifier hs-var">Expected</span></a></span><span> </span><span class="annot"><span class="annottext">(ChainId -&gt; Expected ChainId) -&gt; ChainId -&gt; Expected ChainId
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">p -&gt; ChainId
forall a. HasChainId a =&gt; a -&gt; ChainId
</span><a href="Chainweb.ChainId.html#_chainId"><span class="hs-identifier hs-var">_chainId</span></a></span><span> </span><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621681480416"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-757"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HashSet ChainId -&gt; Actual (HashSet ChainId)
forall a. a -&gt; Actual a
</span><a href="Chainweb.Utils.html#Actual"><span class="hs-identifier hs-var">Actual</span></a></span><span> </span><span class="annot"><span class="annottext">(HashSet ChainId -&gt; Actual (HashSet ChainId))
-&gt; HashSet ChainId -&gt; Actual (HashSet ChainId)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">BlockHeader -&gt; HashSet ChainId
</span><a href="Chainweb.BlockHeader.html#_blockAdjacentChainIds"><span class="hs-identifier hs-var">_blockAdjacentChainIds</span></a></span><span> </span><span class="annot"><span class="annottext">BlockHeader
</span><a href="#local-6989586621681480415"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-758"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Chainweb.BlockHeader.html#getAdjacentHash"><span class="hs-pragma hs-type">getAdjacentHash</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-759"></span><span>
</span><span id="line-760"></span><span class="annot"><a href="Chainweb.BlockHeader.html#computeBlockHash"><span class="hs-identifier hs-type">computeBlockHash</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Chainweb.BlockHeader.html#BlockHeader"><span class="hs-identifier hs-type">BlockHeader</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Chainweb.BlockHash.html#BlockHash"><span class="hs-identifier hs-type">BlockHash</span></a></span><span>
</span><span id="line-761"></span><span id="computeBlockHash"><span class="annot"><span class="annottext">computeBlockHash :: BlockHeader -&gt; BlockHash
</span><a href="Chainweb.BlockHeader.html#computeBlockHash"><span class="hs-identifier hs-var hs-var">computeBlockHash</span></a></span></span><span> </span><span id="local-6989586621681480410"><span class="annot"><span class="annottext">h :: BlockHeader
</span><a href="#local-6989586621681480410"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MerkleLogHash -&gt; BlockHash
</span><a href="Chainweb.BlockHash.html#BlockHash"><span class="hs-identifier hs-var">BlockHash</span></a></span><span> </span><span class="annot"><span class="annottext">(MerkleLogHash -&gt; BlockHash) -&gt; MerkleLogHash -&gt; BlockHash
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">MerkleRoot (HashAlg ChainwebHashTag) -&gt; MerkleLogHash
</span><a href="Chainweb.MerkleLogHash.html#MerkleLogHash"><span class="hs-identifier hs-var">MerkleLogHash</span></a></span><span> </span><span class="annot"><span class="annottext">(MerkleRoot (HashAlg ChainwebHashTag) -&gt; MerkleLogHash)
-&gt; MerkleRoot (HashAlg ChainwebHashTag) -&gt; MerkleLogHash
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">BlockHeader -&gt; MerkleRoot (HashAlg ChainwebHashTag)
forall u b. HasMerkleLog u b =&gt; b -&gt; MerkleRoot (HashAlg u)
</span><a href="Chainweb.Crypto.MerkleLog.html#computeMerkleLogRoot"><span class="hs-identifier hs-var">computeMerkleLogRoot</span></a></span><span> </span><span class="annot"><span class="annottext">BlockHeader
</span><a href="#local-6989586621681480410"><span class="hs-identifier hs-var">h</span></a></span><span>
</span><span id="line-762"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Chainweb.BlockHeader.html#computeBlockHash"><span class="hs-pragma hs-type">computeBlockHash</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-763"></span><span>
</span><span id="line-764"></span><span class="annot"><a href="Chainweb.BlockHeader.html#isGenesisBlockHeader"><span class="hs-identifier hs-type">isGenesisBlockHeader</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Chainweb.BlockHeader.html#BlockHeader"><span class="hs-identifier hs-type">BlockHeader</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-765"></span><span id="isGenesisBlockHeader"><span class="annot"><span class="annottext">isGenesisBlockHeader :: BlockHeader -&gt; Bool
</span><a href="Chainweb.BlockHeader.html#isGenesisBlockHeader"><span class="hs-identifier hs-var hs-var">isGenesisBlockHeader</span></a></span></span><span> </span><span id="local-6989586621681480408"><span class="annot"><span class="annottext">b :: BlockHeader
</span><a href="#local-6989586621681480408"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BlockHeader -&gt; BlockHeight
</span><a href="Chainweb.BlockHeader.html#_blockHeight"><span class="hs-identifier hs-var hs-var">_blockHeight</span></a></span><span> </span><span class="annot"><span class="annottext">BlockHeader
</span><a href="#local-6989586621681480408"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">BlockHeight -&gt; BlockHeight -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; BlockHeight
</span><a href="Chainweb.BlockHeader.html#BlockHeight"><span class="hs-identifier hs-var">BlockHeight</span></a></span><span> </span><span class="annot"><span class="hs-number">0</span></span><span>
</span><span id="line-766"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Chainweb.BlockHeader.html#isGenesisBlockHeader"><span class="hs-pragma hs-type">isGenesisBlockHeader</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-767"></span><span>
</span><span id="line-768"></span><span class="hs-comment">-- | The Proof-Of-Work hash includes all data in the block except for the</span><span>
</span><span id="line-769"></span><span class="hs-comment">-- '_blockHash'. The value (interpreted as 'BlockHashNat' must be smaller than</span><span>
</span><span id="line-770"></span><span class="hs-comment">-- the value of '_blockTarget' (interpreted as 'BlockHashNat').</span><span>
</span><span id="line-771"></span><span class="hs-comment">--</span><span>
</span><span id="line-772"></span><span class="annot"><a href="Chainweb.BlockHeader.html#_blockPow"><span class="hs-identifier hs-type">_blockPow</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Chainweb.BlockHeader.html#BlockHeader"><span class="hs-identifier hs-type">BlockHeader</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Chainweb.PowHash.html#PowHash"><span class="hs-identifier hs-type">PowHash</span></a></span><span>
</span><span id="line-773"></span><span id="_blockPow"><span class="annot"><span class="annottext">_blockPow :: BlockHeader -&gt; PowHash
</span><a href="Chainweb.BlockHeader.html#_blockPow"><span class="hs-identifier hs-var hs-var">_blockPow</span></a></span></span><span> </span><span id="local-6989586621681480407"><span class="annot"><span class="annottext">h :: BlockHeader
</span><a href="#local-6989586621681480407"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ChainwebVersion -&gt; ByteString -&gt; PowHash
</span><a href="Chainweb.PowHash.html#powHash"><span class="hs-identifier hs-var">powHash</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BlockHeader -&gt; ChainwebVersion
</span><a href="Chainweb.BlockHeader.html#_blockChainwebVersion"><span class="hs-identifier hs-var hs-var">_blockChainwebVersion</span></a></span><span> </span><span class="annot"><span class="annottext">BlockHeader
</span><a href="#local-6989586621681480407"><span class="hs-identifier hs-var">h</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-774"></span><span>    </span><span class="annot"><span class="annottext">(ByteString -&gt; PowHash) -&gt; ByteString -&gt; PowHash
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Put -&gt; ByteString
</span><span class="hs-identifier hs-var">runPutS</span></span><span> </span><span class="annot"><span class="annottext">(Put -&gt; ByteString) -&gt; Put -&gt; ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Putter BlockHeader
forall (m :: * -&gt; *). MonadPut m =&gt; BlockHeader -&gt; m ()
</span><a href="Chainweb.BlockHeader.html#encodeBlockHeaderWithoutHash"><span class="hs-identifier hs-var">encodeBlockHeaderWithoutHash</span></a></span><span> </span><span class="annot"><span class="annottext">BlockHeader
</span><a href="#local-6989586621681480407"><span class="hs-identifier hs-var">h</span></a></span><span>
</span><span id="line-775"></span><span>
</span><span id="line-776"></span><span class="annot"><a href="Chainweb.BlockHeader.html#blockPow"><span class="hs-identifier hs-type">blockPow</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Getter</span></span><span> </span><span class="annot"><a href="Chainweb.BlockHeader.html#BlockHeader"><span class="hs-identifier hs-type">BlockHeader</span></a></span><span> </span><span class="annot"><a href="Chainweb.PowHash.html#PowHash"><span class="hs-identifier hs-type">PowHash</span></a></span><span>
</span><span id="line-777"></span><span id="blockPow"><span class="annot"><span class="annottext">blockPow :: (PowHash -&gt; f PowHash) -&gt; BlockHeader -&gt; f BlockHeader
</span><a href="Chainweb.BlockHeader.html#blockPow"><span class="hs-identifier hs-var hs-var">blockPow</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(BlockHeader -&gt; PowHash)
-&gt; (PowHash -&gt; f PowHash) -&gt; BlockHeader -&gt; f BlockHeader
forall (p :: * -&gt; * -&gt; *) (f :: * -&gt; *) s a.
(Profunctor p, Contravariant f) =&gt;
(s -&gt; a) -&gt; Optic' p f s a
</span><span class="hs-identifier hs-var">to</span></span><span> </span><span class="annot"><span class="annottext">BlockHeader -&gt; PowHash
</span><a href="Chainweb.BlockHeader.html#_blockPow"><span class="hs-identifier hs-var">_blockPow</span></a></span><span>
</span><span id="line-778"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Chainweb.BlockHeader.html#blockPow"><span class="hs-pragma hs-type">blockPow</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-779"></span><span>
</span><span id="line-780"></span><span class="hs-comment">-- | The number of microseconds between the creation time of two `BlockHeader`s.</span><span>
</span><span id="line-781"></span><span class="hs-comment">--</span><span>
</span><span id="line-782"></span><span class="annot"><a href="Chainweb.BlockHeader.html#timeBetween"><span class="hs-identifier hs-type">timeBetween</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Chainweb.BlockHeader.html#BlockCreationTime"><span class="hs-identifier hs-type">BlockCreationTime</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Chainweb.BlockHeader.html#BlockCreationTime"><span class="hs-identifier hs-type">BlockCreationTime</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Chainweb.Time.html#Micros"><span class="hs-identifier hs-type">Micros</span></a></span><span>
</span><span id="line-783"></span><span id="timeBetween"><span class="annot"><span class="annottext">timeBetween :: BlockCreationTime -&gt; BlockCreationTime -&gt; Micros
</span><a href="Chainweb.BlockHeader.html#timeBetween"><span class="hs-identifier hs-var hs-var">timeBetween</span></a></span></span><span> </span><span id="local-6989586621681480405"><span class="annot"><span class="annottext">after :: BlockCreationTime
</span><a href="#local-6989586621681480405"><span class="hs-identifier hs-var">after</span></a></span></span><span> </span><span id="local-6989586621681480404"><span class="annot"><span class="annottext">before :: BlockCreationTime
</span><a href="#local-6989586621681480404"><span class="hs-identifier hs-var">before</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BlockCreationTime -&gt; Micros
</span><a href="#local-6989586621681480403"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">BlockCreationTime
</span><a href="#local-6989586621681480405"><span class="hs-identifier hs-var">after</span></a></span><span> </span><span class="annot"><span class="annottext">Micros -&gt; Micros -&gt; Micros
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">BlockCreationTime -&gt; Micros
</span><a href="#local-6989586621681480403"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">BlockCreationTime
</span><a href="#local-6989586621681480404"><span class="hs-identifier hs-var">before</span></a></span><span>
</span><span id="line-784"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-785"></span><span>    </span><span class="annot"><a href="#local-6989586621681480403"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Chainweb.BlockHeader.html#BlockCreationTime"><span class="hs-identifier hs-type">BlockCreationTime</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Chainweb.Time.html#Micros"><span class="hs-identifier hs-type">Micros</span></a></span><span>
</span><span id="line-786"></span><span>    </span><span id="local-6989586621681480403"><span class="annot"><span class="annottext">f :: BlockCreationTime -&gt; Micros
</span><a href="#local-6989586621681480403"><span class="hs-identifier hs-var hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Chainweb.BlockHeader.html#BlockCreationTime"><span class="hs-identifier hs-type">BlockCreationTime</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Chainweb.Time.html#Time"><span class="hs-identifier hs-type">Time</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Chainweb.Time.html#TimeSpan"><span class="hs-identifier hs-type">TimeSpan</span></a></span><span> </span><span id="local-6989586621681480400"><span class="annot"><span class="annottext">ts :: Micros
</span><a href="#local-6989586621681480400"><span class="hs-identifier hs-var">ts</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Micros
</span><a href="#local-6989586621681480400"><span class="hs-identifier hs-var">ts</span></a></span><span>
</span><span id="line-787"></span><span>
</span><span id="line-788"></span><span class="hs-comment">-- -------------------------------------------------------------------------- --</span><span>
</span><span id="line-789"></span><span class="hs-comment">-- Object JSON encoding</span><span>
</span><span id="line-790"></span><span>
</span><span id="line-791"></span><span class="hs-comment">-- | By default a binary encoding of block headers is used as JSON encoding. In</span><span>
</span><span id="line-792"></span><span class="hs-comment">-- some circumstance, like logging and configuration files, a textual encoding</span><span>
</span><span id="line-793"></span><span class="hs-comment">-- is desired.</span><span>
</span><span id="line-794"></span><span class="hs-comment">--</span><span>
</span><span id="line-795"></span><span id="local-6989586621681480398"><span id="local-6989586621681480399"></span></span><span class="hs-keyword">newtype</span><span> </span><span id="ObjectEncoded"><span class="annot"><a href="Chainweb.BlockHeader.html#ObjectEncoded"><span class="hs-identifier hs-var">ObjectEncoded</span></a></span></span><span> </span><span id="local-6989586621681481214"><span class="annot"><a href="#local-6989586621681481214"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="ObjectEncoded"><span class="annot"><a href="Chainweb.BlockHeader.html#ObjectEncoded"><span class="hs-identifier hs-var">ObjectEncoded</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="_objectEncoded"><span class="annot"><span class="annottext">ObjectEncoded a -&gt; a
</span><a href="Chainweb.BlockHeader.html#_objectEncoded"><span class="hs-identifier hs-var hs-var">_objectEncoded</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621681481214"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-796"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681480390"><span id="local-6989586621681480392"><span id="local-6989586621681480394"><span class="annot"><span class="annottext">Int -&gt; ObjectEncoded a -&gt; ShowS
[ObjectEncoded a] -&gt; ShowS
ObjectEncoded a -&gt; String
(Int -&gt; ObjectEncoded a -&gt; ShowS)
-&gt; (ObjectEncoded a -&gt; String)
-&gt; ([ObjectEncoded a] -&gt; ShowS)
-&gt; Show (ObjectEncoded a)
forall a. Show a =&gt; Int -&gt; ObjectEncoded a -&gt; ShowS
forall a. Show a =&gt; [ObjectEncoded a] -&gt; ShowS
forall a. Show a =&gt; ObjectEncoded a -&gt; String
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [ObjectEncoded a] -&gt; ShowS
$cshowList :: forall a. Show a =&gt; [ObjectEncoded a] -&gt; ShowS
show :: ObjectEncoded a -&gt; String
$cshow :: forall a. Show a =&gt; ObjectEncoded a -&gt; String
showsPrec :: Int -&gt; ObjectEncoded a -&gt; ShowS
$cshowsPrec :: forall a. Show a =&gt; Int -&gt; ObjectEncoded a -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(forall x. ObjectEncoded a -&gt; Rep (ObjectEncoded a) x)
-&gt; (forall x. Rep (ObjectEncoded a) x -&gt; ObjectEncoded a)
-&gt; Generic (ObjectEncoded a)
forall x. Rep (ObjectEncoded a) x -&gt; ObjectEncoded a
forall x. ObjectEncoded a -&gt; Rep (ObjectEncoded a) x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
forall a x. Rep (ObjectEncoded a) x -&gt; ObjectEncoded a
forall a x. ObjectEncoded a -&gt; Rep (ObjectEncoded a) x
$cto :: forall a x. Rep (ObjectEncoded a) x -&gt; ObjectEncoded a
$cfrom :: forall a x. ObjectEncoded a -&gt; Rep (ObjectEncoded a) x
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">Generic</span></span><span class="hs-special">)</span><span>
</span><span id="line-797"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">newtype</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621681480384"><span id="local-6989586621681480386"><span class="annot"><span class="annottext">ObjectEncoded a -&gt; ObjectEncoded a -&gt; Bool
(ObjectEncoded a -&gt; ObjectEncoded a -&gt; Bool)
-&gt; (ObjectEncoded a -&gt; ObjectEncoded a -&gt; Bool)
-&gt; Eq (ObjectEncoded a)
forall a. Eq a =&gt; ObjectEncoded a -&gt; ObjectEncoded a -&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: ObjectEncoded a -&gt; ObjectEncoded a -&gt; Bool
$c/= :: forall a. Eq a =&gt; ObjectEncoded a -&gt; ObjectEncoded a -&gt; Bool
== :: ObjectEncoded a -&gt; ObjectEncoded a -&gt; Bool
$c== :: forall a. Eq a =&gt; ObjectEncoded a -&gt; ObjectEncoded a -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681480369"><span id="local-6989586621681480371"><span id="local-6989586621681480373"><span id="local-6989586621681480375"><span id="local-6989586621681480377"><span id="local-6989586621681480379"><span id="local-6989586621681480381"><span class="annot"><span class="annottext">Eq (ObjectEncoded a)
Eq (ObjectEncoded a) =&gt;
(ObjectEncoded a -&gt; ObjectEncoded a -&gt; Ordering)
-&gt; (ObjectEncoded a -&gt; ObjectEncoded a -&gt; Bool)
-&gt; (ObjectEncoded a -&gt; ObjectEncoded a -&gt; Bool)
-&gt; (ObjectEncoded a -&gt; ObjectEncoded a -&gt; Bool)
-&gt; (ObjectEncoded a -&gt; ObjectEncoded a -&gt; Bool)
-&gt; (ObjectEncoded a -&gt; ObjectEncoded a -&gt; ObjectEncoded a)
-&gt; (ObjectEncoded a -&gt; ObjectEncoded a -&gt; ObjectEncoded a)
-&gt; Ord (ObjectEncoded a)
ObjectEncoded a -&gt; ObjectEncoded a -&gt; Bool
ObjectEncoded a -&gt; ObjectEncoded a -&gt; Ordering
ObjectEncoded a -&gt; ObjectEncoded a -&gt; ObjectEncoded a
forall a.
Eq a =&gt;
(a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
forall a. Ord a =&gt; Eq (ObjectEncoded a)
forall a. Ord a =&gt; ObjectEncoded a -&gt; ObjectEncoded a -&gt; Bool
forall a. Ord a =&gt; ObjectEncoded a -&gt; ObjectEncoded a -&gt; Ordering
forall a.
Ord a =&gt;
ObjectEncoded a -&gt; ObjectEncoded a -&gt; ObjectEncoded a
min :: ObjectEncoded a -&gt; ObjectEncoded a -&gt; ObjectEncoded a
$cmin :: forall a.
Ord a =&gt;
ObjectEncoded a -&gt; ObjectEncoded a -&gt; ObjectEncoded a
max :: ObjectEncoded a -&gt; ObjectEncoded a -&gt; ObjectEncoded a
$cmax :: forall a.
Ord a =&gt;
ObjectEncoded a -&gt; ObjectEncoded a -&gt; ObjectEncoded a
&gt;= :: ObjectEncoded a -&gt; ObjectEncoded a -&gt; Bool
$c&gt;= :: forall a. Ord a =&gt; ObjectEncoded a -&gt; ObjectEncoded a -&gt; Bool
&gt; :: ObjectEncoded a -&gt; ObjectEncoded a -&gt; Bool
$c&gt; :: forall a. Ord a =&gt; ObjectEncoded a -&gt; ObjectEncoded a -&gt; Bool
&lt;= :: ObjectEncoded a -&gt; ObjectEncoded a -&gt; Bool
$c&lt;= :: forall a. Ord a =&gt; ObjectEncoded a -&gt; ObjectEncoded a -&gt; Bool
&lt; :: ObjectEncoded a -&gt; ObjectEncoded a -&gt; Bool
$c&lt; :: forall a. Ord a =&gt; ObjectEncoded a -&gt; ObjectEncoded a -&gt; Bool
compare :: ObjectEncoded a -&gt; ObjectEncoded a -&gt; Ordering
$ccompare :: forall a. Ord a =&gt; ObjectEncoded a -&gt; ObjectEncoded a -&gt; Ordering
$cp1Ord :: forall a. Ord a =&gt; Eq (ObjectEncoded a)
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681480365"><span id="local-6989586621681480367"><span class="annot"><span class="annottext">Int -&gt; ObjectEncoded a -&gt; Int
ObjectEncoded a -&gt; Int
(Int -&gt; ObjectEncoded a -&gt; Int)
-&gt; (ObjectEncoded a -&gt; Int) -&gt; Hashable (ObjectEncoded a)
forall a. Hashable a =&gt; Int -&gt; ObjectEncoded a -&gt; Int
forall a. Hashable a =&gt; ObjectEncoded a -&gt; Int
forall a. (Int -&gt; a -&gt; Int) -&gt; (a -&gt; Int) -&gt; Hashable a
hash :: ObjectEncoded a -&gt; Int
$chash :: forall a. Hashable a =&gt; ObjectEncoded a -&gt; Int
hashWithSalt :: Int -&gt; ObjectEncoded a -&gt; Int
$chashWithSalt :: forall a. Hashable a =&gt; Int -&gt; ObjectEncoded a -&gt; Int
</span><a href="#local-6989586621681480365"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Hashable</span></a></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681480363"><span class="annot"><span class="annottext">ObjectEncoded a -&gt; ()
(ObjectEncoded a -&gt; ()) -&gt; NFData (ObjectEncoded a)
forall a. NFData a =&gt; ObjectEncoded a -&gt; ()
forall a. (a -&gt; ()) -&gt; NFData a
rnf :: ObjectEncoded a -&gt; ()
$crnf :: forall a. NFData a =&gt; ObjectEncoded a -&gt; ()
</span><a href="#local-6989586621681480363"><span class="hs-identifier hs-var hs-var hs-var hs-var">NFData</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-798"></span><span>
</span><span id="line-799"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681480356"><span id="local-6989586621681480358"><span id="local-6989586621681480360"><span class="annot"><span class="hs-identifier hs-type">ToJSON</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Chainweb.BlockHeader.html#ObjectEncoded"><span class="hs-identifier hs-type">ObjectEncoded</span></a></span><span> </span><span class="annot"><a href="Chainweb.BlockHeader.html#BlockHeader"><span class="hs-identifier hs-type">BlockHeader</span></a></span><span class="hs-special">)</span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-800"></span><span>    </span><span id="local-6989586621681480355"><span class="annot"><span class="annottext">toJSON :: ObjectEncoded BlockHeader -&gt; Value
</span><a href="#local-6989586621681480355"><span class="hs-identifier hs-var hs-var hs-var hs-var">toJSON</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Chainweb.BlockHeader.html#ObjectEncoded"><span class="hs-identifier hs-type">ObjectEncoded</span></a></span><span> </span><span id="local-6989586621681480354"><span class="annot"><span class="annottext">b :: BlockHeader
</span><a href="#local-6989586621681480354"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Pair] -&gt; Value
</span><span class="hs-identifier hs-var">object</span></span><span>
</span><span id="line-801"></span><span>        </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="hs-string">&quot;nonce&quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Nonce -&gt; Pair
forall kv v. (KeyValue kv, ToJSON v) =&gt; Text -&gt; v -&gt; kv
</span><span class="hs-operator hs-var">.=</span></span><span> </span><span class="annot"><span class="annottext">BlockHeader -&gt; Nonce
</span><a href="Chainweb.BlockHeader.html#_blockNonce"><span class="hs-identifier hs-var hs-var">_blockNonce</span></a></span><span> </span><span class="annot"><span class="annottext">BlockHeader
</span><a href="#local-6989586621681480354"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-802"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-string">&quot;creationTime&quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; BlockCreationTime -&gt; Pair
forall kv v. (KeyValue kv, ToJSON v) =&gt; Text -&gt; v -&gt; kv
</span><span class="hs-operator hs-var">.=</span></span><span> </span><span class="annot"><span class="annottext">BlockHeader -&gt; BlockCreationTime
</span><a href="Chainweb.BlockHeader.html#_blockCreationTime"><span class="hs-identifier hs-var hs-var">_blockCreationTime</span></a></span><span> </span><span class="annot"><span class="annottext">BlockHeader
</span><a href="#local-6989586621681480354"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-803"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-string">&quot;parent&quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; BlockHash -&gt; Pair
forall kv v. (KeyValue kv, ToJSON v) =&gt; Text -&gt; v -&gt; kv
</span><span class="hs-operator hs-var">.=</span></span><span> </span><span class="annot"><span class="annottext">BlockHeader -&gt; BlockHash
</span><a href="Chainweb.BlockHeader.html#_blockParent"><span class="hs-identifier hs-var hs-var">_blockParent</span></a></span><span> </span><span class="annot"><span class="annottext">BlockHeader
</span><a href="#local-6989586621681480354"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-804"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-string">&quot;adjacents&quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; BlockHashRecord -&gt; Pair
forall kv v. (KeyValue kv, ToJSON v) =&gt; Text -&gt; v -&gt; kv
</span><span class="hs-operator hs-var">.=</span></span><span> </span><span class="annot"><span class="annottext">BlockHeader -&gt; BlockHashRecord
</span><a href="Chainweb.BlockHeader.html#_blockAdjacentHashes"><span class="hs-identifier hs-var hs-var">_blockAdjacentHashes</span></a></span><span> </span><span class="annot"><span class="annottext">BlockHeader
</span><a href="#local-6989586621681480354"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-805"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-string">&quot;target&quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; HashTarget -&gt; Pair
forall kv v. (KeyValue kv, ToJSON v) =&gt; Text -&gt; v -&gt; kv
</span><span class="hs-operator hs-var">.=</span></span><span> </span><span class="annot"><span class="annottext">BlockHeader -&gt; HashTarget
</span><a href="Chainweb.BlockHeader.html#_blockTarget"><span class="hs-identifier hs-var hs-var">_blockTarget</span></a></span><span> </span><span class="annot"><span class="annottext">BlockHeader
</span><a href="#local-6989586621681480354"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-806"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-string">&quot;payloadHash&quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; BlockPayloadHash -&gt; Pair
forall kv v. (KeyValue kv, ToJSON v) =&gt; Text -&gt; v -&gt; kv
</span><span class="hs-operator hs-var">.=</span></span><span> </span><span class="annot"><span class="annottext">BlockHeader -&gt; BlockPayloadHash
</span><a href="Chainweb.BlockHeader.html#_blockPayloadHash"><span class="hs-identifier hs-var hs-var">_blockPayloadHash</span></a></span><span> </span><span class="annot"><span class="annottext">BlockHeader
</span><a href="#local-6989586621681480354"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-807"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-string">&quot;chainId&quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; ChainId -&gt; Pair
forall kv v. (KeyValue kv, ToJSON v) =&gt; Text -&gt; v -&gt; kv
</span><span class="hs-operator hs-var">.=</span></span><span> </span><span class="annot"><span class="annottext">BlockHeader -&gt; ChainId
forall a. HasChainId a =&gt; a -&gt; ChainId
</span><a href="Chainweb.ChainId.html#_chainId"><span class="hs-identifier hs-var">_chainId</span></a></span><span> </span><span class="annot"><span class="annottext">BlockHeader
</span><a href="#local-6989586621681480354"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-808"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-string">&quot;weight&quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; BlockWeight -&gt; Pair
forall kv v. (KeyValue kv, ToJSON v) =&gt; Text -&gt; v -&gt; kv
</span><span class="hs-operator hs-var">.=</span></span><span> </span><span class="annot"><span class="annottext">BlockHeader -&gt; BlockWeight
</span><a href="Chainweb.BlockHeader.html#_blockWeight"><span class="hs-identifier hs-var hs-var">_blockWeight</span></a></span><span> </span><span class="annot"><span class="annottext">BlockHeader
</span><a href="#local-6989586621681480354"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-809"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-string">&quot;height&quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; BlockHeight -&gt; Pair
forall kv v. (KeyValue kv, ToJSON v) =&gt; Text -&gt; v -&gt; kv
</span><span class="hs-operator hs-var">.=</span></span><span> </span><span class="annot"><span class="annottext">BlockHeader -&gt; BlockHeight
</span><a href="Chainweb.BlockHeader.html#_blockHeight"><span class="hs-identifier hs-var hs-var">_blockHeight</span></a></span><span> </span><span class="annot"><span class="annottext">BlockHeader
</span><a href="#local-6989586621681480354"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-810"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-string">&quot;chainwebVersion&quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; ChainwebVersion -&gt; Pair
forall kv v. (KeyValue kv, ToJSON v) =&gt; Text -&gt; v -&gt; kv
</span><span class="hs-operator hs-var">.=</span></span><span> </span><span class="annot"><span class="annottext">BlockHeader -&gt; ChainwebVersion
</span><a href="Chainweb.BlockHeader.html#_blockChainwebVersion"><span class="hs-identifier hs-var hs-var">_blockChainwebVersion</span></a></span><span> </span><span class="annot"><span class="annottext">BlockHeader
</span><a href="#local-6989586621681480354"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-811"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-string">&quot;epochStart&quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; EpochStartTime -&gt; Pair
forall kv v. (KeyValue kv, ToJSON v) =&gt; Text -&gt; v -&gt; kv
</span><span class="hs-operator hs-var">.=</span></span><span> </span><span class="annot"><span class="annottext">BlockHeader -&gt; EpochStartTime
</span><a href="Chainweb.BlockHeader.html#_blockEpochStart"><span class="hs-identifier hs-var hs-var">_blockEpochStart</span></a></span><span> </span><span class="annot"><span class="annottext">BlockHeader
</span><a href="#local-6989586621681480354"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-812"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-string">&quot;featureFlags&quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; FeatureFlags -&gt; Pair
forall kv v. (KeyValue kv, ToJSON v) =&gt; Text -&gt; v -&gt; kv
</span><span class="hs-operator hs-var">.=</span></span><span> </span><span class="annot"><span class="annottext">BlockHeader -&gt; FeatureFlags
</span><a href="Chainweb.BlockHeader.html#_blockFlags"><span class="hs-identifier hs-var hs-var">_blockFlags</span></a></span><span> </span><span class="annot"><span class="annottext">BlockHeader
</span><a href="#local-6989586621681480354"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-813"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-string">&quot;hash&quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; BlockHash -&gt; Pair
forall kv v. (KeyValue kv, ToJSON v) =&gt; Text -&gt; v -&gt; kv
</span><span class="hs-operator hs-var">.=</span></span><span> </span><span class="annot"><span class="annottext">BlockHeader -&gt; BlockHash
</span><a href="Chainweb.BlockHeader.html#_blockHash"><span class="hs-identifier hs-var hs-var">_blockHash</span></a></span><span> </span><span class="annot"><span class="annottext">BlockHeader
</span><a href="#local-6989586621681480354"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-814"></span><span>        </span><span class="hs-special">]</span><span>
</span><span id="line-815"></span><span>
</span><span id="line-816"></span><span class="annot"><a href="Chainweb.BlockHeader.html#parseBlockHeaderObject"><span class="hs-identifier hs-type">parseBlockHeaderObject</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Object</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Parser</span></span><span> </span><span class="annot"><a href="Chainweb.BlockHeader.html#BlockHeader"><span class="hs-identifier hs-type">BlockHeader</span></a></span><span>
</span><span id="line-817"></span><span id="parseBlockHeaderObject"><span class="annot"><span class="annottext">parseBlockHeaderObject :: Object -&gt; Parser BlockHeader
</span><a href="Chainweb.BlockHeader.html#parseBlockHeaderObject"><span class="hs-identifier hs-var hs-var">parseBlockHeaderObject</span></a></span></span><span> </span><span id="local-6989586621681480350"><span class="annot"><span class="annottext">o :: Object
</span><a href="#local-6989586621681480350"><span class="hs-identifier hs-var">o</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Nonce
-&gt; BlockCreationTime
-&gt; BlockHash
-&gt; BlockHashRecord
-&gt; HashTarget
-&gt; BlockPayloadHash
-&gt; ChainId
-&gt; BlockWeight
-&gt; BlockHeight
-&gt; ChainwebVersion
-&gt; EpochStartTime
-&gt; FeatureFlags
-&gt; BlockHash
-&gt; BlockHeader
</span><a href="Chainweb.BlockHeader.html#BlockHeader"><span class="hs-identifier hs-var">BlockHeader</span></a></span><span>
</span><span id="line-818"></span><span>    </span><span class="annot"><span class="annottext">(Nonce
 -&gt; BlockCreationTime
 -&gt; BlockHash
 -&gt; BlockHashRecord
 -&gt; HashTarget
 -&gt; BlockPayloadHash
 -&gt; ChainId
 -&gt; BlockWeight
 -&gt; BlockHeight
 -&gt; ChainwebVersion
 -&gt; EpochStartTime
 -&gt; FeatureFlags
 -&gt; BlockHash
 -&gt; BlockHeader)
-&gt; Parser Nonce
-&gt; Parser
     (BlockCreationTime
      -&gt; BlockHash
      -&gt; BlockHashRecord
      -&gt; HashTarget
      -&gt; BlockPayloadHash
      -&gt; ChainId
      -&gt; BlockWeight
      -&gt; BlockHeight
      -&gt; ChainwebVersion
      -&gt; EpochStartTime
      -&gt; FeatureFlags
      -&gt; BlockHash
      -&gt; BlockHeader)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621681480350"><span class="hs-identifier hs-var">o</span></a></span><span> </span><span class="annot"><span class="annottext">Object -&gt; Text -&gt; Parser Nonce
forall a. FromJSON a =&gt; Object -&gt; Text -&gt; Parser a
</span><span class="hs-operator hs-var">.:</span></span><span> </span><span class="annot"><span class="hs-string">&quot;nonce&quot;</span></span><span>
</span><span id="line-819"></span><span>    </span><span class="annot"><span class="annottext">Parser
  (BlockCreationTime
   -&gt; BlockHash
   -&gt; BlockHashRecord
   -&gt; HashTarget
   -&gt; BlockPayloadHash
   -&gt; ChainId
   -&gt; BlockWeight
   -&gt; BlockHeight
   -&gt; ChainwebVersion
   -&gt; EpochStartTime
   -&gt; FeatureFlags
   -&gt; BlockHash
   -&gt; BlockHeader)
-&gt; Parser BlockCreationTime
-&gt; Parser
     (BlockHash
      -&gt; BlockHashRecord
      -&gt; HashTarget
      -&gt; BlockPayloadHash
      -&gt; ChainId
      -&gt; BlockWeight
      -&gt; BlockHeight
      -&gt; ChainwebVersion
      -&gt; EpochStartTime
      -&gt; FeatureFlags
      -&gt; BlockHash
      -&gt; BlockHeader)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621681480350"><span class="hs-identifier hs-var">o</span></a></span><span> </span><span class="annot"><span class="annottext">Object -&gt; Text -&gt; Parser BlockCreationTime
forall a. FromJSON a =&gt; Object -&gt; Text -&gt; Parser a
</span><span class="hs-operator hs-var">.:</span></span><span> </span><span class="annot"><span class="hs-string">&quot;creationTime&quot;</span></span><span>
</span><span id="line-820"></span><span>    </span><span class="annot"><span class="annottext">Parser
  (BlockHash
   -&gt; BlockHashRecord
   -&gt; HashTarget
   -&gt; BlockPayloadHash
   -&gt; ChainId
   -&gt; BlockWeight
   -&gt; BlockHeight
   -&gt; ChainwebVersion
   -&gt; EpochStartTime
   -&gt; FeatureFlags
   -&gt; BlockHash
   -&gt; BlockHeader)
-&gt; Parser BlockHash
-&gt; Parser
     (BlockHashRecord
      -&gt; HashTarget
      -&gt; BlockPayloadHash
      -&gt; ChainId
      -&gt; BlockWeight
      -&gt; BlockHeight
      -&gt; ChainwebVersion
      -&gt; EpochStartTime
      -&gt; FeatureFlags
      -&gt; BlockHash
      -&gt; BlockHeader)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621681480350"><span class="hs-identifier hs-var">o</span></a></span><span> </span><span class="annot"><span class="annottext">Object -&gt; Text -&gt; Parser BlockHash
forall a. FromJSON a =&gt; Object -&gt; Text -&gt; Parser a
</span><span class="hs-operator hs-var">.:</span></span><span> </span><span class="annot"><span class="hs-string">&quot;parent&quot;</span></span><span>
</span><span id="line-821"></span><span>    </span><span class="annot"><span class="annottext">Parser
  (BlockHashRecord
   -&gt; HashTarget
   -&gt; BlockPayloadHash
   -&gt; ChainId
   -&gt; BlockWeight
   -&gt; BlockHeight
   -&gt; ChainwebVersion
   -&gt; EpochStartTime
   -&gt; FeatureFlags
   -&gt; BlockHash
   -&gt; BlockHeader)
-&gt; Parser BlockHashRecord
-&gt; Parser
     (HashTarget
      -&gt; BlockPayloadHash
      -&gt; ChainId
      -&gt; BlockWeight
      -&gt; BlockHeight
      -&gt; ChainwebVersion
      -&gt; EpochStartTime
      -&gt; FeatureFlags
      -&gt; BlockHash
      -&gt; BlockHeader)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621681480350"><span class="hs-identifier hs-var">o</span></a></span><span> </span><span class="annot"><span class="annottext">Object -&gt; Text -&gt; Parser BlockHashRecord
forall a. FromJSON a =&gt; Object -&gt; Text -&gt; Parser a
</span><span class="hs-operator hs-var">.:</span></span><span> </span><span class="annot"><span class="hs-string">&quot;adjacents&quot;</span></span><span>
</span><span id="line-822"></span><span>    </span><span class="annot"><span class="annottext">Parser
  (HashTarget
   -&gt; BlockPayloadHash
   -&gt; ChainId
   -&gt; BlockWeight
   -&gt; BlockHeight
   -&gt; ChainwebVersion
   -&gt; EpochStartTime
   -&gt; FeatureFlags
   -&gt; BlockHash
   -&gt; BlockHeader)
-&gt; Parser HashTarget
-&gt; Parser
     (BlockPayloadHash
      -&gt; ChainId
      -&gt; BlockWeight
      -&gt; BlockHeight
      -&gt; ChainwebVersion
      -&gt; EpochStartTime
      -&gt; FeatureFlags
      -&gt; BlockHash
      -&gt; BlockHeader)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621681480350"><span class="hs-identifier hs-var">o</span></a></span><span> </span><span class="annot"><span class="annottext">Object -&gt; Text -&gt; Parser HashTarget
forall a. FromJSON a =&gt; Object -&gt; Text -&gt; Parser a
</span><span class="hs-operator hs-var">.:</span></span><span> </span><span class="annot"><span class="hs-string">&quot;target&quot;</span></span><span>
</span><span id="line-823"></span><span>    </span><span class="annot"><span class="annottext">Parser
  (BlockPayloadHash
   -&gt; ChainId
   -&gt; BlockWeight
   -&gt; BlockHeight
   -&gt; ChainwebVersion
   -&gt; EpochStartTime
   -&gt; FeatureFlags
   -&gt; BlockHash
   -&gt; BlockHeader)
-&gt; Parser BlockPayloadHash
-&gt; Parser
     (ChainId
      -&gt; BlockWeight
      -&gt; BlockHeight
      -&gt; ChainwebVersion
      -&gt; EpochStartTime
      -&gt; FeatureFlags
      -&gt; BlockHash
      -&gt; BlockHeader)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621681480350"><span class="hs-identifier hs-var">o</span></a></span><span> </span><span class="annot"><span class="annottext">Object -&gt; Text -&gt; Parser BlockPayloadHash
forall a. FromJSON a =&gt; Object -&gt; Text -&gt; Parser a
</span><span class="hs-operator hs-var">.:</span></span><span> </span><span class="annot"><span class="hs-string">&quot;payloadHash&quot;</span></span><span>
</span><span id="line-824"></span><span>    </span><span class="annot"><span class="annottext">Parser
  (ChainId
   -&gt; BlockWeight
   -&gt; BlockHeight
   -&gt; ChainwebVersion
   -&gt; EpochStartTime
   -&gt; FeatureFlags
   -&gt; BlockHash
   -&gt; BlockHeader)
-&gt; Parser ChainId
-&gt; Parser
     (BlockWeight
      -&gt; BlockHeight
      -&gt; ChainwebVersion
      -&gt; EpochStartTime
      -&gt; FeatureFlags
      -&gt; BlockHash
      -&gt; BlockHeader)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621681480350"><span class="hs-identifier hs-var">o</span></a></span><span> </span><span class="annot"><span class="annottext">Object -&gt; Text -&gt; Parser ChainId
forall a. FromJSON a =&gt; Object -&gt; Text -&gt; Parser a
</span><span class="hs-operator hs-var">.:</span></span><span> </span><span class="annot"><span class="hs-string">&quot;chainId&quot;</span></span><span>
</span><span id="line-825"></span><span>    </span><span class="annot"><span class="annottext">Parser
  (BlockWeight
   -&gt; BlockHeight
   -&gt; ChainwebVersion
   -&gt; EpochStartTime
   -&gt; FeatureFlags
   -&gt; BlockHash
   -&gt; BlockHeader)
-&gt; Parser BlockWeight
-&gt; Parser
     (BlockHeight
      -&gt; ChainwebVersion
      -&gt; EpochStartTime
      -&gt; FeatureFlags
      -&gt; BlockHash
      -&gt; BlockHeader)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621681480350"><span class="hs-identifier hs-var">o</span></a></span><span> </span><span class="annot"><span class="annottext">Object -&gt; Text -&gt; Parser BlockWeight
forall a. FromJSON a =&gt; Object -&gt; Text -&gt; Parser a
</span><span class="hs-operator hs-var">.:</span></span><span> </span><span class="annot"><span class="hs-string">&quot;weight&quot;</span></span><span>
</span><span id="line-826"></span><span>    </span><span class="annot"><span class="annottext">Parser
  (BlockHeight
   -&gt; ChainwebVersion
   -&gt; EpochStartTime
   -&gt; FeatureFlags
   -&gt; BlockHash
   -&gt; BlockHeader)
-&gt; Parser BlockHeight
-&gt; Parser
     (ChainwebVersion
      -&gt; EpochStartTime -&gt; FeatureFlags -&gt; BlockHash -&gt; BlockHeader)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621681480350"><span class="hs-identifier hs-var">o</span></a></span><span> </span><span class="annot"><span class="annottext">Object -&gt; Text -&gt; Parser BlockHeight
forall a. FromJSON a =&gt; Object -&gt; Text -&gt; Parser a
</span><span class="hs-operator hs-var">.:</span></span><span> </span><span class="annot"><span class="hs-string">&quot;height&quot;</span></span><span>
</span><span id="line-827"></span><span>    </span><span class="annot"><span class="annottext">Parser
  (ChainwebVersion
   -&gt; EpochStartTime -&gt; FeatureFlags -&gt; BlockHash -&gt; BlockHeader)
-&gt; Parser ChainwebVersion
-&gt; Parser
     (EpochStartTime -&gt; FeatureFlags -&gt; BlockHash -&gt; BlockHeader)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621681480350"><span class="hs-identifier hs-var">o</span></a></span><span> </span><span class="annot"><span class="annottext">Object -&gt; Text -&gt; Parser ChainwebVersion
forall a. FromJSON a =&gt; Object -&gt; Text -&gt; Parser a
</span><span class="hs-operator hs-var">.:</span></span><span> </span><span class="annot"><span class="hs-string">&quot;chainwebVersion&quot;</span></span><span>
</span><span id="line-828"></span><span>    </span><span class="annot"><span class="annottext">Parser (EpochStartTime -&gt; FeatureFlags -&gt; BlockHash -&gt; BlockHeader)
-&gt; Parser EpochStartTime
-&gt; Parser (FeatureFlags -&gt; BlockHash -&gt; BlockHeader)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621681480350"><span class="hs-identifier hs-var">o</span></a></span><span> </span><span class="annot"><span class="annottext">Object -&gt; Text -&gt; Parser EpochStartTime
forall a. FromJSON a =&gt; Object -&gt; Text -&gt; Parser a
</span><span class="hs-operator hs-var">.:</span></span><span> </span><span class="annot"><span class="hs-string">&quot;epochStart&quot;</span></span><span>
</span><span id="line-829"></span><span>    </span><span class="annot"><span class="annottext">Parser (FeatureFlags -&gt; BlockHash -&gt; BlockHeader)
-&gt; Parser FeatureFlags -&gt; Parser (BlockHash -&gt; BlockHeader)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621681480350"><span class="hs-identifier hs-var">o</span></a></span><span> </span><span class="annot"><span class="annottext">Object -&gt; Text -&gt; Parser FeatureFlags
forall a. FromJSON a =&gt; Object -&gt; Text -&gt; Parser a
</span><span class="hs-operator hs-var">.:</span></span><span> </span><span class="annot"><span class="hs-string">&quot;featureFlags&quot;</span></span><span>
</span><span id="line-830"></span><span>    </span><span class="annot"><span class="annottext">Parser (BlockHash -&gt; BlockHeader)
-&gt; Parser BlockHash -&gt; Parser BlockHeader
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621681480350"><span class="hs-identifier hs-var">o</span></a></span><span> </span><span class="annot"><span class="annottext">Object -&gt; Text -&gt; Parser BlockHash
forall a. FromJSON a =&gt; Object -&gt; Text -&gt; Parser a
</span><span class="hs-operator hs-var">.:</span></span><span> </span><span class="annot"><span class="hs-string">&quot;hash&quot;</span></span><span>
</span><span id="line-831"></span><span>
</span><span id="line-832"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681480346"><span class="annot"><span class="hs-identifier hs-type">FromJSON</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Chainweb.BlockHeader.html#ObjectEncoded"><span class="hs-identifier hs-type">ObjectEncoded</span></a></span><span> </span><span class="annot"><a href="Chainweb.BlockHeader.html#BlockHeader"><span class="hs-identifier hs-type">BlockHeader</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-833"></span><span>    </span><span id="local-6989586621681480345"><span class="annot"><span class="annottext">parseJSON :: Value -&gt; Parser (ObjectEncoded BlockHeader)
</span><a href="#local-6989586621681480345"><span class="hs-identifier hs-var hs-var hs-var hs-var">parseJSON</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
-&gt; (Object -&gt; Parser (ObjectEncoded BlockHeader))
-&gt; Value
-&gt; Parser (ObjectEncoded BlockHeader)
forall a. String -&gt; (Object -&gt; Parser a) -&gt; Value -&gt; Parser a
</span><span class="hs-identifier hs-var">withObject</span></span><span> </span><span class="annot"><span class="hs-string">&quot;BlockHeader&quot;</span></span><span>
</span><span id="line-834"></span><span>        </span><span class="annot"><span class="annottext">((Object -&gt; Parser (ObjectEncoded BlockHeader))
 -&gt; Value -&gt; Parser (ObjectEncoded BlockHeader))
-&gt; (Object -&gt; Parser (ObjectEncoded BlockHeader))
-&gt; Value
-&gt; Parser (ObjectEncoded BlockHeader)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(BlockHeader -&gt; ObjectEncoded BlockHeader)
-&gt; Parser BlockHeader -&gt; Parser (ObjectEncoded BlockHeader)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">BlockHeader -&gt; ObjectEncoded BlockHeader
forall a. a -&gt; ObjectEncoded a
</span><a href="Chainweb.BlockHeader.html#ObjectEncoded"><span class="hs-identifier hs-var">ObjectEncoded</span></a></span><span> </span><span class="annot"><span class="annottext">(Parser BlockHeader -&gt; Parser (ObjectEncoded BlockHeader))
-&gt; (Object -&gt; Parser BlockHeader)
-&gt; Object
-&gt; Parser (ObjectEncoded BlockHeader)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Object -&gt; Parser BlockHeader
</span><a href="Chainweb.BlockHeader.html#parseBlockHeaderObject"><span class="hs-identifier hs-var">parseBlockHeaderObject</span></a></span><span>
</span><span id="line-835"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><span class="hs-pragma hs-type">parseJSON</span></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-836"></span><span>
</span><span id="line-837"></span><span class="hs-comment">-- -------------------------------------------------------------------------- --</span><span>
</span><span id="line-838"></span><span class="hs-comment">-- IsBlockHeader</span><span>
</span><span id="line-839"></span><span>
</span><span id="line-840"></span><span class="hs-comment">-- | Any type which can purely produce a `BlockHeader`, or purely construct one.</span><span>
</span><span id="line-841"></span><span class="hs-comment">--</span><span>
</span><span id="line-842"></span><span class="hs-keyword">class</span><span> </span><span id="IsBlockHeader"><span class="annot"><a href="Chainweb.BlockHeader.html#IsBlockHeader"><span class="hs-identifier hs-var">IsBlockHeader</span></a></span></span><span> </span><span id="local-6989586621681481211"><span class="annot"><a href="#local-6989586621681481211"><span class="hs-identifier hs-type">t</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-843"></span><span>    </span><span id="isoBH"><span class="annot"><a href="Chainweb.BlockHeader.html#isoBH"><span class="hs-identifier hs-type">isoBH</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Iso'</span></span><span> </span><span class="annot"><a href="#local-6989586621681481211"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="Chainweb.BlockHeader.html#BlockHeader"><span class="hs-identifier hs-type">BlockHeader</span></a></span><span>
</span><span id="line-844"></span><span>
</span><span id="line-845"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Chainweb.BlockHeader.html#IsBlockHeader"><span class="hs-identifier hs-type">IsBlockHeader</span></a></span><span> </span><span class="annot"><a href="Chainweb.BlockHeader.html#BlockHeader"><span class="hs-identifier hs-type">BlockHeader</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-846"></span><span>    </span><span id="local-6989586621681480340"><span class="annot"><span class="annottext">isoBH :: p BlockHeader (f BlockHeader) -&gt; p BlockHeader (f BlockHeader)
</span><a href="#local-6989586621681480340"><span class="hs-identifier hs-var hs-var hs-var hs-var">isoBH</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">p BlockHeader (f BlockHeader) -&gt; p BlockHeader (f BlockHeader)
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span>
</span><span id="line-847"></span><span>
</span><span id="line-848"></span><span class="hs-comment">-- FIXME: only for testing:</span><span>
</span><span id="line-849"></span><span class="hs-comment">--</span><span>
</span><span id="line-850"></span><span id="local-6989586621681481196"><span class="annot"><a href="Chainweb.BlockHeader.html#hashPayload"><span class="hs-identifier hs-type">hashPayload</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Chainweb.ChainId.html#HasChainId"><span class="hs-identifier hs-type">HasChainId</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681481196"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Chainweb.Version.html#ChainwebVersion"><span class="hs-identifier hs-type">ChainwebVersion</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681481196"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Chainweb.Payload.html#BlockPayloadHash"><span class="hs-identifier hs-type">BlockPayloadHash</span></a></span></span><span>
</span><span id="line-851"></span><span id="hashPayload"><span class="annot"><span class="annottext">hashPayload :: ChainwebVersion -&gt; p -&gt; ByteString -&gt; BlockPayloadHash
</span><a href="Chainweb.BlockHeader.html#hashPayload"><span class="hs-identifier hs-var hs-var">hashPayload</span></a></span></span><span> </span><span id="local-6989586621681480338"><span class="annot"><span class="annottext">v :: ChainwebVersion
</span><a href="#local-6989586621681480338"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621681480337"><span class="annot"><span class="annottext">cid :: p
</span><a href="#local-6989586621681480337"><span class="hs-identifier hs-var">cid</span></a></span></span><span> </span><span id="local-6989586621681480336"><span class="annot"><span class="annottext">b :: ByteString
</span><a href="#local-6989586621681480336"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MerkleLogHash -&gt; BlockPayloadHash
</span><a href="Chainweb.Payload.html#BlockPayloadHash"><span class="hs-identifier hs-var">BlockPayloadHash</span></a></span><span> </span><span class="annot"><span class="annottext">(MerkleLogHash -&gt; BlockPayloadHash)
-&gt; MerkleLogHash -&gt; BlockPayloadHash
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">MerkleRoot (HashAlg ChainwebHashTag) -&gt; MerkleLogHash
</span><a href="Chainweb.MerkleLogHash.html#MerkleLogHash"><span class="hs-identifier hs-var">MerkleLogHash</span></a></span><span>
</span><span id="line-852"></span><span>    </span><span class="annot"><span class="annottext">(MerkleRoot (HashAlg ChainwebHashTag) -&gt; MerkleLogHash)
-&gt; MerkleRoot (HashAlg ChainwebHashTag) -&gt; MerkleLogHash
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">MerkleTree SHA512t_256 -&gt; MerkleRoot (HashAlg ChainwebHashTag)
forall a. HashAlgorithm a =&gt; MerkleTree a -&gt; MerkleRoot a
</span><span class="hs-identifier hs-var">merkleRoot</span></span><span> </span><span class="annot"><span class="annottext">(MerkleTree SHA512t_256 -&gt; MerkleRoot (HashAlg ChainwebHashTag))
-&gt; MerkleTree SHA512t_256 -&gt; MerkleRoot (HashAlg ChainwebHashTag)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[MerkleNodeType (HashAlg ChainwebHashTag) ByteString]
-&gt; MerkleTree (HashAlg ChainwebHashTag)
forall a b.
(HasCallStack, HashAlgorithm a, ByteArrayAccess b) =&gt;
[MerkleNodeType a b] -&gt; MerkleTree a
</span><span class="hs-identifier hs-var">merkleTree</span></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Chainweb.Crypto.MerkleLog.html#HashAlg"><span class="hs-identifier hs-type">HashAlg</span></a></span><span> </span><span class="annot"><a href="Chainweb.MerkleUniverse.html#ChainwebHashTag"><span class="hs-identifier hs-type">ChainwebHashTag</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-853"></span><span>        </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; MerkleNodeType SHA512t_256 ByteString
forall a b. b -&gt; MerkleNodeType a b
</span><span class="hs-identifier hs-var">InputNode</span></span><span> </span><span class="annot"><span class="hs-string">&quot;CHAINWEB_PAYLOAD&quot;</span></span><span>
</span><span id="line-854"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(forall (m :: * -&gt; *). MonadPut m =&gt; ChainwebVersion -&gt; m ())
-&gt; ChainwebVersion -&gt; MerkleNodeType SHA512t_256 ByteString
forall b a.
(forall (m :: * -&gt; *). MonadPut m =&gt; b -&gt; m ())
-&gt; b -&gt; MerkleNodeType a ByteString
</span><a href="Chainweb.Crypto.MerkleLog.html#encodeMerkleInputNode"><span class="hs-identifier hs-var">encodeMerkleInputNode</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). MonadPut m =&gt; ChainwebVersion -&gt; m ()
</span><a href="Chainweb.Version.html#encodeChainwebVersion"><span class="hs-identifier hs-var">encodeChainwebVersion</span></a></span><span> </span><span class="annot"><span class="annottext">ChainwebVersion
</span><a href="#local-6989586621681480338"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-855"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(forall (m :: * -&gt; *). MonadPut m =&gt; ChainId -&gt; m ())
-&gt; ChainId -&gt; MerkleNodeType SHA512t_256 ByteString
forall b a.
(forall (m :: * -&gt; *). MonadPut m =&gt; b -&gt; m ())
-&gt; b -&gt; MerkleNodeType a ByteString
</span><a href="Chainweb.Crypto.MerkleLog.html#encodeMerkleInputNode"><span class="hs-identifier hs-var">encodeMerkleInputNode</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). MonadPut m =&gt; ChainId -&gt; m ()
</span><a href="Chainweb.ChainId.html#encodeChainId"><span class="hs-identifier hs-var">encodeChainId</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">p -&gt; ChainId
forall a. HasChainId a =&gt; a -&gt; ChainId
</span><a href="Chainweb.ChainId.html#_chainId"><span class="hs-identifier hs-var">_chainId</span></a></span><span> </span><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621681480337"><span class="hs-identifier hs-var">cid</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-856"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; MerkleNodeType SHA512t_256 ByteString
forall a b. b -&gt; MerkleNodeType a b
</span><span class="hs-identifier hs-var">InputNode</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621681480336"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-857"></span><span>        </span><span class="hs-special">]</span><span>
</span><span id="line-858"></span><span>
</span><span id="line-859"></span><span class="hs-comment">-- -------------------------------------------------------------------------- --</span><span>
</span><span id="line-860"></span><span class="hs-comment">-- Create new BlockHeader</span><span>
</span><span id="line-861"></span><span>
</span><span id="line-862"></span><span class="annot"><a href="Chainweb.BlockHeader.html#newBlockHeader"><span class="hs-identifier hs-type">newBlockHeader</span></a></span><span>
</span><span id="line-863"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Chainweb.BlockHash.html#BlockHashRecord"><span class="hs-identifier hs-type">BlockHashRecord</span></a></span><span>
</span><span id="line-864"></span><span>        </span><span class="hs-comment">-- ^ Adjacent parent hashes</span><span>
</span><span id="line-865"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Chainweb.Payload.html#BlockPayloadHash"><span class="hs-identifier hs-type">BlockPayloadHash</span></a></span><span>
</span><span id="line-866"></span><span>        </span><span class="hs-comment">-- ^ payload hash</span><span>
</span><span id="line-867"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Chainweb.BlockHeader.html#Nonce"><span class="hs-identifier hs-type">Nonce</span></a></span><span>
</span><span id="line-868"></span><span>        </span><span class="hs-comment">-- ^ Randomness to affect the block hash</span><span>
</span><span id="line-869"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Chainweb.Time.html#Time"><span class="hs-identifier hs-type">Time</span></a></span><span> </span><span class="annot"><a href="Chainweb.Time.html#Micros"><span class="hs-identifier hs-type">Micros</span></a></span><span>
</span><span id="line-870"></span><span>        </span><span class="hs-comment">-- ^ Creation time of the block</span><span>
</span><span id="line-871"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Chainweb.BlockHeader.html#BlockHeader"><span class="hs-identifier hs-type">BlockHeader</span></a></span><span>
</span><span id="line-872"></span><span>        </span><span class="hs-comment">-- ^ parent block header</span><span>
</span><span id="line-873"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Chainweb.BlockHeader.html#BlockHeader"><span class="hs-identifier hs-type">BlockHeader</span></a></span><span>
</span><span id="line-874"></span><span id="newBlockHeader"><span class="annot"><span class="annottext">newBlockHeader :: BlockHashRecord
-&gt; BlockPayloadHash
-&gt; Nonce
-&gt; Time Micros
-&gt; BlockHeader
-&gt; BlockHeader
</span><a href="Chainweb.BlockHeader.html#newBlockHeader"><span class="hs-identifier hs-var hs-var">newBlockHeader</span></a></span></span><span> </span><span id="local-6989586621681480331"><span class="annot"><span class="annottext">adj :: BlockHashRecord
</span><a href="#local-6989586621681480331"><span class="hs-identifier hs-var">adj</span></a></span></span><span> </span><span id="local-6989586621681480330"><span class="annot"><span class="annottext">pay :: BlockPayloadHash
</span><a href="#local-6989586621681480330"><span class="hs-identifier hs-var">pay</span></a></span></span><span> </span><span id="local-6989586621681480329"><span class="annot"><span class="annottext">nonce :: Nonce
</span><a href="#local-6989586621681480329"><span class="hs-identifier hs-var">nonce</span></a></span></span><span> </span><span id="local-6989586621681480328"><span class="annot"><span class="annottext">t :: Time Micros
</span><a href="#local-6989586621681480328"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621681480327"><span class="annot"><span class="annottext">b :: BlockHeader
</span><a href="#local-6989586621681480327"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MerkleLog
  ChainwebHashTag
  (MerkleLogHeader BlockHeader)
  (MerkleLogBody BlockHeader)
-&gt; BlockHeader
forall u b.
HasMerkleLog u b =&gt;
MerkleLog u (MerkleLogHeader b) (MerkleLogBody b) -&gt; b
</span><a href="Chainweb.Crypto.MerkleLog.html#fromLog"><span class="hs-identifier hs-var">fromLog</span></a></span><span> </span><span class="annot"><span class="annottext">(MerkleLog
   ChainwebHashTag
   (MerkleLogHeader BlockHeader)
   (MerkleLogBody BlockHeader)
 -&gt; BlockHeader)
-&gt; MerkleLog
     ChainwebHashTag
     (MerkleLogHeader BlockHeader)
     (MerkleLogBody BlockHeader)
-&gt; BlockHeader
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">MerkleLogEntries
  ChainwebHashTag
  '[Nonce, BlockCreationTime, BlockHash, HashTarget,
    BlockPayloadHash, ChainId, BlockWeight, BlockHeight,
    ChainwebVersion, EpochStartTime, FeatureFlags]
  BlockHash
-&gt; MerkleLog
     ChainwebHashTag
     (MerkleLogHeader BlockHeader)
     (MerkleLogBody BlockHeader)
forall u (h :: [*]) b.
MerkleUniverse u =&gt;
MerkleLogEntries u h b -&gt; MerkleLog u h b
</span><a href="Chainweb.Crypto.MerkleLog.html#newMerkleLog"><span class="hs-identifier hs-var">newMerkleLog</span></a></span><span>
</span><span id="line-875"></span><span>    </span><span class="annot"><span class="annottext">(MerkleLogEntries
   ChainwebHashTag
   '[Nonce, BlockCreationTime, BlockHash, HashTarget,
     BlockPayloadHash, ChainId, BlockWeight, BlockHeight,
     ChainwebVersion, EpochStartTime, FeatureFlags]
   BlockHash
 -&gt; MerkleLog
      ChainwebHashTag
      (MerkleLogHeader BlockHeader)
      (MerkleLogBody BlockHeader))
-&gt; MerkleLogEntries
     ChainwebHashTag
     '[Nonce, BlockCreationTime, BlockHash, HashTarget,
       BlockPayloadHash, ChainId, BlockWeight, BlockHeight,
       ChainwebVersion, EpochStartTime, FeatureFlags]
     BlockHash
-&gt; MerkleLog
     ChainwebHashTag
     (MerkleLogHeader BlockHeader)
     (MerkleLogBody BlockHeader)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Nonce
</span><a href="#local-6989586621681480329"><span class="hs-identifier hs-var">nonce</span></a></span><span>
</span><span id="line-876"></span><span>    </span><span class="annot"><span class="annottext">Nonce
-&gt; MerkleLogEntries
     ChainwebHashTag
     '[BlockCreationTime, BlockHash, HashTarget, BlockPayloadHash,
       ChainId, BlockWeight, BlockHeight, ChainwebVersion, EpochStartTime,
       FeatureFlags]
     BlockHash
-&gt; MerkleLogEntries
     ChainwebHashTag
     '[Nonce, BlockCreationTime, BlockHash, HashTarget,
       BlockPayloadHash, ChainId, BlockWeight, BlockHeight,
       ChainwebVersion, EpochStartTime, FeatureFlags]
     BlockHash
forall u h (t :: [*]) b.
IsMerkleLogEntry u h =&gt;
h -&gt; MerkleLogEntries u t b -&gt; MerkleLogEntries u (h : t) b
</span><a href="Chainweb.Crypto.MerkleLog.html#%3A%2B%3A"><span class="hs-operator hs-var">:+:</span></a></span><span> </span><span class="annot"><span class="annottext">Time Micros -&gt; BlockCreationTime
</span><a href="Chainweb.BlockHeader.html#BlockCreationTime"><span class="hs-identifier hs-var">BlockCreationTime</span></a></span><span> </span><span class="annot"><span class="annottext">Time Micros
</span><a href="#local-6989586621681480328"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-877"></span><span>    </span><span class="annot"><span class="annottext">BlockCreationTime
-&gt; MerkleLogEntries
     ChainwebHashTag
     '[BlockHash, HashTarget, BlockPayloadHash, ChainId, BlockWeight,
       BlockHeight, ChainwebVersion, EpochStartTime, FeatureFlags]
     BlockHash
-&gt; MerkleLogEntries
     ChainwebHashTag
     '[BlockCreationTime, BlockHash, HashTarget, BlockPayloadHash,
       ChainId, BlockWeight, BlockHeight, ChainwebVersion, EpochStartTime,
       FeatureFlags]
     BlockHash
forall u h (t :: [*]) b.
IsMerkleLogEntry u h =&gt;
h -&gt; MerkleLogEntries u t b -&gt; MerkleLogEntries u (h : t) b
</span><a href="Chainweb.Crypto.MerkleLog.html#%3A%2B%3A"><span class="hs-operator hs-var">:+:</span></a></span><span> </span><span class="annot"><span class="annottext">BlockHeader -&gt; BlockHash
</span><a href="Chainweb.BlockHeader.html#_blockHash"><span class="hs-identifier hs-var hs-var">_blockHash</span></a></span><span> </span><span class="annot"><span class="annottext">BlockHeader
</span><a href="#local-6989586621681480327"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-878"></span><span>    </span><span class="annot"><span class="annottext">BlockHash
-&gt; MerkleLogEntries
     ChainwebHashTag
     '[HashTarget, BlockPayloadHash, ChainId, BlockWeight, BlockHeight,
       ChainwebVersion, EpochStartTime, FeatureFlags]
     BlockHash
-&gt; MerkleLogEntries
     ChainwebHashTag
     '[BlockHash, HashTarget, BlockPayloadHash, ChainId, BlockWeight,
       BlockHeight, ChainwebVersion, EpochStartTime, FeatureFlags]
     BlockHash
forall u h (t :: [*]) b.
IsMerkleLogEntry u h =&gt;
h -&gt; MerkleLogEntries u t b -&gt; MerkleLogEntries u (h : t) b
</span><a href="Chainweb.Crypto.MerkleLog.html#%3A%2B%3A"><span class="hs-operator hs-var">:+:</span></a></span><span> </span><span class="annot"><span class="annottext">HashTarget
</span><a href="#local-6989586621681480326"><span class="hs-identifier hs-var">target</span></a></span><span>
</span><span id="line-879"></span><span>    </span><span class="annot"><span class="annottext">HashTarget
-&gt; MerkleLogEntries
     ChainwebHashTag
     '[BlockPayloadHash, ChainId, BlockWeight, BlockHeight,
       ChainwebVersion, EpochStartTime, FeatureFlags]
     BlockHash
-&gt; MerkleLogEntries
     ChainwebHashTag
     '[HashTarget, BlockPayloadHash, ChainId, BlockWeight, BlockHeight,
       ChainwebVersion, EpochStartTime, FeatureFlags]
     BlockHash
forall u h (t :: [*]) b.
IsMerkleLogEntry u h =&gt;
h -&gt; MerkleLogEntries u t b -&gt; MerkleLogEntries u (h : t) b
</span><a href="Chainweb.Crypto.MerkleLog.html#%3A%2B%3A"><span class="hs-operator hs-var">:+:</span></a></span><span> </span><span class="annot"><span class="annottext">BlockPayloadHash
</span><a href="#local-6989586621681480330"><span class="hs-identifier hs-var">pay</span></a></span><span>
</span><span id="line-880"></span><span>    </span><span class="annot"><span class="annottext">BlockPayloadHash
-&gt; MerkleLogEntries
     ChainwebHashTag
     '[ChainId, BlockWeight, BlockHeight, ChainwebVersion,
       EpochStartTime, FeatureFlags]
     BlockHash
-&gt; MerkleLogEntries
     ChainwebHashTag
     '[BlockPayloadHash, ChainId, BlockWeight, BlockHeight,
       ChainwebVersion, EpochStartTime, FeatureFlags]
     BlockHash
forall u h (t :: [*]) b.
IsMerkleLogEntry u h =&gt;
h -&gt; MerkleLogEntries u t b -&gt; MerkleLogEntries u (h : t) b
</span><a href="Chainweb.Crypto.MerkleLog.html#%3A%2B%3A"><span class="hs-operator hs-var">:+:</span></a></span><span> </span><span class="annot"><span class="annottext">ChainId
</span><a href="#local-6989586621681480325"><span class="hs-identifier hs-var">cid</span></a></span><span>
</span><span id="line-881"></span><span>    </span><span class="annot"><span class="annottext">ChainId
-&gt; MerkleLogEntries
     ChainwebHashTag
     '[BlockWeight, BlockHeight, ChainwebVersion, EpochStartTime,
       FeatureFlags]
     BlockHash
-&gt; MerkleLogEntries
     ChainwebHashTag
     '[ChainId, BlockWeight, BlockHeight, ChainwebVersion,
       EpochStartTime, FeatureFlags]
     BlockHash
forall u h (t :: [*]) b.
IsMerkleLogEntry u h =&gt;
h -&gt; MerkleLogEntries u t b -&gt; MerkleLogEntries u (h : t) b
</span><a href="Chainweb.Crypto.MerkleLog.html#%3A%2B%3A"><span class="hs-operator hs-var">:+:</span></a></span><span> </span><span class="annot"><span class="annottext">BlockHeader -&gt; BlockWeight
</span><a href="Chainweb.BlockHeader.html#_blockWeight"><span class="hs-identifier hs-var hs-var">_blockWeight</span></a></span><span> </span><span class="annot"><span class="annottext">BlockHeader
</span><a href="#local-6989586621681480327"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">BlockWeight -&gt; BlockWeight -&gt; BlockWeight
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">HashDifficulty -&gt; BlockWeight
</span><a href="Chainweb.BlockHeader.html#BlockWeight"><span class="hs-identifier hs-var">BlockWeight</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HashTarget -&gt; HashDifficulty
</span><a href="Chainweb.Difficulty.html#targetToDifficulty"><span class="hs-identifier hs-var">targetToDifficulty</span></a></span><span> </span><span class="annot"><span class="annottext">HashTarget
</span><a href="#local-6989586621681480326"><span class="hs-identifier hs-var">target</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-882"></span><span>    </span><span class="annot"><span class="annottext">BlockWeight
-&gt; MerkleLogEntries
     ChainwebHashTag
     '[BlockHeight, ChainwebVersion, EpochStartTime, FeatureFlags]
     BlockHash
-&gt; MerkleLogEntries
     ChainwebHashTag
     '[BlockWeight, BlockHeight, ChainwebVersion, EpochStartTime,
       FeatureFlags]
     BlockHash
forall u h (t :: [*]) b.
IsMerkleLogEntry u h =&gt;
h -&gt; MerkleLogEntries u t b -&gt; MerkleLogEntries u (h : t) b
</span><a href="Chainweb.Crypto.MerkleLog.html#%3A%2B%3A"><span class="hs-operator hs-var">:+:</span></a></span><span> </span><span class="annot"><span class="annottext">BlockHeader -&gt; BlockHeight
</span><a href="Chainweb.BlockHeader.html#_blockHeight"><span class="hs-identifier hs-var hs-var">_blockHeight</span></a></span><span> </span><span class="annot"><span class="annottext">BlockHeader
</span><a href="#local-6989586621681480327"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">BlockHeight -&gt; BlockHeight -&gt; BlockHeight
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span>
</span><span id="line-883"></span><span>    </span><span class="annot"><span class="annottext">BlockHeight
-&gt; MerkleLogEntries
     ChainwebHashTag
     '[ChainwebVersion, EpochStartTime, FeatureFlags]
     BlockHash
-&gt; MerkleLogEntries
     ChainwebHashTag
     '[BlockHeight, ChainwebVersion, EpochStartTime, FeatureFlags]
     BlockHash
forall u h (t :: [*]) b.
IsMerkleLogEntry u h =&gt;
h -&gt; MerkleLogEntries u t b -&gt; MerkleLogEntries u (h : t) b
</span><a href="Chainweb.Crypto.MerkleLog.html#%3A%2B%3A"><span class="hs-operator hs-var">:+:</span></a></span><span> </span><span class="annot"><span class="annottext">ChainwebVersion
</span><a href="#local-6989586621681480323"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-884"></span><span>    </span><span class="annot"><span class="annottext">ChainwebVersion
-&gt; MerkleLogEntries
     ChainwebHashTag '[EpochStartTime, FeatureFlags] BlockHash
-&gt; MerkleLogEntries
     ChainwebHashTag
     '[ChainwebVersion, EpochStartTime, FeatureFlags]
     BlockHash
forall u h (t :: [*]) b.
IsMerkleLogEntry u h =&gt;
h -&gt; MerkleLogEntries u t b -&gt; MerkleLogEntries u (h : t) b
</span><a href="Chainweb.Crypto.MerkleLog.html#%3A%2B%3A"><span class="hs-operator hs-var">:+:</span></a></span><span> </span><span class="annot"><span class="annottext">BlockHeader -&gt; BlockCreationTime -&gt; EpochStartTime
</span><a href="Chainweb.BlockHeader.html#epochStart"><span class="hs-identifier hs-var">epochStart</span></a></span><span> </span><span class="annot"><span class="annottext">BlockHeader
</span><a href="#local-6989586621681480327"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Time Micros -&gt; BlockCreationTime
</span><a href="Chainweb.BlockHeader.html#BlockCreationTime"><span class="hs-identifier hs-var">BlockCreationTime</span></a></span><span> </span><span class="annot"><span class="annottext">Time Micros
</span><a href="#local-6989586621681480328"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-885"></span><span>    </span><span class="annot"><span class="annottext">EpochStartTime
-&gt; MerkleLogEntries ChainwebHashTag '[FeatureFlags] BlockHash
-&gt; MerkleLogEntries
     ChainwebHashTag '[EpochStartTime, FeatureFlags] BlockHash
forall u h (t :: [*]) b.
IsMerkleLogEntry u h =&gt;
h -&gt; MerkleLogEntries u t b -&gt; MerkleLogEntries u (h : t) b
</span><a href="Chainweb.Crypto.MerkleLog.html#%3A%2B%3A"><span class="hs-operator hs-var">:+:</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; FeatureFlags
</span><a href="Chainweb.BlockHeader.html#FeatureFlags"><span class="hs-identifier hs-var">FeatureFlags</span></a></span><span> </span><span class="annot"><span class="hs-number">0</span></span><span>
</span><span id="line-886"></span><span>    </span><span class="annot"><span class="annottext">FeatureFlags
-&gt; MerkleLogEntries ChainwebHashTag '[] BlockHash
-&gt; MerkleLogEntries ChainwebHashTag '[FeatureFlags] BlockHash
forall u h (t :: [*]) b.
IsMerkleLogEntry u h =&gt;
h -&gt; MerkleLogEntries u t b -&gt; MerkleLogEntries u (h : t) b
</span><a href="Chainweb.Crypto.MerkleLog.html#%3A%2B%3A"><span class="hs-operator hs-var">:+:</span></a></span><span> </span><span class="annot"><span class="annottext">Vector BlockHash -&gt; MerkleLogEntries ChainwebHashTag '[] BlockHash
forall u b.
IsMerkleLogEntry u b =&gt;
Vector b -&gt; MerkleLogEntries u '[] b
</span><a href="Chainweb.Crypto.MerkleLog.html#MerkleLogBody"><span class="hs-identifier hs-var">MerkleLogBody</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BlockHashRecord -&gt; Vector BlockHash
</span><a href="Chainweb.BlockHash.html#blockHashRecordToVector"><span class="hs-identifier hs-var">blockHashRecordToVector</span></a></span><span> </span><span class="annot"><span class="annottext">BlockHashRecord
</span><a href="#local-6989586621681480331"><span class="hs-identifier hs-var">adj</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-887"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-888"></span><span>    </span><span id="local-6989586621681480325"><span class="annot"><span class="annottext">cid :: ChainId
</span><a href="#local-6989586621681480325"><span class="hs-identifier hs-var hs-var">cid</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BlockHeader -&gt; ChainId
forall a. HasChainId a =&gt; a -&gt; ChainId
</span><a href="Chainweb.ChainId.html#_chainId"><span class="hs-identifier hs-var">_chainId</span></a></span><span> </span><span class="annot"><span class="annottext">BlockHeader
</span><a href="#local-6989586621681480327"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-889"></span><span>    </span><span id="local-6989586621681480323"><span class="annot"><span class="annottext">v :: ChainwebVersion
</span><a href="#local-6989586621681480323"><span class="hs-identifier hs-var hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BlockHeader -&gt; ChainwebVersion
</span><a href="Chainweb.BlockHeader.html#_blockChainwebVersion"><span class="hs-identifier hs-var hs-var">_blockChainwebVersion</span></a></span><span> </span><span class="annot"><span class="annottext">BlockHeader
</span><a href="#local-6989586621681480327"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-890"></span><span>    </span><span id="local-6989586621681480326"><span class="annot"><span class="annottext">target :: HashTarget
</span><a href="#local-6989586621681480326"><span class="hs-identifier hs-var hs-var">target</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BlockHeader -&gt; BlockCreationTime -&gt; HashTarget
</span><a href="Chainweb.BlockHeader.html#powTarget"><span class="hs-identifier hs-var">powTarget</span></a></span><span> </span><span class="annot"><span class="annottext">BlockHeader
</span><a href="#local-6989586621681480327"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Time Micros -&gt; BlockCreationTime
</span><a href="Chainweb.BlockHeader.html#BlockCreationTime"><span class="hs-identifier hs-var">BlockCreationTime</span></a></span><span> </span><span class="annot"><span class="annottext">Time Micros
</span><a href="#local-6989586621681480328"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-891"></span><span>
</span><span id="line-892"></span><span class="hs-comment">-- -------------------------------------------------------------------------- --</span><span>
</span><span id="line-893"></span><span class="hs-comment">-- TreeDBEntry instance</span><span>
</span><span id="line-894"></span><span>
</span><span id="line-895"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Chainweb.TreeDB.html#TreeDbEntry"><span class="hs-identifier hs-type">TreeDbEntry</span></a></span><span> </span><span class="annot"><a href="Chainweb.BlockHeader.html#BlockHeader"><span class="hs-identifier hs-type">BlockHeader</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-896"></span><span>    </span><span class="hs-keyword">type</span><span> </span><span id="Key"><span class="annot"><a href="Chainweb.TreeDB.html#Key"><span class="hs-identifier hs-var">Key</span></a></span></span><span> </span><span class="annot"><a href="Chainweb.BlockHeader.html#BlockHeader"><span class="hs-identifier hs-type">BlockHeader</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Chainweb.BlockHash.html#BlockHash"><span class="hs-identifier hs-type">BlockHash</span></a></span><span>
</span><span id="line-897"></span><span>    </span><span id="local-6989586621681480312"><span class="annot"><span class="annottext">key :: BlockHeader -&gt; Key BlockHeader
</span><a href="Chainweb.TreeDB.html#key"><span class="hs-identifier hs-var hs-var hs-var hs-var">key</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BlockHeader -&gt; Key BlockHeader
BlockHeader -&gt; BlockHash
</span><a href="Chainweb.BlockHeader.html#_blockHash"><span class="hs-identifier hs-var hs-var">_blockHash</span></a></span><span>
</span><span id="line-898"></span><span>    </span><span id="local-6989586621681480310"><span class="annot"><span class="annottext">rank :: BlockHeader -&gt; Natural
</span><a href="Chainweb.TreeDB.html#rank"><span class="hs-identifier hs-var hs-var hs-var hs-var">rank</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BlockHeight -&gt; Natural
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="Chainweb.Utils.html#int"><span class="hs-identifier hs-var">int</span></a></span><span> </span><span class="annot"><span class="annottext">(BlockHeight -&gt; Natural)
-&gt; (BlockHeader -&gt; BlockHeight) -&gt; BlockHeader -&gt; Natural
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">BlockHeader -&gt; BlockHeight
</span><a href="Chainweb.BlockHeader.html#_blockHeight"><span class="hs-identifier hs-var hs-var">_blockHeight</span></a></span><span>
</span><span id="line-899"></span><span>    </span><span id="local-6989586621681480308"><span class="annot"><span class="annottext">parent :: BlockHeader -&gt; Maybe (Key BlockHeader)
</span><a href="Chainweb.TreeDB.html#parent"><span class="hs-identifier hs-var hs-var hs-var hs-var">parent</span></a></span></span><span> </span><span id="local-6989586621681480306"><span class="annot"><span class="annottext">e :: BlockHeader
</span><a href="#local-6989586621681480306"><span class="hs-identifier hs-var">e</span></a></span></span><span>
</span><span id="line-900"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">BlockHeader -&gt; Bool
</span><a href="Chainweb.BlockHeader.html#isGenesisBlockHeader"><span class="hs-identifier hs-var">isGenesisBlockHeader</span></a></span><span> </span><span class="annot"><span class="annottext">BlockHeader
</span><a href="#local-6989586621681480306"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (Key BlockHeader)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-901"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BlockHash -&gt; Maybe BlockHash
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BlockHeader -&gt; BlockHash
</span><a href="Chainweb.BlockHeader.html#_blockParent"><span class="hs-identifier hs-var hs-var">_blockParent</span></a></span><span> </span><span class="annot"><span class="annottext">BlockHeader
</span><a href="#local-6989586621681480306"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-902"></span><span>
</span><span id="line-903"></span><span class="hs-comment">-- -------------------------------------------------------------------------- --</span><span>
</span><span id="line-904"></span><span class="hs-comment">-- Testing</span><span>
</span><span id="line-905"></span><span>
</span><span id="line-906"></span><span class="annot"><a href="Chainweb.BlockHeader.html#testBlockPayload"><span class="hs-identifier hs-type">testBlockPayload</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Chainweb.BlockHeader.html#BlockHeader"><span class="hs-identifier hs-type">BlockHeader</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Chainweb.Payload.html#BlockPayloadHash"><span class="hs-identifier hs-type">BlockPayloadHash</span></a></span><span>
</span><span id="line-907"></span><span id="testBlockPayload"><span class="annot"><span class="annottext">testBlockPayload :: BlockHeader -&gt; BlockPayloadHash
</span><a href="Chainweb.BlockHeader.html#testBlockPayload"><span class="hs-identifier hs-var hs-var">testBlockPayload</span></a></span></span><span> </span><span id="local-6989586621681480305"><span class="annot"><span class="annottext">b :: BlockHeader
</span><a href="#local-6989586621681480305"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ChainwebVersion -&gt; BlockHeader -&gt; ByteString -&gt; BlockPayloadHash
forall p.
HasChainId p =&gt;
ChainwebVersion -&gt; p -&gt; ByteString -&gt; BlockPayloadHash
</span><a href="Chainweb.BlockHeader.html#hashPayload"><span class="hs-identifier hs-var">hashPayload</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BlockHeader -&gt; ChainwebVersion
</span><a href="Chainweb.BlockHeader.html#_blockChainwebVersion"><span class="hs-identifier hs-var hs-var">_blockChainwebVersion</span></a></span><span> </span><span class="annot"><span class="annottext">BlockHeader
</span><a href="#local-6989586621681480305"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">BlockHeader
</span><a href="#local-6989586621681480305"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;TEST PAYLOAD&quot;</span></span><span>
</span><span id="line-908"></span><span>
</span><span id="line-909"></span><span class="annot"><a href="Chainweb.BlockHeader.html#testBlockHeader"><span class="hs-identifier hs-type">testBlockHeader</span></a></span><span>
</span><span id="line-910"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Chainweb.BlockHash.html#BlockHashRecord"><span class="hs-identifier hs-type">BlockHashRecord</span></a></span><span>
</span><span id="line-911"></span><span>        </span><span class="hs-comment">-- ^ Adjacent parent hashes</span><span>
</span><span id="line-912"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Chainweb.BlockHeader.html#Nonce"><span class="hs-identifier hs-type">Nonce</span></a></span><span>
</span><span id="line-913"></span><span>        </span><span class="hs-comment">-- ^ Randomness to affect the block hash</span><span>
</span><span id="line-914"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Chainweb.BlockHeader.html#BlockHeader"><span class="hs-identifier hs-type">BlockHeader</span></a></span><span>
</span><span id="line-915"></span><span>        </span><span class="hs-comment">-- ^ parent block header</span><span>
</span><span id="line-916"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Chainweb.BlockHeader.html#BlockHeader"><span class="hs-identifier hs-type">BlockHeader</span></a></span><span>
</span><span id="line-917"></span><span id="testBlockHeader"><span class="annot"><span class="annottext">testBlockHeader :: BlockHashRecord -&gt; Nonce -&gt; BlockHeader -&gt; BlockHeader
</span><a href="Chainweb.BlockHeader.html#testBlockHeader"><span class="hs-identifier hs-var hs-var">testBlockHeader</span></a></span></span><span> </span><span id="local-6989586621681480304"><span class="annot"><span class="annottext">adj :: BlockHashRecord
</span><a href="#local-6989586621681480304"><span class="hs-identifier hs-var">adj</span></a></span></span><span> </span><span id="local-6989586621681480303"><span class="annot"><span class="annottext">nonce :: Nonce
</span><a href="#local-6989586621681480303"><span class="hs-identifier hs-var">nonce</span></a></span></span><span> </span><span id="local-6989586621681480302"><span class="annot"><span class="annottext">b :: BlockHeader
</span><a href="#local-6989586621681480302"><span class="hs-identifier hs-var">b</span></a></span></span><span>
</span><span id="line-918"></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BlockHashRecord
-&gt; BlockPayloadHash
-&gt; Nonce
-&gt; Time Micros
-&gt; BlockHeader
-&gt; BlockHeader
</span><a href="Chainweb.BlockHeader.html#newBlockHeader"><span class="hs-identifier hs-var">newBlockHeader</span></a></span><span> </span><span class="annot"><span class="annottext">BlockHashRecord
</span><a href="#local-6989586621681480304"><span class="hs-identifier hs-var">adj</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BlockHeader -&gt; BlockPayloadHash
</span><a href="Chainweb.BlockHeader.html#testBlockPayload"><span class="hs-identifier hs-var">testBlockPayload</span></a></span><span> </span><span class="annot"><span class="annottext">BlockHeader
</span><a href="#local-6989586621681480302"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Nonce
</span><a href="#local-6989586621681480303"><span class="hs-identifier hs-var">nonce</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Diff (Time Micros) -&gt; Time Micros -&gt; Time Micros
forall t. LeftTorsor t =&gt; Diff t -&gt; t -&gt; t
</span><a href="Numeric.AffineSpace.html#add"><span class="hs-identifier hs-var">add</span></a></span><span> </span><span class="annot"><span class="annottext">Diff (Time Micros)
forall a. Num a =&gt; TimeSpan a
</span><a href="Chainweb.Time.html#second"><span class="hs-identifier hs-var">second</span></a></span><span> </span><span class="annot"><span class="annottext">Time Micros
</span><a href="#local-6989586621681480299"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">BlockHeader
</span><a href="#local-6989586621681480302"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-919"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-920"></span><span>    </span><span class="annot"><a href="Chainweb.BlockHeader.html#BlockCreationTime"><span class="hs-identifier hs-type">BlockCreationTime</span></a></span><span> </span><span id="local-6989586621681480299"><span class="annot"><span class="annottext">t :: Time Micros
</span><a href="#local-6989586621681480299"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BlockHeader -&gt; BlockCreationTime
</span><a href="Chainweb.BlockHeader.html#_blockCreationTime"><span class="hs-identifier hs-var hs-var">_blockCreationTime</span></a></span><span> </span><span class="annot"><span class="annottext">BlockHeader
</span><a href="#local-6989586621681480302"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-921"></span><span>
</span><span id="line-922"></span><span class="hs-comment">-- | Given a `BlockHeader` of some initial parent, generate an infinite stream</span><span>
</span><span id="line-923"></span><span class="hs-comment">-- of `BlockHeader`s which form a legal chain.</span><span>
</span><span id="line-924"></span><span class="hs-comment">--</span><span>
</span><span id="line-925"></span><span class="hs-comment">-- Should only be used for testing purposes.</span><span>
</span><span id="line-926"></span><span class="hs-comment">--</span><span>
</span><span id="line-927"></span><span class="annot"><a href="Chainweb.BlockHeader.html#testBlockHeaders"><span class="hs-identifier hs-type">testBlockHeaders</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Chainweb.BlockHeader.html#BlockHeader"><span class="hs-identifier hs-type">BlockHeader</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Chainweb.BlockHeader.html#BlockHeader"><span class="hs-identifier hs-type">BlockHeader</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-928"></span><span id="testBlockHeaders"><span class="annot"><span class="annottext">testBlockHeaders :: BlockHeader -&gt; [BlockHeader]
</span><a href="Chainweb.BlockHeader.html#testBlockHeaders"><span class="hs-identifier hs-var hs-var">testBlockHeaders</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(BlockHeader -&gt; Maybe (BlockHeader, BlockHeader))
-&gt; BlockHeader -&gt; [BlockHeader]
forall b a. (b -&gt; Maybe (a, b)) -&gt; b -&gt; [a]
</span><span class="hs-identifier hs-var">unfoldr</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(BlockHeader, BlockHeader) -&gt; Maybe (BlockHeader, BlockHeader)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">((BlockHeader, BlockHeader) -&gt; Maybe (BlockHeader, BlockHeader))
-&gt; (BlockHeader -&gt; (BlockHeader, BlockHeader))
-&gt; BlockHeader
-&gt; Maybe (BlockHeader, BlockHeader)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BlockHeader -&gt; BlockHeader
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span> </span><span class="annot"><span class="annottext">(BlockHeader -&gt; BlockHeader)
-&gt; (BlockHeader -&gt; BlockHeader)
-&gt; BlockHeader
-&gt; (BlockHeader, BlockHeader)
forall (a :: * -&gt; * -&gt; *) b c c'.
Arrow a =&gt;
a b c -&gt; a b c' -&gt; a b (c, c')
</span><span class="hs-operator hs-var">&amp;&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">BlockHeader -&gt; BlockHeader
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(BlockHeader -&gt; (BlockHeader, BlockHeader))
-&gt; (BlockHeader -&gt; BlockHeader)
-&gt; BlockHeader
-&gt; (BlockHeader, BlockHeader)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">BlockHeader -&gt; BlockHeader
</span><a href="#local-6989586621681480298"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-929"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-930"></span><span>    </span><span id="local-6989586621681480298"><span class="annot"><span class="annottext">f :: BlockHeader -&gt; BlockHeader
</span><a href="#local-6989586621681480298"><span class="hs-identifier hs-var hs-var">f</span></a></span></span><span> </span><span id="local-6989586621681480297"><span class="annot"><span class="annottext">b :: BlockHeader
</span><a href="#local-6989586621681480297"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BlockHashRecord -&gt; Nonce -&gt; BlockHeader -&gt; BlockHeader
</span><a href="Chainweb.BlockHeader.html#testBlockHeader"><span class="hs-identifier hs-var">testBlockHeader</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HashMap ChainId BlockHash -&gt; BlockHashRecord
</span><a href="Chainweb.BlockHash.html#BlockHashRecord"><span class="hs-identifier hs-var">BlockHashRecord</span></a></span><span> </span><span class="annot"><span class="annottext">HashMap ChainId BlockHash
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BlockHeader -&gt; Nonce
</span><a href="Chainweb.BlockHeader.html#_blockNonce"><span class="hs-identifier hs-var hs-var">_blockNonce</span></a></span><span> </span><span class="annot"><span class="annottext">BlockHeader
</span><a href="#local-6989586621681480297"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">BlockHeader
</span><a href="#local-6989586621681480297"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-931"></span><span>
</span><span id="line-932"></span><span class="hs-comment">-- | Given a `BlockHeader` of some initial parent, generate an infinite stream</span><span>
</span><span id="line-933"></span><span class="hs-comment">-- of `BlockHeader`s which form a legal chain.</span><span>
</span><span id="line-934"></span><span class="hs-comment">--</span><span>
</span><span id="line-935"></span><span class="hs-comment">-- Should only be used for testing purposes.</span><span>
</span><span id="line-936"></span><span class="hs-comment">--</span><span>
</span><span id="line-937"></span><span class="annot"><a href="Chainweb.BlockHeader.html#testBlockHeadersWithNonce"><span class="hs-identifier hs-type">testBlockHeadersWithNonce</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Chainweb.BlockHeader.html#Nonce"><span class="hs-identifier hs-type">Nonce</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Chainweb.BlockHeader.html#BlockHeader"><span class="hs-identifier hs-type">BlockHeader</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Chainweb.BlockHeader.html#BlockHeader"><span class="hs-identifier hs-type">BlockHeader</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-938"></span><span id="testBlockHeadersWithNonce"><span class="annot"><span class="annottext">testBlockHeadersWithNonce :: Nonce -&gt; BlockHeader -&gt; [BlockHeader]
</span><a href="Chainweb.BlockHeader.html#testBlockHeadersWithNonce"><span class="hs-identifier hs-var hs-var">testBlockHeadersWithNonce</span></a></span></span><span> </span><span id="local-6989586621681480295"><span class="annot"><span class="annottext">n :: Nonce
</span><a href="#local-6989586621681480295"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(BlockHeader -&gt; Maybe (BlockHeader, BlockHeader))
-&gt; BlockHeader -&gt; [BlockHeader]
forall b a. (b -&gt; Maybe (a, b)) -&gt; b -&gt; [a]
</span><span class="hs-identifier hs-var">unfoldr</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(BlockHeader, BlockHeader) -&gt; Maybe (BlockHeader, BlockHeader)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">((BlockHeader, BlockHeader) -&gt; Maybe (BlockHeader, BlockHeader))
-&gt; (BlockHeader -&gt; (BlockHeader, BlockHeader))
-&gt; BlockHeader
-&gt; Maybe (BlockHeader, BlockHeader)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BlockHeader -&gt; BlockHeader
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span> </span><span class="annot"><span class="annottext">(BlockHeader -&gt; BlockHeader)
-&gt; (BlockHeader -&gt; BlockHeader)
-&gt; BlockHeader
-&gt; (BlockHeader, BlockHeader)
forall (a :: * -&gt; * -&gt; *) b c c'.
Arrow a =&gt;
a b c -&gt; a b c' -&gt; a b (c, c')
</span><span class="hs-operator hs-var">&amp;&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">BlockHeader -&gt; BlockHeader
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(BlockHeader -&gt; (BlockHeader, BlockHeader))
-&gt; (BlockHeader -&gt; BlockHeader)
-&gt; BlockHeader
-&gt; (BlockHeader, BlockHeader)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">BlockHeader -&gt; BlockHeader
</span><a href="#local-6989586621681480294"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-939"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-940"></span><span>    </span><span id="local-6989586621681480294"><span class="annot"><span class="annottext">f :: BlockHeader -&gt; BlockHeader
</span><a href="#local-6989586621681480294"><span class="hs-identifier hs-var hs-var">f</span></a></span></span><span> </span><span id="local-6989586621681480293"><span class="annot"><span class="annottext">b :: BlockHeader
</span><a href="#local-6989586621681480293"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BlockHashRecord -&gt; Nonce -&gt; BlockHeader -&gt; BlockHeader
</span><a href="Chainweb.BlockHeader.html#testBlockHeader"><span class="hs-identifier hs-var">testBlockHeader</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HashMap ChainId BlockHash -&gt; BlockHashRecord
</span><a href="Chainweb.BlockHash.html#BlockHashRecord"><span class="hs-identifier hs-var">BlockHashRecord</span></a></span><span> </span><span class="annot"><span class="annottext">HashMap ChainId BlockHash
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Nonce
</span><a href="#local-6989586621681480295"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">BlockHeader
</span><a href="#local-6989586621681480293"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-941"></span></pre></body></html>