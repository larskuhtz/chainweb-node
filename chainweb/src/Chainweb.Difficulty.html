<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE ConstraintKinds #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE DataKinds #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE DeriveAnyClass #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE DeriveGeneric #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# LANGUAGE DerivingStrategies #-}</span><span>
</span><span id="line-6"></span><span class="hs-pragma">{-# LANGUAGE FlexibleContexts #-}</span><span>
</span><span id="line-7"></span><span class="hs-pragma">{-# LANGUAGE FlexibleInstances #-}</span><span>
</span><span id="line-8"></span><span class="hs-pragma">{-# LANGUAGE GADTs #-}</span><span>
</span><span id="line-9"></span><span class="hs-pragma">{-# LANGUAGE GeneralizedNewtypeDeriving #-}</span><span>
</span><span id="line-10"></span><span class="hs-pragma">{-# LANGUAGE LambdaCase #-}</span><span>
</span><span id="line-11"></span><span class="hs-pragma">{-# LANGUAGE MultiParamTypeClasses #-}</span><span>
</span><span id="line-12"></span><span class="hs-pragma">{-# LANGUAGE OverloadedStrings #-}</span><span>
</span><span id="line-13"></span><span class="hs-pragma">{-# LANGUAGE ParallelListComp #-}</span><span>
</span><span id="line-14"></span><span class="hs-pragma">{-# LANGUAGE ScopedTypeVariables #-}</span><span>
</span><span id="line-15"></span><span class="hs-pragma">{-# LANGUAGE TemplateHaskell #-}</span><span>
</span><span id="line-16"></span><span class="hs-pragma">{-# LANGUAGE TypeFamilies #-}</span><span>
</span><span id="line-17"></span><span class="hs-pragma">{-# LANGUAGE TypeOperators #-}</span><span>
</span><span id="line-18"></span><span class="hs-pragma">{-# LANGUAGE TypeSynonymInstances #-}</span><span>
</span><span id="line-19"></span><span>
</span><span id="line-20"></span><span class="hs-pragma">{-# OPTIONS_GHC -fno-warn-orphans #-}</span><span>
</span><span id="line-21"></span><span>
</span><span id="line-22"></span><span class="hs-comment">-- |</span><span>
</span><span id="line-23"></span><span class="hs-comment">-- Module: Chainweb.Difficulty</span><span>
</span><span id="line-24"></span><span class="hs-comment">-- Copyright: Copyright &#169; 2018 Kadena LLC</span><span>
</span><span id="line-25"></span><span class="hs-comment">-- License: MIT</span><span>
</span><span id="line-26"></span><span class="hs-comment">-- Maintainer: Lars Kuhtz &lt;lars@kadena.io&gt;</span><span>
</span><span id="line-27"></span><span class="hs-comment">-- Stability: experimental</span><span>
</span><span id="line-28"></span><span class="hs-comment">--</span><span>
</span><span id="line-29"></span><span class="hs-comment">-- TODO</span><span>
</span><span id="line-30"></span><span class="hs-comment">--</span><span>
</span><span id="line-31"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Chainweb.Difficulty</span><span>
</span><span id="line-32"></span><span class="hs-special">(</span><span>
</span><span id="line-33"></span><span class="annot"><span class="hs-comment">-- * PowHashNat</span></span><span>
</span><span id="line-34"></span><span>  </span><span class="annot"><a href="Chainweb.Difficulty.html#PowHashNat"><span class="hs-identifier">PowHashNat</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-35"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Chainweb.Difficulty.html#powHashNat"><span class="hs-identifier">powHashNat</span></a></span><span>
</span><span id="line-36"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Chainweb.Difficulty.html#encodePowHashNat"><span class="hs-identifier">encodePowHashNat</span></a></span><span>
</span><span id="line-37"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Chainweb.Difficulty.html#decodePowHashNat"><span class="hs-identifier">decodePowHashNat</span></a></span><span>
</span><span id="line-38"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Chainweb.Difficulty.html#encodePowHashNatBe"><span class="hs-identifier">encodePowHashNatBe</span></a></span><span>
</span><span id="line-39"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Chainweb.Difficulty.html#decodePowHashNatBe"><span class="hs-identifier">decodePowHashNatBe</span></a></span><span>
</span><span id="line-40"></span><span>
</span><span id="line-41"></span><span class="annot"><span class="hs-comment">-- * HashTarget</span></span><span>
</span><span id="line-42"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Chainweb.Difficulty.html#HashTarget"><span class="hs-identifier">HashTarget</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-43"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Chainweb.Difficulty.html#showTargetHex"><span class="hs-identifier">showTargetHex</span></a></span><span>
</span><span id="line-44"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Chainweb.Difficulty.html#showTargetBits"><span class="hs-identifier">showTargetBits</span></a></span><span>
</span><span id="line-45"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Chainweb.Difficulty.html#checkTarget"><span class="hs-identifier">checkTarget</span></a></span><span>
</span><span id="line-46"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Chainweb.Difficulty.html#maxTarget"><span class="hs-identifier">maxTarget</span></a></span><span>
</span><span id="line-47"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Chainweb.Difficulty.html#maxTargetWord"><span class="hs-identifier">maxTargetWord</span></a></span><span>
</span><span id="line-48"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Chainweb.Difficulty.html#difficultyToTarget"><span class="hs-identifier">difficultyToTarget</span></a></span><span>
</span><span id="line-49"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Chainweb.Difficulty.html#targetToDifficulty"><span class="hs-identifier">targetToDifficulty</span></a></span><span>
</span><span id="line-50"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Chainweb.Difficulty.html#encodeHashTarget"><span class="hs-identifier">encodeHashTarget</span></a></span><span>
</span><span id="line-51"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Chainweb.Difficulty.html#decodeHashTarget"><span class="hs-identifier">decodeHashTarget</span></a></span><span>
</span><span id="line-52"></span><span>
</span><span id="line-53"></span><span class="annot"><span class="hs-comment">-- * HashDifficulty</span></span><span>
</span><span id="line-54"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Chainweb.Difficulty.html#HashDifficulty"><span class="hs-identifier">HashDifficulty</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-55"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Chainweb.Difficulty.html#encodeHashDifficulty"><span class="hs-identifier">encodeHashDifficulty</span></a></span><span>
</span><span id="line-56"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Chainweb.Difficulty.html#decodeHashDifficulty"><span class="hs-identifier">decodeHashDifficulty</span></a></span><span>
</span><span id="line-57"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Chainweb.Difficulty.html#encodeHashDifficultyBe"><span class="hs-identifier">encodeHashDifficultyBe</span></a></span><span>
</span><span id="line-58"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Chainweb.Difficulty.html#decodeHashDifficultyBe"><span class="hs-identifier">decodeHashDifficultyBe</span></a></span><span>
</span><span id="line-59"></span><span>
</span><span id="line-60"></span><span class="annot"><span class="hs-comment">-- * Difficulty Adjustment</span></span><span>
</span><span id="line-61"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Chainweb.Difficulty.html#adjust"><span class="hs-identifier">adjust</span></a></span><span>
</span><span id="line-62"></span><span>
</span><span id="line-63"></span><span class="annot"><span class="hs-comment">-- * Test Properties</span></span><span>
</span><span id="line-64"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Chainweb.Difficulty.html#properties"><span class="hs-identifier">properties</span></a></span><span>
</span><span id="line-65"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Chainweb.Difficulty.html#prop_littleEndian"><span class="hs-identifier">prop_littleEndian</span></a></span><span>
</span><span id="line-66"></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-67"></span><span>
</span><span id="line-68"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.DeepSeq</span></span><span>
</span><span id="line-69"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad</span></span><span>
</span><span id="line-70"></span><span>
</span><span id="line-71"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Aeson</span></span><span>
</span><span id="line-72"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Aeson.Types</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">toJSONKeyText</span></span><span class="hs-special">)</span><span>
</span><span id="line-73"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Bits</span></span><span>
</span><span id="line-74"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Bytes.Get</span></span><span>
</span><span id="line-75"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Bytes.Put</span></span><span>
</span><span id="line-76"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.ByteString</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">B</span></span><span>
</span><span id="line-77"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.ByteString.Short</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">SB</span></span><span>
</span><span id="line-78"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Coerce</span></span><span>
</span><span id="line-79"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.DoubleWord</span></span><span>
</span><span id="line-80"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Hashable</span></span><span>
</span><span id="line-81"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Ratio</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-operator">(%)</span></span><span class="hs-special">)</span><span>
</span><span id="line-82"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Text</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">T</span></span><span>
</span><span id="line-83"></span><span>
</span><span id="line-84"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">GHC.Generics</span></span><span>
</span><span id="line-85"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">GHC.TypeNats</span></span><span>
</span><span id="line-86"></span><span>
</span><span id="line-87"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Numeric.Natural</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Natural</span></span><span class="hs-special">)</span><span>
</span><span id="line-88"></span><span>
</span><span id="line-89"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Test.QuickCheck</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Property</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">property</span></span><span class="hs-special">)</span><span>
</span><span id="line-90"></span><span>
</span><span id="line-91"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Text.Printf</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">printf</span></span><span class="hs-special">)</span><span>
</span><span id="line-92"></span><span>
</span><span id="line-93"></span><span class="hs-comment">-- internal imports</span><span>
</span><span id="line-94"></span><span>
</span><span id="line-95"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Chainweb.Crypto.MerkleLog.html"><span class="hs-identifier">Chainweb.Crypto.MerkleLog</span></a></span><span>
</span><span id="line-96"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Chainweb.MerkleUniverse.html"><span class="hs-identifier">Chainweb.MerkleUniverse</span></a></span><span>
</span><span id="line-97"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Chainweb.PowHash.html"><span class="hs-identifier">Chainweb.PowHash</span></a></span><span>
</span><span id="line-98"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Chainweb.Time.html"><span class="hs-identifier">Chainweb.Time</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Chainweb.Time.html#Micros"><span class="hs-identifier">Micros</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Chainweb.Time.html#Seconds"><span class="hs-identifier">Seconds</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Chainweb.Time.html#TimeSpan"><span class="hs-identifier">TimeSpan</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-99"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Chainweb.Utils.html"><span class="hs-identifier">Chainweb.Utils</span></a></span><span>
</span><span id="line-100"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Chainweb.Version.html"><span class="hs-identifier">Chainweb.Version</span></a></span><span>
</span><span id="line-101"></span><span>
</span><span id="line-102"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Data.Word.Encoding.html"><span class="hs-identifier">Data.Word.Encoding</span></a></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Word.Encoding.html#properties"><span class="hs-identifier">properties</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-103"></span><span>
</span><span id="line-104"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Numeric.Additive.html"><span class="hs-identifier">Numeric.Additive</span></a></span><span>
</span><span id="line-105"></span><span>
</span><span id="line-106"></span><span class="hs-comment">-- DEBUGGING ---</span><span>
</span><span id="line-107"></span><span class="hs-comment">-- import Control.Monad (when)</span><span>
</span><span id="line-108"></span><span class="hs-comment">-- import Chainweb.ChainId (testChainId)</span><span>
</span><span id="line-109"></span><span class="hs-comment">-- import System.IO (hFlush, stdout)</span><span>
</span><span id="line-110"></span><span class="hs-comment">-- import Text.Printf (printf)</span><span>
</span><span id="line-111"></span><span>
</span><span id="line-112"></span><span class="hs-comment">-- -------------------------------------------------------------------------- --</span><span>
</span><span id="line-113"></span><span class="hs-comment">-- Large Word Orphans</span><span>
</span><span id="line-114"></span><span>
</span><span id="line-115"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681480115"><span class="annot"><span class="hs-identifier hs-type">NFData</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word128</span></span></span><span>
</span><span id="line-116"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681480112"><span class="annot"><span class="hs-identifier hs-type">NFData</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word256</span></span></span><span>
</span><span id="line-117"></span><span>
</span><span id="line-118"></span><span class="hs-comment">-- -------------------------------------------------------------------------- --</span><span>
</span><span id="line-119"></span><span class="hs-comment">-- PowHashNat</span><span>
</span><span id="line-120"></span><span>
</span><span id="line-121"></span><span class="hs-comment">-- | A type that maps block hashes to unsigned 256 bit integers by</span><span>
</span><span id="line-122"></span><span class="hs-comment">-- projecting onto the first 8 bytes (least significant in little</span><span>
</span><span id="line-123"></span><span class="hs-comment">-- endian encoding) and interpreting them as little endian encoded</span><span>
</span><span id="line-124"></span><span class="hs-comment">-- unsigned integer value.</span><span>
</span><span id="line-125"></span><span class="hs-comment">--</span><span>
</span><span id="line-126"></span><span class="hs-comment">-- Arithmetic is defined as unsigned bounded integer arithmetic.</span><span>
</span><span id="line-127"></span><span class="hs-comment">-- Overflows result in an exception and may result in program abort.</span><span>
</span><span id="line-128"></span><span class="hs-comment">--</span><span>
</span><span id="line-129"></span><span id="local-6989586621681480110"><span id="local-6989586621681480111"></span></span><span class="hs-keyword">newtype</span><span> </span><span id="PowHashNat"><span class="annot"><a href="Chainweb.Difficulty.html#PowHashNat"><span class="hs-identifier hs-var">PowHashNat</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="PowHashNat"><span class="annot"><a href="Chainweb.Difficulty.html#PowHashNat"><span class="hs-identifier hs-var">PowHashNat</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word256</span></span><span>
</span><span id="line-130"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681480103"><span id="local-6989586621681480105"><span id="local-6989586621681480107"><span class="annot"><span class="annottext">Int -&gt; PowHashNat -&gt; ShowS
[PowHashNat] -&gt; ShowS
PowHashNat -&gt; String
(Int -&gt; PowHashNat -&gt; ShowS)
-&gt; (PowHashNat -&gt; String)
-&gt; ([PowHashNat] -&gt; ShowS)
-&gt; Show PowHashNat
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [PowHashNat] -&gt; ShowS
$cshowList :: [PowHashNat] -&gt; ShowS
show :: PowHashNat -&gt; String
$cshow :: PowHashNat -&gt; String
showsPrec :: Int -&gt; PowHashNat -&gt; ShowS
$cshowsPrec :: Int -&gt; PowHashNat -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(forall x. PowHashNat -&gt; Rep PowHashNat x)
-&gt; (forall x. Rep PowHashNat x -&gt; PowHashNat) -&gt; Generic PowHashNat
forall x. Rep PowHashNat x -&gt; PowHashNat
forall x. PowHashNat -&gt; Rep PowHashNat x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
$cto :: forall x. Rep PowHashNat x -&gt; PowHashNat
$cfrom :: forall x. PowHashNat -&gt; Rep PowHashNat x
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">Generic</span></span><span class="hs-special">)</span><span>
</span><span id="line-131"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">anyclass</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621681480095"><span id="local-6989586621681480097"><span class="annot"><span class="annottext">Int -&gt; PowHashNat -&gt; Int
PowHashNat -&gt; Int
(Int -&gt; PowHashNat -&gt; Int)
-&gt; (PowHashNat -&gt; Int) -&gt; Hashable PowHashNat
forall a. (Int -&gt; a -&gt; Int) -&gt; (a -&gt; Int) -&gt; Hashable a
hash :: PowHashNat -&gt; Int
$chash :: PowHashNat -&gt; Int
hashWithSalt :: Int -&gt; PowHashNat -&gt; Int
$chashWithSalt :: Int -&gt; PowHashNat -&gt; Int
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Hashable</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681480092"><span class="annot"><span class="annottext">PowHashNat -&gt; ()
(PowHashNat -&gt; ()) -&gt; NFData PowHashNat
forall a. (a -&gt; ()) -&gt; NFData a
rnf :: PowHashNat -&gt; ()
$crnf :: PowHashNat -&gt; ()
</span><a href="#local-6989586621681480092"><span class="hs-identifier hs-var hs-var hs-var hs-var">NFData</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-132"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">newtype</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621681480088"><span id="local-6989586621681480090"><span class="annot"><span class="annottext">PowHashNat -&gt; PowHashNat -&gt; Bool
(PowHashNat -&gt; PowHashNat -&gt; Bool)
-&gt; (PowHashNat -&gt; PowHashNat -&gt; Bool) -&gt; Eq PowHashNat
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: PowHashNat -&gt; PowHashNat -&gt; Bool
$c/= :: PowHashNat -&gt; PowHashNat -&gt; Bool
== :: PowHashNat -&gt; PowHashNat -&gt; Bool
$c== :: PowHashNat -&gt; PowHashNat -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681480072"><span id="local-6989586621681480074"><span id="local-6989586621681480076"><span id="local-6989586621681480078"><span id="local-6989586621681480080"><span id="local-6989586621681480082"><span id="local-6989586621681480084"><span class="annot"><span class="annottext">Eq PowHashNat
Eq PowHashNat =&gt;
(PowHashNat -&gt; PowHashNat -&gt; Ordering)
-&gt; (PowHashNat -&gt; PowHashNat -&gt; Bool)
-&gt; (PowHashNat -&gt; PowHashNat -&gt; Bool)
-&gt; (PowHashNat -&gt; PowHashNat -&gt; Bool)
-&gt; (PowHashNat -&gt; PowHashNat -&gt; Bool)
-&gt; (PowHashNat -&gt; PowHashNat -&gt; PowHashNat)
-&gt; (PowHashNat -&gt; PowHashNat -&gt; PowHashNat)
-&gt; Ord PowHashNat
PowHashNat -&gt; PowHashNat -&gt; Bool
PowHashNat -&gt; PowHashNat -&gt; Ordering
PowHashNat -&gt; PowHashNat -&gt; PowHashNat
forall a.
Eq a =&gt;
(a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
min :: PowHashNat -&gt; PowHashNat -&gt; PowHashNat
$cmin :: PowHashNat -&gt; PowHashNat -&gt; PowHashNat
max :: PowHashNat -&gt; PowHashNat -&gt; PowHashNat
$cmax :: PowHashNat -&gt; PowHashNat -&gt; PowHashNat
&gt;= :: PowHashNat -&gt; PowHashNat -&gt; Bool
$c&gt;= :: PowHashNat -&gt; PowHashNat -&gt; Bool
&gt; :: PowHashNat -&gt; PowHashNat -&gt; Bool
$c&gt; :: PowHashNat -&gt; PowHashNat -&gt; Bool
&lt;= :: PowHashNat -&gt; PowHashNat -&gt; Bool
$c&lt;= :: PowHashNat -&gt; PowHashNat -&gt; Bool
&lt; :: PowHashNat -&gt; PowHashNat -&gt; Bool
$c&lt; :: PowHashNat -&gt; PowHashNat -&gt; Bool
compare :: PowHashNat -&gt; PowHashNat -&gt; Ordering
$ccompare :: PowHashNat -&gt; PowHashNat -&gt; Ordering
$cp1Ord :: Eq PowHashNat
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681480067"><span id="local-6989586621681480069"><span class="annot"><span class="annottext">PowHashNat
PowHashNat -&gt; PowHashNat -&gt; Bounded PowHashNat
forall a. a -&gt; a -&gt; Bounded a
maxBound :: PowHashNat
$cmaxBound :: PowHashNat
minBound :: PowHashNat
$cminBound :: PowHashNat
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Bounded</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681480050"><span id="local-6989586621681480052"><span id="local-6989586621681480054"><span id="local-6989586621681480056"><span id="local-6989586621681480058"><span id="local-6989586621681480060"><span id="local-6989586621681480062"><span id="local-6989586621681480064"><span class="annot"><span class="annottext">Int -&gt; PowHashNat
PowHashNat -&gt; Int
PowHashNat -&gt; [PowHashNat]
PowHashNat -&gt; PowHashNat
PowHashNat -&gt; PowHashNat -&gt; [PowHashNat]
PowHashNat -&gt; PowHashNat -&gt; PowHashNat -&gt; [PowHashNat]
(PowHashNat -&gt; PowHashNat)
-&gt; (PowHashNat -&gt; PowHashNat)
-&gt; (Int -&gt; PowHashNat)
-&gt; (PowHashNat -&gt; Int)
-&gt; (PowHashNat -&gt; [PowHashNat])
-&gt; (PowHashNat -&gt; PowHashNat -&gt; [PowHashNat])
-&gt; (PowHashNat -&gt; PowHashNat -&gt; [PowHashNat])
-&gt; (PowHashNat -&gt; PowHashNat -&gt; PowHashNat -&gt; [PowHashNat])
-&gt; Enum PowHashNat
forall a.
(a -&gt; a)
-&gt; (a -&gt; a)
-&gt; (Int -&gt; a)
-&gt; (a -&gt; Int)
-&gt; (a -&gt; [a])
-&gt; (a -&gt; a -&gt; [a])
-&gt; (a -&gt; a -&gt; [a])
-&gt; (a -&gt; a -&gt; a -&gt; [a])
-&gt; Enum a
enumFromThenTo :: PowHashNat -&gt; PowHashNat -&gt; PowHashNat -&gt; [PowHashNat]
$cenumFromThenTo :: PowHashNat -&gt; PowHashNat -&gt; PowHashNat -&gt; [PowHashNat]
enumFromTo :: PowHashNat -&gt; PowHashNat -&gt; [PowHashNat]
$cenumFromTo :: PowHashNat -&gt; PowHashNat -&gt; [PowHashNat]
enumFromThen :: PowHashNat -&gt; PowHashNat -&gt; [PowHashNat]
$cenumFromThen :: PowHashNat -&gt; PowHashNat -&gt; [PowHashNat]
enumFrom :: PowHashNat -&gt; [PowHashNat]
$cenumFrom :: PowHashNat -&gt; [PowHashNat]
fromEnum :: PowHashNat -&gt; Int
$cfromEnum :: PowHashNat -&gt; Int
toEnum :: Int -&gt; PowHashNat
$ctoEnum :: Int -&gt; PowHashNat
pred :: PowHashNat -&gt; PowHashNat
$cpred :: PowHashNat -&gt; PowHashNat
succ :: PowHashNat -&gt; PowHashNat
$csucc :: PowHashNat -&gt; PowHashNat
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Enum</span></span></span></span></span></span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-133"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">newtype</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621681480035"><span id="local-6989586621681480037"><span id="local-6989586621681480039"><span id="local-6989586621681480041"><span id="local-6989586621681480043"><span id="local-6989586621681480045"><span id="local-6989586621681480047"><span class="annot"><span class="annottext">Integer -&gt; PowHashNat
PowHashNat -&gt; PowHashNat
PowHashNat -&gt; PowHashNat -&gt; PowHashNat
(PowHashNat -&gt; PowHashNat -&gt; PowHashNat)
-&gt; (PowHashNat -&gt; PowHashNat -&gt; PowHashNat)
-&gt; (PowHashNat -&gt; PowHashNat -&gt; PowHashNat)
-&gt; (PowHashNat -&gt; PowHashNat)
-&gt; (PowHashNat -&gt; PowHashNat)
-&gt; (PowHashNat -&gt; PowHashNat)
-&gt; (Integer -&gt; PowHashNat)
-&gt; Num PowHashNat
forall a.
(a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a)
-&gt; (a -&gt; a)
-&gt; (a -&gt; a)
-&gt; (Integer -&gt; a)
-&gt; Num a
fromInteger :: Integer -&gt; PowHashNat
$cfromInteger :: Integer -&gt; PowHashNat
signum :: PowHashNat -&gt; PowHashNat
$csignum :: PowHashNat -&gt; PowHashNat
abs :: PowHashNat -&gt; PowHashNat
$cabs :: PowHashNat -&gt; PowHashNat
negate :: PowHashNat -&gt; PowHashNat
$cnegate :: PowHashNat -&gt; PowHashNat
* :: PowHashNat -&gt; PowHashNat -&gt; PowHashNat
$c* :: PowHashNat -&gt; PowHashNat -&gt; PowHashNat
- :: PowHashNat -&gt; PowHashNat -&gt; PowHashNat
$c- :: PowHashNat -&gt; PowHashNat -&gt; PowHashNat
+ :: PowHashNat -&gt; PowHashNat -&gt; PowHashNat
$c+ :: PowHashNat -&gt; PowHashNat -&gt; PowHashNat
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Num</span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681480018"><span id="local-6989586621681480020"><span id="local-6989586621681480022"><span id="local-6989586621681480024"><span id="local-6989586621681480026"><span id="local-6989586621681480028"><span id="local-6989586621681480030"><span class="annot"><span class="annottext">Enum PowHashNat
Real PowHashNat
(Real PowHashNat, Enum PowHashNat) =&gt;
(PowHashNat -&gt; PowHashNat -&gt; PowHashNat)
-&gt; (PowHashNat -&gt; PowHashNat -&gt; PowHashNat)
-&gt; (PowHashNat -&gt; PowHashNat -&gt; PowHashNat)
-&gt; (PowHashNat -&gt; PowHashNat -&gt; PowHashNat)
-&gt; (PowHashNat -&gt; PowHashNat -&gt; (PowHashNat, PowHashNat))
-&gt; (PowHashNat -&gt; PowHashNat -&gt; (PowHashNat, PowHashNat))
-&gt; (PowHashNat -&gt; Integer)
-&gt; Integral PowHashNat
PowHashNat -&gt; Integer
PowHashNat -&gt; PowHashNat -&gt; (PowHashNat, PowHashNat)
PowHashNat -&gt; PowHashNat -&gt; PowHashNat
forall a.
(Real a, Enum a) =&gt;
(a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; (a, a))
-&gt; (a -&gt; a -&gt; (a, a))
-&gt; (a -&gt; Integer)
-&gt; Integral a
toInteger :: PowHashNat -&gt; Integer
$ctoInteger :: PowHashNat -&gt; Integer
divMod :: PowHashNat -&gt; PowHashNat -&gt; (PowHashNat, PowHashNat)
$cdivMod :: PowHashNat -&gt; PowHashNat -&gt; (PowHashNat, PowHashNat)
quotRem :: PowHashNat -&gt; PowHashNat -&gt; (PowHashNat, PowHashNat)
$cquotRem :: PowHashNat -&gt; PowHashNat -&gt; (PowHashNat, PowHashNat)
mod :: PowHashNat -&gt; PowHashNat -&gt; PowHashNat
$cmod :: PowHashNat -&gt; PowHashNat -&gt; PowHashNat
div :: PowHashNat -&gt; PowHashNat -&gt; PowHashNat
$cdiv :: PowHashNat -&gt; PowHashNat -&gt; PowHashNat
rem :: PowHashNat -&gt; PowHashNat -&gt; PowHashNat
$crem :: PowHashNat -&gt; PowHashNat -&gt; PowHashNat
quot :: PowHashNat -&gt; PowHashNat -&gt; PowHashNat
$cquot :: PowHashNat -&gt; PowHashNat -&gt; PowHashNat
$cp2Integral :: Enum PowHashNat
$cp1Integral :: Real PowHashNat
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Integral</span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681480013"><span class="annot"><span class="annottext">Num PowHashNat
Ord PowHashNat
(Num PowHashNat, Ord PowHashNat) =&gt;
(PowHashNat -&gt; Rational) -&gt; Real PowHashNat
PowHashNat -&gt; Rational
forall a. (Num a, Ord a) =&gt; (a -&gt; Rational) -&gt; Real a
toRational :: PowHashNat -&gt; Rational
$ctoRational :: PowHashNat -&gt; Rational
$cp2Real :: Ord PowHashNat
$cp1Real :: Num PowHashNat
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Real</span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681479967"><span id="local-6989586621681479969"><span id="local-6989586621681479971"><span id="local-6989586621681479973"><span id="local-6989586621681479975"><span id="local-6989586621681479977"><span id="local-6989586621681479979"><span id="local-6989586621681479981"><span id="local-6989586621681479983"><span id="local-6989586621681479985"><span id="local-6989586621681479987"><span id="local-6989586621681479989"><span id="local-6989586621681479991"><span id="local-6989586621681479993"><span id="local-6989586621681479995"><span id="local-6989586621681479997"><span id="local-6989586621681479999"><span id="local-6989586621681480001"><span id="local-6989586621681480003"><span id="local-6989586621681480005"><span id="local-6989586621681480007"><span id="local-6989586621681480009"><span class="annot"><span class="annottext">Eq PowHashNat
PowHashNat
Eq PowHashNat =&gt;
(PowHashNat -&gt; PowHashNat -&gt; PowHashNat)
-&gt; (PowHashNat -&gt; PowHashNat -&gt; PowHashNat)
-&gt; (PowHashNat -&gt; PowHashNat -&gt; PowHashNat)
-&gt; (PowHashNat -&gt; PowHashNat)
-&gt; (PowHashNat -&gt; Int -&gt; PowHashNat)
-&gt; (PowHashNat -&gt; Int -&gt; PowHashNat)
-&gt; PowHashNat
-&gt; (Int -&gt; PowHashNat)
-&gt; (PowHashNat -&gt; Int -&gt; PowHashNat)
-&gt; (PowHashNat -&gt; Int -&gt; PowHashNat)
-&gt; (PowHashNat -&gt; Int -&gt; PowHashNat)
-&gt; (PowHashNat -&gt; Int -&gt; Bool)
-&gt; (PowHashNat -&gt; Maybe Int)
-&gt; (PowHashNat -&gt; Int)
-&gt; (PowHashNat -&gt; Bool)
-&gt; (PowHashNat -&gt; Int -&gt; PowHashNat)
-&gt; (PowHashNat -&gt; Int -&gt; PowHashNat)
-&gt; (PowHashNat -&gt; Int -&gt; PowHashNat)
-&gt; (PowHashNat -&gt; Int -&gt; PowHashNat)
-&gt; (PowHashNat -&gt; Int -&gt; PowHashNat)
-&gt; (PowHashNat -&gt; Int -&gt; PowHashNat)
-&gt; (PowHashNat -&gt; Int)
-&gt; Bits PowHashNat
Int -&gt; PowHashNat
PowHashNat -&gt; Bool
PowHashNat -&gt; Int
PowHashNat -&gt; Maybe Int
PowHashNat -&gt; PowHashNat
PowHashNat -&gt; Int -&gt; Bool
PowHashNat -&gt; Int -&gt; PowHashNat
PowHashNat -&gt; PowHashNat -&gt; PowHashNat
forall a.
Eq a =&gt;
(a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a)
-&gt; (a -&gt; Int -&gt; a)
-&gt; (a -&gt; Int -&gt; a)
-&gt; a
-&gt; (Int -&gt; a)
-&gt; (a -&gt; Int -&gt; a)
-&gt; (a -&gt; Int -&gt; a)
-&gt; (a -&gt; Int -&gt; a)
-&gt; (a -&gt; Int -&gt; Bool)
-&gt; (a -&gt; Maybe Int)
-&gt; (a -&gt; Int)
-&gt; (a -&gt; Bool)
-&gt; (a -&gt; Int -&gt; a)
-&gt; (a -&gt; Int -&gt; a)
-&gt; (a -&gt; Int -&gt; a)
-&gt; (a -&gt; Int -&gt; a)
-&gt; (a -&gt; Int -&gt; a)
-&gt; (a -&gt; Int -&gt; a)
-&gt; (a -&gt; Int)
-&gt; Bits a
popCount :: PowHashNat -&gt; Int
$cpopCount :: PowHashNat -&gt; Int
rotateR :: PowHashNat -&gt; Int -&gt; PowHashNat
$crotateR :: PowHashNat -&gt; Int -&gt; PowHashNat
rotateL :: PowHashNat -&gt; Int -&gt; PowHashNat
$crotateL :: PowHashNat -&gt; Int -&gt; PowHashNat
unsafeShiftR :: PowHashNat -&gt; Int -&gt; PowHashNat
$cunsafeShiftR :: PowHashNat -&gt; Int -&gt; PowHashNat
shiftR :: PowHashNat -&gt; Int -&gt; PowHashNat
$cshiftR :: PowHashNat -&gt; Int -&gt; PowHashNat
unsafeShiftL :: PowHashNat -&gt; Int -&gt; PowHashNat
$cunsafeShiftL :: PowHashNat -&gt; Int -&gt; PowHashNat
shiftL :: PowHashNat -&gt; Int -&gt; PowHashNat
$cshiftL :: PowHashNat -&gt; Int -&gt; PowHashNat
isSigned :: PowHashNat -&gt; Bool
$cisSigned :: PowHashNat -&gt; Bool
bitSize :: PowHashNat -&gt; Int
$cbitSize :: PowHashNat -&gt; Int
bitSizeMaybe :: PowHashNat -&gt; Maybe Int
$cbitSizeMaybe :: PowHashNat -&gt; Maybe Int
testBit :: PowHashNat -&gt; Int -&gt; Bool
$ctestBit :: PowHashNat -&gt; Int -&gt; Bool
complementBit :: PowHashNat -&gt; Int -&gt; PowHashNat
$ccomplementBit :: PowHashNat -&gt; Int -&gt; PowHashNat
clearBit :: PowHashNat -&gt; Int -&gt; PowHashNat
$cclearBit :: PowHashNat -&gt; Int -&gt; PowHashNat
setBit :: PowHashNat -&gt; Int -&gt; PowHashNat
$csetBit :: PowHashNat -&gt; Int -&gt; PowHashNat
bit :: Int -&gt; PowHashNat
$cbit :: Int -&gt; PowHashNat
zeroBits :: PowHashNat
$czeroBits :: PowHashNat
rotate :: PowHashNat -&gt; Int -&gt; PowHashNat
$crotate :: PowHashNat -&gt; Int -&gt; PowHashNat
shift :: PowHashNat -&gt; Int -&gt; PowHashNat
$cshift :: PowHashNat -&gt; Int -&gt; PowHashNat
complement :: PowHashNat -&gt; PowHashNat
$ccomplement :: PowHashNat -&gt; PowHashNat
xor :: PowHashNat -&gt; PowHashNat -&gt; PowHashNat
$cxor :: PowHashNat -&gt; PowHashNat -&gt; PowHashNat
.|. :: PowHashNat -&gt; PowHashNat -&gt; PowHashNat
$c.|. :: PowHashNat -&gt; PowHashNat -&gt; PowHashNat
.&amp;. :: PowHashNat -&gt; PowHashNat -&gt; PowHashNat
$c.&amp;. :: PowHashNat -&gt; PowHashNat -&gt; PowHashNat
$cp1Bits :: Eq PowHashNat
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Bits</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681479959"><span id="local-6989586621681479961"><span id="local-6989586621681479963"><span class="annot"><span class="annottext">Bits PowHashNat
Bits PowHashNat =&gt;
(PowHashNat -&gt; Int)
-&gt; (PowHashNat -&gt; Int)
-&gt; (PowHashNat -&gt; Int)
-&gt; FiniteBits PowHashNat
PowHashNat -&gt; Int
forall b.
Bits b =&gt;
(b -&gt; Int) -&gt; (b -&gt; Int) -&gt; (b -&gt; Int) -&gt; FiniteBits b
countTrailingZeros :: PowHashNat -&gt; Int
$ccountTrailingZeros :: PowHashNat -&gt; Int
countLeadingZeros :: PowHashNat -&gt; Int
$ccountLeadingZeros :: PowHashNat -&gt; Int
finiteBitSize :: PowHashNat -&gt; Int
$cfiniteBitSize :: PowHashNat -&gt; Int
$cp1FiniteBits :: Bits PowHashNat
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">FiniteBits</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-134"></span><span>        </span><span class="hs-comment">-- FIXME implement checked arithmetic</span><span>
</span><span id="line-135"></span><span>        </span><span class="hs-comment">-- FIXME avoid usage of Num and co</span><span>
</span><span id="line-136"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">newtype</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621681479956"><span class="annot"><span class="annottext">PowHashNat -&gt; PowHashNat -&gt; PowHashNat
(PowHashNat -&gt; PowHashNat -&gt; PowHashNat)
-&gt; AdditiveSemigroup PowHashNat
forall g. (g -&gt; g -&gt; g) -&gt; AdditiveSemigroup g
plus :: PowHashNat -&gt; PowHashNat -&gt; PowHashNat
$cplus :: PowHashNat -&gt; PowHashNat -&gt; PowHashNat
</span><a href="Numeric.Additive.html#C%3AAdditiveSemigroup"><span class="hs-identifier hs-var hs-var hs-var hs-var">AdditiveSemigroup</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">AdditiveSemigroup PowHashNat
AdditiveSemigroup PowHashNat =&gt; AdditiveAbelianSemigroup PowHashNat
forall g. AdditiveSemigroup g =&gt; AdditiveAbelianSemigroup g
</span><a href="Numeric.Additive.html#C%3AAdditiveAbelianSemigroup"><span class="hs-identifier hs-var hs-var hs-var">AdditiveAbelianSemigroup</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-137"></span><span>    </span><span class="hs-comment">-- deriving newtype (MultiplicativeSemigroup, MultiplicativeAbelianSemigroup, MultiplicativeGroup)</span><span>
</span><span id="line-138"></span><span>        </span><span class="hs-comment">-- FIXME use checked arithmetic instead</span><span>
</span><span id="line-139"></span><span>
</span><span id="line-140"></span><span class="annot"><a href="Chainweb.Difficulty.html#powHashNat"><span class="hs-identifier hs-type">powHashNat</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Chainweb.PowHash.html#PowHash"><span class="hs-identifier hs-type">PowHash</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Chainweb.Difficulty.html#PowHashNat"><span class="hs-identifier hs-type">PowHashNat</span></a></span><span>
</span><span id="line-141"></span><span id="powHashNat"><span class="annot"><span class="annottext">powHashNat :: PowHash -&gt; PowHashNat
</span><a href="Chainweb.Difficulty.html#powHashNat"><span class="hs-identifier hs-var hs-var">powHashNat</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word256 -&gt; PowHashNat
</span><a href="Chainweb.Difficulty.html#PowHashNat"><span class="hs-identifier hs-var">PowHashNat</span></a></span><span> </span><span class="annot"><span class="annottext">(Word256 -&gt; PowHashNat)
-&gt; (PowHash -&gt; Word256) -&gt; PowHash -&gt; PowHashNat
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(32 &lt;= 32) =&gt; PowHash -&gt; Word256
PowHash -&gt; Word256
</span><a href="Chainweb.Difficulty.html#powHashToWord256"><span class="hs-identifier hs-var">powHashToWord256</span></a></span><span>
</span><span id="line-142"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Chainweb.Difficulty.html#powHashNat"><span class="hs-pragma hs-type">powHashNat</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-143"></span><span>
</span><span id="line-144"></span><span class="annot"><a href="Chainweb.Difficulty.html#powHashToWord256"><span class="hs-identifier hs-type">powHashToWord256</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-number">32</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;=</span></span><span> </span><span class="annot"><a href="Chainweb.PowHash.html#PowHashBytesCount"><span class="hs-identifier hs-type">PowHashBytesCount</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Chainweb.PowHash.html#PowHash"><span class="hs-identifier hs-type">PowHash</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word256</span></span><span>
</span><span id="line-145"></span><span id="powHashToWord256"><span class="annot"><span class="annottext">powHashToWord256 :: PowHash -&gt; Word256
</span><a href="Chainweb.Difficulty.html#powHashToWord256"><span class="hs-identifier hs-var hs-var">powHashToWord256</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(String -&gt; Word256)
-&gt; (Word256 -&gt; Word256) -&gt; Either String Word256 -&gt; Word256
forall a c b. (a -&gt; c) -&gt; (b -&gt; c) -&gt; Either a b -&gt; c
</span><span class="hs-identifier hs-var">either</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Word256
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">Word256 -&gt; Word256
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span> </span><span class="annot"><span class="annottext">(Either String Word256 -&gt; Word256)
-&gt; (PowHash -&gt; Either String Word256) -&gt; PowHash -&gt; Word256
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Get Word256 -&gt; ByteString -&gt; Either String Word256
forall a. Get a -&gt; ByteString -&gt; Either String a
</span><span class="hs-identifier hs-var">runGetS</span></span><span> </span><span class="annot"><span class="annottext">Get Word256
forall w (m :: * -&gt; *). (WordEncoding w, MonadGet m) =&gt; m w
</span><a href="Data.Word.Encoding.html#decodeWordLe"><span class="hs-identifier hs-var">decodeWordLe</span></a></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; Either String Word256)
-&gt; (PowHash -&gt; ByteString) -&gt; PowHash -&gt; Either String Word256
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ShortByteString -&gt; ByteString
</span><span class="hs-identifier hs-var">SB.fromShort</span></span><span> </span><span class="annot"><span class="annottext">(ShortByteString -&gt; ByteString)
-&gt; (PowHash -&gt; ShortByteString) -&gt; PowHash -&gt; ByteString
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">PowHash -&gt; ShortByteString
</span><a href="Chainweb.PowHash.html#powHashBytes"><span class="hs-identifier hs-var">powHashBytes</span></a></span><span>
</span><span id="line-146"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Chainweb.Difficulty.html#powHashToWord256"><span class="hs-pragma hs-type">powHashToWord256</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-147"></span><span>
</span><span id="line-148"></span><span id="local-6989586621681480227"><span class="annot"><a href="Chainweb.Difficulty.html#encodePowHashNat"><span class="hs-identifier hs-type">encodePowHashNat</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadPut</span></span><span> </span><span class="annot"><a href="#local-6989586621681480227"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Chainweb.Difficulty.html#PowHashNat"><span class="hs-identifier hs-type">PowHashNat</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681480227"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-149"></span><span id="encodePowHashNat"><span class="annot"><span class="annottext">encodePowHashNat :: PowHashNat -&gt; m ()
</span><a href="Chainweb.Difficulty.html#encodePowHashNat"><span class="hs-identifier hs-var hs-var">encodePowHashNat</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Chainweb.Difficulty.html#PowHashNat"><span class="hs-identifier hs-type">PowHashNat</span></a></span><span> </span><span id="local-6989586621681479942"><span class="annot"><span class="annottext">n :: Word256
</span><a href="#local-6989586621681479942"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word256 -&gt; m ()
forall w (m :: * -&gt; *). (WordEncoding w, MonadPut m) =&gt; w -&gt; m ()
</span><a href="Data.Word.Encoding.html#encodeWordLe"><span class="hs-identifier hs-var">encodeWordLe</span></a></span><span> </span><span class="annot"><span class="annottext">Word256
</span><a href="#local-6989586621681479942"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-150"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Chainweb.Difficulty.html#encodePowHashNat"><span class="hs-pragma hs-type">encodePowHashNat</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-151"></span><span>
</span><span id="line-152"></span><span id="local-6989586621681480211"><span class="annot"><a href="Chainweb.Difficulty.html#decodePowHashNat"><span class="hs-identifier hs-type">decodePowHashNat</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadGet</span></span><span> </span><span class="annot"><a href="#local-6989586621681480211"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681480211"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Chainweb.Difficulty.html#PowHashNat"><span class="hs-identifier hs-type">PowHashNat</span></a></span></span><span>
</span><span id="line-153"></span><span id="decodePowHashNat"><span class="annot"><span class="annottext">decodePowHashNat :: m PowHashNat
</span><a href="Chainweb.Difficulty.html#decodePowHashNat"><span class="hs-identifier hs-var hs-var">decodePowHashNat</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word256 -&gt; PowHashNat
</span><a href="Chainweb.Difficulty.html#PowHashNat"><span class="hs-identifier hs-var">PowHashNat</span></a></span><span> </span><span class="annot"><span class="annottext">(Word256 -&gt; PowHashNat) -&gt; m Word256 -&gt; m PowHashNat
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; b) -&gt; m a -&gt; m b
</span><span class="hs-operator hs-var">&lt;$!&gt;</span></span><span> </span><span class="annot"><span class="annottext">m Word256
forall w (m :: * -&gt; *). (WordEncoding w, MonadGet m) =&gt; m w
</span><a href="Data.Word.Encoding.html#decodeWordLe"><span class="hs-identifier hs-var">decodeWordLe</span></a></span><span>
</span><span id="line-154"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Chainweb.Difficulty.html#decodePowHashNat"><span class="hs-pragma hs-type">decodePowHashNat</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-155"></span><span>
</span><span id="line-156"></span><span id="local-6989586621681479939"><span class="annot"><a href="Chainweb.Difficulty.html#encodePowHashNatBe"><span class="hs-identifier hs-type">encodePowHashNatBe</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadPut</span></span><span> </span><span class="annot"><a href="#local-6989586621681479939"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Chainweb.Difficulty.html#PowHashNat"><span class="hs-identifier hs-type">PowHashNat</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681479939"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-157"></span><span id="encodePowHashNatBe"><span class="annot"><span class="annottext">encodePowHashNatBe :: PowHashNat -&gt; m ()
</span><a href="Chainweb.Difficulty.html#encodePowHashNatBe"><span class="hs-identifier hs-var hs-var">encodePowHashNatBe</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Chainweb.Difficulty.html#PowHashNat"><span class="hs-identifier hs-type">PowHashNat</span></a></span><span> </span><span id="local-6989586621681479938"><span class="annot"><span class="annottext">n :: Word256
</span><a href="#local-6989586621681479938"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word256 -&gt; m ()
forall w (m :: * -&gt; *). (WordEncoding w, MonadPut m) =&gt; w -&gt; m ()
</span><a href="Data.Word.Encoding.html#encodeWordBe"><span class="hs-identifier hs-var">encodeWordBe</span></a></span><span> </span><span class="annot"><span class="annottext">Word256
</span><a href="#local-6989586621681479938"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-158"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Chainweb.Difficulty.html#encodePowHashNatBe"><span class="hs-pragma hs-type">encodePowHashNatBe</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-159"></span><span>
</span><span id="line-160"></span><span id="local-6989586621681479936"><span class="annot"><a href="Chainweb.Difficulty.html#decodePowHashNatBe"><span class="hs-identifier hs-type">decodePowHashNatBe</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadGet</span></span><span> </span><span class="annot"><a href="#local-6989586621681479936"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681479936"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Chainweb.Difficulty.html#PowHashNat"><span class="hs-identifier hs-type">PowHashNat</span></a></span></span><span>
</span><span id="line-161"></span><span id="decodePowHashNatBe"><span class="annot"><span class="annottext">decodePowHashNatBe :: m PowHashNat
</span><a href="Chainweb.Difficulty.html#decodePowHashNatBe"><span class="hs-identifier hs-var hs-var">decodePowHashNatBe</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word256 -&gt; PowHashNat
</span><a href="Chainweb.Difficulty.html#PowHashNat"><span class="hs-identifier hs-var">PowHashNat</span></a></span><span> </span><span class="annot"><span class="annottext">(Word256 -&gt; PowHashNat) -&gt; m Word256 -&gt; m PowHashNat
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; b) -&gt; m a -&gt; m b
</span><span class="hs-operator hs-var">&lt;$!&gt;</span></span><span> </span><span class="annot"><span class="annottext">m Word256
forall w (m :: * -&gt; *). (WordEncoding w, MonadGet m) =&gt; m w
</span><a href="Data.Word.Encoding.html#decodeWordBe"><span class="hs-identifier hs-var">decodeWordBe</span></a></span><span>
</span><span id="line-162"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Chainweb.Difficulty.html#decodePowHashNatBe"><span class="hs-pragma hs-type">decodePowHashNatBe</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-163"></span><span>
</span><span id="line-164"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681479928"><span id="local-6989586621681479930"><span id="local-6989586621681479932"><span class="annot"><span class="hs-identifier hs-type">ToJSON</span></span><span> </span><span class="annot"><a href="Chainweb.Difficulty.html#PowHashNat"><span class="hs-identifier hs-type">PowHashNat</span></a></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-165"></span><span>    </span><span id="local-6989586621681479926"><span class="annot"><span class="annottext">toJSON :: PowHashNat -&gt; Value
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">toJSON</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Value
forall a. ToJSON a =&gt; a -&gt; Value
</span><span class="hs-identifier hs-var">toJSON</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Value) -&gt; (PowHashNat -&gt; Text) -&gt; PowHashNat -&gt; Value
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Text
</span><a href="Chainweb.Utils.html#encodeB64UrlNoPaddingText"><span class="hs-identifier hs-var">encodeB64UrlNoPaddingText</span></a></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; Text)
-&gt; (PowHashNat -&gt; ByteString) -&gt; PowHashNat -&gt; Text
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Put -&gt; ByteString
</span><span class="hs-identifier hs-var">runPutS</span></span><span> </span><span class="annot"><span class="annottext">(Put -&gt; ByteString)
-&gt; (PowHashNat -&gt; Put) -&gt; PowHashNat -&gt; ByteString
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">PowHashNat -&gt; Put
forall (m :: * -&gt; *). MonadPut m =&gt; PowHashNat -&gt; m ()
</span><a href="Chainweb.Difficulty.html#encodePowHashNat"><span class="hs-identifier hs-var">encodePowHashNat</span></a></span><span>
</span><span id="line-166"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><span class="hs-pragma hs-type">toJSON</span></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-167"></span><span>
</span><span id="line-168"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681479920"><span class="annot"><span class="hs-identifier hs-type">FromJSON</span></span><span> </span><span class="annot"><a href="Chainweb.Difficulty.html#PowHashNat"><span class="hs-identifier hs-type">PowHashNat</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-169"></span><span>    </span><span id="local-6989586621681479918"><span class="annot"><span class="annottext">parseJSON :: Value -&gt; Parser PowHashNat
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">parseJSON</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; (Text -&gt; Parser PowHashNat) -&gt; Value -&gt; Parser PowHashNat
forall a. String -&gt; (Text -&gt; Parser a) -&gt; Value -&gt; Parser a
</span><span class="hs-identifier hs-var">withText</span></span><span> </span><span class="annot"><span class="hs-string">&quot;PowHashNat&quot;</span></span><span> </span><span class="annot"><span class="annottext">((Text -&gt; Parser PowHashNat) -&gt; Value -&gt; Parser PowHashNat)
-&gt; (Text -&gt; Parser PowHashNat) -&gt; Value -&gt; Parser PowHashNat
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(SomeException -&gt; Parser PowHashNat)
-&gt; (PowHashNat -&gt; Parser PowHashNat)
-&gt; Either SomeException PowHashNat
-&gt; Parser PowHashNat
forall a c b. (a -&gt; c) -&gt; (b -&gt; c) -&gt; Either a b -&gt; c
</span><span class="hs-identifier hs-var">either</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Parser PowHashNat
forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><span class="hs-identifier hs-var">fail</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Parser PowHashNat)
-&gt; (SomeException -&gt; String) -&gt; SomeException -&gt; Parser PowHashNat
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">SomeException -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">PowHashNat -&gt; Parser PowHashNat
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span>
</span><span id="line-170"></span><span>        </span><span class="annot"><span class="annottext">(Either SomeException PowHashNat -&gt; Parser PowHashNat)
-&gt; (Text -&gt; Either SomeException PowHashNat)
-&gt; Text
-&gt; Parser PowHashNat
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Get PowHashNat -&gt; ByteString -&gt; Either SomeException PowHashNat
forall (m :: * -&gt; *) a. MonadThrow m =&gt; Get a -&gt; ByteString -&gt; m a
</span><a href="Chainweb.Utils.html#runGet"><span class="hs-identifier hs-var">runGet</span></a></span><span> </span><span class="annot"><span class="annottext">Get PowHashNat
forall (m :: * -&gt; *). MonadGet m =&gt; m PowHashNat
</span><a href="Chainweb.Difficulty.html#decodePowHashNat"><span class="hs-identifier hs-var">decodePowHashNat</span></a></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; Either SomeException PowHashNat)
-&gt; (Text -&gt; Either SomeException ByteString)
-&gt; Text
-&gt; Either SomeException PowHashNat
forall (m :: * -&gt; *) b c a.
Monad m =&gt;
(b -&gt; m c) -&gt; (a -&gt; m b) -&gt; a -&gt; m c
</span><span class="hs-operator hs-var">&lt;=&lt;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Either SomeException ByteString
forall (m :: * -&gt; *). MonadThrow m =&gt; Text -&gt; m ByteString
</span><a href="Chainweb.Utils.html#decodeB64UrlNoPaddingText"><span class="hs-identifier hs-var">decodeB64UrlNoPaddingText</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-171"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><span class="hs-pragma hs-type">parseJSON</span></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-172"></span><span>
</span><span id="line-173"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681479909"><span class="annot"><span class="hs-identifier hs-type">ToJSONKey</span></span><span> </span><span class="annot"><a href="Chainweb.Difficulty.html#PowHashNat"><span class="hs-identifier hs-type">PowHashNat</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-174"></span><span>    </span><span id="local-6989586621681479907"><span class="annot"><span class="annottext">toJSONKey :: ToJSONKeyFunction PowHashNat
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">toJSONKey</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(PowHashNat -&gt; Text) -&gt; ToJSONKeyFunction PowHashNat
forall a. (a -&gt; Text) -&gt; ToJSONKeyFunction a
</span><span class="hs-identifier hs-var">toJSONKeyText</span></span><span>
</span><span id="line-175"></span><span>        </span><span class="annot"><span class="annottext">((PowHashNat -&gt; Text) -&gt; ToJSONKeyFunction PowHashNat)
-&gt; (PowHashNat -&gt; Text) -&gt; ToJSONKeyFunction PowHashNat
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Text
</span><a href="Chainweb.Utils.html#encodeB64UrlNoPaddingText"><span class="hs-identifier hs-var">encodeB64UrlNoPaddingText</span></a></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; Text)
-&gt; (PowHashNat -&gt; ByteString) -&gt; PowHashNat -&gt; Text
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Put -&gt; ByteString
</span><span class="hs-identifier hs-var">runPutS</span></span><span> </span><span class="annot"><span class="annottext">(Put -&gt; ByteString)
-&gt; (PowHashNat -&gt; Put) -&gt; PowHashNat -&gt; ByteString
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">PowHashNat -&gt; Put
forall (m :: * -&gt; *). MonadPut m =&gt; PowHashNat -&gt; m ()
</span><a href="Chainweb.Difficulty.html#encodePowHashNat"><span class="hs-identifier hs-var">encodePowHashNat</span></a></span><span>
</span><span id="line-176"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><span class="hs-pragma hs-type">toJSONKey</span></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-177"></span><span>
</span><span id="line-178"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681479903"><span class="annot"><span class="hs-identifier hs-type">FromJSONKey</span></span><span> </span><span class="annot"><a href="Chainweb.Difficulty.html#PowHashNat"><span class="hs-identifier hs-type">PowHashNat</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-179"></span><span>    </span><span id="local-6989586621681479901"><span class="annot"><span class="annottext">fromJSONKey :: FromJSONKeyFunction PowHashNat
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">fromJSONKey</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Parser PowHashNat) -&gt; FromJSONKeyFunction PowHashNat
forall a. (Text -&gt; Parser a) -&gt; FromJSONKeyFunction a
</span><span class="hs-identifier hs-var">FromJSONKeyTextParser</span></span><span> </span><span class="annot"><span class="annottext">((Text -&gt; Parser PowHashNat) -&gt; FromJSONKeyFunction PowHashNat)
-&gt; (Text -&gt; Parser PowHashNat) -&gt; FromJSONKeyFunction PowHashNat
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(SomeException -&gt; Parser PowHashNat)
-&gt; (PowHashNat -&gt; Parser PowHashNat)
-&gt; Either SomeException PowHashNat
-&gt; Parser PowHashNat
forall a c b. (a -&gt; c) -&gt; (b -&gt; c) -&gt; Either a b -&gt; c
</span><span class="hs-identifier hs-var">either</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Parser PowHashNat
forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><span class="hs-identifier hs-var">fail</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Parser PowHashNat)
-&gt; (SomeException -&gt; String) -&gt; SomeException -&gt; Parser PowHashNat
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">SomeException -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">PowHashNat -&gt; Parser PowHashNat
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span>
</span><span id="line-180"></span><span>        </span><span class="annot"><span class="annottext">(Either SomeException PowHashNat -&gt; Parser PowHashNat)
-&gt; (Text -&gt; Either SomeException PowHashNat)
-&gt; Text
-&gt; Parser PowHashNat
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Get PowHashNat -&gt; ByteString -&gt; Either SomeException PowHashNat
forall (m :: * -&gt; *) a. MonadThrow m =&gt; Get a -&gt; ByteString -&gt; m a
</span><a href="Chainweb.Utils.html#runGet"><span class="hs-identifier hs-var">runGet</span></a></span><span> </span><span class="annot"><span class="annottext">Get PowHashNat
forall (m :: * -&gt; *). MonadGet m =&gt; m PowHashNat
</span><a href="Chainweb.Difficulty.html#decodePowHashNat"><span class="hs-identifier hs-var">decodePowHashNat</span></a></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; Either SomeException PowHashNat)
-&gt; (Text -&gt; Either SomeException ByteString)
-&gt; Text
-&gt; Either SomeException PowHashNat
forall (m :: * -&gt; *) b c a.
Monad m =&gt;
(b -&gt; m c) -&gt; (a -&gt; m b) -&gt; a -&gt; m c
</span><span class="hs-operator hs-var">&lt;=&lt;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Either SomeException ByteString
forall (m :: * -&gt; *). MonadThrow m =&gt; Text -&gt; m ByteString
</span><a href="Chainweb.Utils.html#decodeB64UrlNoPaddingText"><span class="hs-identifier hs-var">decodeB64UrlNoPaddingText</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-181"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><span class="hs-pragma hs-type">fromJSONKey</span></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-182"></span><span>
</span><span id="line-183"></span><span class="hs-comment">-- -------------------------------------------------------------------------- --</span><span>
</span><span id="line-184"></span><span class="hs-comment">-- HashDifficulty</span><span>
</span><span id="line-185"></span><span>
</span><span id="line-186"></span><span class="hs-comment">-- | Hash Difficulty</span><span>
</span><span id="line-187"></span><span class="hs-comment">--</span><span>
</span><span id="line-188"></span><span class="hs-comment">-- difficulty = maxBound / target</span><span>
</span><span id="line-189"></span><span class="hs-comment">--            = network hash rate * block time</span><span>
</span><span id="line-190"></span><span class="hs-comment">--</span><span>
</span><span id="line-191"></span><span id="local-6989586621681479897"><span id="local-6989586621681479898"></span></span><span class="hs-keyword">newtype</span><span> </span><span id="HashDifficulty"><span class="annot"><a href="Chainweb.Difficulty.html#HashDifficulty"><span class="hs-identifier hs-var">HashDifficulty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="HashDifficulty"><span class="annot"><a href="Chainweb.Difficulty.html#HashDifficulty"><span class="hs-identifier hs-var">HashDifficulty</span></a></span></span><span> </span><span class="annot"><a href="Chainweb.Difficulty.html#PowHashNat"><span class="hs-identifier hs-type">PowHashNat</span></a></span><span>
</span><span id="line-192"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681479890"><span id="local-6989586621681479892"><span id="local-6989586621681479894"><span class="annot"><span class="annottext">Int -&gt; HashDifficulty -&gt; ShowS
[HashDifficulty] -&gt; ShowS
HashDifficulty -&gt; String
(Int -&gt; HashDifficulty -&gt; ShowS)
-&gt; (HashDifficulty -&gt; String)
-&gt; ([HashDifficulty] -&gt; ShowS)
-&gt; Show HashDifficulty
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [HashDifficulty] -&gt; ShowS
$cshowList :: [HashDifficulty] -&gt; ShowS
show :: HashDifficulty -&gt; String
$cshow :: HashDifficulty -&gt; String
showsPrec :: Int -&gt; HashDifficulty -&gt; ShowS
$cshowsPrec :: Int -&gt; HashDifficulty -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681479886"><span id="local-6989586621681479888"><span class="annot"><span class="annottext">HashDifficulty -&gt; HashDifficulty -&gt; Bool
(HashDifficulty -&gt; HashDifficulty -&gt; Bool)
-&gt; (HashDifficulty -&gt; HashDifficulty -&gt; Bool) -&gt; Eq HashDifficulty
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: HashDifficulty -&gt; HashDifficulty -&gt; Bool
$c/= :: HashDifficulty -&gt; HashDifficulty -&gt; Bool
== :: HashDifficulty -&gt; HashDifficulty -&gt; Bool
$c== :: HashDifficulty -&gt; HashDifficulty -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681479871"><span id="local-6989586621681479873"><span id="local-6989586621681479875"><span id="local-6989586621681479877"><span id="local-6989586621681479879"><span id="local-6989586621681479881"><span id="local-6989586621681479883"><span class="annot"><span class="annottext">Eq HashDifficulty
Eq HashDifficulty =&gt;
(HashDifficulty -&gt; HashDifficulty -&gt; Ordering)
-&gt; (HashDifficulty -&gt; HashDifficulty -&gt; Bool)
-&gt; (HashDifficulty -&gt; HashDifficulty -&gt; Bool)
-&gt; (HashDifficulty -&gt; HashDifficulty -&gt; Bool)
-&gt; (HashDifficulty -&gt; HashDifficulty -&gt; Bool)
-&gt; (HashDifficulty -&gt; HashDifficulty -&gt; HashDifficulty)
-&gt; (HashDifficulty -&gt; HashDifficulty -&gt; HashDifficulty)
-&gt; Ord HashDifficulty
HashDifficulty -&gt; HashDifficulty -&gt; Bool
HashDifficulty -&gt; HashDifficulty -&gt; Ordering
HashDifficulty -&gt; HashDifficulty -&gt; HashDifficulty
forall a.
Eq a =&gt;
(a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
min :: HashDifficulty -&gt; HashDifficulty -&gt; HashDifficulty
$cmin :: HashDifficulty -&gt; HashDifficulty -&gt; HashDifficulty
max :: HashDifficulty -&gt; HashDifficulty -&gt; HashDifficulty
$cmax :: HashDifficulty -&gt; HashDifficulty -&gt; HashDifficulty
&gt;= :: HashDifficulty -&gt; HashDifficulty -&gt; Bool
$c&gt;= :: HashDifficulty -&gt; HashDifficulty -&gt; Bool
&gt; :: HashDifficulty -&gt; HashDifficulty -&gt; Bool
$c&gt; :: HashDifficulty -&gt; HashDifficulty -&gt; Bool
&lt;= :: HashDifficulty -&gt; HashDifficulty -&gt; Bool
$c&lt;= :: HashDifficulty -&gt; HashDifficulty -&gt; Bool
&lt; :: HashDifficulty -&gt; HashDifficulty -&gt; Bool
$c&lt; :: HashDifficulty -&gt; HashDifficulty -&gt; Bool
compare :: HashDifficulty -&gt; HashDifficulty -&gt; Ordering
$ccompare :: HashDifficulty -&gt; HashDifficulty -&gt; Ordering
$cp1Ord :: Eq HashDifficulty
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(forall x. HashDifficulty -&gt; Rep HashDifficulty x)
-&gt; (forall x. Rep HashDifficulty x -&gt; HashDifficulty)
-&gt; Generic HashDifficulty
forall x. Rep HashDifficulty x -&gt; HashDifficulty
forall x. HashDifficulty -&gt; Rep HashDifficulty x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
$cto :: forall x. Rep HashDifficulty x -&gt; HashDifficulty
$cfrom :: forall x. HashDifficulty -&gt; Rep HashDifficulty x
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">Generic</span></span><span class="hs-special">)</span><span>
</span><span id="line-193"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">anyclass</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621681479867"><span class="annot"><span class="annottext">HashDifficulty -&gt; ()
(HashDifficulty -&gt; ()) -&gt; NFData HashDifficulty
forall a. (a -&gt; ()) -&gt; NFData a
rnf :: HashDifficulty -&gt; ()
$crnf :: HashDifficulty -&gt; ()
</span><a href="#local-6989586621681479867"><span class="hs-identifier hs-var hs-var hs-var hs-var">NFData</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-194"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">newtype</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621681479859"><span id="local-6989586621681479861"><span id="local-6989586621681479863"><span id="local-6989586621681479865"><span class="annot"><span class="annottext">[HashDifficulty] -&gt; Encoding
[HashDifficulty] -&gt; Value
HashDifficulty -&gt; Encoding
HashDifficulty -&gt; Value
(HashDifficulty -&gt; Value)
-&gt; (HashDifficulty -&gt; Encoding)
-&gt; ([HashDifficulty] -&gt; Value)
-&gt; ([HashDifficulty] -&gt; Encoding)
-&gt; ToJSON HashDifficulty
forall a.
(a -&gt; Value)
-&gt; (a -&gt; Encoding)
-&gt; ([a] -&gt; Value)
-&gt; ([a] -&gt; Encoding)
-&gt; ToJSON a
toEncodingList :: [HashDifficulty] -&gt; Encoding
$ctoEncodingList :: [HashDifficulty] -&gt; Encoding
toJSONList :: [HashDifficulty] -&gt; Value
$ctoJSONList :: [HashDifficulty] -&gt; Value
toEncoding :: HashDifficulty -&gt; Encoding
$ctoEncoding :: HashDifficulty -&gt; Encoding
toJSON :: HashDifficulty -&gt; Value
$ctoJSON :: HashDifficulty -&gt; Value
</span><a href="#local-6989586621681479859"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">ToJSON</span></a></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681479855"><span id="local-6989586621681479857"><span class="annot"><span class="annottext">Value -&gt; Parser [HashDifficulty]
Value -&gt; Parser HashDifficulty
(Value -&gt; Parser HashDifficulty)
-&gt; (Value -&gt; Parser [HashDifficulty]) -&gt; FromJSON HashDifficulty
forall a.
(Value -&gt; Parser a) -&gt; (Value -&gt; Parser [a]) -&gt; FromJSON a
parseJSONList :: Value -&gt; Parser [HashDifficulty]
$cparseJSONList :: Value -&gt; Parser [HashDifficulty]
parseJSON :: Value -&gt; Parser HashDifficulty
$cparseJSON :: Value -&gt; Parser HashDifficulty
</span><a href="#local-6989586621681479855"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">FromJSON</span></a></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681479851"><span id="local-6989586621681479853"><span class="annot"><span class="annottext">ToJSONKeyFunction [HashDifficulty]
ToJSONKeyFunction HashDifficulty
ToJSONKeyFunction HashDifficulty
-&gt; ToJSONKeyFunction [HashDifficulty] -&gt; ToJSONKey HashDifficulty
forall a.
ToJSONKeyFunction a -&gt; ToJSONKeyFunction [a] -&gt; ToJSONKey a
toJSONKeyList :: ToJSONKeyFunction [HashDifficulty]
$ctoJSONKeyList :: ToJSONKeyFunction [HashDifficulty]
toJSONKey :: ToJSONKeyFunction HashDifficulty
$ctoJSONKey :: ToJSONKeyFunction HashDifficulty
</span><a href="#local-6989586621681479851"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">ToJSONKey</span></a></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681479847"><span id="local-6989586621681479849"><span class="annot"><span class="annottext">FromJSONKeyFunction [HashDifficulty]
FromJSONKeyFunction HashDifficulty
FromJSONKeyFunction HashDifficulty
-&gt; FromJSONKeyFunction [HashDifficulty]
-&gt; FromJSONKey HashDifficulty
forall a.
FromJSONKeyFunction a -&gt; FromJSONKeyFunction [a] -&gt; FromJSONKey a
fromJSONKeyList :: FromJSONKeyFunction [HashDifficulty]
$cfromJSONKeyList :: FromJSONKeyFunction [HashDifficulty]
fromJSONKey :: FromJSONKeyFunction HashDifficulty
$cfromJSONKey :: FromJSONKeyFunction HashDifficulty
</span><a href="#local-6989586621681479847"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">FromJSONKey</span></a></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681479843"><span id="local-6989586621681479845"><span class="annot"><span class="annottext">Int -&gt; HashDifficulty -&gt; Int
HashDifficulty -&gt; Int
(Int -&gt; HashDifficulty -&gt; Int)
-&gt; (HashDifficulty -&gt; Int) -&gt; Hashable HashDifficulty
forall a. (Int -&gt; a -&gt; Int) -&gt; (a -&gt; Int) -&gt; Hashable a
hash :: HashDifficulty -&gt; Int
$chash :: HashDifficulty -&gt; Int
hashWithSalt :: Int -&gt; HashDifficulty -&gt; Int
$chashWithSalt :: Int -&gt; HashDifficulty -&gt; Int
</span><a href="#local-6989586621681479843"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Hashable</span></a></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681479839"><span id="local-6989586621681479841"><span class="annot"><span class="annottext">HashDifficulty
HashDifficulty -&gt; HashDifficulty -&gt; Bounded HashDifficulty
forall a. a -&gt; a -&gt; Bounded a
maxBound :: HashDifficulty
$cmaxBound :: HashDifficulty
minBound :: HashDifficulty
$cminBound :: HashDifficulty
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Bounded</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681479823"><span id="local-6989586621681479825"><span id="local-6989586621681479827"><span id="local-6989586621681479829"><span id="local-6989586621681479831"><span id="local-6989586621681479833"><span id="local-6989586621681479835"><span id="local-6989586621681479837"><span class="annot"><span class="annottext">Int -&gt; HashDifficulty
HashDifficulty -&gt; Int
HashDifficulty -&gt; [HashDifficulty]
HashDifficulty -&gt; HashDifficulty
HashDifficulty -&gt; HashDifficulty -&gt; [HashDifficulty]
HashDifficulty
-&gt; HashDifficulty -&gt; HashDifficulty -&gt; [HashDifficulty]
(HashDifficulty -&gt; HashDifficulty)
-&gt; (HashDifficulty -&gt; HashDifficulty)
-&gt; (Int -&gt; HashDifficulty)
-&gt; (HashDifficulty -&gt; Int)
-&gt; (HashDifficulty -&gt; [HashDifficulty])
-&gt; (HashDifficulty -&gt; HashDifficulty -&gt; [HashDifficulty])
-&gt; (HashDifficulty -&gt; HashDifficulty -&gt; [HashDifficulty])
-&gt; (HashDifficulty
    -&gt; HashDifficulty -&gt; HashDifficulty -&gt; [HashDifficulty])
-&gt; Enum HashDifficulty
forall a.
(a -&gt; a)
-&gt; (a -&gt; a)
-&gt; (Int -&gt; a)
-&gt; (a -&gt; Int)
-&gt; (a -&gt; [a])
-&gt; (a -&gt; a -&gt; [a])
-&gt; (a -&gt; a -&gt; [a])
-&gt; (a -&gt; a -&gt; a -&gt; [a])
-&gt; Enum a
enumFromThenTo :: HashDifficulty
-&gt; HashDifficulty -&gt; HashDifficulty -&gt; [HashDifficulty]
$cenumFromThenTo :: HashDifficulty
-&gt; HashDifficulty -&gt; HashDifficulty -&gt; [HashDifficulty]
enumFromTo :: HashDifficulty -&gt; HashDifficulty -&gt; [HashDifficulty]
$cenumFromTo :: HashDifficulty -&gt; HashDifficulty -&gt; [HashDifficulty]
enumFromThen :: HashDifficulty -&gt; HashDifficulty -&gt; [HashDifficulty]
$cenumFromThen :: HashDifficulty -&gt; HashDifficulty -&gt; [HashDifficulty]
enumFrom :: HashDifficulty -&gt; [HashDifficulty]
$cenumFrom :: HashDifficulty -&gt; [HashDifficulty]
fromEnum :: HashDifficulty -&gt; Int
$cfromEnum :: HashDifficulty -&gt; Int
toEnum :: Int -&gt; HashDifficulty
$ctoEnum :: Int -&gt; HashDifficulty
pred :: HashDifficulty -&gt; HashDifficulty
$cpred :: HashDifficulty -&gt; HashDifficulty
succ :: HashDifficulty -&gt; HashDifficulty
$csucc :: HashDifficulty -&gt; HashDifficulty
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Enum</span></span></span></span></span></span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-195"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">newtype</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621681479821"><span class="annot"><span class="annottext">HashDifficulty -&gt; HashDifficulty -&gt; HashDifficulty
(HashDifficulty -&gt; HashDifficulty -&gt; HashDifficulty)
-&gt; AdditiveSemigroup HashDifficulty
forall g. (g -&gt; g -&gt; g) -&gt; AdditiveSemigroup g
plus :: HashDifficulty -&gt; HashDifficulty -&gt; HashDifficulty
$cplus :: HashDifficulty -&gt; HashDifficulty -&gt; HashDifficulty
</span><a href="#local-6989586621681479821"><span class="hs-identifier hs-var hs-var hs-var hs-var">AdditiveSemigroup</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">AdditiveSemigroup HashDifficulty
AdditiveSemigroup HashDifficulty =&gt;
AdditiveAbelianSemigroup HashDifficulty
forall g. AdditiveSemigroup g =&gt; AdditiveAbelianSemigroup g
</span><a href="#local-6989586621681479820"><span class="hs-identifier hs-var hs-var hs-var">AdditiveAbelianSemigroup</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-196"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">newtype</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621681479806"><span id="local-6989586621681479808"><span id="local-6989586621681479810"><span id="local-6989586621681479812"><span id="local-6989586621681479814"><span id="local-6989586621681479816"><span id="local-6989586621681479818"><span class="annot"><span class="annottext">Integer -&gt; HashDifficulty
HashDifficulty -&gt; HashDifficulty
HashDifficulty -&gt; HashDifficulty -&gt; HashDifficulty
(HashDifficulty -&gt; HashDifficulty -&gt; HashDifficulty)
-&gt; (HashDifficulty -&gt; HashDifficulty -&gt; HashDifficulty)
-&gt; (HashDifficulty -&gt; HashDifficulty -&gt; HashDifficulty)
-&gt; (HashDifficulty -&gt; HashDifficulty)
-&gt; (HashDifficulty -&gt; HashDifficulty)
-&gt; (HashDifficulty -&gt; HashDifficulty)
-&gt; (Integer -&gt; HashDifficulty)
-&gt; Num HashDifficulty
forall a.
(a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a)
-&gt; (a -&gt; a)
-&gt; (a -&gt; a)
-&gt; (Integer -&gt; a)
-&gt; Num a
fromInteger :: Integer -&gt; HashDifficulty
$cfromInteger :: Integer -&gt; HashDifficulty
signum :: HashDifficulty -&gt; HashDifficulty
$csignum :: HashDifficulty -&gt; HashDifficulty
abs :: HashDifficulty -&gt; HashDifficulty
$cabs :: HashDifficulty -&gt; HashDifficulty
negate :: HashDifficulty -&gt; HashDifficulty
$cnegate :: HashDifficulty -&gt; HashDifficulty
* :: HashDifficulty -&gt; HashDifficulty -&gt; HashDifficulty
$c* :: HashDifficulty -&gt; HashDifficulty -&gt; HashDifficulty
- :: HashDifficulty -&gt; HashDifficulty -&gt; HashDifficulty
$c- :: HashDifficulty -&gt; HashDifficulty -&gt; HashDifficulty
+ :: HashDifficulty -&gt; HashDifficulty -&gt; HashDifficulty
$c+ :: HashDifficulty -&gt; HashDifficulty -&gt; HashDifficulty
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Num</span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681479790"><span id="local-6989586621681479792"><span id="local-6989586621681479794"><span id="local-6989586621681479796"><span id="local-6989586621681479798"><span id="local-6989586621681479800"><span id="local-6989586621681479802"><span class="annot"><span class="annottext">Enum HashDifficulty
Real HashDifficulty
(Real HashDifficulty, Enum HashDifficulty) =&gt;
(HashDifficulty -&gt; HashDifficulty -&gt; HashDifficulty)
-&gt; (HashDifficulty -&gt; HashDifficulty -&gt; HashDifficulty)
-&gt; (HashDifficulty -&gt; HashDifficulty -&gt; HashDifficulty)
-&gt; (HashDifficulty -&gt; HashDifficulty -&gt; HashDifficulty)
-&gt; (HashDifficulty
    -&gt; HashDifficulty -&gt; (HashDifficulty, HashDifficulty))
-&gt; (HashDifficulty
    -&gt; HashDifficulty -&gt; (HashDifficulty, HashDifficulty))
-&gt; (HashDifficulty -&gt; Integer)
-&gt; Integral HashDifficulty
HashDifficulty -&gt; Integer
HashDifficulty
-&gt; HashDifficulty -&gt; (HashDifficulty, HashDifficulty)
HashDifficulty -&gt; HashDifficulty -&gt; HashDifficulty
forall a.
(Real a, Enum a) =&gt;
(a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; (a, a))
-&gt; (a -&gt; a -&gt; (a, a))
-&gt; (a -&gt; Integer)
-&gt; Integral a
toInteger :: HashDifficulty -&gt; Integer
$ctoInteger :: HashDifficulty -&gt; Integer
divMod :: HashDifficulty
-&gt; HashDifficulty -&gt; (HashDifficulty, HashDifficulty)
$cdivMod :: HashDifficulty
-&gt; HashDifficulty -&gt; (HashDifficulty, HashDifficulty)
quotRem :: HashDifficulty
-&gt; HashDifficulty -&gt; (HashDifficulty, HashDifficulty)
$cquotRem :: HashDifficulty
-&gt; HashDifficulty -&gt; (HashDifficulty, HashDifficulty)
mod :: HashDifficulty -&gt; HashDifficulty -&gt; HashDifficulty
$cmod :: HashDifficulty -&gt; HashDifficulty -&gt; HashDifficulty
div :: HashDifficulty -&gt; HashDifficulty -&gt; HashDifficulty
$cdiv :: HashDifficulty -&gt; HashDifficulty -&gt; HashDifficulty
rem :: HashDifficulty -&gt; HashDifficulty -&gt; HashDifficulty
$crem :: HashDifficulty -&gt; HashDifficulty -&gt; HashDifficulty
quot :: HashDifficulty -&gt; HashDifficulty -&gt; HashDifficulty
$cquot :: HashDifficulty -&gt; HashDifficulty -&gt; HashDifficulty
$cp2Integral :: Enum HashDifficulty
$cp1Integral :: Real HashDifficulty
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Integral</span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681479786"><span class="annot"><span class="annottext">Num HashDifficulty
Ord HashDifficulty
(Num HashDifficulty, Ord HashDifficulty) =&gt;
(HashDifficulty -&gt; Rational) -&gt; Real HashDifficulty
HashDifficulty -&gt; Rational
forall a. (Num a, Ord a) =&gt; (a -&gt; Rational) -&gt; Real a
toRational :: HashDifficulty -&gt; Rational
$ctoRational :: HashDifficulty -&gt; Rational
$cp2Real :: Ord HashDifficulty
$cp1Real :: Num HashDifficulty
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Real</span></span></span><span class="hs-special">)</span><span>
</span><span id="line-197"></span><span>
</span><span id="line-198"></span><span id="local-6989586621681479785"><span class="annot"><a href="Chainweb.Difficulty.html#encodeHashDifficulty"><span class="hs-identifier hs-type">encodeHashDifficulty</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadPut</span></span><span> </span><span class="annot"><a href="#local-6989586621681479785"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Chainweb.Difficulty.html#HashDifficulty"><span class="hs-identifier hs-type">HashDifficulty</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681479785"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-199"></span><span id="encodeHashDifficulty"><span class="annot"><span class="annottext">encodeHashDifficulty :: HashDifficulty -&gt; m ()
</span><a href="Chainweb.Difficulty.html#encodeHashDifficulty"><span class="hs-identifier hs-var hs-var">encodeHashDifficulty</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Chainweb.Difficulty.html#HashDifficulty"><span class="hs-identifier hs-type">HashDifficulty</span></a></span><span> </span><span id="local-6989586621681479784"><span class="annot"><span class="annottext">x :: PowHashNat
</span><a href="#local-6989586621681479784"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PowHashNat -&gt; m ()
forall (m :: * -&gt; *). MonadPut m =&gt; PowHashNat -&gt; m ()
</span><a href="Chainweb.Difficulty.html#encodePowHashNat"><span class="hs-identifier hs-var">encodePowHashNat</span></a></span><span> </span><span class="annot"><span class="annottext">PowHashNat
</span><a href="#local-6989586621681479784"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-200"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Chainweb.Difficulty.html#encodeHashDifficulty"><span class="hs-pragma hs-type">encodeHashDifficulty</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-201"></span><span>
</span><span id="line-202"></span><span id="local-6989586621681479783"><span class="annot"><a href="Chainweb.Difficulty.html#decodeHashDifficulty"><span class="hs-identifier hs-type">decodeHashDifficulty</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadGet</span></span><span> </span><span class="annot"><a href="#local-6989586621681479783"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681479783"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Chainweb.Difficulty.html#HashDifficulty"><span class="hs-identifier hs-type">HashDifficulty</span></a></span></span><span>
</span><span id="line-203"></span><span id="decodeHashDifficulty"><span class="annot"><span class="annottext">decodeHashDifficulty :: m HashDifficulty
</span><a href="Chainweb.Difficulty.html#decodeHashDifficulty"><span class="hs-identifier hs-var hs-var">decodeHashDifficulty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PowHashNat -&gt; HashDifficulty
</span><a href="Chainweb.Difficulty.html#HashDifficulty"><span class="hs-identifier hs-var">HashDifficulty</span></a></span><span> </span><span class="annot"><span class="annottext">(PowHashNat -&gt; HashDifficulty) -&gt; m PowHashNat -&gt; m HashDifficulty
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; b) -&gt; m a -&gt; m b
</span><span class="hs-operator hs-var">&lt;$!&gt;</span></span><span> </span><span class="annot"><span class="annottext">m PowHashNat
forall (m :: * -&gt; *). MonadGet m =&gt; m PowHashNat
</span><a href="Chainweb.Difficulty.html#decodePowHashNat"><span class="hs-identifier hs-var">decodePowHashNat</span></a></span><span>
</span><span id="line-204"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Chainweb.Difficulty.html#decodeHashDifficulty"><span class="hs-pragma hs-type">decodeHashDifficulty</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-205"></span><span>
</span><span id="line-206"></span><span id="local-6989586621681479782"><span class="annot"><a href="Chainweb.Difficulty.html#encodeHashDifficultyBe"><span class="hs-identifier hs-type">encodeHashDifficultyBe</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadPut</span></span><span> </span><span class="annot"><a href="#local-6989586621681479782"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Chainweb.Difficulty.html#HashDifficulty"><span class="hs-identifier hs-type">HashDifficulty</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681479782"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-207"></span><span id="encodeHashDifficultyBe"><span class="annot"><span class="annottext">encodeHashDifficultyBe :: HashDifficulty -&gt; m ()
</span><a href="Chainweb.Difficulty.html#encodeHashDifficultyBe"><span class="hs-identifier hs-var hs-var">encodeHashDifficultyBe</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Chainweb.Difficulty.html#HashDifficulty"><span class="hs-identifier hs-type">HashDifficulty</span></a></span><span> </span><span id="local-6989586621681479781"><span class="annot"><span class="annottext">x :: PowHashNat
</span><a href="#local-6989586621681479781"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PowHashNat -&gt; m ()
forall (m :: * -&gt; *). MonadPut m =&gt; PowHashNat -&gt; m ()
</span><a href="Chainweb.Difficulty.html#encodePowHashNatBe"><span class="hs-identifier hs-var">encodePowHashNatBe</span></a></span><span> </span><span class="annot"><span class="annottext">PowHashNat
</span><a href="#local-6989586621681479781"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-208"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Chainweb.Difficulty.html#encodeHashDifficultyBe"><span class="hs-pragma hs-type">encodeHashDifficultyBe</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-209"></span><span>
</span><span id="line-210"></span><span id="local-6989586621681479780"><span class="annot"><a href="Chainweb.Difficulty.html#decodeHashDifficultyBe"><span class="hs-identifier hs-type">decodeHashDifficultyBe</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadGet</span></span><span> </span><span class="annot"><a href="#local-6989586621681479780"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681479780"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Chainweb.Difficulty.html#HashDifficulty"><span class="hs-identifier hs-type">HashDifficulty</span></a></span></span><span>
</span><span id="line-211"></span><span id="decodeHashDifficultyBe"><span class="annot"><span class="annottext">decodeHashDifficultyBe :: m HashDifficulty
</span><a href="Chainweb.Difficulty.html#decodeHashDifficultyBe"><span class="hs-identifier hs-var hs-var">decodeHashDifficultyBe</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PowHashNat -&gt; HashDifficulty
</span><a href="Chainweb.Difficulty.html#HashDifficulty"><span class="hs-identifier hs-var">HashDifficulty</span></a></span><span> </span><span class="annot"><span class="annottext">(PowHashNat -&gt; HashDifficulty) -&gt; m PowHashNat -&gt; m HashDifficulty
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; b) -&gt; m a -&gt; m b
</span><span class="hs-operator hs-var">&lt;$!&gt;</span></span><span> </span><span class="annot"><span class="annottext">m PowHashNat
forall (m :: * -&gt; *). MonadGet m =&gt; m PowHashNat
</span><a href="Chainweb.Difficulty.html#decodePowHashNatBe"><span class="hs-identifier hs-var">decodePowHashNatBe</span></a></span><span>
</span><span id="line-212"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Chainweb.Difficulty.html#decodeHashDifficultyBe"><span class="hs-pragma hs-type">decodeHashDifficultyBe</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-213"></span><span>
</span><span id="line-214"></span><span class="hs-comment">-- -------------------------------------------------------------------------- --</span><span>
</span><span id="line-215"></span><span class="hs-comment">-- HashTarget</span><span>
</span><span id="line-216"></span><span>
</span><span id="line-217"></span><span class="hs-comment">-- | HashTarget</span><span>
</span><span id="line-218"></span><span class="hs-comment">--</span><span>
</span><span id="line-219"></span><span class="hs-comment">-- target = maxBound / (network hash rate * block time)</span><span>
</span><span id="line-220"></span><span class="hs-comment">--        = maxBound / difficulty</span><span>
</span><span id="line-221"></span><span class="hs-comment">--</span><span>
</span><span id="line-222"></span><span class="hs-comment">-- network hash rate is interpolated from observered past block times.</span><span>
</span><span id="line-223"></span><span class="hs-comment">--</span><span>
</span><span id="line-224"></span><span id="local-6989586621681479778"><span id="local-6989586621681479779"></span></span><span class="hs-keyword">newtype</span><span> </span><span id="HashTarget"><span class="annot"><a href="Chainweb.Difficulty.html#HashTarget"><span class="hs-identifier hs-var">HashTarget</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="HashTarget"><span class="annot"><a href="Chainweb.Difficulty.html#HashTarget"><span class="hs-identifier hs-var">HashTarget</span></a></span></span><span> </span><span class="annot"><a href="Chainweb.Difficulty.html#PowHashNat"><span class="hs-identifier hs-type">PowHashNat</span></a></span><span>
</span><span id="line-225"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681479771"><span id="local-6989586621681479773"><span id="local-6989586621681479775"><span class="annot"><span class="annottext">Int -&gt; HashTarget -&gt; ShowS
[HashTarget] -&gt; ShowS
HashTarget -&gt; String
(Int -&gt; HashTarget -&gt; ShowS)
-&gt; (HashTarget -&gt; String)
-&gt; ([HashTarget] -&gt; ShowS)
-&gt; Show HashTarget
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [HashTarget] -&gt; ShowS
$cshowList :: [HashTarget] -&gt; ShowS
show :: HashTarget -&gt; String
$cshow :: HashTarget -&gt; String
showsPrec :: Int -&gt; HashTarget -&gt; ShowS
$cshowsPrec :: Int -&gt; HashTarget -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681479767"><span id="local-6989586621681479769"><span class="annot"><span class="annottext">HashTarget -&gt; HashTarget -&gt; Bool
(HashTarget -&gt; HashTarget -&gt; Bool)
-&gt; (HashTarget -&gt; HashTarget -&gt; Bool) -&gt; Eq HashTarget
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: HashTarget -&gt; HashTarget -&gt; Bool
$c/= :: HashTarget -&gt; HashTarget -&gt; Bool
== :: HashTarget -&gt; HashTarget -&gt; Bool
$c== :: HashTarget -&gt; HashTarget -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681479752"><span id="local-6989586621681479754"><span id="local-6989586621681479756"><span id="local-6989586621681479758"><span id="local-6989586621681479760"><span id="local-6989586621681479762"><span id="local-6989586621681479764"><span class="annot"><span class="annottext">Eq HashTarget
Eq HashTarget =&gt;
(HashTarget -&gt; HashTarget -&gt; Ordering)
-&gt; (HashTarget -&gt; HashTarget -&gt; Bool)
-&gt; (HashTarget -&gt; HashTarget -&gt; Bool)
-&gt; (HashTarget -&gt; HashTarget -&gt; Bool)
-&gt; (HashTarget -&gt; HashTarget -&gt; Bool)
-&gt; (HashTarget -&gt; HashTarget -&gt; HashTarget)
-&gt; (HashTarget -&gt; HashTarget -&gt; HashTarget)
-&gt; Ord HashTarget
HashTarget -&gt; HashTarget -&gt; Bool
HashTarget -&gt; HashTarget -&gt; Ordering
HashTarget -&gt; HashTarget -&gt; HashTarget
forall a.
Eq a =&gt;
(a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
min :: HashTarget -&gt; HashTarget -&gt; HashTarget
$cmin :: HashTarget -&gt; HashTarget -&gt; HashTarget
max :: HashTarget -&gt; HashTarget -&gt; HashTarget
$cmax :: HashTarget -&gt; HashTarget -&gt; HashTarget
&gt;= :: HashTarget -&gt; HashTarget -&gt; Bool
$c&gt;= :: HashTarget -&gt; HashTarget -&gt; Bool
&gt; :: HashTarget -&gt; HashTarget -&gt; Bool
$c&gt; :: HashTarget -&gt; HashTarget -&gt; Bool
&lt;= :: HashTarget -&gt; HashTarget -&gt; Bool
$c&lt;= :: HashTarget -&gt; HashTarget -&gt; Bool
&lt; :: HashTarget -&gt; HashTarget -&gt; Bool
$c&lt; :: HashTarget -&gt; HashTarget -&gt; Bool
compare :: HashTarget -&gt; HashTarget -&gt; Ordering
$ccompare :: HashTarget -&gt; HashTarget -&gt; Ordering
$cp1Ord :: Eq HashTarget
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(forall x. HashTarget -&gt; Rep HashTarget x)
-&gt; (forall x. Rep HashTarget x -&gt; HashTarget) -&gt; Generic HashTarget
forall x. Rep HashTarget x -&gt; HashTarget
forall x. HashTarget -&gt; Rep HashTarget x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
$cto :: forall x. Rep HashTarget x -&gt; HashTarget
$cfrom :: forall x. HashTarget -&gt; Rep HashTarget x
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">Generic</span></span><span class="hs-special">)</span><span>
</span><span id="line-226"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">anyclass</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621681479748"><span class="annot"><span class="annottext">HashTarget -&gt; ()
(HashTarget -&gt; ()) -&gt; NFData HashTarget
forall a. (a -&gt; ()) -&gt; NFData a
rnf :: HashTarget -&gt; ()
$crnf :: HashTarget -&gt; ()
</span><a href="#local-6989586621681479748"><span class="hs-identifier hs-var hs-var hs-var hs-var">NFData</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-227"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">newtype</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621681479740"><span id="local-6989586621681479742"><span id="local-6989586621681479744"><span id="local-6989586621681479746"><span class="annot"><span class="annottext">[HashTarget] -&gt; Encoding
[HashTarget] -&gt; Value
HashTarget -&gt; Encoding
HashTarget -&gt; Value
(HashTarget -&gt; Value)
-&gt; (HashTarget -&gt; Encoding)
-&gt; ([HashTarget] -&gt; Value)
-&gt; ([HashTarget] -&gt; Encoding)
-&gt; ToJSON HashTarget
forall a.
(a -&gt; Value)
-&gt; (a -&gt; Encoding)
-&gt; ([a] -&gt; Value)
-&gt; ([a] -&gt; Encoding)
-&gt; ToJSON a
toEncodingList :: [HashTarget] -&gt; Encoding
$ctoEncodingList :: [HashTarget] -&gt; Encoding
toJSONList :: [HashTarget] -&gt; Value
$ctoJSONList :: [HashTarget] -&gt; Value
toEncoding :: HashTarget -&gt; Encoding
$ctoEncoding :: HashTarget -&gt; Encoding
toJSON :: HashTarget -&gt; Value
$ctoJSON :: HashTarget -&gt; Value
</span><a href="#local-6989586621681479740"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">ToJSON</span></a></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681479736"><span id="local-6989586621681479738"><span class="annot"><span class="annottext">Value -&gt; Parser [HashTarget]
Value -&gt; Parser HashTarget
(Value -&gt; Parser HashTarget)
-&gt; (Value -&gt; Parser [HashTarget]) -&gt; FromJSON HashTarget
forall a.
(Value -&gt; Parser a) -&gt; (Value -&gt; Parser [a]) -&gt; FromJSON a
parseJSONList :: Value -&gt; Parser [HashTarget]
$cparseJSONList :: Value -&gt; Parser [HashTarget]
parseJSON :: Value -&gt; Parser HashTarget
$cparseJSON :: Value -&gt; Parser HashTarget
</span><a href="#local-6989586621681479736"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">FromJSON</span></a></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681479732"><span id="local-6989586621681479734"><span class="annot"><span class="annottext">Int -&gt; HashTarget -&gt; Int
HashTarget -&gt; Int
(Int -&gt; HashTarget -&gt; Int)
-&gt; (HashTarget -&gt; Int) -&gt; Hashable HashTarget
forall a. (Int -&gt; a -&gt; Int) -&gt; (a -&gt; Int) -&gt; Hashable a
hash :: HashTarget -&gt; Int
$chash :: HashTarget -&gt; Int
hashWithSalt :: Int -&gt; HashTarget -&gt; Int
$chashWithSalt :: Int -&gt; HashTarget -&gt; Int
</span><a href="#local-6989586621681479732"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Hashable</span></a></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681479728"><span id="local-6989586621681479730"><span class="annot"><span class="annottext">HashTarget
HashTarget -&gt; HashTarget -&gt; Bounded HashTarget
forall a. a -&gt; a -&gt; Bounded a
maxBound :: HashTarget
$cmaxBound :: HashTarget
minBound :: HashTarget
$cminBound :: HashTarget
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Bounded</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-228"></span><span>
</span><span id="line-229"></span><span class="hs-comment">-- | A visualization of a `HashTarget` as binary.</span><span>
</span><span id="line-230"></span><span class="hs-comment">--</span><span>
</span><span id="line-231"></span><span class="annot"><a href="Chainweb.Difficulty.html#showTargetHex"><span class="hs-identifier hs-type">showTargetHex</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Chainweb.Difficulty.html#HashTarget"><span class="hs-identifier hs-type">HashTarget</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span>
</span><span id="line-232"></span><span id="showTargetHex"><span class="annot"><span class="annottext">showTargetHex :: HashTarget -&gt; Text
</span><a href="Chainweb.Difficulty.html#showTargetHex"><span class="hs-identifier hs-var hs-var">showTargetHex</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Chainweb.Difficulty.html#HashTarget"><span class="hs-identifier hs-type">HashTarget</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Chainweb.Difficulty.html#PowHashNat"><span class="hs-identifier hs-type">PowHashNat</span></a></span><span> </span><span id="local-6989586621681479727"><span class="annot"><span class="annottext">n :: Word256
</span><a href="#local-6989586621681479727"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Text
</span><span class="hs-identifier hs-var">T.pack</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Text) -&gt; (Integer -&gt; String) -&gt; Integer -&gt; Text
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Integer -&gt; String
forall r. PrintfType r =&gt; String -&gt; r
</span><span class="hs-identifier hs-var">printf</span></span><span> </span><span class="annot"><span class="hs-string">&quot;%064x&quot;</span></span><span> </span><span class="annot"><span class="annottext">(Integer -&gt; Text) -&gt; Integer -&gt; Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word256 -&gt; Integer
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="Chainweb.Utils.html#int"><span class="hs-identifier hs-var">int</span></a></span><span> </span><span class="annot"><span class="annottext">Word256
</span><a href="#local-6989586621681479727"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span class="hs-special">)</span><span>
</span><span id="line-233"></span><span>
</span><span id="line-234"></span><span class="hs-comment">-- | A visualization of a `HashTarget` as binary.</span><span>
</span><span id="line-235"></span><span class="hs-comment">--</span><span>
</span><span id="line-236"></span><span class="annot"><a href="Chainweb.Difficulty.html#showTargetBits"><span class="hs-identifier hs-type">showTargetBits</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Chainweb.Difficulty.html#HashTarget"><span class="hs-identifier hs-type">HashTarget</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span>
</span><span id="line-237"></span><span id="showTargetBits"><span class="annot"><span class="annottext">showTargetBits :: HashTarget -&gt; Text
</span><a href="Chainweb.Difficulty.html#showTargetBits"><span class="hs-identifier hs-var hs-var">showTargetBits</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Chainweb.Difficulty.html#HashTarget"><span class="hs-identifier hs-type">HashTarget</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Chainweb.Difficulty.html#PowHashNat"><span class="hs-identifier hs-type">PowHashNat</span></a></span><span> </span><span id="local-6989586621681479724"><span class="annot"><span class="annottext">n :: Word256
</span><a href="#local-6989586621681479724"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Text
</span><span class="hs-identifier hs-var">T.pack</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Text) -&gt; (Integer -&gt; String) -&gt; Integer -&gt; Text
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Integer -&gt; String
forall r. PrintfType r =&gt; String -&gt; r
</span><span class="hs-identifier hs-var">printf</span></span><span> </span><span class="annot"><span class="hs-string">&quot;%0256b&quot;</span></span><span> </span><span class="annot"><span class="annottext">(Integer -&gt; Text) -&gt; Integer -&gt; Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word256 -&gt; Integer
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="Chainweb.Utils.html#int"><span class="hs-identifier hs-var">int</span></a></span><span> </span><span class="annot"><span class="annottext">Word256
</span><a href="#local-6989586621681479724"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span class="hs-special">)</span><span>
</span><span id="line-238"></span><span>
</span><span id="line-239"></span><span class="hs-comment">-- | By maximum, we mean &quot;easiest&quot;.</span><span>
</span><span id="line-240"></span><span class="hs-comment">--</span><span>
</span><span id="line-241"></span><span class="annot"><a href="Chainweb.Difficulty.html#maxTarget"><span class="hs-identifier hs-type">maxTarget</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Chainweb.Difficulty.html#HashTarget"><span class="hs-identifier hs-type">HashTarget</span></a></span><span>
</span><span id="line-242"></span><span id="maxTarget"><span class="annot"><span class="annottext">maxTarget :: HashTarget
</span><a href="Chainweb.Difficulty.html#maxTarget"><span class="hs-identifier hs-var hs-var">maxTarget</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PowHashNat -&gt; HashTarget
</span><a href="Chainweb.Difficulty.html#HashTarget"><span class="hs-identifier hs-var">HashTarget</span></a></span><span> </span><span class="annot"><span class="annottext">(PowHashNat -&gt; HashTarget) -&gt; PowHashNat -&gt; HashTarget
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Word256 -&gt; PowHashNat
</span><a href="Chainweb.Difficulty.html#PowHashNat"><span class="hs-identifier hs-var">PowHashNat</span></a></span><span> </span><span class="annot"><span class="annottext">Word256
</span><a href="Chainweb.Difficulty.html#maxTargetWord"><span class="hs-identifier hs-var">maxTargetWord</span></a></span><span>
</span><span id="line-243"></span><span>
</span><span id="line-244"></span><span class="annot"><a href="Chainweb.Difficulty.html#maxTargetWord"><span class="hs-identifier hs-type">maxTargetWord</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word256</span></span><span>
</span><span id="line-245"></span><span id="maxTargetWord"><span class="annot"><span class="annottext">maxTargetWord :: Word256
</span><a href="Chainweb.Difficulty.html#maxTargetWord"><span class="hs-identifier hs-var hs-var">maxTargetWord</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word256
forall a. Bounded a =&gt; a
</span><span class="hs-identifier hs-var">maxBound</span></span><span>
</span><span id="line-246"></span><span>
</span><span id="line-247"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Chainweb.Crypto.MerkleLog.html#IsMerkleLogEntry"><span class="hs-identifier hs-type">IsMerkleLogEntry</span></a></span><span> </span><span class="annot"><a href="Chainweb.MerkleUniverse.html#ChainwebHashTag"><span class="hs-identifier hs-type">ChainwebHashTag</span></a></span><span> </span><span class="annot"><a href="Chainweb.Difficulty.html#HashTarget"><span class="hs-identifier hs-type">HashTarget</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-248"></span><span>    </span><span class="hs-keyword">type</span><span> </span><span id="Tag"><span class="annot"><a href="Chainweb.Crypto.MerkleLog.html#Tag"><span class="hs-identifier hs-var">Tag</span></a></span></span><span> </span><span class="annot"><a href="Chainweb.Difficulty.html#HashTarget"><span class="hs-identifier hs-type">HashTarget</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Chainweb.MerkleUniverse.html#HashTargetTag"><span class="hs-identifier hs-type">HashTargetTag</span></a></span><span>
</span><span id="line-249"></span><span>    </span><span id="local-6989586621681479717"><span class="annot"><span class="annottext">toMerkleNode :: HashTarget -&gt; MerkleNodeType (HashAlg ChainwebHashTag) ByteString
</span><a href="Chainweb.Crypto.MerkleLog.html#toMerkleNode"><span class="hs-identifier hs-var hs-var hs-var hs-var">toMerkleNode</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall (m :: * -&gt; *). MonadPut m =&gt; HashTarget -&gt; m ())
-&gt; HashTarget -&gt; MerkleNodeType SHA512t_256 ByteString
forall b a.
(forall (m :: * -&gt; *). MonadPut m =&gt; b -&gt; m ())
-&gt; b -&gt; MerkleNodeType a ByteString
</span><a href="Chainweb.Crypto.MerkleLog.html#encodeMerkleInputNode"><span class="hs-identifier hs-var">encodeMerkleInputNode</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). MonadPut m =&gt; HashTarget -&gt; m ()
</span><a href="Chainweb.Difficulty.html#encodeHashTarget"><span class="hs-identifier hs-var">encodeHashTarget</span></a></span><span>
</span><span id="line-250"></span><span>    </span><span id="local-6989586621681479714"><span class="annot"><span class="annottext">fromMerkleNode :: MerkleNodeType (HashAlg ChainwebHashTag) ByteString
-&gt; Either SomeException HashTarget
</span><a href="Chainweb.Crypto.MerkleLog.html#fromMerkleNode"><span class="hs-identifier hs-var hs-var hs-var hs-var">fromMerkleNode</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall (n :: * -&gt; *). MonadGet n =&gt; n HashTarget)
-&gt; MerkleNodeType SHA512t_256 ByteString
-&gt; Either SomeException HashTarget
forall (m :: * -&gt; *) b a.
MonadThrow m =&gt;
(forall (n :: * -&gt; *). MonadGet n =&gt; n b)
-&gt; MerkleNodeType a ByteString -&gt; m b
</span><a href="Chainweb.Crypto.MerkleLog.html#decodeMerkleInputNode"><span class="hs-identifier hs-var">decodeMerkleInputNode</span></a></span><span> </span><span class="annot"><span class="annottext">forall (n :: * -&gt; *). MonadGet n =&gt; n HashTarget
</span><a href="Chainweb.Difficulty.html#decodeHashTarget"><span class="hs-identifier hs-var">decodeHashTarget</span></a></span><span>
</span><span id="line-251"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Chainweb.Crypto.MerkleLog.html#toMerkleNode"><span class="hs-pragma hs-type">toMerkleNode</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-252"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Chainweb.Crypto.MerkleLog.html#fromMerkleNode"><span class="hs-pragma hs-type">fromMerkleNode</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-253"></span><span>
</span><span id="line-254"></span><span class="hs-comment">-- | Given the same `ChainwebVersion`, forms an isomorphism with</span><span>
</span><span id="line-255"></span><span class="hs-comment">-- `targetToDifficulty`.</span><span>
</span><span id="line-256"></span><span class="hs-comment">--</span><span>
</span><span id="line-257"></span><span class="annot"><a href="Chainweb.Difficulty.html#difficultyToTarget"><span class="hs-identifier hs-type">difficultyToTarget</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Chainweb.Difficulty.html#HashDifficulty"><span class="hs-identifier hs-type">HashDifficulty</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Chainweb.Difficulty.html#HashTarget"><span class="hs-identifier hs-type">HashTarget</span></a></span><span>
</span><span id="line-258"></span><span id="difficultyToTarget"><span class="annot"><span class="annottext">difficultyToTarget :: HashDifficulty -&gt; HashTarget
</span><a href="Chainweb.Difficulty.html#difficultyToTarget"><span class="hs-identifier hs-var hs-var">difficultyToTarget</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Chainweb.Difficulty.html#HashDifficulty"><span class="hs-identifier hs-type">HashDifficulty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Chainweb.Difficulty.html#PowHashNat"><span class="hs-identifier hs-type">PowHashNat</span></a></span><span> </span><span id="local-6989586621681479711"><span class="annot"><span class="annottext">difficulty :: Word256
</span><a href="#local-6989586621681479711"><span class="hs-identifier hs-var">difficulty</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-259"></span><span>    </span><span class="annot"><span class="annottext">PowHashNat -&gt; HashTarget
</span><a href="Chainweb.Difficulty.html#HashTarget"><span class="hs-identifier hs-var">HashTarget</span></a></span><span> </span><span class="annot"><span class="annottext">(PowHashNat -&gt; HashTarget)
-&gt; (Word256 -&gt; PowHashNat) -&gt; Word256 -&gt; HashTarget
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Word256 -&gt; PowHashNat
</span><a href="Chainweb.Difficulty.html#PowHashNat"><span class="hs-identifier hs-var">PowHashNat</span></a></span><span> </span><span class="annot"><span class="annottext">(Word256 -&gt; HashTarget) -&gt; Word256 -&gt; HashTarget
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Word256
</span><a href="Chainweb.Difficulty.html#maxTargetWord"><span class="hs-identifier hs-var">maxTargetWord</span></a></span><span> </span><span class="annot"><span class="annottext">Word256 -&gt; Word256 -&gt; Word256
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`div`</span></span><span> </span><span class="annot"><span class="annottext">Word256
</span><a href="#local-6989586621681479711"><span class="hs-identifier hs-var">difficulty</span></a></span><span>
</span><span id="line-260"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Chainweb.Difficulty.html#difficultyToTarget"><span class="hs-pragma hs-type">difficultyToTarget</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-261"></span><span>
</span><span id="line-262"></span><span class="hs-comment">-- | Like `difficultyToTarget`, but accepts a `Rational` that would have been</span><span>
</span><span id="line-263"></span><span class="hs-comment">-- produced by `targetToDifficultyR` and then further manipulated during</span><span>
</span><span id="line-264"></span><span class="hs-comment">-- Difficulty Adjustment.</span><span>
</span><span id="line-265"></span><span class="hs-comment">--</span><span>
</span><span id="line-266"></span><span class="annot"><a href="Chainweb.Difficulty.html#difficultyToTargetR"><span class="hs-identifier hs-type">difficultyToTargetR</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Rational</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Chainweb.Difficulty.html#HashTarget"><span class="hs-identifier hs-type">HashTarget</span></a></span><span>
</span><span id="line-267"></span><span id="difficultyToTargetR"><span class="annot"><span class="annottext">difficultyToTargetR :: Rational -&gt; HashTarget
</span><a href="Chainweb.Difficulty.html#difficultyToTargetR"><span class="hs-identifier hs-var hs-var">difficultyToTargetR</span></a></span></span><span> </span><span id="local-6989586621681479708"><span class="annot"><span class="annottext">difficulty :: Rational
</span><a href="#local-6989586621681479708"><span class="hs-identifier hs-var">difficulty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-268"></span><span>    </span><span class="hs-comment">-- `ceiling` is chosen here, to avoid the (hopefully rare) case where the</span><span>
</span><span id="line-269"></span><span>    </span><span class="hs-comment">-- `Rational` given is between 0 and 1. `floor` instead would drop that to</span><span>
</span><span id="line-270"></span><span>    </span><span class="hs-comment">-- 0, making the `div` crash. At most, this would &quot;spuriously&quot; raise the</span><span>
</span><span id="line-271"></span><span>    </span><span class="hs-comment">-- difficulty by at most 0.999... (~1) hash, which is negligible.</span><span>
</span><span id="line-272"></span><span>    </span><span class="annot"><span class="annottext">PowHashNat -&gt; HashTarget
</span><a href="Chainweb.Difficulty.html#HashTarget"><span class="hs-identifier hs-var">HashTarget</span></a></span><span> </span><span class="annot"><span class="annottext">(PowHashNat -&gt; HashTarget)
-&gt; (Word256 -&gt; PowHashNat) -&gt; Word256 -&gt; HashTarget
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Word256 -&gt; PowHashNat
</span><a href="Chainweb.Difficulty.html#PowHashNat"><span class="hs-identifier hs-var">PowHashNat</span></a></span><span> </span><span class="annot"><span class="annottext">(Word256 -&gt; HashTarget) -&gt; Word256 -&gt; HashTarget
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Word256
</span><a href="Chainweb.Difficulty.html#maxTargetWord"><span class="hs-identifier hs-var">maxTargetWord</span></a></span><span> </span><span class="annot"><span class="annottext">Word256 -&gt; Word256 -&gt; Word256
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`div`</span></span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Word256
forall a b. (RealFrac a, Integral b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">ceiling</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621681479708"><span class="hs-identifier hs-var">difficulty</span></a></span><span>
</span><span id="line-273"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Chainweb.Difficulty.html#difficultyToTargetR"><span class="hs-pragma hs-type">difficultyToTargetR</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-274"></span><span>
</span><span id="line-275"></span><span class="hs-comment">-- | Given the same `ChainwebVersion`, forms an isomorphism with</span><span>
</span><span id="line-276"></span><span class="hs-comment">-- `difficultyToTarget`.</span><span>
</span><span id="line-277"></span><span class="hs-comment">--</span><span>
</span><span id="line-278"></span><span class="annot"><a href="Chainweb.Difficulty.html#targetToDifficulty"><span class="hs-identifier hs-type">targetToDifficulty</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Chainweb.Difficulty.html#HashTarget"><span class="hs-identifier hs-type">HashTarget</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Chainweb.Difficulty.html#HashDifficulty"><span class="hs-identifier hs-type">HashDifficulty</span></a></span><span>
</span><span id="line-279"></span><span id="targetToDifficulty"><span class="annot"><span class="annottext">targetToDifficulty :: HashTarget -&gt; HashDifficulty
</span><a href="Chainweb.Difficulty.html#targetToDifficulty"><span class="hs-identifier hs-var hs-var">targetToDifficulty</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Chainweb.Difficulty.html#HashTarget"><span class="hs-identifier hs-type">HashTarget</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Chainweb.Difficulty.html#PowHashNat"><span class="hs-identifier hs-type">PowHashNat</span></a></span><span> </span><span id="local-6989586621681479706"><span class="annot"><span class="annottext">target :: Word256
</span><a href="#local-6989586621681479706"><span class="hs-identifier hs-var">target</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-280"></span><span>    </span><span class="annot"><span class="annottext">PowHashNat -&gt; HashDifficulty
</span><a href="Chainweb.Difficulty.html#HashDifficulty"><span class="hs-identifier hs-var">HashDifficulty</span></a></span><span> </span><span class="annot"><span class="annottext">(PowHashNat -&gt; HashDifficulty)
-&gt; (Word256 -&gt; PowHashNat) -&gt; Word256 -&gt; HashDifficulty
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Word256 -&gt; PowHashNat
</span><a href="Chainweb.Difficulty.html#PowHashNat"><span class="hs-identifier hs-var">PowHashNat</span></a></span><span> </span><span class="annot"><span class="annottext">(Word256 -&gt; HashDifficulty) -&gt; Word256 -&gt; HashDifficulty
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Word256
</span><a href="Chainweb.Difficulty.html#maxTargetWord"><span class="hs-identifier hs-var">maxTargetWord</span></a></span><span> </span><span class="annot"><span class="annottext">Word256 -&gt; Word256 -&gt; Word256
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`div`</span></span><span> </span><span class="annot"><span class="annottext">Word256
</span><a href="#local-6989586621681479706"><span class="hs-identifier hs-var">target</span></a></span><span>
</span><span id="line-281"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Chainweb.Difficulty.html#targetToDifficulty"><span class="hs-pragma hs-type">targetToDifficulty</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-282"></span><span>
</span><span id="line-283"></span><span class="hs-comment">-- | Like `targetToDifficulty`, but yields a `Rational` for lossless</span><span>
</span><span id="line-284"></span><span class="hs-comment">-- calculations in Difficulty Adjustment.</span><span>
</span><span id="line-285"></span><span class="hs-comment">--</span><span>
</span><span id="line-286"></span><span class="annot"><a href="Chainweb.Difficulty.html#targetToDifficultyR"><span class="hs-identifier hs-type">targetToDifficultyR</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Chainweb.Difficulty.html#HashTarget"><span class="hs-identifier hs-type">HashTarget</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Rational</span></span><span>
</span><span id="line-287"></span><span id="targetToDifficultyR"><span class="annot"><span class="annottext">targetToDifficultyR :: HashTarget -&gt; Rational
</span><a href="Chainweb.Difficulty.html#targetToDifficultyR"><span class="hs-identifier hs-var hs-var">targetToDifficultyR</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Chainweb.Difficulty.html#HashTarget"><span class="hs-identifier hs-type">HashTarget</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Chainweb.Difficulty.html#PowHashNat"><span class="hs-identifier hs-type">PowHashNat</span></a></span><span> </span><span id="local-6989586621681479704"><span class="annot"><span class="annottext">target :: Word256
</span><a href="#local-6989586621681479704"><span class="hs-identifier hs-var">target</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-288"></span><span>    </span><span class="annot"><span class="annottext">Word256 -&gt; Integer
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="Chainweb.Utils.html#int"><span class="hs-identifier hs-var">int</span></a></span><span> </span><span class="annot"><span class="annottext">Word256
</span><a href="Chainweb.Difficulty.html#maxTargetWord"><span class="hs-identifier hs-var">maxTargetWord</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Rational
forall a. Integral a =&gt; a -&gt; a -&gt; Ratio a
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Word256 -&gt; Integer
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="Chainweb.Utils.html#int"><span class="hs-identifier hs-var">int</span></a></span><span> </span><span class="annot"><span class="annottext">Word256
</span><a href="#local-6989586621681479704"><span class="hs-identifier hs-var">target</span></a></span><span>
</span><span id="line-289"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Chainweb.Difficulty.html#targetToDifficultyR"><span class="hs-pragma hs-type">targetToDifficultyR</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-290"></span><span>
</span><span id="line-291"></span><span class="hs-comment">-- | The critical check in Proof-of-Work mining: did the generated hash match</span><span>
</span><span id="line-292"></span><span class="hs-comment">-- the target?</span><span>
</span><span id="line-293"></span><span class="hs-comment">--</span><span>
</span><span id="line-294"></span><span class="annot"><a href="Chainweb.Difficulty.html#checkTarget"><span class="hs-identifier hs-type">checkTarget</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Chainweb.Difficulty.html#HashTarget"><span class="hs-identifier hs-type">HashTarget</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Chainweb.PowHash.html#PowHash"><span class="hs-identifier hs-type">PowHash</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-295"></span><span id="checkTarget"><span class="annot"><span class="annottext">checkTarget :: HashTarget -&gt; PowHash -&gt; Bool
</span><a href="Chainweb.Difficulty.html#checkTarget"><span class="hs-identifier hs-var hs-var">checkTarget</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Chainweb.Difficulty.html#HashTarget"><span class="hs-identifier hs-type">HashTarget</span></a></span><span> </span><span id="local-6989586621681479703"><span class="annot"><span class="annottext">target :: PowHashNat
</span><a href="#local-6989586621681479703"><span class="hs-identifier hs-var">target</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621681479702"><span class="annot"><span class="annottext">h :: PowHash
</span><a href="#local-6989586621681479702"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PowHash -&gt; PowHashNat
</span><a href="Chainweb.Difficulty.html#powHashNat"><span class="hs-identifier hs-var">powHashNat</span></a></span><span> </span><span class="annot"><span class="annottext">PowHash
</span><a href="#local-6989586621681479702"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">PowHashNat -&gt; PowHashNat -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">PowHashNat
</span><a href="#local-6989586621681479703"><span class="hs-identifier hs-var">target</span></a></span><span>
</span><span id="line-296"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Chainweb.Difficulty.html#checkTarget"><span class="hs-pragma hs-type">checkTarget</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-297"></span><span>
</span><span id="line-298"></span><span id="local-6989586621681479700"><span class="annot"><a href="Chainweb.Difficulty.html#encodeHashTarget"><span class="hs-identifier hs-type">encodeHashTarget</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadPut</span></span><span> </span><span class="annot"><a href="#local-6989586621681479700"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Chainweb.Difficulty.html#HashTarget"><span class="hs-identifier hs-type">HashTarget</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681479700"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-299"></span><span id="encodeHashTarget"><span class="annot"><span class="annottext">encodeHashTarget :: HashTarget -&gt; m ()
</span><a href="Chainweb.Difficulty.html#encodeHashTarget"><span class="hs-identifier hs-var hs-var">encodeHashTarget</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PowHashNat -&gt; m ()
forall (m :: * -&gt; *). MonadPut m =&gt; PowHashNat -&gt; m ()
</span><a href="Chainweb.Difficulty.html#encodePowHashNat"><span class="hs-identifier hs-var">encodePowHashNat</span></a></span><span> </span><span class="annot"><span class="annottext">(PowHashNat -&gt; m ())
-&gt; (HashTarget -&gt; PowHashNat) -&gt; HashTarget -&gt; m ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">HashTarget -&gt; PowHashNat
forall a b. Coercible a b =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">coerce</span></span><span>
</span><span id="line-300"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Chainweb.Difficulty.html#encodeHashTarget"><span class="hs-pragma hs-type">encodeHashTarget</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-301"></span><span>
</span><span id="line-302"></span><span id="local-6989586621681479699"><span class="annot"><a href="Chainweb.Difficulty.html#decodeHashTarget"><span class="hs-identifier hs-type">decodeHashTarget</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadGet</span></span><span> </span><span class="annot"><a href="#local-6989586621681479699"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681479699"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Chainweb.Difficulty.html#HashTarget"><span class="hs-identifier hs-type">HashTarget</span></a></span></span><span>
</span><span id="line-303"></span><span id="decodeHashTarget"><span class="annot"><span class="annottext">decodeHashTarget :: m HashTarget
</span><a href="Chainweb.Difficulty.html#decodeHashTarget"><span class="hs-identifier hs-var hs-var">decodeHashTarget</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PowHashNat -&gt; HashTarget
</span><a href="Chainweb.Difficulty.html#HashTarget"><span class="hs-identifier hs-var">HashTarget</span></a></span><span> </span><span class="annot"><span class="annottext">(PowHashNat -&gt; HashTarget) -&gt; m PowHashNat -&gt; m HashTarget
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; b) -&gt; m a -&gt; m b
</span><span class="hs-operator hs-var">&lt;$!&gt;</span></span><span> </span><span class="annot"><span class="annottext">m PowHashNat
forall (m :: * -&gt; *). MonadGet m =&gt; m PowHashNat
</span><a href="Chainweb.Difficulty.html#decodePowHashNat"><span class="hs-identifier hs-var">decodePowHashNat</span></a></span><span>
</span><span id="line-304"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Chainweb.Difficulty.html#decodeHashTarget"><span class="hs-pragma hs-type">decodeHashTarget</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-305"></span><span>
</span><span id="line-306"></span><span class="hs-comment">-- -------------------------------------------------------------------------- --</span><span>
</span><span id="line-307"></span><span class="hs-comment">-- Difficulty Adjustment</span><span>
</span><span id="line-308"></span><span>
</span><span id="line-309"></span><span class="hs-comment">-- | A new `HashTarget`, based on the rate of mining success over the previous N</span><span>
</span><span id="line-310"></span><span class="hs-comment">-- blocks.</span><span>
</span><span id="line-311"></span><span class="hs-comment">--</span><span>
</span><span id="line-312"></span><span class="hs-comment">-- == Epoch-based Difficulty Adjustment</span><span>
</span><span id="line-313"></span><span class="hs-comment">--</span><span>
</span><span id="line-314"></span><span class="hs-comment">-- This function represents a Bitcoin-inspired, &quot;epoch-based&quot; adjustment</span><span>
</span><span id="line-315"></span><span class="hs-comment">-- algorithm. For every N blocks (as defined by `WindowWidth`), we perform an</span><span>
</span><span id="line-316"></span><span class="hs-comment">-- adjustment.</span><span>
</span><span id="line-317"></span><span class="hs-comment">--</span><span>
</span><span id="line-318"></span><span class="hs-comment">-- === Terminology</span><span>
</span><span id="line-319"></span><span class="hs-comment">--</span><span>
</span><span id="line-320"></span><span class="hs-comment">-- `BlockHeader` stores a 256-bit measure of difficulty: `HashTarget`. More</span><span>
</span><span id="line-321"></span><span class="hs-comment">-- precisely, `HashTarget` is a derivation (seen below) of the `HashDifficulty`.</span><span>
</span><span id="line-322"></span><span class="hs-comment">-- `HashDifficulty` in itself is roughly a measure of the number of hashes</span><span>
</span><span id="line-323"></span><span class="hs-comment">-- necessary to &quot;solve&quot; a block. For non-POW testing scenarios that use trivial</span><span>
</span><span id="line-324"></span><span class="hs-comment">-- targets (i.e. `maxBound`), then difficulty is exactly the number of necessary</span><span>
</span><span id="line-325"></span><span class="hs-comment">-- hashes. For POW mining, this is offset. See `maxTarget`.</span><span>
</span><span id="line-326"></span><span class="hs-comment">--</span><span>
</span><span id="line-327"></span><span class="hs-comment">-- A `HashDifficulty` of 1 is considered the &quot;easiest&quot; difficulty, and</span><span>
</span><span id="line-328"></span><span class="hs-comment">-- represents a `HashTarget` of `maxTarget`. There must never be a difficulty of</span><span>
</span><span id="line-329"></span><span class="hs-comment">-- 0.</span><span>
</span><span id="line-330"></span><span class="hs-comment">--</span><span>
</span><span id="line-331"></span><span class="hs-comment">-- Given the same `Chainweb.Version.ChainwebVersion`, the functions</span><span>
</span><span id="line-332"></span><span class="hs-comment">-- `targetToDifficulty` and `difficultyToTarget` form an isomorphism between the</span><span>
</span><span id="line-333"></span><span class="hs-comment">-- above mentioned types.</span><span>
</span><span id="line-334"></span><span class="hs-comment">--</span><span>
</span><span id="line-335"></span><span class="hs-comment">-- === Justification</span><span>
</span><span id="line-336"></span><span class="hs-comment">--</span><span>
</span><span id="line-337"></span><span class="hs-comment">-- We define the maximum possible hash target (the &quot;easiest&quot; target) as follows:</span><span>
</span><span id="line-338"></span><span class="hs-comment">--</span><span>
</span><span id="line-339"></span><span class="hs-comment">-- \[</span><span>
</span><span id="line-340"></span><span class="hs-comment">-- \begin{align*}</span><span>
</span><span id="line-341"></span><span class="hs-comment">--   \text{MaxBound} &amp;= 2^{256} - 1 \\</span><span>
</span><span id="line-342"></span><span class="hs-comment">--   \text{MaxTarget} &amp;= \frac{\text{MaxBound}}{2^{\text{offset}}}</span><span>
</span><span id="line-343"></span><span class="hs-comment">-- \end{align*}</span><span>
</span><span id="line-344"></span><span class="hs-comment">-- \]</span><span>
</span><span id="line-345"></span><span class="hs-comment">--</span><span>
</span><span id="line-346"></span><span class="hs-comment">-- where /offset/ is some number of bits, 0 for trivial scenarios and some</span><span>
</span><span id="line-347"></span><span class="hs-comment">-- experimentally discovered \(N\) for real POW mining scenarios. For Bitcoin,</span><span>
</span><span id="line-348"></span><span class="hs-comment">-- \(N = 32\).</span><span>
</span><span id="line-349"></span><span class="hs-comment">--</span><span>
</span><span id="line-350"></span><span class="hs-comment">-- Given some difficulty \(D\), its corresponding `HashTarget` can be found by:</span><span>
</span><span id="line-351"></span><span class="hs-comment">--</span><span>
</span><span id="line-352"></span><span class="hs-comment">-- \[</span><span>
</span><span id="line-353"></span><span class="hs-comment">-- \text{Target} = \frac{\text{MaxTarget}}{D}</span><span>
</span><span id="line-354"></span><span class="hs-comment">-- \]</span><span>
</span><span id="line-355"></span><span class="hs-comment">--</span><span>
</span><span id="line-356"></span><span class="hs-comment">-- During adjustment, we seek to solve for some new \(D\). From the above, it</span><span>
</span><span id="line-357"></span><span class="hs-comment">-- follows that the expected number of hashes necessary to &quot;solve&quot; a block</span><span>
</span><span id="line-358"></span><span class="hs-comment">-- becomes:</span><span>
</span><span id="line-359"></span><span class="hs-comment">--</span><span>
</span><span id="line-360"></span><span class="hs-comment">-- \[</span><span>
</span><span id="line-361"></span><span class="hs-comment">-- \text{Expected} = \frac{D * \text{MaxBound}}{\text{MaxTarget}}</span><span>
</span><span id="line-362"></span><span class="hs-comment">-- \]</span><span>
</span><span id="line-363"></span><span class="hs-comment">--</span><span>
</span><span id="line-364"></span><span class="hs-comment">-- If we expect a block to be solved every \(R\) seconds, we find our total</span><span>
</span><span id="line-365"></span><span class="hs-comment">-- Network Hash Rate:</span><span>
</span><span id="line-366"></span><span class="hs-comment">--</span><span>
</span><span id="line-367"></span><span class="hs-comment">-- \[</span><span>
</span><span id="line-368"></span><span class="hs-comment">-- \text{HashRate} = \frac{\text{Expected}}{R}</span><span>
</span><span id="line-369"></span><span class="hs-comment">-- \]</span><span>
</span><span id="line-370"></span><span class="hs-comment">--</span><span>
</span><span id="line-371"></span><span class="hs-comment">-- But, as a block chain is a dynamic system, the real time it took to mine some</span><span>
</span><span id="line-372"></span><span class="hs-comment">-- block would likely not be exactly \(R\). This implies:</span><span>
</span><span id="line-373"></span><span class="hs-comment">--</span><span>
</span><span id="line-374"></span><span class="hs-comment">-- \[</span><span>
</span><span id="line-375"></span><span class="hs-comment">-- \begin{align*}</span><span>
</span><span id="line-376"></span><span class="hs-comment">--   \frac{\text{Expected}}{R} &amp;= \text{HashRate} = \frac{\text{Expected}'}{M} \\</span><span>
</span><span id="line-377"></span><span class="hs-comment">--   \frac{D * \text{MaxBound}}{R * \text{MaxTarget}} &amp;= \text{HashRate} = \frac{D' * \text{MaxBound}}{M * \text{MaxTarget}} \\</span><span>
</span><span id="line-378"></span><span class="hs-comment">--   \frac{D}{R} &amp;= \text{HashRate} = \frac{D'}{M}</span><span>
</span><span id="line-379"></span><span class="hs-comment">-- \end{align*}</span><span>
</span><span id="line-380"></span><span class="hs-comment">-- \]</span><span>
</span><span id="line-381"></span><span class="hs-comment">--</span><span>
</span><span id="line-382"></span><span class="hs-comment">-- where \(D'\) is the known difficulty from the previous block, \(M\) is the</span><span>
</span><span id="line-383"></span><span class="hs-comment">-- average time in seconds it took to calculate the previous \(B\) blocks. The</span><span>
</span><span id="line-384"></span><span class="hs-comment">-- value of \(B\) is assumed to be configurable.</span><span>
</span><span id="line-385"></span><span class="hs-comment">--</span><span>
</span><span id="line-386"></span><span class="hs-comment">-- Given this, our new \(D\) is a simple ratio:</span><span>
</span><span id="line-387"></span><span class="hs-comment">--</span><span>
</span><span id="line-388"></span><span class="hs-comment">-- \[</span><span>
</span><span id="line-389"></span><span class="hs-comment">-- D = \frac{D' * R}{M}</span><span>
</span><span id="line-390"></span><span class="hs-comment">-- \]</span><span>
</span><span id="line-391"></span><span class="hs-comment">--</span><span>
</span><span id="line-392"></span><span class="hs-comment">-- /HashRate/ will of course not stay fixed as the network grows. Luckily, the</span><span>
</span><span id="line-393"></span><span class="hs-comment">-- difference in \(M\) values will naturally correct for this in the calculation</span><span>
</span><span id="line-394"></span><span class="hs-comment">-- of a new \(D\).</span><span>
</span><span id="line-395"></span><span class="hs-comment">--</span><span>
</span><span id="line-396"></span><span class="hs-comment">-- === Precision</span><span>
</span><span id="line-397"></span><span class="hs-comment">--</span><span>
</span><span id="line-398"></span><span class="hs-comment">-- In real systems, the difference between \(M\) and \(R\) may be minute. To</span><span>
</span><span id="line-399"></span><span class="hs-comment">-- ensure that:</span><span>
</span><span id="line-400"></span><span class="hs-comment">--</span><span>
</span><span id="line-401"></span><span class="hs-comment">--   * differences are not lost to integer-math rounding errors</span><span>
</span><span id="line-402"></span><span class="hs-comment">--   * adjustment actually occurs</span><span>
</span><span id="line-403"></span><span class="hs-comment">--   * small, incremental adjustments are allowed to build into greater change over time</span><span>
</span><span id="line-404"></span><span class="hs-comment">--   * `Word256`-based overflows do not occur</span><span>
</span><span id="line-405"></span><span class="hs-comment">--   * the algorithm is simple</span><span>
</span><span id="line-406"></span><span class="hs-comment">--</span><span>
</span><span id="line-407"></span><span class="hs-comment">-- we use the infinite-precision `Rational` type in the calculation of the new</span><span>
</span><span id="line-408"></span><span class="hs-comment">-- \(D\). Only when being converted to a final `HashTarget` is the non-integer</span><span>
</span><span id="line-409"></span><span class="hs-comment">-- precision discarded.</span><span>
</span><span id="line-410"></span><span class="hs-comment">--</span><span>
</span><span id="line-411"></span><span class="hs-comment">-- /Note/: Use of `Rational` is likely not our final solution, and complicates</span><span>
</span><span id="line-412"></span><span class="hs-comment">-- any cross-language spec we would write regarding adjustment algorithm</span><span>
</span><span id="line-413"></span><span class="hs-comment">-- expectations. For now, however, `Rational` is stable for a Haskell-only</span><span>
</span><span id="line-414"></span><span class="hs-comment">-- environment.</span><span>
</span><span id="line-415"></span><span class="hs-comment">--</span><span>
</span><span id="line-416"></span><span class="annot"><a href="Chainweb.Difficulty.html#adjust"><span class="hs-identifier hs-type">adjust</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Chainweb.Version.html#ChainwebVersion"><span class="hs-identifier hs-type">ChainwebVersion</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Chainweb.Version.html#WindowWidth"><span class="hs-identifier hs-type">WindowWidth</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Chainweb.Time.html#TimeSpan"><span class="hs-identifier hs-type">TimeSpan</span></a></span><span> </span><span class="annot"><a href="Chainweb.Time.html#Micros"><span class="hs-identifier hs-type">Micros</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Chainweb.Difficulty.html#HashTarget"><span class="hs-identifier hs-type">HashTarget</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Chainweb.Difficulty.html#HashTarget"><span class="hs-identifier hs-type">HashTarget</span></a></span><span>
</span><span id="line-417"></span><span id="adjust"><span class="annot"><span class="annottext">adjust :: ChainwebVersion
-&gt; WindowWidth -&gt; TimeSpan Micros -&gt; HashTarget -&gt; HashTarget
</span><a href="Chainweb.Difficulty.html#adjust"><span class="hs-identifier hs-var hs-var">adjust</span></a></span></span><span> </span><span id="local-6989586621681479698"><span class="annot"><span class="annottext">ver :: ChainwebVersion
</span><a href="#local-6989586621681479698"><span class="hs-identifier hs-var">ver</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Chainweb.Version.html#WindowWidth"><span class="hs-identifier hs-type">WindowWidth</span></a></span><span> </span><span id="local-6989586621681479696"><span class="annot"><span class="annottext">ww :: Natural
</span><a href="#local-6989586621681479696"><span class="hs-identifier hs-var">ww</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Chainweb.Time.html#TimeSpan"><span class="hs-identifier hs-type">TimeSpan</span></a></span><span> </span><span id="local-6989586621681479694"><span class="annot"><span class="annottext">delta :: Micros
</span><a href="#local-6989586621681479694"><span class="hs-identifier hs-var">delta</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621681479693"><span class="annot"><span class="annottext">oldTarget :: HashTarget
</span><a href="#local-6989586621681479693"><span class="hs-identifier hs-var">oldTarget</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HashTarget
</span><a href="#local-6989586621681479692"><span class="hs-identifier hs-var">newTarget</span></a></span><span>
</span><span id="line-418"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-419"></span><span>    </span><span class="annot"><a href="#local-6989586621681479691"><span class="hs-identifier hs-type">br</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Natural</span></span><span>
</span><span id="line-420"></span><span>    </span><span id="local-6989586621681479691"><span class="annot"><span class="annottext">br :: Natural
</span><a href="#local-6989586621681479691"><span class="hs-identifier hs-var hs-var">br</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ChainwebVersion -&gt; BlockRate
</span><a href="Chainweb.Version.html#blockRate"><span class="hs-identifier hs-var">blockRate</span></a></span><span> </span><span class="annot"><span class="annottext">ChainwebVersion
</span><a href="#local-6989586621681479698"><span class="hs-identifier hs-var">ver</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-421"></span><span>        </span><span class="annot"><a href="Chainweb.Version.html#BlockRate"><span class="hs-identifier hs-type">BlockRate</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Chainweb.Time.html#Seconds"><span class="hs-identifier hs-type">Seconds</span></a></span><span> </span><span id="local-6989586621681479687"><span class="annot"><span class="annottext">n :: Integer
</span><a href="#local-6989586621681479687"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Natural
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="Chainweb.Utils.html#int"><span class="hs-identifier hs-var">int</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621681479687"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-422"></span><span>
</span><span id="line-423"></span><span>    </span><span class="hs-comment">-- The average time in seconds that it took to mine each block in</span><span>
</span><span id="line-424"></span><span>    </span><span class="hs-comment">-- the given window.</span><span>
</span><span id="line-425"></span><span>    </span><span class="annot"><a href="#local-6989586621681479686"><span class="hs-identifier hs-type">avg</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Rational</span></span><span>
</span><span id="line-426"></span><span>    </span><span id="local-6989586621681479686"><span class="annot"><span class="annottext">avg :: Rational
</span><a href="#local-6989586621681479686"><span class="hs-identifier hs-var hs-var">avg</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Micros
</span><a href="#local-6989586621681479694"><span class="hs-identifier hs-var">delta</span></a></span><span> </span><span class="annot"><span class="annottext">Micros -&gt; Micros -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Rational
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="hs-string">&quot;adjust: Impossibly negative delta!&quot;</span></span><span>
</span><span id="line-427"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Micros -&gt; Integer
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="Chainweb.Utils.html#int"><span class="hs-identifier hs-var">int</span></a></span><span> </span><span class="annot"><span class="annottext">Micros
</span><a href="#local-6989586621681479694"><span class="hs-identifier hs-var">delta</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Rational
forall a. Integral a =&gt; a -&gt; a -&gt; Ratio a
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Natural -&gt; Integer
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="Chainweb.Utils.html#int"><span class="hs-identifier hs-var">int</span></a></span><span> </span><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621681479696"><span class="hs-identifier hs-var">ww</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; Rational
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="annot"><span class="hs-number">1000000</span></span><span>
</span><span id="line-428"></span><span>
</span><span id="line-429"></span><span>    </span><span class="hs-comment">-- The mining difficulty of the previous block (the parent) as a</span><span>
</span><span id="line-430"></span><span>    </span><span class="hs-comment">-- function of its `HashTarget`.</span><span>
</span><span id="line-431"></span><span>    </span><span class="annot"><a href="#local-6989586621681479683"><span class="hs-identifier hs-type">oldDiff</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Rational</span></span><span>
</span><span id="line-432"></span><span>    </span><span id="local-6989586621681479683"><span class="annot"><span class="annottext">oldDiff :: Rational
</span><a href="#local-6989586621681479683"><span class="hs-identifier hs-var hs-var">oldDiff</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HashTarget -&gt; Rational
</span><a href="Chainweb.Difficulty.html#targetToDifficultyR"><span class="hs-identifier hs-var">targetToDifficultyR</span></a></span><span> </span><span class="annot"><span class="annottext">HashTarget
</span><a href="#local-6989586621681479693"><span class="hs-identifier hs-var">oldTarget</span></a></span><span>
</span><span id="line-433"></span><span>
</span><span id="line-434"></span><span>    </span><span class="hs-comment">-- The adjusted difficulty, following the formula explained in the</span><span>
</span><span id="line-435"></span><span>    </span><span class="hs-comment">-- docstring of this function.</span><span>
</span><span id="line-436"></span><span>    </span><span class="annot"><a href="#local-6989586621681479682"><span class="hs-identifier hs-type">newDiff</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Rational</span></span><span>
</span><span id="line-437"></span><span>    </span><span id="local-6989586621681479682"><span class="annot"><span class="annottext">newDiff :: Rational
</span><a href="#local-6989586621681479682"><span class="hs-identifier hs-var hs-var">newDiff</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621681479683"><span class="hs-identifier hs-var">oldDiff</span></a></span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; Rational
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Natural -&gt; Rational
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="Chainweb.Utils.html#int"><span class="hs-identifier hs-var">int</span></a></span><span> </span><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621681479691"><span class="hs-identifier hs-var">br</span></a></span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; Rational
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621681479686"><span class="hs-identifier hs-var">avg</span></a></span><span>
</span><span id="line-438"></span><span>
</span><span id="line-439"></span><span>    </span><span class="annot"><a href="#local-6989586621681479692"><span class="hs-identifier hs-type">newTarget</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Chainweb.Difficulty.html#HashTarget"><span class="hs-identifier hs-type">HashTarget</span></a></span><span>
</span><span id="line-440"></span><span>    </span><span id="local-6989586621681479692"><span class="annot"><span class="annottext">newTarget :: HashTarget
</span><a href="#local-6989586621681479692"><span class="hs-identifier hs-var hs-var">newTarget</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; HashTarget
</span><a href="Chainweb.Difficulty.html#difficultyToTargetR"><span class="hs-identifier hs-var">difficultyToTargetR</span></a></span><span> </span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621681479682"><span class="hs-identifier hs-var">newDiff</span></a></span><span>
</span><span id="line-441"></span><span>
</span><span id="line-442"></span><span class="hs-comment">-- -------------------------------------------------------------------------- --</span><span>
</span><span id="line-443"></span><span class="hs-comment">-- Properties</span><span>
</span><span id="line-444"></span><span>
</span><span id="line-445"></span><span class="annot"><a href="Chainweb.Difficulty.html#prop_littleEndian"><span class="hs-identifier hs-type">prop_littleEndian</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-446"></span><span id="prop_littleEndian"><span class="annot"><span class="annottext">prop_littleEndian :: Bool
</span><a href="Chainweb.Difficulty.html#prop_littleEndian"><span class="hs-identifier hs-var hs-var">prop_littleEndian</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Bool) -&gt; [Int] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">all</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Bool
</span><a href="#local-6989586621681479679"><span class="hs-identifier hs-var">run</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-number">1</span></span><span class="hs-glyph">..</span><span class="annot"><span class="hs-number">31</span></span><span class="hs-special">]</span><span>
</span><span id="line-447"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-448"></span><span>    </span><span id="local-6989586621681479679"><span class="annot"><span class="annottext">run :: Int -&gt; Bool
</span><a href="#local-6989586621681479679"><span class="hs-identifier hs-var hs-var">run</span></a></span></span><span> </span><span id="local-6989586621681479678"><span class="annot"><span class="annottext">i :: Int
</span><a href="#local-6989586621681479678"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">(==)</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681479678"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-449"></span><span>        </span><span class="annot"><span class="annottext">(Int -&gt; Bool) -&gt; Int -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Word8] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span>
</span><span id="line-450"></span><span>        </span><span class="annot"><span class="annottext">([Word8] -&gt; Int) -&gt; [Word8] -&gt; Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Word8 -&gt; Bool) -&gt; [Word8] -&gt; [Word8]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">takeWhile</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word8 -&gt; Word8 -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="hs-number">0x00</span></span><span class="hs-special">)</span><span>
</span><span id="line-451"></span><span>        </span><span class="annot"><span class="annottext">([Word8] -&gt; [Word8]) -&gt; [Word8] -&gt; [Word8]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Word8] -&gt; [Word8]
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">reverse</span></span><span>
</span><span id="line-452"></span><span>        </span><span class="annot"><span class="annottext">([Word8] -&gt; [Word8]) -&gt; [Word8] -&gt; [Word8]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; [Word8]
</span><span class="hs-identifier hs-var">B.unpack</span></span><span>
</span><span id="line-453"></span><span>        </span><span class="annot"><span class="annottext">(ByteString -&gt; [Word8]) -&gt; ByteString -&gt; [Word8]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Put -&gt; ByteString
</span><span class="hs-identifier hs-var">runPutS</span></span><span>
</span><span id="line-454"></span><span>        </span><span class="annot"><span class="annottext">(Put -&gt; ByteString) -&gt; Put -&gt; ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">PowHashNat -&gt; Put
forall (m :: * -&gt; *). MonadPut m =&gt; PowHashNat -&gt; m ()
</span><a href="Chainweb.Difficulty.html#encodePowHashNat"><span class="hs-identifier hs-var">encodePowHashNat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PowHashNat
forall a. Bounded a =&gt; a
</span><span class="hs-identifier hs-var">maxBound</span></span><span> </span><span class="annot"><span class="annottext">PowHashNat -&gt; PowHashNat -&gt; PowHashNat
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`div`</span></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span class="annot"><span class="annottext">PowHashNat -&gt; Int -&gt; PowHashNat
forall a b. (Num a, Integral b) =&gt; a -&gt; b -&gt; a
</span><span class="hs-operator hs-var">^</span></span><span class="hs-special">(</span><span class="annot"><span class="hs-number">8</span></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681479678"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-455"></span><span>
</span><span id="line-456"></span><span class="annot"><a href="Chainweb.Difficulty.html#properties"><span class="hs-identifier hs-type">properties</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Property</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-457"></span><span id="properties"><span class="annot"><span class="annottext">properties :: [(String, Property)]
</span><a href="Chainweb.Difficulty.html#properties"><span class="hs-identifier hs-var hs-var">properties</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-458"></span><span>    </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-string">&quot;BlockHashNat is encoded as little endian&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Property
forall prop. Testable prop =&gt; prop -&gt; Property
</span><span class="hs-identifier hs-var">property</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="Chainweb.Difficulty.html#prop_littleEndian"><span class="hs-identifier hs-var">prop_littleEndian</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-459"></span><span>    </span><span class="hs-special">]</span><span>
</span><span id="line-460"></span></pre></body></html>