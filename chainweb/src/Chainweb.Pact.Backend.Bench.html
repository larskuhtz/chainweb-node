<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE BangPatterns #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE LambdaCase #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE OverloadedStrings #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE RecordWildCards #-}</span><span>
</span><span id="line-5"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Chainweb.Pact.Backend.Bench</span><span>
</span><span id="line-6"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Chainweb.Pact.Backend.Bench.html#bench"><span class="hs-identifier">bench</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-7"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-8"></span><span>
</span><span id="line-9"></span><span>
</span><span id="line-10"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Concurrent</span></span><span>
</span><span id="line-11"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad</span></span><span>
</span><span id="line-12"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Catch</span></span><span>
</span><span id="line-13"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Criterion.Main</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">C</span></span><span>
</span><span id="line-14"></span><span>
</span><span id="line-15"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.String.Conv</span></span><span>
</span><span id="line-16"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.ByteString</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">B</span></span><span>
</span><span id="line-17"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Map.Strict</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">M</span></span><span>
</span><span id="line-18"></span><span>
</span><span id="line-19"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">System.IO.Extra</span></span><span>
</span><span id="line-20"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">System.Random</span></span><span>
</span><span id="line-21"></span><span>
</span><span id="line-22"></span><span class="hs-comment">-- pact imports</span><span>
</span><span id="line-23"></span><span>
</span><span id="line-24"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Pact.Interpreter</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">PactDbEnv</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">mkPactDbEnv</span></span><span class="hs-special">)</span><span>
</span><span id="line-25"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Pact.PersistPactDb</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">DbEnv</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">initDbEnv</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">pactdb</span></span><span class="hs-special">)</span><span>
</span><span id="line-26"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Pact.Types.Exp</span></span><span>
</span><span id="line-27"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Pact.Types.Logger</span></span><span>
</span><span id="line-28"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Pact.Types.PactValue</span></span><span>
</span><span id="line-29"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Pact.Types.Persistence</span></span><span>
</span><span id="line-30"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Pact.Types.Term</span></span><span>
</span><span id="line-31"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Pact.Types.Util</span></span><span>
</span><span id="line-32"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Pact.Interpreter</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">PI</span></span><span>
</span><span id="line-33"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Pact.Persist.SQLite</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">PSQL</span></span><span>
</span><span id="line-34"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Pact.Types.SQLite</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">PSQL</span></span><span>
</span><span id="line-35"></span><span>
</span><span id="line-36"></span><span class="hs-comment">-- chainweb imports</span><span>
</span><span id="line-37"></span><span>
</span><span id="line-38"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Chainweb.BlockHash.html"><span class="hs-identifier">Chainweb.BlockHash</span></a></span><span>
</span><span id="line-39"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Chainweb.BlockHeader.html"><span class="hs-identifier">Chainweb.BlockHeader</span></a></span><span>
</span><span id="line-40"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Chainweb.MerkleLogHash.html"><span class="hs-identifier">Chainweb.MerkleLogHash</span></a></span><span>
</span><span id="line-41"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Chainweb.Pact.Backend.RelationalCheckpointer.html"><span class="hs-identifier">Chainweb.Pact.Backend.RelationalCheckpointer</span></a></span><span>
</span><span id="line-42"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Chainweb.Pact.Backend.Types.html"><span class="hs-identifier">Chainweb.Pact.Backend.Types</span></a></span><span>
</span><span id="line-43"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Chainweb.Pact.Backend.Utils.html"><span class="hs-identifier">Chainweb.Pact.Backend.Utils</span></a></span><span>
</span><span id="line-44"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Chainweb.Utils.Bench.html"><span class="hs-identifier">Chainweb.Utils.Bench</span></a></span><span>
</span><span id="line-45"></span><span>
</span><span id="line-46"></span><span class="annot"><a href="Chainweb.Pact.Backend.Bench.html#bench"><span class="hs-identifier hs-type">bench</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">C.Benchmark</span></span><span>
</span><span id="line-47"></span><span id="bench"><span class="annot"><span class="annottext">bench :: Benchmark
</span><a href="Chainweb.Pact.Backend.Bench.html#bench"><span class="hs-identifier hs-var hs-var">bench</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; [Benchmark] -&gt; Benchmark
</span><span class="hs-identifier hs-var">C.bgroup</span></span><span> </span><span class="annot"><span class="hs-string">&quot;pact-backend&quot;</span></span><span> </span><span class="annot"><span class="annottext">([Benchmark] -&gt; Benchmark) -&gt; [Benchmark] -&gt; Benchmark
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-48"></span><span>        </span><span class="annot"><span class="annottext">[Int -&gt; Benchmark] -&gt; [Benchmark]
forall b. [Int -&gt; b] -&gt; [b]
</span><a href="#local-6989586621681489877"><span class="hs-identifier hs-var">play</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; (PactDbEnv (DbEnv SQLite) -&gt; Benchmark) -&gt; Benchmark
</span><a href="Chainweb.Pact.Backend.Bench.html#pactSqliteWithBench"><span class="hs-identifier hs-var">pactSqliteWithBench</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="annot"><span class="annottext">((PactDbEnv (DbEnv SQLite) -&gt; Benchmark) -&gt; Benchmark)
-&gt; (Int -&gt; PactDbEnv (DbEnv SQLite) -&gt; Benchmark)
-&gt; Int
-&gt; Benchmark
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; PactDbEnv (DbEnv SQLite) -&gt; Benchmark
forall e. Int -&gt; PactDbEnv e -&gt; Benchmark
</span><a href="Chainweb.Pact.Backend.Bench.html#benchUserTable"><span class="hs-identifier hs-var">benchUserTable</span></a></span><span>
</span><span id="line-49"></span><span>             </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; (PactDbEnv (DbEnv SQLite) -&gt; Benchmark) -&gt; Benchmark
</span><a href="Chainweb.Pact.Backend.Bench.html#pactSqliteWithBench"><span class="hs-identifier hs-var">pactSqliteWithBench</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="annot"><span class="annottext">((PactDbEnv (DbEnv SQLite) -&gt; Benchmark) -&gt; Benchmark)
-&gt; (Int -&gt; PactDbEnv (DbEnv SQLite) -&gt; Benchmark)
-&gt; Int
-&gt; Benchmark
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; PactDbEnv (DbEnv SQLite) -&gt; Benchmark
forall e. Int -&gt; PactDbEnv e -&gt; Benchmark
</span><a href="Chainweb.Pact.Backend.Bench.html#benchUserTable"><span class="hs-identifier hs-var">benchUserTable</span></a></span><span>
</span><span id="line-50"></span><span>             </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; (PactDbEnv (DbEnv SQLite) -&gt; Benchmark) -&gt; Benchmark
</span><a href="Chainweb.Pact.Backend.Bench.html#pactSqliteWithBench"><span class="hs-identifier hs-var">pactSqliteWithBench</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="annot"><span class="annottext">((PactDbEnv (DbEnv SQLite) -&gt; Benchmark) -&gt; Benchmark)
-&gt; (Int -&gt; PactDbEnv (DbEnv SQLite) -&gt; Benchmark)
-&gt; Int
-&gt; Benchmark
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; PactDbEnv (DbEnv SQLite) -&gt; Benchmark
forall e. Int -&gt; PactDbEnv e -&gt; Benchmark
</span><a href="Chainweb.Pact.Backend.Bench.html#benchUserTableForKeys"><span class="hs-identifier hs-var">benchUserTableForKeys</span></a></span><span>
</span><span id="line-51"></span><span>             </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; (PactDbEnv (DbEnv SQLite) -&gt; Benchmark) -&gt; Benchmark
</span><a href="Chainweb.Pact.Backend.Bench.html#pactSqliteWithBench"><span class="hs-identifier hs-var">pactSqliteWithBench</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="annot"><span class="annottext">((PactDbEnv (DbEnv SQLite) -&gt; Benchmark) -&gt; Benchmark)
-&gt; (Int -&gt; PactDbEnv (DbEnv SQLite) -&gt; Benchmark)
-&gt; Int
-&gt; Benchmark
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; PactDbEnv (DbEnv SQLite) -&gt; Benchmark
forall e. Int -&gt; PactDbEnv e -&gt; Benchmark
</span><a href="Chainweb.Pact.Backend.Bench.html#benchUserTableForKeys"><span class="hs-identifier hs-var">benchUserTableForKeys</span></a></span><span>
</span><span id="line-52"></span><span>             </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(CheckpointEnv -&gt; Benchmark) -&gt; Benchmark
</span><a href="Chainweb.Pact.Backend.Bench.html#cpWithBench"><span class="hs-identifier hs-var">cpWithBench</span></a></span><span> </span><span class="annot"><span class="annottext">((CheckpointEnv -&gt; Benchmark) -&gt; Benchmark)
-&gt; (Int -&gt; CheckpointEnv -&gt; Benchmark) -&gt; Int -&gt; Benchmark
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; CheckpointEnv -&gt; Benchmark
</span><a href="Chainweb.Pact.Backend.Bench.html#cpBenchNoRewindOverBlock"><span class="hs-identifier hs-var">cpBenchNoRewindOverBlock</span></a></span><span>
</span><span id="line-53"></span><span>             </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(CheckpointEnv -&gt; Benchmark) -&gt; Benchmark
</span><a href="Chainweb.Pact.Backend.Bench.html#cpWithBench"><span class="hs-identifier hs-var">cpWithBench</span></a></span><span> </span><span class="annot"><span class="annottext">((CheckpointEnv -&gt; Benchmark) -&gt; Benchmark)
-&gt; (Int -&gt; CheckpointEnv -&gt; Benchmark) -&gt; Int -&gt; Benchmark
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; CheckpointEnv -&gt; Benchmark
</span><a href="Chainweb.Pact.Backend.Bench.html#cpBenchOverBlock"><span class="hs-identifier hs-var">cpBenchOverBlock</span></a></span><span>
</span><span id="line-54"></span><span>             </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(CheckpointEnv -&gt; Benchmark) -&gt; Benchmark
</span><a href="Chainweb.Pact.Backend.Bench.html#cpWithBench"><span class="hs-identifier hs-var">cpWithBench</span></a></span><span> </span><span class="annot"><span class="annottext">((CheckpointEnv -&gt; Benchmark) -&gt; Benchmark)
-&gt; (Int -&gt; CheckpointEnv -&gt; Benchmark) -&gt; Int -&gt; Benchmark
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; CheckpointEnv -&gt; Benchmark
</span><a href="Chainweb.Pact.Backend.Bench.html#cpBenchSampleKeys"><span class="hs-identifier hs-var">cpBenchSampleKeys</span></a></span><span>
</span><span id="line-55"></span><span>             </span><span class="hs-comment">-- , cpWithBench . cpBenchKeys</span><span>
</span><span id="line-56"></span><span>             </span><span class="hs-special">]</span><span>
</span><span id="line-57"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-58"></span><span>    </span><span id="local-6989586621681489868"><span class="annot"><span class="annottext">testPoints :: [Int]
</span><a href="#local-6989586621681489868"><span class="hs-identifier hs-var hs-var">testPoints</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-number">5</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-number">10</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-number">20</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-number">50</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-number">100</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-number">200</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-number">500</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-number">1000</span></span><span class="hs-special">]</span><span>
</span><span id="line-59"></span><span>
</span><span id="line-60"></span><span>    </span><span id="local-6989586621681489877"><span class="annot"><span class="annottext">play :: [Int -&gt; b] -&gt; [b]
</span><a href="#local-6989586621681489877"><span class="hs-identifier hs-var hs-var">play</span></a></span></span><span> </span><span id="local-6989586621681489867"><span class="annot"><span class="annottext">benches :: [Int -&gt; b]
</span><a href="#local-6989586621681489867"><span class="hs-identifier hs-var">benches</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Int -&gt; [b]) -&gt; [Int] -&gt; [b]
forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><span class="hs-identifier hs-var">concatMap</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; [b]
</span><a href="#local-6989586621681489865"><span class="hs-identifier hs-var">playOne</span></a></span><span> </span><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621681489868"><span class="hs-identifier hs-var">testPoints</span></a></span><span>
</span><span id="line-61"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-62"></span><span>        </span><span id="local-6989586621681489865"><span class="annot"><span class="annottext">playOne :: Int -&gt; [b]
</span><a href="#local-6989586621681489865"><span class="hs-identifier hs-var hs-var">playOne</span></a></span></span><span> </span><span id="local-6989586621681489864"><span class="annot"><span class="annottext">n :: Int
</span><a href="#local-6989586621681489864"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((Int -&gt; b) -&gt; b) -&gt; [Int -&gt; b] -&gt; [b]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Int -&gt; b) -&gt; Int -&gt; b
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681489864"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Int -&gt; b]
</span><a href="#local-6989586621681489867"><span class="hs-identifier hs-var">benches</span></a></span><span>
</span><span id="line-63"></span><span>
</span><span id="line-64"></span><span class="annot"><a href="Chainweb.Pact.Backend.Bench.html#pactSqliteWithBench"><span class="hs-identifier hs-type">pactSqliteWithBench</span></a></span><span>
</span><span id="line-65"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-66"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">PactDbEnv</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">DbEnv</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">PSQL.SQLite</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">C.Benchmark</span></span><span class="hs-special">)</span><span>
</span><span id="line-67"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">C.Benchmark</span></span><span>
</span><span id="line-68"></span><span id="pactSqliteWithBench"><span class="annot"><span class="annottext">pactSqliteWithBench :: Bool -&gt; (PactDbEnv (DbEnv SQLite) -&gt; Benchmark) -&gt; Benchmark
</span><a href="Chainweb.Pact.Backend.Bench.html#pactSqliteWithBench"><span class="hs-identifier hs-var hs-var">pactSqliteWithBench</span></a></span></span><span> </span><span id="local-6989586621681489863"><span class="annot"><span class="annottext">unsafe :: Bool
</span><a href="#local-6989586621681489863"><span class="hs-keyword hs-var">unsafe</span></a></span></span><span> </span><span id="local-6989586621681489862"><span class="annot"><span class="annottext">benchtorun :: PactDbEnv (DbEnv SQLite) -&gt; Benchmark
</span><a href="#local-6989586621681489862"><span class="hs-identifier hs-var">benchtorun</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-69"></span><span>    </span><span class="annot"><span class="annottext">IO (NoopNFData (PactDbEnv (DbEnv SQLite), IO ()))
-&gt; (NoopNFData (PactDbEnv (DbEnv SQLite), IO ()) -&gt; IO ())
-&gt; (NoopNFData (PactDbEnv (DbEnv SQLite), IO ()) -&gt; Benchmark)
-&gt; Benchmark
forall env a.
NFData env =&gt;
IO env -&gt; (env -&gt; IO a) -&gt; (env -&gt; Benchmark) -&gt; Benchmark
</span><span class="hs-identifier hs-var">C.envWithCleanup</span></span><span> </span><span class="annot"><span class="annottext">IO (NoopNFData (PactDbEnv (DbEnv SQLite), IO ()))
</span><a href="#local-6989586621681489860"><span class="hs-identifier hs-var">setup</span></a></span><span> </span><span class="annot"><span class="annottext">NoopNFData (PactDbEnv (DbEnv SQLite), IO ()) -&gt; IO ()
forall b. NoopNFData (PactDbEnv (DbEnv SQLite), IO b) -&gt; IO b
</span><a href="#local-6989586621681489859"><span class="hs-identifier hs-var">teardown</span></a></span><span>
</span><span id="line-70"></span><span>    </span><span class="annot"><span class="annottext">((NoopNFData (PactDbEnv (DbEnv SQLite), IO ()) -&gt; Benchmark)
 -&gt; Benchmark)
-&gt; (NoopNFData (PactDbEnv (DbEnv SQLite), IO ()) -&gt; Benchmark)
-&gt; Benchmark
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span> </span><span class="hs-glyph">~</span><span class="hs-special">(</span><span class="annot"><a href="Chainweb.Utils.Bench.html#NoopNFData"><span class="hs-identifier hs-type">NoopNFData</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621681489857"><span class="annot"><span class="annottext">e :: PactDbEnv (DbEnv SQLite)
</span><a href="#local-6989586621681489857"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">,</span><span class="hs-identifier">_</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; [Benchmark] -&gt; Benchmark
</span><span class="hs-identifier hs-var">C.bgroup</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621681489856"><span class="hs-identifier hs-var">tname</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PactDbEnv (DbEnv SQLite) -&gt; [Benchmark]
</span><a href="#local-6989586621681489855"><span class="hs-identifier hs-var">benches</span></a></span><span> </span><span class="annot"><span class="annottext">PactDbEnv (DbEnv SQLite)
</span><a href="#local-6989586621681489857"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-71"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-72"></span><span>    </span><span id="local-6989586621681489856"><span class="annot"><span class="annottext">tname :: String
</span><a href="#local-6989586621681489856"><span class="hs-identifier hs-var hs-var">tname</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[String] -&gt; String
forall a. Monoid a =&gt; [a] -&gt; a
</span><span class="hs-identifier hs-var">mconcat</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="hs-string">&quot;pact-sqlite/&quot;</span></span><span>
</span><span id="line-73"></span><span>                    </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681489863"><span class="hs-keyword hs-var">unsafe</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="hs-string">&quot;unsafe&quot;</span></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="hs-string">&quot;safe&quot;</span></span><span>
</span><span id="line-74"></span><span>                    </span><span class="hs-special">]</span><span>
</span><span id="line-75"></span><span>    </span><span id="local-6989586621681489854"><span class="annot"><span class="annottext">prags :: [Pragma]
</span><a href="#local-6989586621681489854"><span class="hs-identifier hs-var hs-var">prags</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681489863"><span class="hs-keyword hs-var">unsafe</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">[Pragma]
</span><span class="hs-identifier hs-var">PSQL.fastNoJournalPragmas</span></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">[Pragma]
</span><a href="Chainweb.Pact.Backend.Utils.html#chainwebPragmas"><span class="hs-identifier hs-var">chainwebPragmas</span></a></span><span>
</span><span id="line-76"></span><span>    </span><span id="local-6989586621681489860"><span class="annot"><span class="annottext">setup :: IO (NoopNFData (PactDbEnv (DbEnv SQLite), IO ()))
</span><a href="#local-6989586621681489860"><span class="hs-identifier hs-var hs-var">setup</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-77"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621681489851"><span class="annot"><span class="annottext">f :: String
</span><a href="#local-6989586621681489851"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621681489850"><span class="annot"><span class="annottext">deleter :: IO ()
</span><a href="#local-6989586621681489850"><span class="hs-identifier hs-var">deleter</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO (String, IO ())
</span><span class="hs-identifier hs-var">newTempFile</span></span><span>
</span><span id="line-78"></span><span>        </span><span class="hs-glyph">!</span><span id="local-6989586621681489848"><span class="annot"><span class="annottext">SQLite
</span><a href="#local-6989586621681489848"><span class="hs-identifier hs-var">sqliteEnv</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">SQLiteConfig -&gt; Loggers -&gt; IO SQLite
</span><span class="hs-identifier hs-var">PSQL.initSQLite</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; [Pragma] -&gt; SQLiteConfig
</span><span class="hs-identifier hs-var">PSQL.SQLiteConfig</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621681489851"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">[Pragma]
</span><a href="#local-6989586621681489854"><span class="hs-identifier hs-var">prags</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Loggers
</span><span class="hs-identifier hs-var">neverLog</span></span><span>
</span><span id="line-79"></span><span>        </span><span id="local-6989586621681489844"><span class="annot"><span class="annottext">PactDbEnv (DbEnv SQLite)
</span><a href="#local-6989586621681489844"><span class="hs-identifier hs-var">dbe</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">PactDb (DbEnv SQLite)
-&gt; DbEnv SQLite -&gt; IO (PactDbEnv (DbEnv SQLite))
forall e. PactDb e -&gt; e -&gt; IO (PactDbEnv e)
</span><span class="hs-identifier hs-var">mkPactDbEnv</span></span><span> </span><span class="annot"><span class="annottext">PactDb (DbEnv SQLite)
forall p. PactDb (DbEnv p)
</span><span class="hs-identifier hs-var">pactdb</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Loggers -&gt; Persister SQLite -&gt; SQLite -&gt; DbEnv SQLite
forall p. Loggers -&gt; Persister p -&gt; p -&gt; DbEnv p
</span><span class="hs-identifier hs-var">initDbEnv</span></span><span> </span><span class="annot"><span class="annottext">Loggers
</span><span class="hs-identifier hs-var">neverLog</span></span><span> </span><span class="annot"><span class="annottext">Persister SQLite
</span><span class="hs-identifier hs-var">PSQL.persister</span></span><span> </span><span class="annot"><span class="annottext">SQLite
</span><a href="#local-6989586621681489848"><span class="hs-identifier hs-var">sqliteEnv</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-80"></span><span>        </span><span class="annot"><span class="annottext">PactDbEnv (DbEnv SQLite) -&gt; IO ()
forall p. PactDbEnv (DbEnv p) -&gt; IO ()
</span><span class="hs-identifier hs-var">PI.initSchema</span></span><span> </span><span class="annot"><span class="annottext">PactDbEnv (DbEnv SQLite)
</span><a href="#local-6989586621681489844"><span class="hs-identifier hs-var">dbe</span></a></span><span>
</span><span id="line-81"></span><span>        </span><span class="annot"><span class="annottext">NoopNFData (PactDbEnv (DbEnv SQLite), IO ())
-&gt; IO (NoopNFData (PactDbEnv (DbEnv SQLite), IO ()))
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(NoopNFData (PactDbEnv (DbEnv SQLite), IO ())
 -&gt; IO (NoopNFData (PactDbEnv (DbEnv SQLite), IO ())))
-&gt; NoopNFData (PactDbEnv (DbEnv SQLite), IO ())
-&gt; IO (NoopNFData (PactDbEnv (DbEnv SQLite), IO ()))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(PactDbEnv (DbEnv SQLite), IO ())
-&gt; NoopNFData (PactDbEnv (DbEnv SQLite), IO ())
forall a. a -&gt; NoopNFData a
</span><a href="Chainweb.Utils.Bench.html#NoopNFData"><span class="hs-identifier hs-var">NoopNFData</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PactDbEnv (DbEnv SQLite)
</span><a href="#local-6989586621681489844"><span class="hs-identifier hs-var">dbe</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">IO ()
</span><a href="#local-6989586621681489850"><span class="hs-identifier hs-var">deleter</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-82"></span><span>
</span><span id="line-83"></span><span>    </span><span id="local-6989586621681489859"><span class="annot"><span class="annottext">teardown :: NoopNFData (PactDbEnv (DbEnv SQLite), IO b) -&gt; IO b
</span><a href="#local-6989586621681489859"><span class="hs-identifier hs-var hs-var">teardown</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Chainweb.Utils.Bench.html#NoopNFData"><span class="hs-identifier hs-type">NoopNFData</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">PactDbEnv</span></span><span> </span><span class="hs-identifier">_</span><span> </span><span id="local-6989586621681489840"><span class="annot"><span class="annottext">e :: MVar (DbEnv SQLite)
</span><a href="#local-6989586621681489840"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681489839"><span class="annot"><span class="annottext">deleter :: IO b
</span><a href="#local-6989586621681489839"><span class="hs-identifier hs-var">deleter</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-84"></span><span>        </span><span id="local-6989586621681489838"><span class="annot"><span class="annottext">DbEnv SQLite
</span><a href="#local-6989586621681489838"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">MVar (DbEnv SQLite) -&gt; IO (DbEnv SQLite)
forall a. MVar a -&gt; IO a
</span><span class="hs-identifier hs-var">readMVar</span></span><span> </span><span class="annot"><span class="annottext">MVar (DbEnv SQLite)
</span><a href="#local-6989586621681489840"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-85"></span><span>        </span><span class="annot"><span class="annottext">IO (Either String ()) -&gt; IO ()
forall (f :: * -&gt; *) a. Functor f =&gt; f a -&gt; f ()
</span><span class="hs-identifier hs-var">void</span></span><span> </span><span class="annot"><span class="annottext">(IO (Either String ()) -&gt; IO ()) -&gt; IO (Either String ()) -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SQLite -&gt; IO (Either String ())
</span><span class="hs-identifier hs-var">PSQL.closeSQLite</span></span><span> </span><span class="annot"><span class="annottext">(SQLite -&gt; IO (Either String ()))
-&gt; SQLite -&gt; IO (Either String ())
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">DbEnv SQLite -&gt; SQLite
forall p. DbEnv p -&gt; p
</span><span class="hs-identifier hs-var hs-var">_db</span></span><span> </span><span class="annot"><span class="annottext">DbEnv SQLite
</span><a href="#local-6989586621681489838"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-86"></span><span>        </span><span class="annot"><span class="annottext">IO b
</span><a href="#local-6989586621681489839"><span class="hs-identifier hs-var">deleter</span></a></span><span>
</span><span id="line-87"></span><span>
</span><span id="line-88"></span><span>    </span><span class="annot"><a href="#local-6989586621681489855"><span class="hs-identifier hs-type">benches</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">PactDbEnv</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">DbEnv</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">PSQL.SQLite</span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">C.Benchmark</span></span><span class="hs-special">]</span><span>
</span><span id="line-89"></span><span>    </span><span id="local-6989586621681489855"><span class="annot"><span class="annottext">benches :: PactDbEnv (DbEnv SQLite) -&gt; [Benchmark]
</span><a href="#local-6989586621681489855"><span class="hs-identifier hs-var hs-var">benches</span></a></span></span><span> </span><span id="local-6989586621681489833"><span class="annot"><span class="annottext">dbEnv :: PactDbEnv (DbEnv SQLite)
</span><a href="#local-6989586621681489833"><span class="hs-identifier hs-var">dbEnv</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-90"></span><span>        </span><span class="hs-special">[</span><span>
</span><span id="line-91"></span><span>          </span><span class="annot"><span class="annottext">PactDbEnv (DbEnv SQLite) -&gt; Benchmark
</span><a href="#local-6989586621681489862"><span class="hs-identifier hs-var">benchtorun</span></a></span><span> </span><span class="annot"><span class="annottext">PactDbEnv (DbEnv SQLite)
</span><a href="#local-6989586621681489833"><span class="hs-identifier hs-var">dbEnv</span></a></span><span>
</span><span id="line-92"></span><span>        </span><span class="hs-special">]</span><span>
</span><span id="line-93"></span><span>
</span><span id="line-94"></span><span class="annot"><a href="Chainweb.Pact.Backend.Bench.html#cpWithBench"><span class="hs-identifier hs-type">cpWithBench</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Chainweb.Pact.Backend.Types.html#CheckpointEnv"><span class="hs-identifier hs-type">CheckpointEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">C.Benchmark</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">C.Benchmark</span></span><span>
</span><span id="line-95"></span><span id="cpWithBench"><span class="annot"><span class="annottext">cpWithBench :: (CheckpointEnv -&gt; Benchmark) -&gt; Benchmark
</span><a href="Chainweb.Pact.Backend.Bench.html#cpWithBench"><span class="hs-identifier hs-var hs-var">cpWithBench</span></a></span></span><span> </span><span id="local-6989586621681489832"><span class="annot"><span class="annottext">torun :: CheckpointEnv -&gt; Benchmark
</span><a href="#local-6989586621681489832"><span class="hs-identifier hs-var">torun</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-96"></span><span>    </span><span class="annot"><span class="annottext">IO (NoopNFData (SQLiteEnv, CheckpointEnv, IO ()))
-&gt; (NoopNFData (SQLiteEnv, CheckpointEnv, IO ()) -&gt; IO ())
-&gt; (NoopNFData (SQLiteEnv, CheckpointEnv, IO ()) -&gt; Benchmark)
-&gt; Benchmark
forall env a.
NFData env =&gt;
IO env -&gt; (env -&gt; IO a) -&gt; (env -&gt; Benchmark) -&gt; Benchmark
</span><span class="hs-identifier hs-var">C.envWithCleanup</span></span><span> </span><span class="annot"><span class="annottext">IO (NoopNFData (SQLiteEnv, CheckpointEnv, IO ()))
</span><a href="#local-6989586621681489831"><span class="hs-identifier hs-var">setup</span></a></span><span> </span><span class="annot"><span class="annottext">NoopNFData (SQLiteEnv, CheckpointEnv, IO ()) -&gt; IO ()
forall b b. NoopNFData (SQLiteEnv, b, IO b) -&gt; IO b
</span><a href="#local-6989586621681489830"><span class="hs-identifier hs-var">teardown</span></a></span><span> </span><span class="annot"><span class="annottext">((NoopNFData (SQLiteEnv, CheckpointEnv, IO ()) -&gt; Benchmark)
 -&gt; Benchmark)
-&gt; (NoopNFData (SQLiteEnv, CheckpointEnv, IO ()) -&gt; Benchmark)
-&gt; Benchmark
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span> </span><span class="hs-glyph">~</span><span class="hs-special">(</span><span class="annot"><a href="Chainweb.Utils.Bench.html#NoopNFData"><span class="hs-identifier hs-type">NoopNFData</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span id="local-6989586621681489829"><span class="annot"><span class="annottext">e :: CheckpointEnv
</span><a href="#local-6989586621681489829"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">,</span><span class="hs-identifier">_</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-97"></span><span>                                        </span><span class="annot"><span class="annottext">String -&gt; [Benchmark] -&gt; Benchmark
</span><span class="hs-identifier hs-var">C.bgroup</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621681489828"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CheckpointEnv -&gt; [Benchmark]
</span><a href="#local-6989586621681489827"><span class="hs-identifier hs-var">benches</span></a></span><span> </span><span class="annot"><span class="annottext">CheckpointEnv
</span><a href="#local-6989586621681489829"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-98"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-99"></span><span>
</span><span id="line-100"></span><span>    </span><span id="local-6989586621681489828"><span class="annot"><span class="annottext">name :: String
</span><a href="#local-6989586621681489828"><span class="hs-identifier hs-var hs-var">name</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-string">&quot;batchedCheckpointer&quot;</span></span><span>
</span><span id="line-101"></span><span>
</span><span id="line-102"></span><span>    </span><span id="local-6989586621681489831"><span class="annot"><span class="annottext">setup :: IO (NoopNFData (SQLiteEnv, CheckpointEnv, IO ()))
</span><a href="#local-6989586621681489831"><span class="hs-identifier hs-var hs-var">setup</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-103"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621681489826"><span class="annot"><span class="annottext">f :: String
</span><a href="#local-6989586621681489826"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681489825"><span class="annot"><span class="annottext">deleter :: IO ()
</span><a href="#local-6989586621681489825"><span class="hs-identifier hs-var">deleter</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO (String, IO ())
</span><span class="hs-identifier hs-var">newTempFile</span></span><span>
</span><span id="line-104"></span><span>        </span><span class="hs-glyph">!</span><span id="local-6989586621681489824"><span class="annot"><span class="annottext">SQLiteEnv
</span><a href="#local-6989586621681489824"><span class="hs-identifier hs-var">sqliteEnv</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String -&gt; [Pragma] -&gt; IO SQLiteEnv
</span><a href="Chainweb.Pact.Backend.Utils.html#openSQLiteConnection"><span class="hs-identifier hs-var">openSQLiteConnection</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621681489826"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">[Pragma]
</span><a href="Chainweb.Pact.Backend.Utils.html#chainwebPragmas"><span class="hs-identifier hs-var">chainwebPragmas</span></a></span><span>
</span><span id="line-105"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681489822"><span class="annot"><span class="annottext">nolog :: Logger
</span><a href="#local-6989586621681489822"><span class="hs-identifier hs-var hs-var">nolog</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Loggers -&gt; LogName -&gt; Logger
</span><span class="hs-identifier hs-var hs-var">newLogger</span></span><span> </span><span class="annot"><span class="annottext">Loggers
</span><span class="hs-identifier hs-var">neverLog</span></span><span> </span><span class="annot"><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-106"></span><span>        </span><span class="hs-glyph">!</span><span id="local-6989586621681489820"><span class="annot"><span class="annottext">CheckpointEnv
</span><a href="#local-6989586621681489820"><span class="hs-identifier hs-var">cenv</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-107"></span><span>          </span><span class="annot"><span class="annottext">BlockState -&gt; SQLiteEnv -&gt; Logger -&gt; IO CheckpointEnv
</span><a href="Chainweb.Pact.Backend.RelationalCheckpointer.html#initRelationalCheckpointer"><span class="hs-identifier hs-var">initRelationalCheckpointer</span></a></span><span> </span><span class="annot"><span class="annottext">BlockState
</span><a href="Chainweb.Pact.Backend.Types.html#initBlockState"><span class="hs-identifier hs-var">initBlockState</span></a></span><span> </span><span class="annot"><span class="annottext">SQLiteEnv
</span><a href="#local-6989586621681489824"><span class="hs-identifier hs-var">sqliteEnv</span></a></span><span> </span><span class="annot"><span class="annottext">Logger
</span><a href="#local-6989586621681489822"><span class="hs-identifier hs-var">nolog</span></a></span><span>
</span><span id="line-108"></span><span>        </span><span class="annot"><span class="annottext">NoopNFData (SQLiteEnv, CheckpointEnv, IO ())
-&gt; IO (NoopNFData (SQLiteEnv, CheckpointEnv, IO ()))
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(NoopNFData (SQLiteEnv, CheckpointEnv, IO ())
 -&gt; IO (NoopNFData (SQLiteEnv, CheckpointEnv, IO ())))
-&gt; NoopNFData (SQLiteEnv, CheckpointEnv, IO ())
-&gt; IO (NoopNFData (SQLiteEnv, CheckpointEnv, IO ()))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(SQLiteEnv, CheckpointEnv, IO ())
-&gt; NoopNFData (SQLiteEnv, CheckpointEnv, IO ())
forall a. a -&gt; NoopNFData a
</span><a href="Chainweb.Utils.Bench.html#NoopNFData"><span class="hs-identifier hs-var">NoopNFData</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SQLiteEnv
</span><a href="#local-6989586621681489824"><span class="hs-identifier hs-var">sqliteEnv</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">CheckpointEnv
</span><a href="#local-6989586621681489820"><span class="hs-identifier hs-var">cenv</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">IO ()
</span><a href="#local-6989586621681489825"><span class="hs-identifier hs-var">deleter</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-109"></span><span>
</span><span id="line-110"></span><span>    </span><span id="local-6989586621681489830"><span class="annot"><span class="annottext">teardown :: NoopNFData (SQLiteEnv, b, IO b) -&gt; IO b
</span><a href="#local-6989586621681489830"><span class="hs-identifier hs-var hs-var">teardown</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Chainweb.Utils.Bench.html#NoopNFData"><span class="hs-identifier hs-type">NoopNFData</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621681489817"><span class="annot"><span class="annottext">sqliteEnv :: SQLiteEnv
</span><a href="#local-6989586621681489817"><span class="hs-identifier hs-var">sqliteEnv</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681489816"><span class="annot"><span class="annottext">_cenv :: b
</span><a href="#local-6989586621681489816"><span class="hs-identifier hs-var">_cenv</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681489815"><span class="annot"><span class="annottext">deleter :: IO b
</span><a href="#local-6989586621681489815"><span class="hs-identifier hs-var">deleter</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-111"></span><span>        </span><span class="annot"><span class="annottext">SQLiteEnv -&gt; IO ()
</span><a href="Chainweb.Pact.Backend.Utils.html#closeSQLiteConnection"><span class="hs-identifier hs-var">closeSQLiteConnection</span></a></span><span> </span><span class="annot"><span class="annottext">SQLiteEnv
</span><a href="#local-6989586621681489817"><span class="hs-identifier hs-var">sqliteEnv</span></a></span><span>
</span><span id="line-112"></span><span>        </span><span class="annot"><span class="annottext">IO b
</span><a href="#local-6989586621681489815"><span class="hs-identifier hs-var">deleter</span></a></span><span>
</span><span id="line-113"></span><span>
</span><span id="line-114"></span><span>    </span><span class="annot"><a href="#local-6989586621681489827"><span class="hs-identifier hs-type">benches</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Chainweb.Pact.Backend.Types.html#CheckpointEnv"><span class="hs-identifier hs-type">CheckpointEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">C.Benchmark</span></span><span class="hs-special">]</span><span>
</span><span id="line-115"></span><span>    </span><span id="local-6989586621681489827"><span class="annot"><span class="annottext">benches :: CheckpointEnv -&gt; [Benchmark]
</span><a href="#local-6989586621681489827"><span class="hs-identifier hs-var hs-var">benches</span></a></span></span><span> </span><span id="local-6989586621681489813"><span class="annot"><span class="annottext">cpenv :: CheckpointEnv
</span><a href="#local-6989586621681489813"><span class="hs-identifier hs-var">cpenv</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-116"></span><span>        </span><span class="hs-special">[</span><span>
</span><span id="line-117"></span><span>          </span><span class="annot"><span class="annottext">CheckpointEnv -&gt; Benchmark
</span><a href="#local-6989586621681489832"><span class="hs-identifier hs-var">torun</span></a></span><span> </span><span class="annot"><span class="annottext">CheckpointEnv
</span><a href="#local-6989586621681489813"><span class="hs-identifier hs-var">cpenv</span></a></span><span>
</span><span id="line-118"></span><span>        </span><span class="hs-special">]</span><span>
</span><span id="line-119"></span><span>
</span><span id="line-120"></span><span class="annot"><a href="Chainweb.Pact.Backend.Bench.html#cpBenchNoRewindOverBlock"><span class="hs-identifier hs-type">cpBenchNoRewindOverBlock</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Chainweb.Pact.Backend.Types.html#CheckpointEnv"><span class="hs-identifier hs-type">CheckpointEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">C.Benchmark</span></span><span>
</span><span id="line-121"></span><span id="cpBenchNoRewindOverBlock"><span class="annot"><span class="annottext">cpBenchNoRewindOverBlock :: Int -&gt; CheckpointEnv -&gt; Benchmark
</span><a href="Chainweb.Pact.Backend.Bench.html#cpBenchNoRewindOverBlock"><span class="hs-identifier hs-var hs-var">cpBenchNoRewindOverBlock</span></a></span></span><span> </span><span id="local-6989586621681489812"><span class="annot"><span class="annottext">transactionCount :: Int
</span><a href="#local-6989586621681489812"><span class="hs-identifier hs-var">transactionCount</span></a></span></span><span> </span><span id="local-6989586621681489811"><span class="annot"><span class="annottext">cp :: CheckpointEnv
</span><a href="#local-6989586621681489811"><span class="hs-identifier hs-var">cp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IO (NoopNFData (Domain RowKey (ObjectMap PactValue)))
-&gt; (NoopNFData (Domain RowKey (ObjectMap PactValue)) -&gt; Benchmark)
-&gt; Benchmark
forall env. NFData env =&gt; IO env -&gt; (env -&gt; Benchmark) -&gt; Benchmark
</span><span class="hs-identifier hs-var">C.env</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CheckpointEnv
-&gt; IO (NoopNFData (Domain RowKey (ObjectMap PactValue)))
</span><a href="#local-6989586621681489809"><span class="hs-identifier hs-var">setup'</span></a></span><span> </span><span class="annot"><span class="annottext">CheckpointEnv
</span><a href="#local-6989586621681489811"><span class="hs-identifier hs-var">cp</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((NoopNFData (Domain RowKey (ObjectMap PactValue)) -&gt; Benchmark)
 -&gt; Benchmark)
-&gt; (NoopNFData (Domain RowKey (ObjectMap PactValue)) -&gt; Benchmark)
-&gt; Benchmark
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span> </span><span class="hs-glyph">~</span><span class="hs-special">(</span><span id="local-6989586621681489808"><span class="annot"><span class="annottext">NoopNFData (Domain RowKey (ObjectMap PactValue))
</span><a href="#local-6989586621681489808"><span class="hs-identifier hs-var">ut</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-122"></span><span>  </span><span class="annot"><span class="annottext">String -&gt; Benchmarkable -&gt; Benchmark
</span><span class="hs-identifier hs-var">C.bench</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621681489806"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">(Benchmarkable -&gt; Benchmark) -&gt; Benchmarkable -&gt; Benchmark
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">IO () -&gt; Benchmarkable
forall a. NFData a =&gt; IO a -&gt; Benchmarkable
</span><span class="hs-identifier hs-var">C.nfIO</span></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; Benchmarkable) -&gt; IO () -&gt; Benchmarkable
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-123"></span><span>      </span><span id="local-6989586621681489804"><span class="annot"><span class="annottext">MVar (BlockHeight, ByteString, BlockHash)
</span><a href="#local-6989586621681489804"><span class="hs-identifier hs-var">mv</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(BlockHeight, ByteString, BlockHash)
-&gt; IO (MVar (BlockHeight, ByteString, BlockHash))
forall a. a -&gt; IO (MVar a)
</span><span class="hs-identifier hs-var">newMVar</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64 -&gt; BlockHeight
</span><a href="Chainweb.BlockHeader.html#BlockHeight"><span class="hs-identifier hs-var">BlockHeight</span></a></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621681489801"><span class="hs-identifier hs-var">initbytestring</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">BlockHash
</span><a href="#local-6989586621681489800"><span class="hs-identifier hs-var">hash01</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-124"></span><span>      </span><span class="annot"><span class="annottext">CheckpointEnv
-&gt; MVar (BlockHeight, ByteString, BlockHash)
-&gt; NoopNFData (Domain RowKey (ObjectMap PactValue))
-&gt; IO ()
</span><a href="#local-6989586621681489799"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">CheckpointEnv
</span><a href="#local-6989586621681489811"><span class="hs-identifier hs-var">cp</span></a></span><span> </span><span class="annot"><span class="annottext">MVar (BlockHeight, ByteString, BlockHash)
</span><a href="#local-6989586621681489804"><span class="hs-identifier hs-var">mv</span></a></span><span> </span><span class="annot"><span class="annottext">NoopNFData (Domain RowKey (ObjectMap PactValue))
</span><a href="#local-6989586621681489808"><span class="hs-identifier hs-var">ut</span></a></span><span>
</span><span id="line-125"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-126"></span><span>    </span><span id="local-6989586621681489806"><span class="annot"><span class="annottext">name :: String
</span><a href="#local-6989586621681489806"><span class="hs-identifier hs-var hs-var">name</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-string">&quot;noRewind/transactionCount=&quot;</span></span><span>
</span><span id="line-127"></span><span>      </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681489812"><span class="hs-identifier hs-var">transactionCount</span></a></span><span>
</span><span id="line-128"></span><span>    </span><span id="local-6989586621681489809"><span class="annot"><span class="annottext">setup' :: CheckpointEnv
-&gt; IO (NoopNFData (Domain RowKey (ObjectMap PactValue)))
</span><a href="#local-6989586621681489809"><span class="hs-identifier hs-var hs-var">setup'</span></a></span></span><span> </span><span id="local-6989586621681489796"><span id="local-6989586621681489797"><span class="annot"><a href="Chainweb.Pact.Backend.Types.html#CheckpointEnv"><span class="hs-identifier hs-type">CheckpointEnv</span></a></span><span class="hs-special">{</span><span class="hs-glyph">..</span><span class="hs-special">}</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-129"></span><span>        </span><span id="local-6989586621681489792"><span class="annot"><span class="annottext">NoopNFData (Domain RowKey (ObjectMap PactValue))
</span><a href="#local-6989586621681489792"><span class="hs-identifier hs-var">usertablename</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Checkpointer -&gt; Maybe (BlockHeight, BlockHash) -&gt; IO PactDbEnv'
</span><a href="Chainweb.Pact.Backend.Types.html#_cpRestore"><span class="hs-identifier hs-var hs-var">_cpRestore</span></a></span><span> </span><span class="annot"><span class="annottext">Checkpointer
</span><a href="#local-6989586621681489797"><span class="hs-identifier hs-var">_cpeCheckpointer</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (BlockHeight, BlockHash)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="annot"><span class="annottext">IO PactDbEnv'
-&gt; (PactDbEnv'
    -&gt; IO (NoopNFData (Domain RowKey (ObjectMap PactValue))))
-&gt; IO (NoopNFData (Domain RowKey (ObjectMap PactValue)))
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-130"></span><span>          </span><span class="annot"><a href="Chainweb.Pact.Backend.Types.html#PactDbEnv%27"><span class="hs-identifier hs-type">PactDbEnv'</span></a></span><span> </span><span id="local-6989586621681489789"><span class="annot"><span class="annottext">db :: PactDbEnv e
</span><a href="#local-6989586621681489789"><span class="hs-identifier hs-var">db</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-131"></span><span>            </span><span class="annot"><span class="annottext">PactDbEnv e
-&gt; (Domain RowKey (ObjectMap PactValue) -&gt; IO ())
-&gt; IO (NoopNFData (Domain RowKey (ObjectMap PactValue)))
forall e.
PactDbEnv e
-&gt; (Domain RowKey (ObjectMap PactValue) -&gt; IO ())
-&gt; IO (NoopNFData (Domain RowKey (ObjectMap PactValue)))
</span><a href="Chainweb.Pact.Backend.Bench.html#setupUserTable"><span class="hs-identifier hs-var">setupUserTable</span></a></span><span> </span><span class="annot"><span class="annottext">PactDbEnv e
</span><a href="#local-6989586621681489789"><span class="hs-identifier hs-var">db</span></a></span><span> </span><span class="annot"><span class="annottext">((Domain RowKey (ObjectMap PactValue) -&gt; IO ())
 -&gt; IO (NoopNFData (Domain RowKey (ObjectMap PactValue))))
-&gt; (Domain RowKey (ObjectMap PactValue) -&gt; IO ())
-&gt; IO (NoopNFData (Domain RowKey (ObjectMap PactValue)))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621681489787"><span class="annot"><span class="annottext">ut :: Domain RowKey (ObjectMap PactValue)
</span><a href="#local-6989586621681489787"><span class="hs-identifier hs-var">ut</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">PactDbEnv e
-&gt; WriteType
-&gt; Domain RowKey (ObjectMap PactValue)
-&gt; FieldKey
-&gt; RowKey
-&gt; Integer
-&gt; IO ()
forall k e.
AsString k =&gt;
PactDbEnv e
-&gt; WriteType
-&gt; Domain k (ObjectMap PactValue)
-&gt; FieldKey
-&gt; k
-&gt; Integer
-&gt; IO ()
</span><a href="Chainweb.Pact.Backend.Bench.html#writeRow"><span class="hs-identifier hs-var">writeRow</span></a></span><span> </span><span class="annot"><span class="annottext">PactDbEnv e
</span><a href="#local-6989586621681489789"><span class="hs-identifier hs-var">db</span></a></span><span> </span><span class="annot"><span class="annottext">WriteType
</span><span class="hs-identifier hs-var">Insert</span></span><span> </span><span class="annot"><span class="annottext">Domain RowKey (ObjectMap PactValue)
</span><a href="#local-6989586621681489787"><span class="hs-identifier hs-var">ut</span></a></span><span> </span><span class="annot"><span class="annottext">FieldKey
</span><a href="#local-6989586621681489784"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">RowKey
</span><a href="#local-6989586621681489783"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span>
</span><span id="line-132"></span><span>        </span><span class="annot"><span class="annottext">Checkpointer -&gt; BlockHash -&gt; IO ()
</span><a href="Chainweb.Pact.Backend.Types.html#_cpSave"><span class="hs-identifier hs-var hs-var">_cpSave</span></a></span><span> </span><span class="annot"><span class="annottext">Checkpointer
</span><a href="#local-6989586621681489797"><span class="hs-identifier hs-var">_cpeCheckpointer</span></a></span><span> </span><span class="annot"><span class="annottext">BlockHash
</span><a href="#local-6989586621681489800"><span class="hs-identifier hs-var">hash01</span></a></span><span>
</span><span id="line-133"></span><span>        </span><span class="annot"><span class="annottext">NoopNFData (Domain RowKey (ObjectMap PactValue))
-&gt; IO (NoopNFData (Domain RowKey (ObjectMap PactValue)))
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">NoopNFData (Domain RowKey (ObjectMap PactValue))
</span><a href="#local-6989586621681489792"><span class="hs-identifier hs-var">usertablename</span></a></span><span>
</span><span id="line-134"></span><span>
</span><span id="line-135"></span><span>    </span><span id="local-6989586621681489784"><span class="annot"><span class="annottext">f :: FieldKey
</span><a href="#local-6989586621681489784"><span class="hs-identifier hs-var hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-string">&quot;f&quot;</span></span><span>
</span><span id="line-136"></span><span>    </span><span id="local-6989586621681489783"><span class="annot"><span class="annottext">k :: RowKey
</span><a href="#local-6989586621681489783"><span class="hs-identifier hs-var hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-string">&quot;k&quot;</span></span><span>
</span><span id="line-137"></span><span>
</span><span id="line-138"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621681489801"><span class="annot"><span class="annottext">initbytestring :: ByteString
</span><a href="#local-6989586621681489801"><span class="hs-identifier hs-var">initbytestring</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681489800"><span class="annot"><span class="annottext">hash01 :: BlockHash
</span><a href="#local-6989586621681489800"><span class="hs-identifier hs-var">hash01</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-139"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621681489781"><span class="hs-identifier hs-var">bytestring</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">MerkleLogHash -&gt; BlockHash
</span><a href="Chainweb.BlockHash.html#BlockHash"><span class="hs-identifier hs-var">BlockHash</span></a></span><span> </span><span class="annot"><span class="annottext">(MerkleLogHash -&gt; BlockHash) -&gt; MerkleLogHash -&gt; BlockHash
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">HasCallStack =&gt; ByteString -&gt; MerkleLogHash
ByteString -&gt; MerkleLogHash
</span><a href="Chainweb.MerkleLogHash.html#unsafeMerkleLogHash"><span class="hs-identifier hs-var">unsafeMerkleLogHash</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621681489781"><span class="hs-identifier hs-var">bytestring</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-140"></span><span>        </span><span class="hs-keyword">where</span><span>
</span><span id="line-141"></span><span>          </span><span id="local-6989586621681489781"><span class="annot"><span class="annottext">bytestring :: ByteString
</span><a href="#local-6989586621681489781"><span class="hs-identifier hs-var hs-var">bytestring</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-142"></span><span>            </span><span class="annot"><span class="hs-string">&quot;0000000000000000000000000000001a&quot;</span></span><span>
</span><span id="line-143"></span><span>
</span><span id="line-144"></span><span>    </span><span id="local-6989586621681489778"><span class="annot"><span class="annottext">nextHash :: ByteString -&gt; (ByteString, BlockHash)
</span><a href="#local-6989586621681489778"><span class="hs-identifier hs-var hs-var">nextHash</span></a></span></span><span> </span><span id="local-6989586621681489777"><span class="annot"><span class="annottext">bytestring :: ByteString
</span><a href="#local-6989586621681489777"><span class="hs-identifier hs-var">bytestring</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-145"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621681489777"><span class="hs-identifier hs-var">bytestring</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-146"></span><span>       </span><span class="annot"><span class="annottext">MerkleLogHash -&gt; BlockHash
</span><a href="Chainweb.BlockHash.html#BlockHash"><span class="hs-identifier hs-var">BlockHash</span></a></span><span> </span><span class="annot"><span class="annottext">(MerkleLogHash -&gt; BlockHash) -&gt; MerkleLogHash -&gt; BlockHash
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">HasCallStack =&gt; ByteString -&gt; MerkleLogHash
ByteString -&gt; MerkleLogHash
</span><a href="Chainweb.MerkleLogHash.html#unsafeMerkleLogHash"><span class="hs-identifier hs-var">unsafeMerkleLogHash</span></a></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; MerkleLogHash) -&gt; ByteString -&gt; MerkleLogHash
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Word8] -&gt; ByteString
</span><span class="hs-identifier hs-var">B.pack</span></span><span> </span><span class="annot"><span class="annottext">([Word8] -&gt; ByteString) -&gt; [Word8] -&gt; ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Word8 -&gt; Word8 -&gt; Word8) -&gt; ByteString -&gt; ByteString -&gt; [Word8]
forall a. (Word8 -&gt; Word8 -&gt; a) -&gt; ByteString -&gt; ByteString -&gt; [a]
</span><span class="hs-identifier hs-var">B.zipWith</span></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Word8 -&gt; Word8
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">(+)</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621681489777"><span class="hs-identifier hs-var">bytestring</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621681489773"><span class="hs-identifier hs-var">inc</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-147"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-148"></span><span>        </span><span id="local-6989586621681489773"><span class="annot"><span class="annottext">inc :: ByteString
</span><a href="#local-6989586621681489773"><span class="hs-identifier hs-var hs-var">inc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; ByteString
forall a b. StringConv a b =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">toS</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; ByteString) -&gt; String -&gt; ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Char -&gt; String
forall a. Int -&gt; a -&gt; [a]
</span><span class="hs-identifier hs-var">replicate</span></span><span> </span><span class="annot"><span class="hs-number">30</span></span><span> </span><span class="annot"><span class="hs-char">'\NUL'</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-char">'\SOH'</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-char">'\NUL'</span></span><span class="hs-special">]</span><span>
</span><span id="line-149"></span><span>
</span><span id="line-150"></span><span>    </span><span id="local-6989586621681489799"><span class="annot"><span class="annottext">go :: CheckpointEnv
-&gt; MVar (BlockHeight, ByteString, BlockHash)
-&gt; NoopNFData (Domain RowKey (ObjectMap PactValue))
-&gt; IO ()
</span><a href="#local-6989586621681489799"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621681489769"><span id="local-6989586621681489770"><span class="annot"><a href="Chainweb.Pact.Backend.Types.html#CheckpointEnv"><span class="hs-identifier hs-type">CheckpointEnv</span></a></span><span class="hs-special">{</span><span class="hs-glyph">..</span><span class="hs-special">}</span></span></span><span> </span><span id="local-6989586621681489768"><span class="annot"><span class="annottext">mblock :: MVar (BlockHeight, ByteString, BlockHash)
</span><a href="#local-6989586621681489768"><span class="hs-identifier hs-var">mblock</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Chainweb.Utils.Bench.html#NoopNFData"><span class="hs-identifier hs-type">NoopNFData</span></a></span><span> </span><span id="local-6989586621681489767"><span class="annot"><span class="annottext">ut :: Domain RowKey (ObjectMap PactValue)
</span><a href="#local-6989586621681489767"><span class="hs-identifier hs-var">ut</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-151"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621681489766"><span class="annot"><span class="annottext">blockheight :: BlockHeight
</span><a href="#local-6989586621681489766"><span class="hs-identifier hs-var">blockheight</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681489765"><span class="annot"><span class="annottext">bytestring :: ByteString
</span><a href="#local-6989586621681489765"><span class="hs-identifier hs-var">bytestring</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681489764"><span class="annot"><span class="annottext">hash :: BlockHash
</span><a href="#local-6989586621681489764"><span class="hs-identifier hs-var">hash</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">MVar (BlockHeight, ByteString, BlockHash)
-&gt; IO (BlockHeight, ByteString, BlockHash)
forall a. MVar a -&gt; IO a
</span><span class="hs-identifier hs-var">readMVar</span></span><span> </span><span class="annot"><span class="annottext">MVar (BlockHeight, ByteString, BlockHash)
</span><a href="#local-6989586621681489768"><span class="hs-identifier hs-var">mblock</span></a></span><span>
</span><span id="line-152"></span><span>        </span><span class="annot"><span class="annottext">IO () -&gt; IO ()
forall (f :: * -&gt; *) a. Functor f =&gt; f a -&gt; f ()
</span><span class="hs-identifier hs-var">void</span></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; IO ()) -&gt; IO () -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Checkpointer -&gt; Maybe (BlockHeight, BlockHash) -&gt; IO PactDbEnv'
</span><a href="Chainweb.Pact.Backend.Types.html#_cpRestore"><span class="hs-identifier hs-var hs-var">_cpRestore</span></a></span><span> </span><span class="annot"><span class="annottext">Checkpointer
</span><a href="#local-6989586621681489770"><span class="hs-identifier hs-var">_cpeCheckpointer</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(BlockHeight, BlockHash) -&gt; Maybe (BlockHeight, BlockHash)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BlockHeight
</span><a href="#local-6989586621681489766"><span class="hs-identifier hs-var">blockheight</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">BlockHash
</span><a href="#local-6989586621681489764"><span class="hs-identifier hs-var">hash</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">IO PactDbEnv' -&gt; (PactDbEnv' -&gt; IO ()) -&gt; IO ()
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-153"></span><span>          </span><span class="annot"><a href="Chainweb.Pact.Backend.Types.html#PactDbEnv%27"><span class="hs-identifier hs-type">PactDbEnv'</span></a></span><span> </span><span id="local-6989586621681489763"><span class="annot"><span class="annottext">pactdbenv :: PactDbEnv e
</span><a href="#local-6989586621681489763"><span class="hs-identifier hs-var">pactdbenv</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-154"></span><span>            </span><span class="annot"><span class="annottext">Int -&gt; IO Integer -&gt; IO ()
forall (m :: * -&gt; *) a. Applicative m =&gt; Int -&gt; m a -&gt; m ()
</span><span class="hs-identifier hs-var">replicateM_</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681489812"><span class="hs-identifier hs-var">transactionCount</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PactDbEnv e -&gt; IO Integer
forall e. PactDbEnv e -&gt; IO Integer
</span><a href="#local-6989586621681489761"><span class="hs-identifier hs-var">transaction</span></a></span><span> </span><span class="annot"><span class="annottext">PactDbEnv e
</span><a href="#local-6989586621681489763"><span class="hs-identifier hs-var">pactdbenv</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-155"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681489760"><span class="annot"><span class="annottext">bytestring' :: ByteString
</span><a href="#local-6989586621681489760"><span class="hs-identifier hs-var">bytestring'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681489759"><span class="annot"><span class="annottext">hash' :: BlockHash
</span><a href="#local-6989586621681489759"><span class="hs-identifier hs-var">hash'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; (ByteString, BlockHash)
</span><a href="#local-6989586621681489778"><span class="hs-identifier hs-var">nextHash</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621681489765"><span class="hs-identifier hs-var">bytestring</span></a></span><span>
</span><span id="line-156"></span><span>        </span><span class="annot"><span class="annottext">MVar (BlockHeight, ByteString, BlockHash)
-&gt; ((BlockHeight, ByteString, BlockHash)
    -&gt; IO (BlockHeight, ByteString, BlockHash))
-&gt; IO ()
forall a. MVar a -&gt; (a -&gt; IO a) -&gt; IO ()
</span><span class="hs-identifier hs-var">modifyMVar_</span></span><span> </span><span class="annot"><span class="annottext">MVar (BlockHeight, ByteString, BlockHash)
</span><a href="#local-6989586621681489768"><span class="hs-identifier hs-var">mblock</span></a></span><span>
</span><span id="line-157"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IO (BlockHeight, ByteString, BlockHash)
-&gt; (BlockHeight, ByteString, BlockHash)
-&gt; IO (BlockHeight, ByteString, BlockHash)
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">(IO (BlockHeight, ByteString, BlockHash)
 -&gt; (BlockHeight, ByteString, BlockHash)
 -&gt; IO (BlockHeight, ByteString, BlockHash))
-&gt; IO (BlockHeight, ByteString, BlockHash)
-&gt; (BlockHeight, ByteString, BlockHash)
-&gt; IO (BlockHeight, ByteString, BlockHash)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>  </span><span class="annot"><span class="annottext">(BlockHeight, ByteString, BlockHash)
-&gt; IO (BlockHeight, ByteString, BlockHash)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BlockHeight
</span><a href="#local-6989586621681489766"><span class="hs-identifier hs-var">blockheight</span></a></span><span> </span><span class="annot"><span class="annottext">BlockHeight -&gt; BlockHeight -&gt; BlockHeight
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621681489760"><span class="hs-identifier hs-var">bytestring'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">BlockHash
</span><a href="#local-6989586621681489759"><span class="hs-identifier hs-var">hash'</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-158"></span><span>        </span><span class="annot"><span class="annottext">IO () -&gt; IO ()
forall (f :: * -&gt; *) a. Functor f =&gt; f a -&gt; f ()
</span><span class="hs-identifier hs-var">void</span></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; IO ()) -&gt; IO () -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Checkpointer -&gt; BlockHash -&gt; IO ()
</span><a href="Chainweb.Pact.Backend.Types.html#_cpSave"><span class="hs-identifier hs-var hs-var">_cpSave</span></a></span><span> </span><span class="annot"><span class="annottext">Checkpointer
</span><a href="#local-6989586621681489770"><span class="hs-identifier hs-var">_cpeCheckpointer</span></a></span><span> </span><span class="annot"><span class="annottext">BlockHash
</span><a href="#local-6989586621681489759"><span class="hs-identifier hs-var">hash'</span></a></span><span>
</span><span id="line-159"></span><span>
</span><span id="line-160"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-161"></span><span>        </span><span id="local-6989586621681489761"><span class="annot"><span class="annottext">transaction :: PactDbEnv e -&gt; IO Integer
</span><a href="#local-6989586621681489761"><span class="hs-identifier hs-var hs-var">transaction</span></a></span></span><span> </span><span id="local-6989586621681489756"><span class="annot"><span class="annottext">db :: PactDbEnv e
</span><a href="#local-6989586621681489756"><span class="hs-identifier hs-var">db</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PactDbEnv e
-&gt; Domain RowKey (ObjectMap PactValue)
-&gt; FieldKey
-&gt; RowKey
-&gt; Integer
-&gt; IO Integer
forall e.
PactDbEnv e
-&gt; Domain RowKey (ObjectMap PactValue)
-&gt; FieldKey
-&gt; RowKey
-&gt; Integer
-&gt; IO Integer
</span><a href="Chainweb.Pact.Backend.Bench.html#incIntegerAtKey"><span class="hs-identifier hs-var">incIntegerAtKey</span></a></span><span> </span><span class="annot"><span class="annottext">PactDbEnv e
</span><a href="#local-6989586621681489756"><span class="hs-identifier hs-var">db</span></a></span><span> </span><span class="annot"><span class="annottext">Domain RowKey (ObjectMap PactValue)
</span><a href="#local-6989586621681489767"><span class="hs-identifier hs-var">ut</span></a></span><span> </span><span class="annot"><span class="annottext">FieldKey
</span><a href="#local-6989586621681489784"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">RowKey
</span><a href="#local-6989586621681489783"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span>
</span><span id="line-162"></span><span>
</span><span id="line-163"></span><span class="annot"><a href="Chainweb.Pact.Backend.Bench.html#cpBenchOverBlock"><span class="hs-identifier hs-type">cpBenchOverBlock</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Chainweb.Pact.Backend.Types.html#CheckpointEnv"><span class="hs-identifier hs-type">CheckpointEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">C.Benchmark</span></span><span>
</span><span id="line-164"></span><span id="cpBenchOverBlock"><span class="annot"><span class="annottext">cpBenchOverBlock :: Int -&gt; CheckpointEnv -&gt; Benchmark
</span><a href="Chainweb.Pact.Backend.Bench.html#cpBenchOverBlock"><span class="hs-identifier hs-var hs-var">cpBenchOverBlock</span></a></span></span><span> </span><span id="local-6989586621681489754"><span class="annot"><span class="annottext">transactionCount :: Int
</span><a href="#local-6989586621681489754"><span class="hs-identifier hs-var">transactionCount</span></a></span></span><span> </span><span id="local-6989586621681489753"><span class="annot"><span class="annottext">cp :: CheckpointEnv
</span><a href="#local-6989586621681489753"><span class="hs-identifier hs-var">cp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IO (NoopNFData (Domain RowKey (ObjectMap PactValue)))
-&gt; (NoopNFData (Domain RowKey (ObjectMap PactValue)) -&gt; Benchmark)
-&gt; Benchmark
forall env. NFData env =&gt; IO env -&gt; (env -&gt; Benchmark) -&gt; Benchmark
</span><span class="hs-identifier hs-var">C.env</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CheckpointEnv
-&gt; IO (NoopNFData (Domain RowKey (ObjectMap PactValue)))
</span><a href="#local-6989586621681489752"><span class="hs-identifier hs-var">setup'</span></a></span><span> </span><span class="annot"><span class="annottext">CheckpointEnv
</span><a href="#local-6989586621681489753"><span class="hs-identifier hs-var">cp</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((NoopNFData (Domain RowKey (ObjectMap PactValue)) -&gt; Benchmark)
 -&gt; Benchmark)
-&gt; (NoopNFData (Domain RowKey (ObjectMap PactValue)) -&gt; Benchmark)
-&gt; Benchmark
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span> </span><span class="hs-glyph">~</span><span class="hs-special">(</span><span id="local-6989586621681489751"><span class="annot"><span class="annottext">NoopNFData (Domain RowKey (ObjectMap PactValue))
</span><a href="#local-6989586621681489751"><span class="hs-identifier hs-var">ut</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-165"></span><span>    </span><span class="annot"><span class="annottext">String -&gt; Benchmarkable -&gt; Benchmark
</span><span class="hs-identifier hs-var">C.bench</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621681489750"><span class="hs-identifier hs-var">benchname</span></a></span><span> </span><span class="annot"><span class="annottext">(Benchmarkable -&gt; Benchmark) -&gt; Benchmarkable -&gt; Benchmark
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">IO () -&gt; Benchmarkable
forall a. NFData a =&gt; IO a -&gt; Benchmarkable
</span><span class="hs-identifier hs-var">C.nfIO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CheckpointEnv
-&gt; NoopNFData (Domain RowKey (ObjectMap PactValue)) -&gt; IO ()
</span><a href="#local-6989586621681489749"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">CheckpointEnv
</span><a href="#local-6989586621681489753"><span class="hs-identifier hs-var">cp</span></a></span><span> </span><span class="annot"><span class="annottext">NoopNFData (Domain RowKey (ObjectMap PactValue))
</span><a href="#local-6989586621681489751"><span class="hs-identifier hs-var">ut</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-166"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-167"></span><span>    </span><span id="local-6989586621681489750"><span class="annot"><span class="annottext">benchname :: String
</span><a href="#local-6989586621681489750"><span class="hs-identifier hs-var hs-var">benchname</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-string">&quot;overBlock/transactionCount=&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681489754"><span class="hs-identifier hs-var">transactionCount</span></a></span><span>
</span><span id="line-168"></span><span>    </span><span id="local-6989586621681489752"><span class="annot"><span class="annottext">setup' :: CheckpointEnv
-&gt; IO (NoopNFData (Domain RowKey (ObjectMap PactValue)))
</span><a href="#local-6989586621681489752"><span class="hs-identifier hs-var hs-var">setup'</span></a></span></span><span> </span><span id="local-6989586621681489747"><span id="local-6989586621681489748"><span class="annot"><a href="Chainweb.Pact.Backend.Types.html#CheckpointEnv"><span class="hs-identifier hs-type">CheckpointEnv</span></a></span><span class="hs-special">{</span><span class="hs-glyph">..</span><span class="hs-special">}</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-169"></span><span>        </span><span id="local-6989586621681489746"><span class="annot"><span class="annottext">NoopNFData (Domain RowKey (ObjectMap PactValue))
</span><a href="#local-6989586621681489746"><span class="hs-identifier hs-var">usertablename</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Checkpointer -&gt; Maybe (BlockHeight, BlockHash) -&gt; IO PactDbEnv'
</span><a href="Chainweb.Pact.Backend.Types.html#_cpRestore"><span class="hs-identifier hs-var hs-var">_cpRestore</span></a></span><span> </span><span class="annot"><span class="annottext">Checkpointer
</span><a href="#local-6989586621681489748"><span class="hs-identifier hs-var">_cpeCheckpointer</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (BlockHeight, BlockHash)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="annot"><span class="annottext">IO PactDbEnv'
-&gt; (PactDbEnv'
    -&gt; IO (NoopNFData (Domain RowKey (ObjectMap PactValue))))
-&gt; IO (NoopNFData (Domain RowKey (ObjectMap PactValue)))
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-170"></span><span>            </span><span class="annot"><a href="Chainweb.Pact.Backend.Types.html#PactDbEnv%27"><span class="hs-identifier hs-type">PactDbEnv'</span></a></span><span> </span><span id="local-6989586621681489745"><span class="annot"><span class="annottext">db :: PactDbEnv e
</span><a href="#local-6989586621681489745"><span class="hs-identifier hs-var">db</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-171"></span><span>              </span><span class="annot"><span class="annottext">PactDbEnv e
-&gt; (Domain RowKey (ObjectMap PactValue) -&gt; IO ())
-&gt; IO (NoopNFData (Domain RowKey (ObjectMap PactValue)))
forall e.
PactDbEnv e
-&gt; (Domain RowKey (ObjectMap PactValue) -&gt; IO ())
-&gt; IO (NoopNFData (Domain RowKey (ObjectMap PactValue)))
</span><a href="Chainweb.Pact.Backend.Bench.html#setupUserTable"><span class="hs-identifier hs-var">setupUserTable</span></a></span><span> </span><span class="annot"><span class="annottext">PactDbEnv e
</span><a href="#local-6989586621681489745"><span class="hs-identifier hs-var">db</span></a></span><span> </span><span class="annot"><span class="annottext">((Domain RowKey (ObjectMap PactValue) -&gt; IO ())
 -&gt; IO (NoopNFData (Domain RowKey (ObjectMap PactValue))))
-&gt; (Domain RowKey (ObjectMap PactValue) -&gt; IO ())
-&gt; IO (NoopNFData (Domain RowKey (ObjectMap PactValue)))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621681489744"><span class="annot"><span class="annottext">ut :: Domain RowKey (ObjectMap PactValue)
</span><a href="#local-6989586621681489744"><span class="hs-identifier hs-var">ut</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">PactDbEnv e
-&gt; WriteType
-&gt; Domain RowKey (ObjectMap PactValue)
-&gt; FieldKey
-&gt; RowKey
-&gt; Integer
-&gt; IO ()
forall k e.
AsString k =&gt;
PactDbEnv e
-&gt; WriteType
-&gt; Domain k (ObjectMap PactValue)
-&gt; FieldKey
-&gt; k
-&gt; Integer
-&gt; IO ()
</span><a href="Chainweb.Pact.Backend.Bench.html#writeRow"><span class="hs-identifier hs-var">writeRow</span></a></span><span> </span><span class="annot"><span class="annottext">PactDbEnv e
</span><a href="#local-6989586621681489745"><span class="hs-identifier hs-var">db</span></a></span><span> </span><span class="annot"><span class="annottext">WriteType
</span><span class="hs-identifier hs-var">Insert</span></span><span> </span><span class="annot"><span class="annottext">Domain RowKey (ObjectMap PactValue)
</span><a href="#local-6989586621681489744"><span class="hs-identifier hs-var">ut</span></a></span><span> </span><span class="annot"><span class="annottext">FieldKey
</span><a href="#local-6989586621681489743"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">RowKey
</span><a href="#local-6989586621681489742"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span>
</span><span id="line-172"></span><span>        </span><span class="annot"><span class="annottext">Checkpointer -&gt; BlockHash -&gt; IO ()
</span><a href="Chainweb.Pact.Backend.Types.html#_cpSave"><span class="hs-identifier hs-var hs-var">_cpSave</span></a></span><span> </span><span class="annot"><span class="annottext">Checkpointer
</span><a href="#local-6989586621681489748"><span class="hs-identifier hs-var">_cpeCheckpointer</span></a></span><span> </span><span class="annot"><span class="annottext">BlockHash
</span><a href="#local-6989586621681489741"><span class="hs-identifier hs-var">hash01</span></a></span><span>
</span><span id="line-173"></span><span>        </span><span class="annot"><span class="annottext">NoopNFData (Domain RowKey (ObjectMap PactValue))
-&gt; IO (NoopNFData (Domain RowKey (ObjectMap PactValue)))
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">NoopNFData (Domain RowKey (ObjectMap PactValue))
</span><a href="#local-6989586621681489746"><span class="hs-identifier hs-var">usertablename</span></a></span><span>
</span><span id="line-174"></span><span>
</span><span id="line-175"></span><span>    </span><span id="local-6989586621681489743"><span class="annot"><span class="annottext">f :: FieldKey
</span><a href="#local-6989586621681489743"><span class="hs-identifier hs-var hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-string">&quot;f&quot;</span></span><span>
</span><span id="line-176"></span><span>    </span><span id="local-6989586621681489742"><span class="annot"><span class="annottext">k :: RowKey
</span><a href="#local-6989586621681489742"><span class="hs-identifier hs-var hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-string">&quot;k&quot;</span></span><span>
</span><span id="line-177"></span><span>
</span><span id="line-178"></span><span>    </span><span id="local-6989586621681489741"><span class="annot"><span class="annottext">hash01 :: BlockHash
</span><a href="#local-6989586621681489741"><span class="hs-identifier hs-var hs-var">hash01</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MerkleLogHash -&gt; BlockHash
</span><a href="Chainweb.BlockHash.html#BlockHash"><span class="hs-identifier hs-var">BlockHash</span></a></span><span> </span><span class="annot"><span class="annottext">(MerkleLogHash -&gt; BlockHash) -&gt; MerkleLogHash -&gt; BlockHash
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">HasCallStack =&gt; ByteString -&gt; MerkleLogHash
ByteString -&gt; MerkleLogHash
</span><a href="Chainweb.MerkleLogHash.html#unsafeMerkleLogHash"><span class="hs-identifier hs-var">unsafeMerkleLogHash</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;0000000000000000000000000000001a&quot;</span></span><span>
</span><span id="line-179"></span><span>    </span><span id="local-6989586621681489740"><span class="annot"><span class="annottext">hash02 :: BlockHash
</span><a href="#local-6989586621681489740"><span class="hs-identifier hs-var hs-var">hash02</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MerkleLogHash -&gt; BlockHash
</span><a href="Chainweb.BlockHash.html#BlockHash"><span class="hs-identifier hs-var">BlockHash</span></a></span><span> </span><span class="annot"><span class="annottext">(MerkleLogHash -&gt; BlockHash) -&gt; MerkleLogHash -&gt; BlockHash
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">HasCallStack =&gt; ByteString -&gt; MerkleLogHash
ByteString -&gt; MerkleLogHash
</span><a href="Chainweb.MerkleLogHash.html#unsafeMerkleLogHash"><span class="hs-identifier hs-var">unsafeMerkleLogHash</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;0000000000000000000000000000002a&quot;</span></span><span>
</span><span id="line-180"></span><span>
</span><span id="line-181"></span><span>    </span><span id="local-6989586621681489749"><span class="annot"><span class="annottext">go :: CheckpointEnv
-&gt; NoopNFData (Domain RowKey (ObjectMap PactValue)) -&gt; IO ()
</span><a href="#local-6989586621681489749"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621681489738"><span id="local-6989586621681489739"><span class="annot"><a href="Chainweb.Pact.Backend.Types.html#CheckpointEnv"><span class="hs-identifier hs-type">CheckpointEnv</span></a></span><span class="hs-special">{</span><span class="hs-glyph">..</span><span class="hs-special">}</span></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Chainweb.Utils.Bench.html#NoopNFData"><span class="hs-identifier hs-type">NoopNFData</span></a></span><span> </span><span id="local-6989586621681489737"><span class="annot"><span class="annottext">ut :: Domain RowKey (ObjectMap PactValue)
</span><a href="#local-6989586621681489737"><span class="hs-identifier hs-var">ut</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-182"></span><span>        </span><span class="annot"><span class="annottext">Checkpointer -&gt; Maybe (BlockHeight, BlockHash) -&gt; IO PactDbEnv'
</span><a href="Chainweb.Pact.Backend.Types.html#_cpRestore"><span class="hs-identifier hs-var hs-var">_cpRestore</span></a></span><span> </span><span class="annot"><span class="annottext">Checkpointer
</span><a href="#local-6989586621681489739"><span class="hs-identifier hs-var">_cpeCheckpointer</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(BlockHeight, BlockHash) -&gt; Maybe (BlockHeight, BlockHash)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64 -&gt; BlockHeight
</span><a href="Chainweb.BlockHeader.html#BlockHeight"><span class="hs-identifier hs-var">BlockHeight</span></a></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">BlockHash
</span><a href="#local-6989586621681489741"><span class="hs-identifier hs-var">hash01</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">IO PactDbEnv' -&gt; (PactDbEnv' -&gt; IO ()) -&gt; IO ()
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-183"></span><span>            </span><span class="annot"><a href="Chainweb.Pact.Backend.Types.html#PactDbEnv%27"><span class="hs-identifier hs-type">PactDbEnv'</span></a></span><span> </span><span id="local-6989586621681489736"><span class="annot"><span class="annottext">pactdbenv :: PactDbEnv e
</span><a href="#local-6989586621681489736"><span class="hs-identifier hs-var">pactdbenv</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-184"></span><span>              </span><span class="annot"><span class="annottext">Int -&gt; IO Integer -&gt; IO ()
forall (m :: * -&gt; *) a. Applicative m =&gt; Int -&gt; m a -&gt; m ()
</span><span class="hs-identifier hs-var">replicateM_</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681489754"><span class="hs-identifier hs-var">transactionCount</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PactDbEnv e -&gt; IO Integer
forall e. PactDbEnv e -&gt; IO Integer
</span><a href="#local-6989586621681489735"><span class="hs-identifier hs-var">transaction</span></a></span><span> </span><span class="annot"><span class="annottext">PactDbEnv e
</span><a href="#local-6989586621681489736"><span class="hs-identifier hs-var">pactdbenv</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-185"></span><span>        </span><span class="annot"><span class="annottext">IO () -&gt; IO ()
forall (f :: * -&gt; *) a. Functor f =&gt; f a -&gt; f ()
</span><span class="hs-identifier hs-var">void</span></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; IO ()) -&gt; IO () -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Checkpointer -&gt; BlockHash -&gt; IO ()
</span><a href="Chainweb.Pact.Backend.Types.html#_cpSave"><span class="hs-identifier hs-var hs-var">_cpSave</span></a></span><span> </span><span class="annot"><span class="annottext">Checkpointer
</span><a href="#local-6989586621681489739"><span class="hs-identifier hs-var">_cpeCheckpointer</span></a></span><span> </span><span class="annot"><span class="annottext">BlockHash
</span><a href="#local-6989586621681489740"><span class="hs-identifier hs-var">hash02</span></a></span><span>
</span><span id="line-186"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-187"></span><span>        </span><span id="local-6989586621681489735"><span class="annot"><span class="annottext">transaction :: PactDbEnv e -&gt; IO Integer
</span><a href="#local-6989586621681489735"><span class="hs-identifier hs-var hs-var">transaction</span></a></span></span><span> </span><span id="local-6989586621681489734"><span class="annot"><span class="annottext">db :: PactDbEnv e
</span><a href="#local-6989586621681489734"><span class="hs-identifier hs-var">db</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PactDbEnv e
-&gt; Domain RowKey (ObjectMap PactValue)
-&gt; FieldKey
-&gt; RowKey
-&gt; Integer
-&gt; IO Integer
forall e.
PactDbEnv e
-&gt; Domain RowKey (ObjectMap PactValue)
-&gt; FieldKey
-&gt; RowKey
-&gt; Integer
-&gt; IO Integer
</span><a href="Chainweb.Pact.Backend.Bench.html#incIntegerAtKey"><span class="hs-identifier hs-var">incIntegerAtKey</span></a></span><span> </span><span class="annot"><span class="annottext">PactDbEnv e
</span><a href="#local-6989586621681489734"><span class="hs-identifier hs-var">db</span></a></span><span> </span><span class="annot"><span class="annottext">Domain RowKey (ObjectMap PactValue)
</span><a href="#local-6989586621681489737"><span class="hs-identifier hs-var">ut</span></a></span><span> </span><span class="annot"><span class="annottext">FieldKey
</span><a href="#local-6989586621681489743"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">RowKey
</span><a href="#local-6989586621681489742"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span>
</span><span id="line-188"></span><span>
</span><span id="line-189"></span><span id="local-6989586621681489933"><span class="annot"><a href="Chainweb.Pact.Backend.Bench.html#begin"><span class="hs-identifier hs-type">begin</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">PactDbEnv</span></span><span> </span><span class="annot"><a href="#local-6989586621681489933"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-190"></span><span id="begin"><span class="annot"><span class="annottext">begin :: PactDbEnv e -&gt; IO ()
</span><a href="Chainweb.Pact.Backend.Bench.html#begin"><span class="hs-identifier hs-var hs-var">begin</span></a></span></span><span> </span><span id="local-6989586621681489732"><span class="annot"><span class="annottext">db :: PactDbEnv e
</span><a href="#local-6989586621681489732"><span class="hs-identifier hs-var">db</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IO (Maybe TxId) -&gt; IO ()
forall (f :: * -&gt; *) a. Functor f =&gt; f a -&gt; f ()
</span><span class="hs-identifier hs-var">void</span></span><span> </span><span class="annot"><span class="annottext">(IO (Maybe TxId) -&gt; IO ()) -&gt; IO (Maybe TxId) -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">PactDb e -&gt; ExecutionMode -&gt; Method e (Maybe TxId)
forall e. PactDb e -&gt; ExecutionMode -&gt; Method e (Maybe TxId)
</span><span class="hs-identifier hs-var hs-var">_beginTx</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PactDbEnv e -&gt; PactDb e
forall e. PactDbEnv e -&gt; PactDb e
</span><span class="hs-identifier hs-var hs-var">pdPactDb</span></span><span> </span><span class="annot"><span class="annottext">PactDbEnv e
</span><a href="#local-6989586621681489732"><span class="hs-identifier hs-var">db</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ExecutionMode
</span><span class="hs-identifier hs-var">Transactional</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PactDbEnv e -&gt; MVar e
forall e. PactDbEnv e -&gt; MVar e
</span><span class="hs-identifier hs-var hs-var">pdPactDbVar</span></span><span> </span><span class="annot"><span class="annottext">PactDbEnv e
</span><a href="#local-6989586621681489732"><span class="hs-identifier hs-var">db</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-191"></span><span>
</span><span id="line-192"></span><span id="local-6989586621681489727"><span class="annot"><a href="Chainweb.Pact.Backend.Bench.html#commit"><span class="hs-identifier hs-type">commit</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">PactDbEnv</span></span><span> </span><span class="annot"><a href="#local-6989586621681489727"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-193"></span><span id="commit"><span class="annot"><span class="annottext">commit :: PactDbEnv e -&gt; IO ()
</span><a href="Chainweb.Pact.Backend.Bench.html#commit"><span class="hs-identifier hs-var hs-var">commit</span></a></span></span><span> </span><span id="local-6989586621681489725"><span class="annot"><span class="annottext">db :: PactDbEnv e
</span><a href="#local-6989586621681489725"><span class="hs-identifier hs-var">db</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IO [TxLog Value] -&gt; IO ()
forall (f :: * -&gt; *) a. Functor f =&gt; f a -&gt; f ()
</span><span class="hs-identifier hs-var">void</span></span><span> </span><span class="annot"><span class="annottext">(IO [TxLog Value] -&gt; IO ()) -&gt; IO [TxLog Value] -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">PactDb e -&gt; Method e [TxLog Value]
forall e. PactDb e -&gt; Method e [TxLog Value]
</span><span class="hs-identifier hs-var hs-var">_commitTx</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PactDbEnv e -&gt; PactDb e
forall e. PactDbEnv e -&gt; PactDb e
</span><span class="hs-identifier hs-var hs-var">pdPactDb</span></span><span> </span><span class="annot"><span class="annottext">PactDbEnv e
</span><a href="#local-6989586621681489725"><span class="hs-identifier hs-var">db</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PactDbEnv e -&gt; MVar e
forall e. PactDbEnv e -&gt; MVar e
</span><span class="hs-identifier hs-var hs-var">pdPactDbVar</span></span><span> </span><span class="annot"><span class="annottext">PactDbEnv e
</span><a href="#local-6989586621681489725"><span class="hs-identifier hs-var">db</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-194"></span><span>
</span><span id="line-195"></span><span id="local-6989586621681489909"><span class="annot"><a href="Chainweb.Pact.Backend.Bench.html#die"><span class="hs-identifier hs-type">die</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="#local-6989586621681489909"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-196"></span><span id="die"><span class="annot"><span class="annottext">die :: String -&gt; IO a
</span><a href="Chainweb.Pact.Backend.Bench.html#die"><span class="hs-identifier hs-var hs-var">die</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IOError -&gt; IO a
forall (m :: * -&gt; *) e a. (MonadThrow m, Exception e) =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwM</span></span><span> </span><span class="annot"><span class="annottext">(IOError -&gt; IO a) -&gt; (String -&gt; IOError) -&gt; String -&gt; IO a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; IOError
</span><span class="hs-identifier hs-var">userError</span></span><span>
</span><span id="line-197"></span><span>
</span><span id="line-198"></span><span id="local-6989586621681489978"><span class="annot"><a href="Chainweb.Pact.Backend.Bench.html#setupUserTable"><span class="hs-identifier hs-type">setupUserTable</span></a></span><span>
</span><span id="line-199"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">PactDbEnv</span></span><span> </span><span class="annot"><a href="#local-6989586621681489978"><span class="hs-identifier hs-type">e</span></a></span><span>
</span><span id="line-200"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Domain</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">RowKey</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ObjectMap</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">PactValue</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-201"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Chainweb.Utils.Bench.html#NoopNFData"><span class="hs-identifier hs-type">NoopNFData</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Domain</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">RowKey</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ObjectMap</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">PactValue</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span></span><span>
</span><span id="line-202"></span><span id="setupUserTable"><span class="annot"><span class="annottext">setupUserTable :: PactDbEnv e
-&gt; (Domain RowKey (ObjectMap PactValue) -&gt; IO ())
-&gt; IO (NoopNFData (Domain RowKey (ObjectMap PactValue)))
</span><a href="Chainweb.Pact.Backend.Bench.html#setupUserTable"><span class="hs-identifier hs-var hs-var">setupUserTable</span></a></span></span><span> </span><span id="local-6989586621681489720"><span class="annot"><span class="annottext">db :: PactDbEnv e
</span><a href="#local-6989586621681489720"><span class="hs-identifier hs-var">db</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">PactDbEnv</span></span><span> </span><span id="local-6989586621681489719"><span class="annot"><span class="annottext">pdb :: PactDb e
</span><a href="#local-6989586621681489719"><span class="hs-identifier hs-var">pdb</span></a></span></span><span> </span><span id="local-6989586621681489718"><span class="annot"><span class="annottext">e :: MVar e
</span><a href="#local-6989586621681489718"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621681489717"><span class="annot"><span class="annottext">setupio :: Domain RowKey (ObjectMap PactValue) -&gt; IO ()
</span><a href="#local-6989586621681489717"><span class="hs-identifier hs-var">setupio</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-203"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681489716"><span class="annot"><span class="annottext">tn :: TableName
</span><a href="#local-6989586621681489716"><span class="hs-identifier hs-var hs-var">tn</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-string">&quot;user1&quot;</span></span><span>
</span><span id="line-204"></span><span>        </span><span id="local-6989586621681489715"><span class="annot"><span class="annottext">ut :: Domain RowKey (ObjectMap PactValue)
</span><a href="#local-6989586621681489715"><span class="hs-identifier hs-var hs-var">ut</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TableName -&gt; Domain RowKey (ObjectMap PactValue)
</span><span class="hs-identifier hs-var">UserTables</span></span><span> </span><span class="annot"><span class="annottext">TableName
</span><a href="#local-6989586621681489716"><span class="hs-identifier hs-var">tn</span></a></span><span>
</span><span id="line-205"></span><span>    </span><span class="annot"><span class="annottext">PactDbEnv e -&gt; IO ()
forall e. PactDbEnv e -&gt; IO ()
</span><a href="Chainweb.Pact.Backend.Bench.html#begin"><span class="hs-identifier hs-var">begin</span></a></span><span> </span><span class="annot"><span class="annottext">PactDbEnv e
</span><a href="#local-6989586621681489720"><span class="hs-identifier hs-var">db</span></a></span><span>
</span><span id="line-206"></span><span>    </span><span class="annot"><span class="annottext">PactDb e -&gt; TableName -&gt; ModuleName -&gt; Method e ()
forall e. PactDb e -&gt; TableName -&gt; ModuleName -&gt; Method e ()
</span><span class="hs-identifier hs-var hs-var">_createUserTable</span></span><span> </span><span class="annot"><span class="annottext">PactDb e
</span><a href="#local-6989586621681489719"><span class="hs-identifier hs-var">pdb</span></a></span><span> </span><span class="annot"><span class="annottext">TableName
</span><a href="#local-6989586621681489716"><span class="hs-identifier hs-var">tn</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;someModule&quot;</span></span><span> </span><span class="annot"><span class="annottext">MVar e
</span><a href="#local-6989586621681489718"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-207"></span><span>    </span><span class="annot"><span class="annottext">Domain RowKey (ObjectMap PactValue) -&gt; IO ()
</span><a href="#local-6989586621681489717"><span class="hs-identifier hs-var">setupio</span></a></span><span> </span><span class="annot"><span class="annottext">Domain RowKey (ObjectMap PactValue)
</span><a href="#local-6989586621681489715"><span class="hs-identifier hs-var">ut</span></a></span><span>
</span><span id="line-208"></span><span>    </span><span class="annot"><span class="annottext">PactDbEnv e -&gt; IO ()
forall e. PactDbEnv e -&gt; IO ()
</span><a href="Chainweb.Pact.Backend.Bench.html#commit"><span class="hs-identifier hs-var">commit</span></a></span><span> </span><span class="annot"><span class="annottext">PactDbEnv e
</span><a href="#local-6989586621681489720"><span class="hs-identifier hs-var">db</span></a></span><span>
</span><span id="line-209"></span><span>    </span><span class="annot"><span class="annottext">NoopNFData (Domain RowKey (ObjectMap PactValue))
-&gt; IO (NoopNFData (Domain RowKey (ObjectMap PactValue)))
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(NoopNFData (Domain RowKey (ObjectMap PactValue))
 -&gt; IO (NoopNFData (Domain RowKey (ObjectMap PactValue))))
-&gt; NoopNFData (Domain RowKey (ObjectMap PactValue))
-&gt; IO (NoopNFData (Domain RowKey (ObjectMap PactValue)))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Domain RowKey (ObjectMap PactValue)
-&gt; NoopNFData (Domain RowKey (ObjectMap PactValue))
forall a. a -&gt; NoopNFData a
</span><a href="Chainweb.Utils.Bench.html#NoopNFData"><span class="hs-identifier hs-var">NoopNFData</span></a></span><span> </span><span class="annot"><span class="annottext">Domain RowKey (ObjectMap PactValue)
</span><a href="#local-6989586621681489715"><span class="hs-identifier hs-var">ut</span></a></span><span>
</span><span id="line-210"></span><span>
</span><span id="line-211"></span><span id="local-6989586621681489973"><span id="local-6989586621681489975"><span class="annot"><a href="Chainweb.Pact.Backend.Bench.html#writeRow"><span class="hs-identifier hs-type">writeRow</span></a></span><span>
</span><span id="line-212"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">AsString</span></span><span> </span><span class="annot"><a href="#local-6989586621681489975"><span class="hs-identifier hs-type">k</span></a></span><span>
</span><span id="line-213"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">PactDbEnv</span></span><span> </span><span class="annot"><a href="#local-6989586621681489973"><span class="hs-identifier hs-type">e</span></a></span><span>
</span><span id="line-214"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">WriteType</span></span><span>
</span><span id="line-215"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Domain</span></span><span> </span><span class="annot"><a href="#local-6989586621681489975"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ObjectMap</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">PactValue</span></span><span class="hs-special">)</span><span>
</span><span id="line-216"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FieldKey</span></span><span>
</span><span id="line-217"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681489975"><span class="hs-identifier hs-type">k</span></a></span><span>
</span><span id="line-218"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span>
</span><span id="line-219"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span></span><span>
</span><span id="line-220"></span><span id="writeRow"><span class="annot"><span class="annottext">writeRow :: PactDbEnv e
-&gt; WriteType
-&gt; Domain k (ObjectMap PactValue)
-&gt; FieldKey
-&gt; k
-&gt; Integer
-&gt; IO ()
</span><a href="Chainweb.Pact.Backend.Bench.html#writeRow"><span class="hs-identifier hs-var hs-var">writeRow</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">PactDbEnv</span></span><span> </span><span id="local-6989586621681489712"><span class="annot"><span class="annottext">pdb :: PactDb e
</span><a href="#local-6989586621681489712"><span class="hs-identifier hs-var">pdb</span></a></span></span><span> </span><span id="local-6989586621681489711"><span class="annot"><span class="annottext">e :: MVar e
</span><a href="#local-6989586621681489711"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621681489710"><span class="annot"><span class="annottext">writeType :: WriteType
</span><a href="#local-6989586621681489710"><span class="hs-identifier hs-var">writeType</span></a></span></span><span> </span><span id="local-6989586621681489709"><span class="annot"><span class="annottext">ut :: Domain k (ObjectMap PactValue)
</span><a href="#local-6989586621681489709"><span class="hs-identifier hs-var">ut</span></a></span></span><span> </span><span id="local-6989586621681489708"><span class="annot"><span class="annottext">f :: FieldKey
</span><a href="#local-6989586621681489708"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621681489707"><span class="annot"><span class="annottext">k :: k
</span><a href="#local-6989586621681489707"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621681489706"><span class="annot"><span class="annottext">i :: Integer
</span><a href="#local-6989586621681489706"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-221"></span><span>    </span><span class="annot"><span class="annottext">PactDb e
-&gt; WriteType
-&gt; Domain k (ObjectMap PactValue)
-&gt; k
-&gt; ObjectMap PactValue
-&gt; Method e ()
forall e.
PactDb e
-&gt; forall k v.
   (AsString k, ToJSON v) =&gt;
   WriteType -&gt; Domain k v -&gt; k -&gt; v -&gt; Method e ()
</span><span class="hs-identifier hs-var hs-var">_writeRow</span></span><span> </span><span class="annot"><span class="annottext">PactDb e
</span><a href="#local-6989586621681489712"><span class="hs-identifier hs-var">pdb</span></a></span><span> </span><span class="annot"><span class="annottext">WriteType
</span><a href="#local-6989586621681489710"><span class="hs-identifier hs-var">writeType</span></a></span><span> </span><span class="annot"><span class="annottext">Domain k (ObjectMap PactValue)
</span><a href="#local-6989586621681489709"><span class="hs-identifier hs-var">ut</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621681489707"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-222"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map FieldKey PactValue -&gt; ObjectMap PactValue
forall v. Map FieldKey v -&gt; ObjectMap v
</span><span class="hs-identifier hs-var">ObjectMap</span></span><span> </span><span class="annot"><span class="annottext">(Map FieldKey PactValue -&gt; ObjectMap PactValue)
-&gt; Map FieldKey PactValue -&gt; ObjectMap PactValue
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[(FieldKey, PactValue)] -&gt; Map FieldKey PactValue
forall k a. Ord k =&gt; [(k, a)] -&gt; Map k a
</span><span class="hs-identifier hs-var">M.fromList</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">FieldKey
</span><a href="#local-6989586621681489708"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">,</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Literal -&gt; PactValue
</span><span class="hs-identifier hs-var">PLiteral</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Literal
</span><span class="hs-identifier hs-var">LInteger</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621681489706"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">MVar e
</span><a href="#local-6989586621681489711"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-223"></span><span>
</span><span id="line-224"></span><span id="local-6989586621681490033"><span class="annot"><a href="Chainweb.Pact.Backend.Bench.html#benchUserTable"><span class="hs-identifier hs-type">benchUserTable</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">PactDbEnv</span></span><span> </span><span class="annot"><a href="#local-6989586621681490033"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">C.Benchmark</span></span></span><span>
</span><span id="line-225"></span><span id="benchUserTable"><span class="annot"><span class="annottext">benchUserTable :: Int -&gt; PactDbEnv e -&gt; Benchmark
</span><a href="Chainweb.Pact.Backend.Bench.html#benchUserTable"><span class="hs-identifier hs-var hs-var">benchUserTable</span></a></span></span><span> </span><span id="local-6989586621681489700"><span class="annot"><span class="annottext">transactionCount :: Int
</span><a href="#local-6989586621681489700"><span class="hs-identifier hs-var">transactionCount</span></a></span></span><span> </span><span id="local-6989586621681489699"><span class="annot"><span class="annottext">dbEnv :: PactDbEnv e
</span><a href="#local-6989586621681489699"><span class="hs-identifier hs-var">dbEnv</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IO (NoopNFData (Domain RowKey (ObjectMap PactValue)))
-&gt; (NoopNFData (Domain RowKey (ObjectMap PactValue)) -&gt; Benchmark)
-&gt; Benchmark
forall env. NFData env =&gt; IO env -&gt; (env -&gt; Benchmark) -&gt; Benchmark
</span><span class="hs-identifier hs-var">C.env</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PactDbEnv e
-&gt; IO (NoopNFData (Domain RowKey (ObjectMap PactValue)))
forall e.
PactDbEnv e
-&gt; IO (NoopNFData (Domain RowKey (ObjectMap PactValue)))
</span><a href="#local-6989586621681489698"><span class="hs-identifier hs-var">setup</span></a></span><span> </span><span class="annot"><span class="annottext">PactDbEnv e
</span><a href="#local-6989586621681489699"><span class="hs-identifier hs-var">dbEnv</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((NoopNFData (Domain RowKey (ObjectMap PactValue)) -&gt; Benchmark)
 -&gt; Benchmark)
-&gt; (NoopNFData (Domain RowKey (ObjectMap PactValue)) -&gt; Benchmark)
-&gt; Benchmark
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span> </span><span class="hs-glyph">~</span><span class="hs-special">(</span><span id="local-6989586621681489697"><span class="annot"><span class="annottext">NoopNFData (Domain RowKey (ObjectMap PactValue))
</span><a href="#local-6989586621681489697"><span class="hs-identifier hs-var">ut</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-226"></span><span>    </span><span class="annot"><span class="annottext">String -&gt; Benchmarkable -&gt; Benchmark
</span><span class="hs-identifier hs-var">C.bench</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621681489696"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">(Benchmarkable -&gt; Benchmark) -&gt; Benchmarkable -&gt; Benchmark
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">IO [Integer] -&gt; Benchmarkable
forall a. NFData a =&gt; IO a -&gt; Benchmarkable
</span><span class="hs-identifier hs-var">C.nfIO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PactDbEnv e
-&gt; NoopNFData (Domain RowKey (ObjectMap PactValue)) -&gt; IO [Integer]
forall e.
PactDbEnv e
-&gt; NoopNFData (Domain RowKey (ObjectMap PactValue)) -&gt; IO [Integer]
</span><a href="#local-6989586621681489695"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">PactDbEnv e
</span><a href="#local-6989586621681489699"><span class="hs-identifier hs-var">dbEnv</span></a></span><span> </span><span class="annot"><span class="annottext">NoopNFData (Domain RowKey (ObjectMap PactValue))
</span><a href="#local-6989586621681489697"><span class="hs-identifier hs-var">ut</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-227"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-228"></span><span>
</span><span id="line-229"></span><span>    </span><span id="local-6989586621681489698"><span class="annot"><span class="annottext">setup :: PactDbEnv e
-&gt; IO (NoopNFData (Domain RowKey (ObjectMap PactValue)))
</span><a href="#local-6989586621681489698"><span class="hs-identifier hs-var hs-var">setup</span></a></span></span><span> </span><span id="local-6989586621681489694"><span class="annot"><span class="annottext">db :: PactDbEnv e
</span><a href="#local-6989586621681489694"><span class="hs-identifier hs-var">db</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PactDbEnv e
-&gt; (Domain RowKey (ObjectMap PactValue) -&gt; IO ())
-&gt; IO (NoopNFData (Domain RowKey (ObjectMap PactValue)))
forall e.
PactDbEnv e
-&gt; (Domain RowKey (ObjectMap PactValue) -&gt; IO ())
-&gt; IO (NoopNFData (Domain RowKey (ObjectMap PactValue)))
</span><a href="Chainweb.Pact.Backend.Bench.html#setupUserTable"><span class="hs-identifier hs-var">setupUserTable</span></a></span><span> </span><span class="annot"><span class="annottext">PactDbEnv e
</span><a href="#local-6989586621681489694"><span class="hs-identifier hs-var">db</span></a></span><span> </span><span class="annot"><span class="annottext">((Domain RowKey (ObjectMap PactValue) -&gt; IO ())
 -&gt; IO (NoopNFData (Domain RowKey (ObjectMap PactValue))))
-&gt; (Domain RowKey (ObjectMap PactValue) -&gt; IO ())
-&gt; IO (NoopNFData (Domain RowKey (ObjectMap PactValue)))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621681489693"><span class="annot"><span class="annottext">ut :: Domain RowKey (ObjectMap PactValue)
</span><a href="#local-6989586621681489693"><span class="hs-identifier hs-var">ut</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">PactDbEnv e
-&gt; WriteType
-&gt; Domain RowKey (ObjectMap PactValue)
-&gt; FieldKey
-&gt; RowKey
-&gt; Integer
-&gt; IO ()
forall k e.
AsString k =&gt;
PactDbEnv e
-&gt; WriteType
-&gt; Domain k (ObjectMap PactValue)
-&gt; FieldKey
-&gt; k
-&gt; Integer
-&gt; IO ()
</span><a href="Chainweb.Pact.Backend.Bench.html#writeRow"><span class="hs-identifier hs-var">writeRow</span></a></span><span> </span><span class="annot"><span class="annottext">PactDbEnv e
</span><a href="#local-6989586621681489694"><span class="hs-identifier hs-var">db</span></a></span><span> </span><span class="annot"><span class="annottext">WriteType
</span><span class="hs-identifier hs-var">Insert</span></span><span> </span><span class="annot"><span class="annottext">Domain RowKey (ObjectMap PactValue)
</span><a href="#local-6989586621681489693"><span class="hs-identifier hs-var">ut</span></a></span><span> </span><span class="annot"><span class="annottext">FieldKey
</span><a href="#local-6989586621681489692"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">RowKey
</span><a href="#local-6989586621681489691"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span>
</span><span id="line-230"></span><span>
</span><span id="line-231"></span><span>    </span><span id="local-6989586621681489696"><span class="annot"><span class="annottext">name :: String
</span><a href="#local-6989586621681489696"><span class="hs-identifier hs-var hs-var">name</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-string">&quot;user-table/tc=&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681489700"><span class="hs-identifier hs-var">transactionCount</span></a></span><span>
</span><span id="line-232"></span><span>
</span><span id="line-233"></span><span>    </span><span id="local-6989586621681489691"><span class="annot"><span class="annottext">k :: RowKey
</span><a href="#local-6989586621681489691"><span class="hs-identifier hs-var hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-string">&quot;k&quot;</span></span><span>
</span><span id="line-234"></span><span>    </span><span id="local-6989586621681489692"><span class="annot"><span class="annottext">f :: FieldKey
</span><a href="#local-6989586621681489692"><span class="hs-identifier hs-var hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-string">&quot;f&quot;</span></span><span>
</span><span id="line-235"></span><span>
</span><span id="line-236"></span><span>    </span><span id="local-6989586621681489695"><span class="annot"><span class="annottext">go :: PactDbEnv e
-&gt; NoopNFData (Domain RowKey (ObjectMap PactValue)) -&gt; IO [Integer]
</span><a href="#local-6989586621681489695"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621681489690"><span class="annot"><span class="annottext">db :: PactDbEnv e
</span><a href="#local-6989586621681489690"><span class="hs-identifier hs-var">db</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Chainweb.Utils.Bench.html#NoopNFData"><span class="hs-identifier hs-type">NoopNFData</span></a></span><span> </span><span id="local-6989586621681489689"><span class="annot"><span class="annottext">ut :: Domain RowKey (ObjectMap PactValue)
</span><a href="#local-6989586621681489689"><span class="hs-identifier hs-var">ut</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-237"></span><span>      </span><span class="annot"><span class="annottext">Int -&gt; IO Integer -&gt; IO [Integer]
forall (m :: * -&gt; *) a. Applicative m =&gt; Int -&gt; m a -&gt; m [a]
</span><span class="hs-identifier hs-var">replicateM</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681489700"><span class="hs-identifier hs-var">transactionCount</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PactDbEnv e
-&gt; Domain RowKey (ObjectMap PactValue)
-&gt; FieldKey
-&gt; RowKey
-&gt; Integer
-&gt; IO Integer
forall e.
PactDbEnv e
-&gt; Domain RowKey (ObjectMap PactValue)
-&gt; FieldKey
-&gt; RowKey
-&gt; Integer
-&gt; IO Integer
</span><a href="Chainweb.Pact.Backend.Bench.html#incIntegerAtKey"><span class="hs-identifier hs-var">incIntegerAtKey</span></a></span><span> </span><span class="annot"><span class="annottext">PactDbEnv e
</span><a href="#local-6989586621681489690"><span class="hs-identifier hs-var">db</span></a></span><span> </span><span class="annot"><span class="annottext">Domain RowKey (ObjectMap PactValue)
</span><a href="#local-6989586621681489689"><span class="hs-identifier hs-var">ut</span></a></span><span> </span><span class="annot"><span class="annottext">FieldKey
</span><a href="#local-6989586621681489692"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">RowKey
</span><a href="#local-6989586621681489691"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-238"></span><span>
</span><span id="line-239"></span><span id="local-6989586621681489957"><span class="annot"><a href="Chainweb.Pact.Backend.Bench.html#incIntegerAtKey"><span class="hs-identifier hs-type">incIntegerAtKey</span></a></span><span>
</span><span id="line-240"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">PactDbEnv</span></span><span> </span><span class="annot"><a href="#local-6989586621681489957"><span class="hs-identifier hs-type">e</span></a></span><span>
</span><span id="line-241"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Domain</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">RowKey</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ObjectMap</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">PactValue</span></span><span class="hs-special">)</span><span>
</span><span id="line-242"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FieldKey</span></span><span>
</span><span id="line-243"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">RowKey</span></span><span>
</span><span id="line-244"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span>
</span><span id="line-245"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span></span><span>
</span><span id="line-246"></span><span id="incIntegerAtKey"><span class="annot"><span class="annottext">incIntegerAtKey :: PactDbEnv e
-&gt; Domain RowKey (ObjectMap PactValue)
-&gt; FieldKey
-&gt; RowKey
-&gt; Integer
-&gt; IO Integer
</span><a href="Chainweb.Pact.Backend.Bench.html#incIntegerAtKey"><span class="hs-identifier hs-var hs-var">incIntegerAtKey</span></a></span></span><span> </span><span id="local-6989586621681489687"><span class="annot"><span class="annottext">db :: PactDbEnv e
</span><a href="#local-6989586621681489687"><span class="hs-identifier hs-var">db</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">PactDbEnv</span></span><span> </span><span id="local-6989586621681489686"><span class="annot"><span class="annottext">pdb :: PactDb e
</span><a href="#local-6989586621681489686"><span class="hs-identifier hs-var">pdb</span></a></span></span><span> </span><span id="local-6989586621681489685"><span class="annot"><span class="annottext">e :: MVar e
</span><a href="#local-6989586621681489685"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621681489684"><span class="annot"><span class="annottext">ut :: Domain RowKey (ObjectMap PactValue)
</span><a href="#local-6989586621681489684"><span class="hs-identifier hs-var">ut</span></a></span></span><span> </span><span id="local-6989586621681489683"><span class="annot"><span class="annottext">f :: FieldKey
</span><a href="#local-6989586621681489683"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621681489682"><span class="annot"><span class="annottext">k :: RowKey
</span><a href="#local-6989586621681489682"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621681489681"><span class="annot"><span class="annottext">z :: Integer
</span><a href="#local-6989586621681489681"><span class="hs-identifier hs-var">z</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-247"></span><span>    </span><span class="annot"><span class="annottext">PactDbEnv e -&gt; IO ()
forall e. PactDbEnv e -&gt; IO ()
</span><a href="Chainweb.Pact.Backend.Bench.html#begin"><span class="hs-identifier hs-var">begin</span></a></span><span> </span><span class="annot"><span class="annottext">PactDbEnv e
</span><a href="#local-6989586621681489687"><span class="hs-identifier hs-var">db</span></a></span><span>
</span><span id="line-248"></span><span>    </span><span id="local-6989586621681489680"><span class="annot"><span class="annottext">Maybe (ObjectMap PactValue)
</span><a href="#local-6989586621681489680"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">PactDb e
-&gt; Domain RowKey (ObjectMap PactValue)
-&gt; RowKey
-&gt; Method e (Maybe (ObjectMap PactValue))
forall e.
PactDb e
-&gt; forall k v.
   (IsString k, FromJSON v) =&gt;
   Domain k v -&gt; k -&gt; Method e (Maybe v)
</span><span class="hs-identifier hs-var hs-var">_readRow</span></span><span> </span><span class="annot"><span class="annottext">PactDb e
</span><a href="#local-6989586621681489686"><span class="hs-identifier hs-var">pdb</span></a></span><span> </span><span class="annot"><span class="annottext">Domain RowKey (ObjectMap PactValue)
</span><a href="#local-6989586621681489684"><span class="hs-identifier hs-var">ut</span></a></span><span> </span><span class="annot"><span class="annottext">RowKey
</span><a href="#local-6989586621681489682"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">MVar e
</span><a href="#local-6989586621681489685"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-249"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe (ObjectMap PactValue)
</span><a href="#local-6989586621681489680"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-250"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; IO Integer
forall a. String -&gt; IO a
</span><a href="Chainweb.Pact.Backend.Bench.html#die"><span class="hs-identifier hs-var">die</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;no row read&quot;</span></span><span>
</span><span id="line-251"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ObjectMap</span></span><span> </span><span id="local-6989586621681489678"><span class="annot"><span class="annottext">m :: Map FieldKey PactValue
</span><a href="#local-6989586621681489678"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">FieldKey -&gt; Map FieldKey PactValue -&gt; Maybe PactValue
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><span class="hs-identifier hs-var">M.lookup</span></span><span> </span><span class="annot"><span class="annottext">FieldKey
</span><a href="#local-6989586621681489683"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Map FieldKey PactValue
</span><a href="#local-6989586621681489678"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-252"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; IO Integer
forall a. String -&gt; IO a
</span><a href="Chainweb.Pact.Backend.Bench.html#die"><span class="hs-identifier hs-var">die</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;field not found&quot;</span></span><span>
</span><span id="line-253"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">PLiteral</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">LInteger</span></span><span> </span><span id="local-6989586621681489676"><span class="annot"><span class="annottext">i :: Integer
</span><a href="#local-6989586621681489676"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-254"></span><span>                </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681489675"><span class="annot"><span class="annottext">j :: Integer
</span><a href="#local-6989586621681489675"><span class="hs-identifier hs-var hs-var">j</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621681489676"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621681489681"><span class="hs-identifier hs-var">z</span></a></span><span>
</span><span id="line-255"></span><span>                </span><span class="annot"><span class="annottext">PactDbEnv e
-&gt; WriteType
-&gt; Domain RowKey (ObjectMap PactValue)
-&gt; FieldKey
-&gt; RowKey
-&gt; Integer
-&gt; IO ()
forall k e.
AsString k =&gt;
PactDbEnv e
-&gt; WriteType
-&gt; Domain k (ObjectMap PactValue)
-&gt; FieldKey
-&gt; k
-&gt; Integer
-&gt; IO ()
</span><a href="Chainweb.Pact.Backend.Bench.html#writeRow"><span class="hs-identifier hs-var">writeRow</span></a></span><span> </span><span class="annot"><span class="annottext">PactDbEnv e
</span><a href="#local-6989586621681489687"><span class="hs-identifier hs-var">db</span></a></span><span> </span><span class="annot"><span class="annottext">WriteType
</span><span class="hs-identifier hs-var">Update</span></span><span> </span><span class="annot"><span class="annottext">Domain RowKey (ObjectMap PactValue)
</span><a href="#local-6989586621681489684"><span class="hs-identifier hs-var">ut</span></a></span><span> </span><span class="annot"><span class="annottext">FieldKey
</span><a href="#local-6989586621681489683"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">RowKey
</span><a href="#local-6989586621681489682"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621681489675"><span class="hs-identifier hs-var">j</span></a></span><span>
</span><span id="line-256"></span><span>                </span><span class="annot"><span class="annottext">PactDbEnv e -&gt; IO ()
forall e. PactDbEnv e -&gt; IO ()
</span><a href="Chainweb.Pact.Backend.Bench.html#commit"><span class="hs-identifier hs-var">commit</span></a></span><span> </span><span class="annot"><span class="annottext">PactDbEnv e
</span><a href="#local-6989586621681489687"><span class="hs-identifier hs-var">db</span></a></span><span>
</span><span id="line-257"></span><span>                </span><span class="annot"><span class="annottext">Integer -&gt; IO Integer
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621681489675"><span class="hs-identifier hs-var">j</span></a></span><span>
</span><span id="line-258"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; IO Integer
forall a. String -&gt; IO a
</span><a href="Chainweb.Pact.Backend.Bench.html#die"><span class="hs-identifier hs-var">die</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;field not integer&quot;</span></span><span>
</span><span id="line-259"></span><span>
</span><span id="line-260"></span><span id="local-6989586621681489673"><span class="annot"><a href="Chainweb.Pact.Backend.Bench.html#benchUserTableForKeys"><span class="hs-identifier hs-type">benchUserTableForKeys</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">PactDbEnv</span></span><span> </span><span class="annot"><a href="#local-6989586621681489673"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">C.Benchmark</span></span></span><span>
</span><span id="line-261"></span><span id="benchUserTableForKeys"><span class="annot"><span class="annottext">benchUserTableForKeys :: Int -&gt; PactDbEnv e -&gt; Benchmark
</span><a href="Chainweb.Pact.Backend.Bench.html#benchUserTableForKeys"><span class="hs-identifier hs-var hs-var">benchUserTableForKeys</span></a></span></span><span> </span><span id="local-6989586621681489672"><span class="annot"><span class="annottext">numSampleEvents :: Int
</span><a href="#local-6989586621681489672"><span class="hs-identifier hs-var">numSampleEvents</span></a></span></span><span> </span><span id="local-6989586621681489671"><span class="annot"><span class="annottext">dbEnv :: PactDbEnv e
</span><a href="#local-6989586621681489671"><span class="hs-identifier hs-var">dbEnv</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-262"></span><span>    </span><span class="annot"><span class="annottext">IO (NoopNFData (Domain RowKey (ObjectMap PactValue)))
-&gt; (NoopNFData (Domain RowKey (ObjectMap PactValue)) -&gt; Benchmark)
-&gt; Benchmark
forall env. NFData env =&gt; IO env -&gt; (env -&gt; Benchmark) -&gt; Benchmark
</span><span class="hs-identifier hs-var">C.env</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PactDbEnv e
-&gt; IO (NoopNFData (Domain RowKey (ObjectMap PactValue)))
forall e.
PactDbEnv e
-&gt; IO (NoopNFData (Domain RowKey (ObjectMap PactValue)))
</span><a href="#local-6989586621681489670"><span class="hs-identifier hs-var">setup</span></a></span><span> </span><span class="annot"><span class="annottext">PactDbEnv e
</span><a href="#local-6989586621681489671"><span class="hs-identifier hs-var">dbEnv</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((NoopNFData (Domain RowKey (ObjectMap PactValue)) -&gt; Benchmark)
 -&gt; Benchmark)
-&gt; (NoopNFData (Domain RowKey (ObjectMap PactValue)) -&gt; Benchmark)
-&gt; Benchmark
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span> </span><span class="hs-glyph">~</span><span class="hs-special">(</span><span id="local-6989586621681489669"><span class="annot"><span class="annottext">NoopNFData (Domain RowKey (ObjectMap PactValue))
</span><a href="#local-6989586621681489669"><span class="hs-identifier hs-var">ut</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; Benchmarkable -&gt; Benchmark
</span><span class="hs-identifier hs-var">C.bench</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621681489668"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">(Benchmarkable -&gt; Benchmark) -&gt; Benchmarkable -&gt; Benchmark
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">IO () -&gt; Benchmarkable
forall a. NFData a =&gt; IO a -&gt; Benchmarkable
</span><span class="hs-identifier hs-var">C.nfIO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PactDbEnv e
-&gt; NoopNFData (Domain RowKey (ObjectMap PactValue)) -&gt; IO ()
forall e.
PactDbEnv e
-&gt; NoopNFData (Domain RowKey (ObjectMap PactValue)) -&gt; IO ()
</span><a href="#local-6989586621681489667"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">PactDbEnv e
</span><a href="#local-6989586621681489671"><span class="hs-identifier hs-var">dbEnv</span></a></span><span> </span><span class="annot"><span class="annottext">NoopNFData (Domain RowKey (ObjectMap PactValue))
</span><a href="#local-6989586621681489669"><span class="hs-identifier hs-var">ut</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-263"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-264"></span><span>
</span><span id="line-265"></span><span>    </span><span class="annot"><a href="#local-6989586621681489666"><span class="hs-identifier hs-type">numberOfKeys</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span>
</span><span id="line-266"></span><span>    </span><span id="local-6989586621681489666"><span class="annot"><span class="annottext">numberOfKeys :: Integer
</span><a href="#local-6989586621681489666"><span class="hs-identifier hs-var hs-var">numberOfKeys</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-number">10</span></span><span>
</span><span id="line-267"></span><span>
</span><span id="line-268"></span><span>    </span><span id="local-6989586621681489670"><span class="annot"><span class="annottext">setup :: PactDbEnv e
-&gt; IO (NoopNFData (Domain RowKey (ObjectMap PactValue)))
</span><a href="#local-6989586621681489670"><span class="hs-identifier hs-var hs-var">setup</span></a></span></span><span> </span><span id="local-6989586621681489665"><span class="annot"><span class="annottext">db :: PactDbEnv e
</span><a href="#local-6989586621681489665"><span class="hs-identifier hs-var">db</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PactDbEnv e
-&gt; (Domain RowKey (ObjectMap PactValue) -&gt; IO ())
-&gt; IO (NoopNFData (Domain RowKey (ObjectMap PactValue)))
forall e.
PactDbEnv e
-&gt; (Domain RowKey (ObjectMap PactValue) -&gt; IO ())
-&gt; IO (NoopNFData (Domain RowKey (ObjectMap PactValue)))
</span><a href="Chainweb.Pact.Backend.Bench.html#setupUserTable"><span class="hs-identifier hs-var">setupUserTable</span></a></span><span> </span><span class="annot"><span class="annottext">PactDbEnv e
</span><a href="#local-6989586621681489665"><span class="hs-identifier hs-var">db</span></a></span><span> </span><span class="annot"><span class="annottext">((Domain RowKey (ObjectMap PactValue) -&gt; IO ())
 -&gt; IO (NoopNFData (Domain RowKey (ObjectMap PactValue))))
-&gt; (Domain RowKey (ObjectMap PactValue) -&gt; IO ())
-&gt; IO (NoopNFData (Domain RowKey (ObjectMap PactValue)))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621681489664"><span class="annot"><span class="annottext">ut :: Domain RowKey (ObjectMap PactValue)
</span><a href="#local-6989586621681489664"><span class="hs-identifier hs-var">ut</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-269"></span><span>      </span><span class="annot"><span class="annottext">[Integer] -&gt; (Integer -&gt; IO ()) -&gt; IO ()
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
t a -&gt; (a -&gt; m b) -&gt; m ()
</span><span class="hs-identifier hs-var">forM_</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-number">1</span></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621681489666"><span class="hs-identifier hs-var">numberOfKeys</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">((Integer -&gt; IO ()) -&gt; IO ()) -&gt; (Integer -&gt; IO ()) -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621681489662"><span class="annot"><span class="annottext">i :: Integer
</span><a href="#local-6989586621681489662"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-270"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681489661"><span class="annot"><span class="annottext">rowkey :: RowKey
</span><a href="#local-6989586621681489661"><span class="hs-identifier hs-var hs-var">rowkey</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; RowKey
</span><span class="hs-identifier hs-var">RowKey</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; RowKey) -&gt; Text -&gt; RowKey
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="hs-string">&quot;k&quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Text
forall a b. StringConv a b =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">toS</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621681489662"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-271"></span><span>          </span><span class="annot"><span class="annottext">PactDbEnv e
-&gt; WriteType
-&gt; Domain RowKey (ObjectMap PactValue)
-&gt; FieldKey
-&gt; RowKey
-&gt; Integer
-&gt; IO ()
forall k e.
AsString k =&gt;
PactDbEnv e
-&gt; WriteType
-&gt; Domain k (ObjectMap PactValue)
-&gt; FieldKey
-&gt; k
-&gt; Integer
-&gt; IO ()
</span><a href="Chainweb.Pact.Backend.Bench.html#writeRow"><span class="hs-identifier hs-var">writeRow</span></a></span><span> </span><span class="annot"><span class="annottext">PactDbEnv e
</span><a href="#local-6989586621681489665"><span class="hs-identifier hs-var">db</span></a></span><span> </span><span class="annot"><span class="annottext">WriteType
</span><span class="hs-identifier hs-var">Insert</span></span><span> </span><span class="annot"><span class="annottext">Domain RowKey (ObjectMap PactValue)
</span><a href="#local-6989586621681489664"><span class="hs-identifier hs-var">ut</span></a></span><span> </span><span class="annot"><span class="annottext">FieldKey
</span><a href="#local-6989586621681489659"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">RowKey
</span><a href="#local-6989586621681489661"><span class="hs-identifier hs-var">rowkey</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621681489662"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-272"></span><span>
</span><span id="line-273"></span><span>    </span><span id="local-6989586621681489659"><span class="annot"><span class="annottext">f :: FieldKey
</span><a href="#local-6989586621681489659"><span class="hs-identifier hs-var hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-string">&quot;f&quot;</span></span><span>
</span><span id="line-274"></span><span>
</span><span id="line-275"></span><span>    </span><span id="local-6989586621681489668"><span class="annot"><span class="annottext">name :: String
</span><a href="#local-6989586621681489668"><span class="hs-identifier hs-var hs-var">name</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-string">&quot;user-table-keys/sampleEvents=&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681489672"><span class="hs-identifier hs-var">numSampleEvents</span></a></span><span>
</span><span id="line-276"></span><span>
</span><span id="line-277"></span><span>    </span><span id="local-6989586621681489658"><span class="annot"><span class="annottext">unpack :: Maybe (ObjectMap PactValue) -&gt; IO Integer
</span><a href="#local-6989586621681489658"><span class="hs-identifier hs-var hs-var">unpack</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-278"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; IO Integer
forall a. String -&gt; IO a
</span><a href="Chainweb.Pact.Backend.Bench.html#die"><span class="hs-identifier hs-var">die</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;no row read&quot;</span></span><span>
</span><span id="line-279"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ObjectMap</span></span><span> </span><span id="local-6989586621681489657"><span class="annot"><span class="annottext">m :: Map FieldKey PactValue
</span><a href="#local-6989586621681489657"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">FieldKey -&gt; Map FieldKey PactValue -&gt; Maybe PactValue
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><span class="hs-identifier hs-var">M.lookup</span></span><span> </span><span class="annot"><span class="annottext">FieldKey
</span><a href="#local-6989586621681489659"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Map FieldKey PactValue
</span><a href="#local-6989586621681489657"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-280"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; IO Integer
forall a. String -&gt; IO a
</span><a href="Chainweb.Pact.Backend.Bench.html#die"><span class="hs-identifier hs-var">die</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;field not found&quot;</span></span><span>
</span><span id="line-281"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">PLiteral</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">LInteger</span></span><span> </span><span id="local-6989586621681489656"><span class="annot"><span class="annottext">result :: Integer
</span><a href="#local-6989586621681489656"><span class="hs-identifier hs-var">result</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; IO Integer
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621681489656"><span class="hs-identifier hs-var">result</span></a></span><span>
</span><span id="line-282"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; IO Integer
forall a. String -&gt; IO a
</span><a href="Chainweb.Pact.Backend.Bench.html#die"><span class="hs-identifier hs-var">die</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;field not integer&quot;</span></span><span>
</span><span id="line-283"></span><span>
</span><span id="line-284"></span><span>
</span><span id="line-285"></span><span>    </span><span id="local-6989586621681489667"><span class="annot"><span class="annottext">go :: PactDbEnv e
-&gt; NoopNFData (Domain RowKey (ObjectMap PactValue)) -&gt; IO ()
</span><a href="#local-6989586621681489667"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621681489655"><span class="annot"><span class="annottext">db :: PactDbEnv e
</span><a href="#local-6989586621681489655"><span class="hs-identifier hs-var">db</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">PactDbEnv</span></span><span> </span><span id="local-6989586621681489654"><span class="annot"><span class="annottext">pdb :: PactDb e
</span><a href="#local-6989586621681489654"><span class="hs-identifier hs-var">pdb</span></a></span></span><span> </span><span id="local-6989586621681489653"><span class="annot"><span class="annottext">e :: MVar e
</span><a href="#local-6989586621681489653"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Chainweb.Utils.Bench.html#NoopNFData"><span class="hs-identifier hs-type">NoopNFData</span></a></span><span> </span><span id="local-6989586621681489652"><span class="annot"><span class="annottext">ut :: Domain RowKey (ObjectMap PactValue)
</span><a href="#local-6989586621681489652"><span class="hs-identifier hs-var">ut</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-286"></span><span>      </span><span class="annot"><span class="annottext">[Int] -&gt; (Int -&gt; IO ()) -&gt; IO ()
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
t a -&gt; (a -&gt; m b) -&gt; m ()
</span><span class="hs-identifier hs-var">forM_</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-number">1</span></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681489672"><span class="hs-identifier hs-var">numSampleEvents</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">((Int -&gt; IO ()) -&gt; IO ()) -&gt; (Int -&gt; IO ()) -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-287"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681489651"><span class="annot"><span class="annottext">torowkey :: a -&gt; RowKey
</span><a href="#local-6989586621681489651"><span class="hs-identifier hs-var hs-var">torowkey</span></a></span></span><span> </span><span id="local-6989586621681489650"><span class="annot"><span class="annottext">ind :: a
</span><a href="#local-6989586621681489650"><span class="hs-identifier hs-var">ind</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; RowKey
</span><span class="hs-identifier hs-var">RowKey</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; RowKey) -&gt; Text -&gt; RowKey
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="hs-string">&quot;k&quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Text
forall a b. StringConv a b =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">toS</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681489650"><span class="hs-identifier hs-var">ind</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-288"></span><span>          </span><span id="local-6989586621681489649"><span class="annot"><span class="annottext">RowKey
</span><a href="#local-6989586621681489649"><span class="hs-identifier hs-var">rowkeya</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; RowKey
forall a. Show a =&gt; a -&gt; RowKey
</span><a href="#local-6989586621681489651"><span class="hs-identifier hs-var">torowkey</span></a></span><span> </span><span class="annot"><span class="annottext">(Integer -&gt; RowKey) -&gt; IO Integer -&gt; IO RowKey
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">(Integer, Integer) -&gt; IO Integer
forall a. Random a =&gt; (a, a) -&gt; IO a
</span><span class="hs-identifier hs-var">randomRIO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621681489666"><span class="hs-identifier hs-var">numberOfKeys</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-289"></span><span>          </span><span id="local-6989586621681489646"><span class="annot"><span class="annottext">RowKey
</span><a href="#local-6989586621681489646"><span class="hs-identifier hs-var">rowkeyb</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; RowKey
forall a. Show a =&gt; a -&gt; RowKey
</span><a href="#local-6989586621681489651"><span class="hs-identifier hs-var">torowkey</span></a></span><span> </span><span class="annot"><span class="annottext">(Integer -&gt; RowKey) -&gt; IO Integer -&gt; IO RowKey
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">(Integer, Integer) -&gt; IO Integer
forall a. Random a =&gt; (a, a) -&gt; IO a
</span><span class="hs-identifier hs-var">randomRIO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621681489666"><span class="hs-identifier hs-var">numberOfKeys</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-290"></span><span>          </span><span id="local-6989586621681489645"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621681489645"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">PactDb e
-&gt; Domain RowKey (ObjectMap PactValue)
-&gt; RowKey
-&gt; Method e (Maybe (ObjectMap PactValue))
forall e.
PactDb e
-&gt; forall k v.
   (IsString k, FromJSON v) =&gt;
   Domain k v -&gt; k -&gt; Method e (Maybe v)
</span><span class="hs-identifier hs-var hs-var">_readRow</span></span><span> </span><span class="annot"><span class="annottext">PactDb e
</span><a href="#local-6989586621681489654"><span class="hs-identifier hs-var">pdb</span></a></span><span> </span><span class="annot"><span class="annottext">Domain RowKey (ObjectMap PactValue)
</span><a href="#local-6989586621681489652"><span class="hs-identifier hs-var">ut</span></a></span><span> </span><span class="annot"><span class="annottext">RowKey
</span><a href="#local-6989586621681489649"><span class="hs-identifier hs-var">rowkeya</span></a></span><span> </span><span class="annot"><span class="annottext">MVar e
</span><a href="#local-6989586621681489653"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">IO (Maybe (ObjectMap PactValue))
-&gt; (Maybe (ObjectMap PactValue) -&gt; IO Integer) -&gt; IO Integer
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Maybe (ObjectMap PactValue) -&gt; IO Integer
</span><a href="#local-6989586621681489658"><span class="hs-identifier hs-var">unpack</span></a></span><span>
</span><span id="line-291"></span><span>          </span><span id="local-6989586621681489644"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621681489644"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">PactDb e
-&gt; Domain RowKey (ObjectMap PactValue)
-&gt; RowKey
-&gt; Method e (Maybe (ObjectMap PactValue))
forall e.
PactDb e
-&gt; forall k v.
   (IsString k, FromJSON v) =&gt;
   Domain k v -&gt; k -&gt; Method e (Maybe v)
</span><span class="hs-identifier hs-var hs-var">_readRow</span></span><span> </span><span class="annot"><span class="annottext">PactDb e
</span><a href="#local-6989586621681489654"><span class="hs-identifier hs-var">pdb</span></a></span><span> </span><span class="annot"><span class="annottext">Domain RowKey (ObjectMap PactValue)
</span><a href="#local-6989586621681489652"><span class="hs-identifier hs-var">ut</span></a></span><span> </span><span class="annot"><span class="annottext">RowKey
</span><a href="#local-6989586621681489646"><span class="hs-identifier hs-var">rowkeyb</span></a></span><span> </span><span class="annot"><span class="annottext">MVar e
</span><a href="#local-6989586621681489653"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">IO (Maybe (ObjectMap PactValue))
-&gt; (Maybe (ObjectMap PactValue) -&gt; IO Integer) -&gt; IO Integer
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Maybe (ObjectMap PactValue) -&gt; IO Integer
</span><a href="#local-6989586621681489658"><span class="hs-identifier hs-var">unpack</span></a></span><span>
</span><span id="line-292"></span><span>          </span><span class="annot"><span class="annottext">PactDbEnv e
-&gt; WriteType
-&gt; Domain RowKey (ObjectMap PactValue)
-&gt; FieldKey
-&gt; RowKey
-&gt; Integer
-&gt; IO ()
forall k e.
AsString k =&gt;
PactDbEnv e
-&gt; WriteType
-&gt; Domain k (ObjectMap PactValue)
-&gt; FieldKey
-&gt; k
-&gt; Integer
-&gt; IO ()
</span><a href="Chainweb.Pact.Backend.Bench.html#writeRow"><span class="hs-identifier hs-var">writeRow</span></a></span><span> </span><span class="annot"><span class="annottext">PactDbEnv e
</span><a href="#local-6989586621681489655"><span class="hs-identifier hs-var">db</span></a></span><span> </span><span class="annot"><span class="annottext">WriteType
</span><span class="hs-identifier hs-var">Update</span></span><span> </span><span class="annot"><span class="annottext">Domain RowKey (ObjectMap PactValue)
</span><a href="#local-6989586621681489652"><span class="hs-identifier hs-var">ut</span></a></span><span> </span><span class="annot"><span class="annottext">FieldKey
</span><a href="#local-6989586621681489659"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">RowKey
</span><a href="#local-6989586621681489649"><span class="hs-identifier hs-var">rowkeya</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621681489644"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-293"></span><span>          </span><span class="annot"><span class="annottext">PactDbEnv e
-&gt; WriteType
-&gt; Domain RowKey (ObjectMap PactValue)
-&gt; FieldKey
-&gt; RowKey
-&gt; Integer
-&gt; IO ()
forall k e.
AsString k =&gt;
PactDbEnv e
-&gt; WriteType
-&gt; Domain k (ObjectMap PactValue)
-&gt; FieldKey
-&gt; k
-&gt; Integer
-&gt; IO ()
</span><a href="Chainweb.Pact.Backend.Bench.html#writeRow"><span class="hs-identifier hs-var">writeRow</span></a></span><span> </span><span class="annot"><span class="annottext">PactDbEnv e
</span><a href="#local-6989586621681489655"><span class="hs-identifier hs-var">db</span></a></span><span> </span><span class="annot"><span class="annottext">WriteType
</span><span class="hs-identifier hs-var">Update</span></span><span> </span><span class="annot"><span class="annottext">Domain RowKey (ObjectMap PactValue)
</span><a href="#local-6989586621681489652"><span class="hs-identifier hs-var">ut</span></a></span><span> </span><span class="annot"><span class="annottext">FieldKey
</span><a href="#local-6989586621681489659"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">RowKey
</span><a href="#local-6989586621681489646"><span class="hs-identifier hs-var">rowkeyb</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621681489645"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-294"></span><span>
</span><span id="line-295"></span><span>
</span><span id="line-296"></span><span class="annot"><a href="Chainweb.Pact.Backend.Bench.html#_cpBenchKeys"><span class="hs-identifier hs-type">_cpBenchKeys</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Chainweb.Pact.Backend.Types.html#CheckpointEnv"><span class="hs-identifier hs-type">CheckpointEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">C.Benchmark</span></span><span>
</span><span id="line-297"></span><span id="_cpBenchKeys"><span class="annot"><span class="annottext">_cpBenchKeys :: Int -&gt; CheckpointEnv -&gt; Benchmark
</span><a href="Chainweb.Pact.Backend.Bench.html#_cpBenchKeys"><span class="hs-identifier hs-var hs-var">_cpBenchKeys</span></a></span></span><span> </span><span id="local-6989586621681489642"><span class="annot"><span class="annottext">numKeys :: Int
</span><a href="#local-6989586621681489642"><span class="hs-identifier hs-var">numKeys</span></a></span></span><span> </span><span id="local-6989586621681489641"><span class="annot"><span class="annottext">cp :: CheckpointEnv
</span><a href="#local-6989586621681489641"><span class="hs-identifier hs-var">cp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-298"></span><span>    </span><span class="annot"><span class="annottext">IO (NoopNFData (Domain RowKey (ObjectMap PactValue)))
-&gt; (NoopNFData (Domain RowKey (ObjectMap PactValue)) -&gt; Benchmark)
-&gt; Benchmark
forall env. NFData env =&gt; IO env -&gt; (env -&gt; Benchmark) -&gt; Benchmark
</span><span class="hs-identifier hs-var">C.env</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CheckpointEnv
-&gt; IO (NoopNFData (Domain RowKey (ObjectMap PactValue)))
</span><a href="#local-6989586621681489640"><span class="hs-identifier hs-var">setup'</span></a></span><span> </span><span class="annot"><span class="annottext">CheckpointEnv
</span><a href="#local-6989586621681489641"><span class="hs-identifier hs-var">cp</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((NoopNFData (Domain RowKey (ObjectMap PactValue)) -&gt; Benchmark)
 -&gt; Benchmark)
-&gt; (NoopNFData (Domain RowKey (ObjectMap PactValue)) -&gt; Benchmark)
-&gt; Benchmark
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span> </span><span class="hs-glyph">~</span><span class="hs-special">(</span><span id="local-6989586621681489639"><span class="annot"><span class="annottext">NoopNFData (Domain RowKey (ObjectMap PactValue))
</span><a href="#local-6989586621681489639"><span class="hs-identifier hs-var">ut</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; Benchmarkable -&gt; Benchmark
</span><span class="hs-identifier hs-var">C.bench</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621681489638"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">(Benchmarkable -&gt; Benchmark) -&gt; Benchmarkable -&gt; Benchmark
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">IO () -&gt; Benchmarkable
forall a. NFData a =&gt; IO a -&gt; Benchmarkable
</span><span class="hs-identifier hs-var">C.nfIO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CheckpointEnv
-&gt; NoopNFData (Domain RowKey (ObjectMap PactValue)) -&gt; IO ()
</span><a href="#local-6989586621681489637"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">CheckpointEnv
</span><a href="#local-6989586621681489641"><span class="hs-identifier hs-var">cp</span></a></span><span> </span><span class="annot"><span class="annottext">NoopNFData (Domain RowKey (ObjectMap PactValue))
</span><a href="#local-6989586621681489639"><span class="hs-identifier hs-var">ut</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-299"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-300"></span><span>    </span><span id="local-6989586621681489638"><span class="annot"><span class="annottext">name :: String
</span><a href="#local-6989586621681489638"><span class="hs-identifier hs-var hs-var">name</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-string">&quot;withKeys/keyCount=&quot;</span></span><span>
</span><span id="line-301"></span><span>      </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681489642"><span class="hs-identifier hs-var">numKeys</span></a></span><span>
</span><span id="line-302"></span><span>    </span><span id="local-6989586621681489640"><span class="annot"><span class="annottext">setup' :: CheckpointEnv
-&gt; IO (NoopNFData (Domain RowKey (ObjectMap PactValue)))
</span><a href="#local-6989586621681489640"><span class="hs-identifier hs-var hs-var">setup'</span></a></span></span><span> </span><span id="local-6989586621681489635"><span id="local-6989586621681489636"><span class="annot"><a href="Chainweb.Pact.Backend.Types.html#CheckpointEnv"><span class="hs-identifier hs-type">CheckpointEnv</span></a></span><span class="hs-special">{</span><span class="hs-glyph">..</span><span class="hs-special">}</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-303"></span><span>        </span><span id="local-6989586621681489634"><span class="annot"><span class="annottext">NoopNFData (Domain RowKey (ObjectMap PactValue))
</span><a href="#local-6989586621681489634"><span class="hs-identifier hs-var">usertablename</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Checkpointer -&gt; Maybe (BlockHeight, BlockHash) -&gt; IO PactDbEnv'
</span><a href="Chainweb.Pact.Backend.Types.html#_cpRestore"><span class="hs-identifier hs-var hs-var">_cpRestore</span></a></span><span> </span><span class="annot"><span class="annottext">Checkpointer
</span><a href="#local-6989586621681489636"><span class="hs-identifier hs-var">_cpeCheckpointer</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (BlockHeight, BlockHash)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="annot"><span class="annottext">IO PactDbEnv'
-&gt; (PactDbEnv'
    -&gt; IO (NoopNFData (Domain RowKey (ObjectMap PactValue))))
-&gt; IO (NoopNFData (Domain RowKey (ObjectMap PactValue)))
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-304"></span><span>            </span><span class="annot"><a href="Chainweb.Pact.Backend.Types.html#PactDbEnv%27"><span class="hs-identifier hs-type">PactDbEnv'</span></a></span><span> </span><span id="local-6989586621681489633"><span class="annot"><span class="annottext">db :: PactDbEnv e
</span><a href="#local-6989586621681489633"><span class="hs-identifier hs-var">db</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-305"></span><span>              </span><span class="annot"><span class="annottext">PactDbEnv e
-&gt; (Domain RowKey (ObjectMap PactValue) -&gt; IO ())
-&gt; IO (NoopNFData (Domain RowKey (ObjectMap PactValue)))
forall e.
PactDbEnv e
-&gt; (Domain RowKey (ObjectMap PactValue) -&gt; IO ())
-&gt; IO (NoopNFData (Domain RowKey (ObjectMap PactValue)))
</span><a href="Chainweb.Pact.Backend.Bench.html#setupUserTable"><span class="hs-identifier hs-var">setupUserTable</span></a></span><span> </span><span class="annot"><span class="annottext">PactDbEnv e
</span><a href="#local-6989586621681489633"><span class="hs-identifier hs-var">db</span></a></span><span> </span><span class="annot"><span class="annottext">((Domain RowKey (ObjectMap PactValue) -&gt; IO ())
 -&gt; IO (NoopNFData (Domain RowKey (ObjectMap PactValue))))
-&gt; (Domain RowKey (ObjectMap PactValue) -&gt; IO ())
-&gt; IO (NoopNFData (Domain RowKey (ObjectMap PactValue)))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621681489632"><span class="annot"><span class="annottext">ut :: Domain RowKey (ObjectMap PactValue)
</span><a href="#local-6989586621681489632"><span class="hs-identifier hs-var">ut</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Int] -&gt; (Int -&gt; IO ()) -&gt; IO ()
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
t a -&gt; (a -&gt; m b) -&gt; m ()
</span><span class="hs-identifier hs-var">forM_</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-number">1</span></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681489642"><span class="hs-identifier hs-var">numKeys</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">((Int -&gt; IO ()) -&gt; IO ()) -&gt; (Int -&gt; IO ()) -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621681489631"><span class="annot"><span class="annottext">i :: Int
</span><a href="#local-6989586621681489631"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-306"></span><span>                  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681489630"><span class="annot"><span class="annottext">rowkey :: RowKey
</span><a href="#local-6989586621681489630"><span class="hs-identifier hs-var hs-var">rowkey</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; RowKey
</span><span class="hs-identifier hs-var">RowKey</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; RowKey) -&gt; Text -&gt; RowKey
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="hs-string">&quot;k&quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Text
forall a b. StringConv a b =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">toS</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681489631"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-307"></span><span>                  </span><span class="annot"><span class="annottext">PactDbEnv e
-&gt; WriteType
-&gt; Domain RowKey (ObjectMap PactValue)
-&gt; FieldKey
-&gt; RowKey
-&gt; Integer
-&gt; IO ()
forall k e.
AsString k =&gt;
PactDbEnv e
-&gt; WriteType
-&gt; Domain k (ObjectMap PactValue)
-&gt; FieldKey
-&gt; k
-&gt; Integer
-&gt; IO ()
</span><a href="Chainweb.Pact.Backend.Bench.html#writeRow"><span class="hs-identifier hs-var">writeRow</span></a></span><span> </span><span class="annot"><span class="annottext">PactDbEnv e
</span><a href="#local-6989586621681489633"><span class="hs-identifier hs-var">db</span></a></span><span> </span><span class="annot"><span class="annottext">WriteType
</span><span class="hs-identifier hs-var">Insert</span></span><span> </span><span class="annot"><span class="annottext">Domain RowKey (ObjectMap PactValue)
</span><a href="#local-6989586621681489632"><span class="hs-identifier hs-var">ut</span></a></span><span> </span><span class="annot"><span class="annottext">FieldKey
</span><a href="#local-6989586621681489629"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">RowKey
</span><a href="#local-6989586621681489630"><span class="hs-identifier hs-var">rowkey</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Integer
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681489631"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-308"></span><span>
</span><span id="line-309"></span><span>        </span><span class="annot"><span class="annottext">Checkpointer -&gt; BlockHash -&gt; IO ()
</span><a href="Chainweb.Pact.Backend.Types.html#_cpSave"><span class="hs-identifier hs-var hs-var">_cpSave</span></a></span><span> </span><span class="annot"><span class="annottext">Checkpointer
</span><a href="#local-6989586621681489636"><span class="hs-identifier hs-var">_cpeCheckpointer</span></a></span><span> </span><span class="annot"><span class="annottext">BlockHash
</span><a href="#local-6989586621681489628"><span class="hs-identifier hs-var">hash01</span></a></span><span>
</span><span id="line-310"></span><span>        </span><span class="annot"><span class="annottext">NoopNFData (Domain RowKey (ObjectMap PactValue))
-&gt; IO (NoopNFData (Domain RowKey (ObjectMap PactValue)))
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">NoopNFData (Domain RowKey (ObjectMap PactValue))
</span><a href="#local-6989586621681489634"><span class="hs-identifier hs-var">usertablename</span></a></span><span>
</span><span id="line-311"></span><span>
</span><span id="line-312"></span><span>    </span><span id="local-6989586621681489629"><span class="annot"><span class="annottext">f :: FieldKey
</span><a href="#local-6989586621681489629"><span class="hs-identifier hs-var hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-string">&quot;f&quot;</span></span><span>
</span><span id="line-313"></span><span>
</span><span id="line-314"></span><span>    </span><span id="local-6989586621681489628"><span class="annot"><span class="annottext">hash01 :: BlockHash
</span><a href="#local-6989586621681489628"><span class="hs-identifier hs-var hs-var">hash01</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MerkleLogHash -&gt; BlockHash
</span><a href="Chainweb.BlockHash.html#BlockHash"><span class="hs-identifier hs-var">BlockHash</span></a></span><span> </span><span class="annot"><span class="annottext">(MerkleLogHash -&gt; BlockHash) -&gt; MerkleLogHash -&gt; BlockHash
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">HasCallStack =&gt; ByteString -&gt; MerkleLogHash
ByteString -&gt; MerkleLogHash
</span><a href="Chainweb.MerkleLogHash.html#unsafeMerkleLogHash"><span class="hs-identifier hs-var">unsafeMerkleLogHash</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;0000000000000000000000000000001a&quot;</span></span><span>
</span><span id="line-315"></span><span>    </span><span id="local-6989586621681489627"><span class="annot"><span class="annottext">hash02 :: BlockHash
</span><a href="#local-6989586621681489627"><span class="hs-identifier hs-var hs-var">hash02</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MerkleLogHash -&gt; BlockHash
</span><a href="Chainweb.BlockHash.html#BlockHash"><span class="hs-identifier hs-var">BlockHash</span></a></span><span> </span><span class="annot"><span class="annottext">(MerkleLogHash -&gt; BlockHash) -&gt; MerkleLogHash -&gt; BlockHash
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">HasCallStack =&gt; ByteString -&gt; MerkleLogHash
ByteString -&gt; MerkleLogHash
</span><a href="Chainweb.MerkleLogHash.html#unsafeMerkleLogHash"><span class="hs-identifier hs-var">unsafeMerkleLogHash</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;0000000000000000000000000000002a&quot;</span></span><span>
</span><span id="line-316"></span><span>
</span><span id="line-317"></span><span>    </span><span id="local-6989586621681489637"><span class="annot"><span class="annottext">go :: CheckpointEnv
-&gt; NoopNFData (Domain RowKey (ObjectMap PactValue)) -&gt; IO ()
</span><a href="#local-6989586621681489637"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621681489625"><span id="local-6989586621681489626"><span class="annot"><a href="Chainweb.Pact.Backend.Types.html#CheckpointEnv"><span class="hs-identifier hs-type">CheckpointEnv</span></a></span><span class="hs-special">{</span><span class="hs-glyph">..</span><span class="hs-special">}</span></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Chainweb.Utils.Bench.html#NoopNFData"><span class="hs-identifier hs-type">NoopNFData</span></a></span><span> </span><span id="local-6989586621681489624"><span class="annot"><span class="annottext">ut :: Domain RowKey (ObjectMap PactValue)
</span><a href="#local-6989586621681489624"><span class="hs-identifier hs-var">ut</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-318"></span><span>        </span><span class="annot"><span class="annottext">Checkpointer -&gt; Maybe (BlockHeight, BlockHash) -&gt; IO PactDbEnv'
</span><a href="Chainweb.Pact.Backend.Types.html#_cpRestore"><span class="hs-identifier hs-var hs-var">_cpRestore</span></a></span><span> </span><span class="annot"><span class="annottext">Checkpointer
</span><a href="#local-6989586621681489626"><span class="hs-identifier hs-var">_cpeCheckpointer</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(BlockHeight, BlockHash) -&gt; Maybe (BlockHeight, BlockHash)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64 -&gt; BlockHeight
</span><a href="Chainweb.BlockHeader.html#BlockHeight"><span class="hs-identifier hs-var">BlockHeight</span></a></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">BlockHash
</span><a href="#local-6989586621681489628"><span class="hs-identifier hs-var">hash01</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">IO PactDbEnv' -&gt; (PactDbEnv' -&gt; IO ()) -&gt; IO ()
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-319"></span><span>            </span><span class="annot"><a href="Chainweb.Pact.Backend.Types.html#PactDbEnv%27"><span class="hs-identifier hs-type">PactDbEnv'</span></a></span><span> </span><span id="local-6989586621681489623"><span class="annot"><span class="annottext">pactdbenv :: PactDbEnv e
</span><a href="#local-6989586621681489623"><span class="hs-identifier hs-var">pactdbenv</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Int] -&gt; (Int -&gt; IO Integer) -&gt; IO ()
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
t a -&gt; (a -&gt; m b) -&gt; m ()
</span><span class="hs-identifier hs-var">forM_</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-number">1</span></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681489642"><span class="hs-identifier hs-var">numKeys</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PactDbEnv e -&gt; Int -&gt; IO Integer
forall a e. Show a =&gt; PactDbEnv e -&gt; a -&gt; IO Integer
</span><a href="#local-6989586621681489622"><span class="hs-identifier hs-var">transaction</span></a></span><span> </span><span class="annot"><span class="annottext">PactDbEnv e
</span><a href="#local-6989586621681489623"><span class="hs-identifier hs-var">pactdbenv</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-320"></span><span>        </span><span class="annot"><span class="annottext">IO () -&gt; IO ()
forall (f :: * -&gt; *) a. Functor f =&gt; f a -&gt; f ()
</span><span class="hs-identifier hs-var">void</span></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; IO ()) -&gt; IO () -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Checkpointer -&gt; BlockHash -&gt; IO ()
</span><a href="Chainweb.Pact.Backend.Types.html#_cpSave"><span class="hs-identifier hs-var hs-var">_cpSave</span></a></span><span> </span><span class="annot"><span class="annottext">Checkpointer
</span><a href="#local-6989586621681489626"><span class="hs-identifier hs-var">_cpeCheckpointer</span></a></span><span> </span><span class="annot"><span class="annottext">BlockHash
</span><a href="#local-6989586621681489627"><span class="hs-identifier hs-var">hash02</span></a></span><span>
</span><span id="line-321"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-322"></span><span>        </span><span id="local-6989586621681489622"><span class="annot"><span class="annottext">transaction :: PactDbEnv e -&gt; a -&gt; IO Integer
</span><a href="#local-6989586621681489622"><span class="hs-identifier hs-var hs-var">transaction</span></a></span></span><span> </span><span id="local-6989586621681489621"><span class="annot"><span class="annottext">db :: PactDbEnv e
</span><a href="#local-6989586621681489621"><span class="hs-identifier hs-var">db</span></a></span></span><span> </span><span id="local-6989586621681489620"><span class="annot"><span class="annottext">numkey :: a
</span><a href="#local-6989586621681489620"><span class="hs-identifier hs-var">numkey</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-323"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681489619"><span class="annot"><span class="annottext">rowkey :: RowKey
</span><a href="#local-6989586621681489619"><span class="hs-identifier hs-var hs-var">rowkey</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; RowKey
</span><span class="hs-identifier hs-var">RowKey</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; RowKey) -&gt; Text -&gt; RowKey
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="hs-string">&quot;k&quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Text
forall a b. StringConv a b =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">toS</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681489620"><span class="hs-identifier hs-var">numkey</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-324"></span><span>            </span><span class="annot"><span class="annottext">PactDbEnv e
-&gt; Domain RowKey (ObjectMap PactValue)
-&gt; FieldKey
-&gt; RowKey
-&gt; Integer
-&gt; IO Integer
forall e.
PactDbEnv e
-&gt; Domain RowKey (ObjectMap PactValue)
-&gt; FieldKey
-&gt; RowKey
-&gt; Integer
-&gt; IO Integer
</span><a href="Chainweb.Pact.Backend.Bench.html#incIntegerAtKey"><span class="hs-identifier hs-var">incIntegerAtKey</span></a></span><span> </span><span class="annot"><span class="annottext">PactDbEnv e
</span><a href="#local-6989586621681489621"><span class="hs-identifier hs-var">db</span></a></span><span> </span><span class="annot"><span class="annottext">Domain RowKey (ObjectMap PactValue)
</span><a href="#local-6989586621681489624"><span class="hs-identifier hs-var">ut</span></a></span><span> </span><span class="annot"><span class="annottext">FieldKey
</span><a href="#local-6989586621681489629"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">RowKey
</span><a href="#local-6989586621681489619"><span class="hs-identifier hs-var">rowkey</span></a></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span>
</span><span id="line-325"></span><span>
</span><span id="line-326"></span><span class="annot"><a href="Chainweb.Pact.Backend.Bench.html#cpBenchSampleKeys"><span class="hs-identifier hs-type">cpBenchSampleKeys</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Chainweb.Pact.Backend.Types.html#CheckpointEnv"><span class="hs-identifier hs-type">CheckpointEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">C.Benchmark</span></span><span>
</span><span id="line-327"></span><span id="cpBenchSampleKeys"><span class="annot"><span class="annottext">cpBenchSampleKeys :: Int -&gt; CheckpointEnv -&gt; Benchmark
</span><a href="Chainweb.Pact.Backend.Bench.html#cpBenchSampleKeys"><span class="hs-identifier hs-var hs-var">cpBenchSampleKeys</span></a></span></span><span> </span><span id="local-6989586621681489618"><span class="annot"><span class="annottext">numSampleEvents :: Int
</span><a href="#local-6989586621681489618"><span class="hs-identifier hs-var">numSampleEvents</span></a></span></span><span> </span><span id="local-6989586621681489617"><span class="annot"><span class="annottext">cp :: CheckpointEnv
</span><a href="#local-6989586621681489617"><span class="hs-identifier hs-var">cp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-328"></span><span>    </span><span class="annot"><span class="annottext">IO (NoopNFData (Domain RowKey (ObjectMap PactValue)))
-&gt; (NoopNFData (Domain RowKey (ObjectMap PactValue)) -&gt; Benchmark)
-&gt; Benchmark
forall env. NFData env =&gt; IO env -&gt; (env -&gt; Benchmark) -&gt; Benchmark
</span><span class="hs-identifier hs-var">C.env</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CheckpointEnv
-&gt; IO (NoopNFData (Domain RowKey (ObjectMap PactValue)))
</span><a href="#local-6989586621681489616"><span class="hs-identifier hs-var">setup'</span></a></span><span> </span><span class="annot"><span class="annottext">CheckpointEnv
</span><a href="#local-6989586621681489617"><span class="hs-identifier hs-var">cp</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((NoopNFData (Domain RowKey (ObjectMap PactValue)) -&gt; Benchmark)
 -&gt; Benchmark)
-&gt; (NoopNFData (Domain RowKey (ObjectMap PactValue)) -&gt; Benchmark)
-&gt; Benchmark
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span> </span><span class="hs-glyph">~</span><span class="hs-special">(</span><span id="local-6989586621681489615"><span class="annot"><span class="annottext">NoopNFData (Domain RowKey (ObjectMap PactValue))
</span><a href="#local-6989586621681489615"><span class="hs-identifier hs-var">ut</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; Benchmarkable -&gt; Benchmark
</span><span class="hs-identifier hs-var">C.bench</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621681489614"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">(Benchmarkable -&gt; Benchmark) -&gt; Benchmarkable -&gt; Benchmark
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">IO () -&gt; Benchmarkable
forall a. NFData a =&gt; IO a -&gt; Benchmarkable
</span><span class="hs-identifier hs-var">C.nfIO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CheckpointEnv
-&gt; NoopNFData (Domain RowKey (ObjectMap PactValue)) -&gt; IO ()
</span><a href="#local-6989586621681489613"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">CheckpointEnv
</span><a href="#local-6989586621681489617"><span class="hs-identifier hs-var">cp</span></a></span><span> </span><span class="annot"><span class="annottext">NoopNFData (Domain RowKey (ObjectMap PactValue))
</span><a href="#local-6989586621681489615"><span class="hs-identifier hs-var">ut</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-329"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-330"></span><span>    </span><span id="local-6989586621681489614"><span class="annot"><span class="annottext">name :: String
</span><a href="#local-6989586621681489614"><span class="hs-identifier hs-var hs-var">name</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-string">&quot;user-table-keys/sampleEvents=&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681489618"><span class="hs-identifier hs-var">numSampleEvents</span></a></span><span>
</span><span id="line-331"></span><span>    </span><span class="annot"><a href="#local-6989586621681489612"><span class="hs-identifier hs-type">numberOfKeys</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span>
</span><span id="line-332"></span><span>    </span><span id="local-6989586621681489612"><span class="annot"><span class="annottext">numberOfKeys :: Integer
</span><a href="#local-6989586621681489612"><span class="hs-identifier hs-var hs-var">numberOfKeys</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-number">10</span></span><span>
</span><span id="line-333"></span><span>    </span><span id="local-6989586621681489616"><span class="annot"><span class="annottext">setup' :: CheckpointEnv
-&gt; IO (NoopNFData (Domain RowKey (ObjectMap PactValue)))
</span><a href="#local-6989586621681489616"><span class="hs-identifier hs-var hs-var">setup'</span></a></span></span><span> </span><span id="local-6989586621681489610"><span id="local-6989586621681489611"><span class="annot"><a href="Chainweb.Pact.Backend.Types.html#CheckpointEnv"><span class="hs-identifier hs-type">CheckpointEnv</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-glyph">..</span><span class="hs-special">}</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-334"></span><span>        </span><span id="local-6989586621681489609"><span class="annot"><span class="annottext">NoopNFData (Domain RowKey (ObjectMap PactValue))
</span><a href="#local-6989586621681489609"><span class="hs-identifier hs-var">usertablename</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Checkpointer -&gt; Maybe (BlockHeight, BlockHash) -&gt; IO PactDbEnv'
</span><a href="Chainweb.Pact.Backend.Types.html#_cpRestore"><span class="hs-identifier hs-var hs-var">_cpRestore</span></a></span><span> </span><span class="annot"><span class="annottext">Checkpointer
</span><a href="#local-6989586621681489611"><span class="hs-identifier hs-var">_cpeCheckpointer</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (BlockHeight, BlockHash)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="annot"><span class="annottext">IO PactDbEnv'
-&gt; (PactDbEnv'
    -&gt; IO (NoopNFData (Domain RowKey (ObjectMap PactValue))))
-&gt; IO (NoopNFData (Domain RowKey (ObjectMap PactValue)))
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-335"></span><span>            </span><span class="annot"><a href="Chainweb.Pact.Backend.Types.html#PactDbEnv%27"><span class="hs-identifier hs-type">PactDbEnv'</span></a></span><span> </span><span id="local-6989586621681489608"><span class="annot"><span class="annottext">db :: PactDbEnv e
</span><a href="#local-6989586621681489608"><span class="hs-identifier hs-var">db</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-336"></span><span>              </span><span class="annot"><span class="annottext">PactDbEnv e
-&gt; (Domain RowKey (ObjectMap PactValue) -&gt; IO ())
-&gt; IO (NoopNFData (Domain RowKey (ObjectMap PactValue)))
forall e.
PactDbEnv e
-&gt; (Domain RowKey (ObjectMap PactValue) -&gt; IO ())
-&gt; IO (NoopNFData (Domain RowKey (ObjectMap PactValue)))
</span><a href="Chainweb.Pact.Backend.Bench.html#setupUserTable"><span class="hs-identifier hs-var">setupUserTable</span></a></span><span> </span><span class="annot"><span class="annottext">PactDbEnv e
</span><a href="#local-6989586621681489608"><span class="hs-identifier hs-var">db</span></a></span><span> </span><span class="annot"><span class="annottext">((Domain RowKey (ObjectMap PactValue) -&gt; IO ())
 -&gt; IO (NoopNFData (Domain RowKey (ObjectMap PactValue))))
-&gt; (Domain RowKey (ObjectMap PactValue) -&gt; IO ())
-&gt; IO (NoopNFData (Domain RowKey (ObjectMap PactValue)))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621681489607"><span class="annot"><span class="annottext">ut :: Domain RowKey (ObjectMap PactValue)
</span><a href="#local-6989586621681489607"><span class="hs-identifier hs-var">ut</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Integer] -&gt; (Integer -&gt; IO ()) -&gt; IO ()
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
t a -&gt; (a -&gt; m b) -&gt; m ()
</span><span class="hs-identifier hs-var">forM_</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-number">1</span></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621681489612"><span class="hs-identifier hs-var">numberOfKeys</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">((Integer -&gt; IO ()) -&gt; IO ()) -&gt; (Integer -&gt; IO ()) -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621681489606"><span class="annot"><span class="annottext">i :: Integer
</span><a href="#local-6989586621681489606"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-337"></span><span>                  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681489605"><span class="annot"><span class="annottext">rowkey :: RowKey
</span><a href="#local-6989586621681489605"><span class="hs-identifier hs-var hs-var">rowkey</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; RowKey
</span><span class="hs-identifier hs-var">RowKey</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; RowKey) -&gt; Text -&gt; RowKey
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="hs-string">&quot;k&quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Text
forall a b. StringConv a b =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">toS</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621681489606"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-338"></span><span>                  </span><span class="annot"><span class="annottext">PactDbEnv e
-&gt; WriteType
-&gt; Domain RowKey (ObjectMap PactValue)
-&gt; FieldKey
-&gt; RowKey
-&gt; Integer
-&gt; IO ()
forall k e.
AsString k =&gt;
PactDbEnv e
-&gt; WriteType
-&gt; Domain k (ObjectMap PactValue)
-&gt; FieldKey
-&gt; k
-&gt; Integer
-&gt; IO ()
</span><a href="Chainweb.Pact.Backend.Bench.html#writeRow"><span class="hs-identifier hs-var">writeRow</span></a></span><span> </span><span class="annot"><span class="annottext">PactDbEnv e
</span><a href="#local-6989586621681489608"><span class="hs-identifier hs-var">db</span></a></span><span> </span><span class="annot"><span class="annottext">WriteType
</span><span class="hs-identifier hs-var">Insert</span></span><span> </span><span class="annot"><span class="annottext">Domain RowKey (ObjectMap PactValue)
</span><a href="#local-6989586621681489607"><span class="hs-identifier hs-var">ut</span></a></span><span> </span><span class="annot"><span class="annottext">FieldKey
</span><a href="#local-6989586621681489604"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">RowKey
</span><a href="#local-6989586621681489605"><span class="hs-identifier hs-var">rowkey</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621681489606"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-339"></span><span>
</span><span id="line-340"></span><span>        </span><span class="annot"><span class="annottext">Checkpointer -&gt; BlockHash -&gt; IO ()
</span><a href="Chainweb.Pact.Backend.Types.html#_cpSave"><span class="hs-identifier hs-var hs-var">_cpSave</span></a></span><span> </span><span class="annot"><span class="annottext">Checkpointer
</span><a href="#local-6989586621681489611"><span class="hs-identifier hs-var">_cpeCheckpointer</span></a></span><span> </span><span class="annot"><span class="annottext">BlockHash
</span><a href="#local-6989586621681489603"><span class="hs-identifier hs-var">hash01</span></a></span><span>
</span><span id="line-341"></span><span>        </span><span class="annot"><span class="annottext">NoopNFData (Domain RowKey (ObjectMap PactValue))
-&gt; IO (NoopNFData (Domain RowKey (ObjectMap PactValue)))
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">NoopNFData (Domain RowKey (ObjectMap PactValue))
</span><a href="#local-6989586621681489609"><span class="hs-identifier hs-var">usertablename</span></a></span><span>
</span><span id="line-342"></span><span>
</span><span id="line-343"></span><span>    </span><span id="local-6989586621681489602"><span class="annot"><span class="annottext">unpack :: Maybe (ObjectMap PactValue) -&gt; IO Integer
</span><a href="#local-6989586621681489602"><span class="hs-identifier hs-var hs-var">unpack</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-344"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; IO Integer
forall a. String -&gt; IO a
</span><a href="Chainweb.Pact.Backend.Bench.html#die"><span class="hs-identifier hs-var">die</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;no row read&quot;</span></span><span>
</span><span id="line-345"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ObjectMap</span></span><span> </span><span id="local-6989586621681489601"><span class="annot"><span class="annottext">m :: Map FieldKey PactValue
</span><a href="#local-6989586621681489601"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">FieldKey -&gt; Map FieldKey PactValue -&gt; Maybe PactValue
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><span class="hs-identifier hs-var">M.lookup</span></span><span> </span><span class="annot"><span class="annottext">FieldKey
</span><a href="#local-6989586621681489604"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Map FieldKey PactValue
</span><a href="#local-6989586621681489601"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-346"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; IO Integer
forall a. String -&gt; IO a
</span><a href="Chainweb.Pact.Backend.Bench.html#die"><span class="hs-identifier hs-var">die</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;field not found&quot;</span></span><span>
</span><span id="line-347"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">PLiteral</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">LInteger</span></span><span> </span><span id="local-6989586621681489600"><span class="annot"><span class="annottext">result :: Integer
</span><a href="#local-6989586621681489600"><span class="hs-identifier hs-var">result</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; IO Integer
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621681489600"><span class="hs-identifier hs-var">result</span></a></span><span>
</span><span id="line-348"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; IO Integer
forall a. String -&gt; IO a
</span><a href="Chainweb.Pact.Backend.Bench.html#die"><span class="hs-identifier hs-var">die</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;field not integer&quot;</span></span><span>
</span><span id="line-349"></span><span>
</span><span id="line-350"></span><span>
</span><span id="line-351"></span><span>    </span><span id="local-6989586621681489603"><span class="annot"><span class="annottext">hash01 :: BlockHash
</span><a href="#local-6989586621681489603"><span class="hs-identifier hs-var hs-var">hash01</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MerkleLogHash -&gt; BlockHash
</span><a href="Chainweb.BlockHash.html#BlockHash"><span class="hs-identifier hs-var">BlockHash</span></a></span><span> </span><span class="annot"><span class="annottext">(MerkleLogHash -&gt; BlockHash) -&gt; MerkleLogHash -&gt; BlockHash
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">HasCallStack =&gt; ByteString -&gt; MerkleLogHash
ByteString -&gt; MerkleLogHash
</span><a href="Chainweb.MerkleLogHash.html#unsafeMerkleLogHash"><span class="hs-identifier hs-var">unsafeMerkleLogHash</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;0000000000000000000000000000001a&quot;</span></span><span>
</span><span id="line-352"></span><span>    </span><span id="local-6989586621681489599"><span class="annot"><span class="annottext">hash02 :: BlockHash
</span><a href="#local-6989586621681489599"><span class="hs-identifier hs-var hs-var">hash02</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MerkleLogHash -&gt; BlockHash
</span><a href="Chainweb.BlockHash.html#BlockHash"><span class="hs-identifier hs-var">BlockHash</span></a></span><span> </span><span class="annot"><span class="annottext">(MerkleLogHash -&gt; BlockHash) -&gt; MerkleLogHash -&gt; BlockHash
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">HasCallStack =&gt; ByteString -&gt; MerkleLogHash
ByteString -&gt; MerkleLogHash
</span><a href="Chainweb.MerkleLogHash.html#unsafeMerkleLogHash"><span class="hs-identifier hs-var">unsafeMerkleLogHash</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;0000000000000000000000000000002a&quot;</span></span><span>
</span><span id="line-353"></span><span>
</span><span id="line-354"></span><span>    </span><span id="local-6989586621681489604"><span class="annot"><span class="annottext">f :: FieldKey
</span><a href="#local-6989586621681489604"><span class="hs-identifier hs-var hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-string">&quot;f&quot;</span></span><span>
</span><span id="line-355"></span><span>
</span><span id="line-356"></span><span>    </span><span id="local-6989586621681489613"><span class="annot"><span class="annottext">go :: CheckpointEnv
-&gt; NoopNFData (Domain RowKey (ObjectMap PactValue)) -&gt; IO ()
</span><a href="#local-6989586621681489613"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621681489597"><span id="local-6989586621681489598"><span class="annot"><a href="Chainweb.Pact.Backend.Types.html#CheckpointEnv"><span class="hs-identifier hs-type">CheckpointEnv</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-glyph">..</span><span class="hs-special">}</span></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Chainweb.Utils.Bench.html#NoopNFData"><span class="hs-identifier hs-type">NoopNFData</span></a></span><span> </span><span id="local-6989586621681489596"><span class="annot"><span class="annottext">ut :: Domain RowKey (ObjectMap PactValue)
</span><a href="#local-6989586621681489596"><span class="hs-identifier hs-var">ut</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-357"></span><span>        </span><span class="annot"><span class="annottext">Checkpointer -&gt; Maybe (BlockHeight, BlockHash) -&gt; IO PactDbEnv'
</span><a href="Chainweb.Pact.Backend.Types.html#_cpRestore"><span class="hs-identifier hs-var hs-var">_cpRestore</span></a></span><span> </span><span class="annot"><span class="annottext">Checkpointer
</span><a href="#local-6989586621681489598"><span class="hs-identifier hs-var">_cpeCheckpointer</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(BlockHeight, BlockHash) -&gt; Maybe (BlockHeight, BlockHash)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64 -&gt; BlockHeight
</span><a href="Chainweb.BlockHeader.html#BlockHeight"><span class="hs-identifier hs-var">BlockHeight</span></a></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">BlockHash
</span><a href="#local-6989586621681489603"><span class="hs-identifier hs-var">hash01</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">IO PactDbEnv' -&gt; (PactDbEnv' -&gt; IO ()) -&gt; IO ()
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-358"></span><span>              </span><span class="annot"><a href="Chainweb.Pact.Backend.Types.html#PactDbEnv%27"><span class="hs-identifier hs-type">PactDbEnv'</span></a></span><span> </span><span id="local-6989586621681489595"><span class="annot"><span class="annottext">db :: PactDbEnv e
</span><a href="#local-6989586621681489595"><span class="hs-identifier hs-var">db</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">PactDbEnv</span></span><span> </span><span id="local-6989586621681489594"><span class="annot"><span class="annottext">pdb :: PactDb e
</span><a href="#local-6989586621681489594"><span class="hs-identifier hs-var">pdb</span></a></span></span><span> </span><span id="local-6989586621681489593"><span class="annot"><span class="annottext">e :: MVar e
</span><a href="#local-6989586621681489593"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-359"></span><span>                </span><span class="annot"><span class="annottext">[Int] -&gt; (Int -&gt; IO ()) -&gt; IO ()
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
t a -&gt; (a -&gt; m b) -&gt; m ()
</span><span class="hs-identifier hs-var">forM_</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-number">1</span></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681489618"><span class="hs-identifier hs-var">numSampleEvents</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">((Int -&gt; IO ()) -&gt; IO ()) -&gt; (Int -&gt; IO ()) -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-360"></span><span>                    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681489592"><span class="annot"><span class="annottext">torowkey :: a -&gt; RowKey
</span><a href="#local-6989586621681489592"><span class="hs-identifier hs-var hs-var">torowkey</span></a></span></span><span> </span><span id="local-6989586621681489591"><span class="annot"><span class="annottext">ind :: a
</span><a href="#local-6989586621681489591"><span class="hs-identifier hs-var">ind</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; RowKey
</span><span class="hs-identifier hs-var">RowKey</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; RowKey) -&gt; Text -&gt; RowKey
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="hs-string">&quot;k&quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Text
forall a b. StringConv a b =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">toS</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681489591"><span class="hs-identifier hs-var">ind</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-361"></span><span>                    </span><span id="local-6989586621681489590"><span class="annot"><span class="annottext">RowKey
</span><a href="#local-6989586621681489590"><span class="hs-identifier hs-var">rowkeya</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; RowKey
forall a. Show a =&gt; a -&gt; RowKey
</span><a href="#local-6989586621681489592"><span class="hs-identifier hs-var">torowkey</span></a></span><span> </span><span class="annot"><span class="annottext">(Integer -&gt; RowKey) -&gt; IO Integer -&gt; IO RowKey
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">(Integer, Integer) -&gt; IO Integer
forall a. Random a =&gt; (a, a) -&gt; IO a
</span><span class="hs-identifier hs-var">randomRIO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621681489612"><span class="hs-identifier hs-var">numberOfKeys</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-362"></span><span>                    </span><span id="local-6989586621681489589"><span class="annot"><span class="annottext">RowKey
</span><a href="#local-6989586621681489589"><span class="hs-identifier hs-var">rowkeyb</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; RowKey
forall a. Show a =&gt; a -&gt; RowKey
</span><a href="#local-6989586621681489592"><span class="hs-identifier hs-var">torowkey</span></a></span><span> </span><span class="annot"><span class="annottext">(Integer -&gt; RowKey) -&gt; IO Integer -&gt; IO RowKey
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">(Integer, Integer) -&gt; IO Integer
forall a. Random a =&gt; (a, a) -&gt; IO a
</span><span class="hs-identifier hs-var">randomRIO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621681489612"><span class="hs-identifier hs-var">numberOfKeys</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-363"></span><span>                    </span><span id="local-6989586621681489588"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621681489588"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">PactDb e
-&gt; Domain RowKey (ObjectMap PactValue)
-&gt; RowKey
-&gt; Method e (Maybe (ObjectMap PactValue))
forall e.
PactDb e
-&gt; forall k v.
   (IsString k, FromJSON v) =&gt;
   Domain k v -&gt; k -&gt; Method e (Maybe v)
</span><span class="hs-identifier hs-var hs-var">_readRow</span></span><span> </span><span class="annot"><span class="annottext">PactDb e
</span><a href="#local-6989586621681489594"><span class="hs-identifier hs-var">pdb</span></a></span><span> </span><span class="annot"><span class="annottext">Domain RowKey (ObjectMap PactValue)
</span><a href="#local-6989586621681489596"><span class="hs-identifier hs-var">ut</span></a></span><span> </span><span class="annot"><span class="annottext">RowKey
</span><a href="#local-6989586621681489590"><span class="hs-identifier hs-var">rowkeya</span></a></span><span> </span><span class="annot"><span class="annottext">MVar e
</span><a href="#local-6989586621681489593"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">IO (Maybe (ObjectMap PactValue))
-&gt; (Maybe (ObjectMap PactValue) -&gt; IO Integer) -&gt; IO Integer
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Maybe (ObjectMap PactValue) -&gt; IO Integer
</span><a href="#local-6989586621681489602"><span class="hs-identifier hs-var">unpack</span></a></span><span>
</span><span id="line-364"></span><span>                    </span><span id="local-6989586621681489587"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621681489587"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">PactDb e
-&gt; Domain RowKey (ObjectMap PactValue)
-&gt; RowKey
-&gt; Method e (Maybe (ObjectMap PactValue))
forall e.
PactDb e
-&gt; forall k v.
   (IsString k, FromJSON v) =&gt;
   Domain k v -&gt; k -&gt; Method e (Maybe v)
</span><span class="hs-identifier hs-var hs-var">_readRow</span></span><span> </span><span class="annot"><span class="annottext">PactDb e
</span><a href="#local-6989586621681489594"><span class="hs-identifier hs-var">pdb</span></a></span><span> </span><span class="annot"><span class="annottext">Domain RowKey (ObjectMap PactValue)
</span><a href="#local-6989586621681489596"><span class="hs-identifier hs-var">ut</span></a></span><span> </span><span class="annot"><span class="annottext">RowKey
</span><a href="#local-6989586621681489589"><span class="hs-identifier hs-var">rowkeyb</span></a></span><span> </span><span class="annot"><span class="annottext">MVar e
</span><a href="#local-6989586621681489593"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">IO (Maybe (ObjectMap PactValue))
-&gt; (Maybe (ObjectMap PactValue) -&gt; IO Integer) -&gt; IO Integer
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Maybe (ObjectMap PactValue) -&gt; IO Integer
</span><a href="#local-6989586621681489602"><span class="hs-identifier hs-var">unpack</span></a></span><span>
</span><span id="line-365"></span><span>                    </span><span class="annot"><span class="annottext">PactDbEnv e
-&gt; WriteType
-&gt; Domain RowKey (ObjectMap PactValue)
-&gt; FieldKey
-&gt; RowKey
-&gt; Integer
-&gt; IO ()
forall k e.
AsString k =&gt;
PactDbEnv e
-&gt; WriteType
-&gt; Domain k (ObjectMap PactValue)
-&gt; FieldKey
-&gt; k
-&gt; Integer
-&gt; IO ()
</span><a href="Chainweb.Pact.Backend.Bench.html#writeRow"><span class="hs-identifier hs-var">writeRow</span></a></span><span> </span><span class="annot"><span class="annottext">PactDbEnv e
</span><a href="#local-6989586621681489595"><span class="hs-identifier hs-var">db</span></a></span><span> </span><span class="annot"><span class="annottext">WriteType
</span><span class="hs-identifier hs-var">Update</span></span><span> </span><span class="annot"><span class="annottext">Domain RowKey (ObjectMap PactValue)
</span><a href="#local-6989586621681489596"><span class="hs-identifier hs-var">ut</span></a></span><span> </span><span class="annot"><span class="annottext">FieldKey
</span><a href="#local-6989586621681489604"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">RowKey
</span><a href="#local-6989586621681489590"><span class="hs-identifier hs-var">rowkeya</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621681489587"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-366"></span><span>                    </span><span class="annot"><span class="annottext">PactDbEnv e
-&gt; WriteType
-&gt; Domain RowKey (ObjectMap PactValue)
-&gt; FieldKey
-&gt; RowKey
-&gt; Integer
-&gt; IO ()
forall k e.
AsString k =&gt;
PactDbEnv e
-&gt; WriteType
-&gt; Domain k (ObjectMap PactValue)
-&gt; FieldKey
-&gt; k
-&gt; Integer
-&gt; IO ()
</span><a href="Chainweb.Pact.Backend.Bench.html#writeRow"><span class="hs-identifier hs-var">writeRow</span></a></span><span> </span><span class="annot"><span class="annottext">PactDbEnv e
</span><a href="#local-6989586621681489595"><span class="hs-identifier hs-var">db</span></a></span><span> </span><span class="annot"><span class="annottext">WriteType
</span><span class="hs-identifier hs-var">Update</span></span><span> </span><span class="annot"><span class="annottext">Domain RowKey (ObjectMap PactValue)
</span><a href="#local-6989586621681489596"><span class="hs-identifier hs-var">ut</span></a></span><span> </span><span class="annot"><span class="annottext">FieldKey
</span><a href="#local-6989586621681489604"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">RowKey
</span><a href="#local-6989586621681489589"><span class="hs-identifier hs-var">rowkeyb</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621681489588"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-367"></span><span>        </span><span class="annot"><span class="annottext">IO () -&gt; IO ()
forall (f :: * -&gt; *) a. Functor f =&gt; f a -&gt; f ()
</span><span class="hs-identifier hs-var">void</span></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; IO ()) -&gt; IO () -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Checkpointer -&gt; BlockHash -&gt; IO ()
</span><a href="Chainweb.Pact.Backend.Types.html#_cpSave"><span class="hs-identifier hs-var hs-var">_cpSave</span></a></span><span> </span><span class="annot"><span class="annottext">Checkpointer
</span><a href="#local-6989586621681489598"><span class="hs-identifier hs-var">_cpeCheckpointer</span></a></span><span> </span><span class="annot"><span class="annottext">BlockHash
</span><a href="#local-6989586621681489599"><span class="hs-identifier hs-var">hash02</span></a></span><span>
</span><span id="line-368"></span></pre></body></html>